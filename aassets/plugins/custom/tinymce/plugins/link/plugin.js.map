{"version":3,"sources":["link/plugin.js"],"names":["domGlobals","eq","call","id","me","global$1","tinymce","util","Tools","resolve","global$2","isType","type","value","x","t","Array","prototype","isPrototypeOf","constructor","name","String","typeOf","isString","isArray","isBoolean","isFunction","Settings","editor","externalTargets","getParam","OpenUrl","url","link","document","createElement","target","href","rel","evt","createEvent","initMouseEvent","window","body","appendChild","dispatchEvent","removeChild","appendClickRemove","noop","constant","never","always","none","NONE","o","isNone","fold","n","s","is","isSome","getOr","getOrThunk","thunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","Object","freeze","some","a","constant_a","self","f","v","elementEq","b","Option","from","nativeSlice","slice","nativeIndexOf","indexOf","nativePush","push","contains","xs","ts","i","len","length","flatten","r","apply","output","global$3","hasProtocol","test","applyRelTargetRules","isUnsafe","rules","rels","split","removeTargetRules","val","inArray","newRels","concat","addTargetRules","trim","sort","join","getAnchorElement","selectedElm","selection","getNode","isImageFigure","dom","select","getParent","isLink","elm","nodeName","className","getLinkAttrs","data","acc","key","unlinkImageFigure","fig","img","getParents","parentNode","insertBefore","remove","linkImageFigure","attrs","create","Utils","attachState","undoManager","transact","assumeExternalTargets","anchorElm","linkAttrs","newRel","attach","focus","text","hasOwnProperty","innerText","textContent","setAttribs","updateLink","execCommand","insertContent","createHTML","encode","createLink","node","getBody","elements","grep","getAttribute","html","replace","trimCaretContainers","getContent","format","cat","arr","findMap","getValue","item","sanitizeWith","extracter","list","extractValue","out","title","menu","sanitizeList","ListOptions","sanitize","createUi","label","items","Cell","initial","get","set","clone","getDelta","persistentText","fieldName","catalog","hasPersistentText","findTextByValue","meta","DialogChanges","initialData","linkSettings","onCatalogChange","change","settings","catalogs","anchor","onChange","getData","urlText","onUrlChange","__assign","assign","arguments","p","this","exports$1","module","exports","define","require","amd","global","EphoxContactWrapper","e","c","u","code","1","cachedSetTimeout","cachedClearTimeout","process","defaultSetTimout","defaultClearTimeout","runTimeout","fun","setTimeout","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","run","marker","runClearTimeout","Item","array","nextTick","args","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","2","setImmediate","root","setTimeoutFunc","Promise","fn","TypeError","_state","_handled","_value","_deferreds","doResolve","handle","deferred","_immediateFn","cb","onFulfilled","onRejected","ret","reject","promise","newValue","then","finale","thisArg","_unhandledRejectionFn","Handler","done","reason","ex","prom","all","remaining","res","race","values","err","console","warn","_setImmediateFn","_setUnhandledRejectionFn","timers","3","clearImmediate","Function","immediateIds","nextImmediateId","Timeout","clearFn","_id","_clearFn","setInterval","clearInterval","close","unref","ref","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","process/browser.js","4","promisePolyfill","Global","boltExport","promise-polyfill","nu","baseFn","callbacks","nCallback","isReady","cbs","LazyValue","pure","callback","errorReporter","make","fab","aFutureB","toPromise","anonBind","futureB","toLazy","toCached","cache","Future","global$4","tryEmailTransform","message","preprocess","oldData","tryProtocolTransform","DialogConfirms","transform","rng","getRng","setEditorTimeout","windowManager","confirm","state","setRng","delayedConfirm","AnchorListOptions","anchorNodes","anchors","ClassListOptions","global$5","LinkListOptions","extractor","convertURL","linkList","send","success","JSON","parse","parseJson","error","_","optItems","RelOptions","initialTarget","isTargetBlank_1","fallbacks","TargetOptions","nonEmptyAttr","elem","getAttrib","DialogInfo","linkNode","links","linkClass","extractFromAnchor","targets","classes","optNode","flags","titleEnabled","Dialog","anchorNode","collectData","info","onSubmit","api","getChangedValue","changedData","class","pData","handleSubmit","displayText","titleText","defaultTarget","original","getInitialData","dialogDelta","size","filetype","buttons","primary","_a","newData","setData","makeDialog","spec","open","getLink","getSelectedLink","getStart","gotoLink","targetEl","$","scrollIntoView","Actions","openDialog","gotoSelectedLink","leftClickedOnAHref","sel","startContainer","nodeType","isCollapsed","startOffset","setupGotoLinks","metaKeyPressed","preventDefault","keyCode","altKey","shiftKey","ctrlKey","metaKey","hasOnlyAltModifier","toggleActiveState","nodeChangeHandler","setActive","readonly","element","toggleEnabledState","setDisabled","parents","Commands","register","addCommand","fire","toolbarKey","Keyboard","setup","addShortcut","Controls","setupButtons","ui","registry","addToggleButton","icon","tooltip","onAction","onSetup","addButton","setupMenuItems","addMenuItem","shortcut","setupContextMenu","addContextMenu","update","setupContextToolbars","onSetupLink","buttonApi","addContextForm","launch","predicate","initValue","commands","formApi","setAttrib","collapse","collapseSelectionToEnd","hide","add"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isString = isType('string');\n    var isArray = isType('array');\n    var isBoolean = isType('boolean');\n    var isFunction = isType('function');\n\n    var assumeExternalTargets = function (editor) {\n      var externalTargets = editor.getParam('link_assume_external_targets', false);\n      if (isBoolean(externalTargets) && externalTargets) {\n        return 1;\n      } else if (isString(externalTargets) && (externalTargets === 'http' || externalTargets === 'https')) {\n        return externalTargets;\n      }\n      return 0;\n    };\n    var hasContextToolbar = function (editor) {\n      return editor.getParam('link_context_toolbar', false, 'boolean');\n    };\n    var getLinkList = function (editor) {\n      return editor.getParam('link_list');\n    };\n    var getDefaultLinkTarget = function (editor) {\n      return editor.getParam('default_link_target');\n    };\n    var getTargetList = function (editor) {\n      return editor.getParam('target_list', true);\n    };\n    var getRelList = function (editor) {\n      return editor.getParam('rel_list', [], 'array');\n    };\n    var getLinkClassList = function (editor) {\n      return editor.getParam('link_class_list', [], 'array');\n    };\n    var shouldShowLinkTitle = function (editor) {\n      return editor.getParam('link_title', true, 'boolean');\n    };\n    var allowUnsafeLinkTarget = function (editor) {\n      return editor.getParam('allow_unsafe_link_target', false, 'boolean');\n    };\n    var useQuickLink = function (editor) {\n      return editor.getParam('link_quicklink', false, 'boolean');\n    };\n    var Settings = {\n      assumeExternalTargets: assumeExternalTargets,\n      hasContextToolbar: hasContextToolbar,\n      getLinkList: getLinkList,\n      getDefaultLinkTarget: getDefaultLinkTarget,\n      getTargetList: getTargetList,\n      getRelList: getRelList,\n      getLinkClassList: getLinkClassList,\n      shouldShowLinkTitle: shouldShowLinkTitle,\n      allowUnsafeLinkTarget: allowUnsafeLinkTarget,\n      useQuickLink: useQuickLink\n    };\n\n    var appendClickRemove = function (link, evt) {\n      domGlobals.document.body.appendChild(link);\n      link.dispatchEvent(evt);\n      domGlobals.document.body.removeChild(link);\n    };\n    var open = function (url) {\n      var link = domGlobals.document.createElement('a');\n      link.target = '_blank';\n      link.href = url;\n      link.rel = 'noreferrer noopener';\n      var evt = domGlobals.document.createEvent('MouseEvents');\n      evt.initMouseEvent('click', true, true, domGlobals.window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n      appendClickRemove(link, evt);\n    };\n    var OpenUrl = { open: open };\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var nativeSlice = Array.prototype.slice;\n    var nativeIndexOf = Array.prototype.indexOf;\n    var nativePush = Array.prototype.push;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var contains = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      var output = map(xs, f);\n      return flatten(output);\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var hasProtocol = function (url) {\n      return /^\\w+:/i.test(url);\n    };\n    var getHref = function (elm) {\n      var href = elm.getAttribute('data-mce-href');\n      return href ? href : elm.getAttribute('href');\n    };\n    var applyRelTargetRules = function (rel, isUnsafe) {\n      var rules = ['noopener'];\n      var rels = rel ? rel.split(/\\s+/) : [];\n      var toString = function (rels) {\n        return global$3.trim(rels.sort().join(' '));\n      };\n      var addTargetRules = function (rels) {\n        rels = removeTargetRules(rels);\n        return rels.length > 0 ? rels.concat(rules) : rules;\n      };\n      var removeTargetRules = function (rels) {\n        return rels.filter(function (val) {\n          return global$3.inArray(rules, val) === -1;\n        });\n      };\n      var newRels = isUnsafe ? addTargetRules(rels) : removeTargetRules(rels);\n      return newRels.length > 0 ? toString(newRels) : '';\n    };\n    var trimCaretContainers = function (text) {\n      return text.replace(/\\uFEFF/g, '');\n    };\n    var getAnchorElement = function (editor, selectedElm) {\n      selectedElm = selectedElm || editor.selection.getNode();\n      if (isImageFigure(selectedElm)) {\n        return editor.dom.select('a[href]', selectedElm)[0];\n      } else {\n        return editor.dom.getParent(selectedElm, 'a[href]');\n      }\n    };\n    var getAnchorText = function (selection, anchorElm) {\n      var text = anchorElm ? anchorElm.innerText || anchorElm.textContent : selection.getContent({ format: 'text' });\n      return trimCaretContainers(text);\n    };\n    var isLink = function (elm) {\n      return elm && elm.nodeName === 'A' && !!elm.href;\n    };\n    var hasLinks = function (elements) {\n      return global$3.grep(elements, isLink).length > 0;\n    };\n    var isOnlyTextSelected = function (html) {\n      if (/</.test(html) && (!/^<a [^>]+>[^<]+<\\/a>$/.test(html) || html.indexOf('href=') === -1)) {\n        return false;\n      }\n      return true;\n    };\n    var isImageFigure = function (elm) {\n      return elm && elm.nodeName === 'FIGURE' && /\\bimage\\b/i.test(elm.className);\n    };\n    var getLinkAttrs = function (data) {\n      return foldl([\n        'title',\n        'rel',\n        'class',\n        'target'\n      ], function (acc, key) {\n        data[key].each(function (value) {\n          acc[key] = value.length > 0 ? value : null;\n        });\n        return acc;\n      }, { href: data.href });\n    };\n    var handleExternalTargets = function (href, assumeExternalTargets) {\n      if ((assumeExternalTargets === 'http' || assumeExternalTargets === 'https') && !hasProtocol(href)) {\n        return assumeExternalTargets + '://' + href;\n      }\n      return href;\n    };\n    var updateLink = function (editor, anchorElm, text, linkAttrs) {\n      text.each(function (text) {\n        if (anchorElm.hasOwnProperty('innerText')) {\n          anchorElm.innerText = text;\n        } else {\n          anchorElm.textContent = text;\n        }\n      });\n      editor.dom.setAttribs(anchorElm, linkAttrs);\n      editor.selection.select(anchorElm);\n    };\n    var createLink = function (editor, selectedElm, text, linkAttrs) {\n      if (isImageFigure(selectedElm)) {\n        linkImageFigure(editor, selectedElm, linkAttrs);\n      } else {\n        text.fold(function () {\n          editor.execCommand('mceInsertLink', false, linkAttrs);\n        }, function (text) {\n          editor.insertContent(editor.dom.createHTML('a', linkAttrs, editor.dom.encode(text)));\n        });\n      }\n    };\n    var link = function (editor, attachState, data) {\n      editor.undoManager.transact(function () {\n        var selectedElm = editor.selection.getNode();\n        var anchorElm = getAnchorElement(editor, selectedElm);\n        var linkAttrs = getLinkAttrs(data);\n        if (!(Settings.getRelList(editor).length > 0) && Settings.allowUnsafeLinkTarget(editor) === false) {\n          var newRel = applyRelTargetRules(linkAttrs.rel, linkAttrs.target === '_blank');\n          linkAttrs.rel = newRel ? newRel : null;\n        }\n        if (Option.from(linkAttrs.target).isNone()) {\n          linkAttrs.target = Settings.getDefaultLinkTarget(editor);\n        }\n        linkAttrs.href = handleExternalTargets(linkAttrs.href, Settings.assumeExternalTargets(editor));\n        if (data.href === attachState.href) {\n          attachState.attach();\n        }\n        if (anchorElm) {\n          editor.focus();\n          updateLink(editor, anchorElm, data.text, linkAttrs);\n        } else {\n          createLink(editor, selectedElm, data.text, linkAttrs);\n        }\n      });\n    };\n    var unlink = function (editor) {\n      editor.undoManager.transact(function () {\n        var node = editor.selection.getNode();\n        if (isImageFigure(node)) {\n          unlinkImageFigure(editor, node);\n        } else {\n          var anchorElm = editor.dom.getParent(node, 'a[href]', editor.getBody());\n          if (anchorElm) {\n            editor.dom.remove(anchorElm, true);\n          }\n        }\n        editor.focus();\n      });\n    };\n    var unlinkImageFigure = function (editor, fig) {\n      var img = editor.dom.select('img', fig)[0];\n      if (img) {\n        var a = editor.dom.getParents(img, 'a[href]', fig)[0];\n        if (a) {\n          a.parentNode.insertBefore(img, a);\n          editor.dom.remove(a);\n        }\n      }\n    };\n    var linkImageFigure = function (editor, fig, attrs) {\n      var img = editor.dom.select('img', fig)[0];\n      if (img) {\n        var a = editor.dom.create('a', attrs);\n        img.parentNode.insertBefore(a, img);\n        a.appendChild(img);\n      }\n    };\n    var Utils = {\n      link: link,\n      unlink: unlink,\n      isLink: isLink,\n      hasLinks: hasLinks,\n      getHref: getHref,\n      isOnlyTextSelected: isOnlyTextSelected,\n      getAnchorElement: getAnchorElement,\n      getAnchorText: getAnchorText,\n      applyRelTargetRules: applyRelTargetRules,\n      hasProtocol: hasProtocol\n    };\n\n    var cat = function (arr) {\n      var r = [];\n      var push = function (x) {\n        r.push(x);\n      };\n      for (var i = 0; i < arr.length; i++) {\n        arr[i].each(push);\n      }\n      return r;\n    };\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Option.none();\n    };\n\n    var getValue = function (item) {\n      return isString(item.value) ? item.value : '';\n    };\n    var sanitizeList = function (list, extractValue) {\n      var out = [];\n      global$3.each(list, function (item) {\n        var text = isString(item.text) ? item.text : isString(item.title) ? item.title : '';\n        if (item.menu !== undefined) ; else {\n          var value = extractValue(item);\n          out.push({\n            text: text,\n            value: value\n          });\n        }\n      });\n      return out;\n    };\n    var sanitizeWith = function (extracter) {\n      if (extracter === void 0) {\n        extracter = getValue;\n      }\n      return function (list) {\n        return Option.from(list).map(function (list) {\n          return sanitizeList(list, extracter);\n        });\n      };\n    };\n    var sanitize = function (list) {\n      return sanitizeWith(getValue)(list);\n    };\n    var createUi = function (name, label) {\n      return function (items) {\n        return {\n          name: name,\n          type: 'selectbox',\n          label: label,\n          items: items\n        };\n      };\n    };\n    var ListOptions = {\n      sanitize: sanitize,\n      sanitizeWith: sanitizeWith,\n      createUi: createUi,\n      getValue: getValue\n    };\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      var clone = function () {\n        return Cell(get());\n      };\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var findTextByValue = function (value, catalog) {\n      return findMap(catalog, function (item) {\n        return Option.some(item).filter(function (i) {\n          return i.value === value;\n        });\n      });\n    };\n    var getDelta = function (persistentText, fieldName, catalog, data) {\n      var value = data[fieldName];\n      var hasPersistentText = persistentText.length > 0;\n      return value !== undefined ? findTextByValue(value, catalog).map(function (i) {\n        return {\n          url: {\n            value: i.value,\n            meta: {\n              text: hasPersistentText ? persistentText : i.text,\n              attach: noop\n            }\n          },\n          text: hasPersistentText ? persistentText : i.text\n        };\n      }) : Option.none();\n    };\n    var findCatalog = function (settings, fieldName) {\n      if (fieldName === 'link') {\n        return settings.catalogs.link;\n      } else if (fieldName === 'anchor') {\n        return settings.catalogs.anchor;\n      } else {\n        return Option.none();\n      }\n    };\n    var init = function (initialData, linkSettings) {\n      var persistentText = Cell(initialData.text);\n      var onUrlChange = function (data) {\n        if (persistentText.get().length <= 0) {\n          var urlText = data.url.meta.text !== undefined ? data.url.meta.text : data.url.value;\n          return Option.some({ text: urlText });\n        } else {\n          return Option.none();\n        }\n      };\n      var onCatalogChange = function (data, change) {\n        var catalog = findCatalog(linkSettings, change.name).getOr([]);\n        return getDelta(persistentText.get(), change.name, catalog, data);\n      };\n      var onChange = function (getData, change) {\n        if (change.name === 'url') {\n          return onUrlChange(getData());\n        } else if (contains([\n            'anchor',\n            'link'\n          ], change.name)) {\n          return onCatalogChange(getData(), change);\n        } else if (change.name === 'text') {\n          persistentText.set(getData().text);\n          return Option.none();\n        } else {\n          return Option.none();\n        }\n      };\n      return { onChange: onChange };\n    };\n    var DialogChanges = {\n      init: init,\n      getDelta: getDelta\n    };\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n\n    var exports$1 = {}, module = { exports: exports$1 };\n    (function (define, exports, module, require) {\n      (function (f) {\n        if (typeof exports === 'object' && typeof module !== 'undefined') {\n          module.exports = f();\n        } else if (typeof define === 'function' && define.amd) {\n          define([], f);\n        } else {\n          var g;\n          if (typeof window !== 'undefined') {\n            g = window;\n          } else if (typeof global !== 'undefined') {\n            g = global;\n          } else if (typeof self !== 'undefined') {\n            g = self;\n          } else {\n            g = this;\n          }\n          g.EphoxContactWrapper = f();\n        }\n      }(function () {\n        return function () {\n          function r(e, n, t) {\n            function o(i, f) {\n              if (!n[i]) {\n                if (!e[i]) {\n                  var c = 'function' == typeof require && require;\n                  if (!f && c)\n                    return c(i, !0);\n                  if (u)\n                    return u(i, !0);\n                  var a = new Error('Cannot find module \\'' + i + '\\'');\n                  throw a.code = 'MODULE_NOT_FOUND', a;\n                }\n                var p = n[i] = { exports: {} };\n                e[i][0].call(p.exports, function (r) {\n                  var n = e[i][1][r];\n                  return o(n || r);\n                }, p, p.exports, r, e, n, t);\n              }\n              return n[i].exports;\n            }\n            for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++)\n              o(t[i]);\n            return o;\n          }\n          return r;\n        }()({\n          1: [\n            function (require, module, exports) {\n              var process = module.exports = {};\n              var cachedSetTimeout;\n              var cachedClearTimeout;\n              function defaultSetTimout() {\n                throw new Error('setTimeout has not been defined');\n              }\n              function defaultClearTimeout() {\n                throw new Error('clearTimeout has not been defined');\n              }\n              (function () {\n                try {\n                  if (typeof setTimeout === 'function') {\n                    cachedSetTimeout = setTimeout;\n                  } else {\n                    cachedSetTimeout = defaultSetTimout;\n                  }\n                } catch (e) {\n                  cachedSetTimeout = defaultSetTimout;\n                }\n                try {\n                  if (typeof clearTimeout === 'function') {\n                    cachedClearTimeout = clearTimeout;\n                  } else {\n                    cachedClearTimeout = defaultClearTimeout;\n                  }\n                } catch (e) {\n                  cachedClearTimeout = defaultClearTimeout;\n                }\n              }());\n              function runTimeout(fun) {\n                if (cachedSetTimeout === setTimeout) {\n                  return setTimeout(fun, 0);\n                }\n                if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n                  cachedSetTimeout = setTimeout;\n                  return setTimeout(fun, 0);\n                }\n                try {\n                  return cachedSetTimeout(fun, 0);\n                } catch (e) {\n                  try {\n                    return cachedSetTimeout.call(null, fun, 0);\n                  } catch (e) {\n                    return cachedSetTimeout.call(this, fun, 0);\n                  }\n                }\n              }\n              function runClearTimeout(marker) {\n                if (cachedClearTimeout === clearTimeout) {\n                  return clearTimeout(marker);\n                }\n                if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n                  cachedClearTimeout = clearTimeout;\n                  return clearTimeout(marker);\n                }\n                try {\n                  return cachedClearTimeout(marker);\n                } catch (e) {\n                  try {\n                    return cachedClearTimeout.call(null, marker);\n                  } catch (e) {\n                    return cachedClearTimeout.call(this, marker);\n                  }\n                }\n              }\n              var queue = [];\n              var draining = false;\n              var currentQueue;\n              var queueIndex = -1;\n              function cleanUpNextTick() {\n                if (!draining || !currentQueue) {\n                  return;\n                }\n                draining = false;\n                if (currentQueue.length) {\n                  queue = currentQueue.concat(queue);\n                } else {\n                  queueIndex = -1;\n                }\n                if (queue.length) {\n                  drainQueue();\n                }\n              }\n              function drainQueue() {\n                if (draining) {\n                  return;\n                }\n                var timeout = runTimeout(cleanUpNextTick);\n                draining = true;\n                var len = queue.length;\n                while (len) {\n                  currentQueue = queue;\n                  queue = [];\n                  while (++queueIndex < len) {\n                    if (currentQueue) {\n                      currentQueue[queueIndex].run();\n                    }\n                  }\n                  queueIndex = -1;\n                  len = queue.length;\n                }\n                currentQueue = null;\n                draining = false;\n                runClearTimeout(timeout);\n              }\n              process.nextTick = function (fun) {\n                var args = new Array(arguments.length - 1);\n                if (arguments.length > 1) {\n                  for (var i = 1; i < arguments.length; i++) {\n                    args[i - 1] = arguments[i];\n                  }\n                }\n                queue.push(new Item(fun, args));\n                if (queue.length === 1 && !draining) {\n                  runTimeout(drainQueue);\n                }\n              };\n              function Item(fun, array) {\n                this.fun = fun;\n                this.array = array;\n              }\n              Item.prototype.run = function () {\n                this.fun.apply(null, this.array);\n              };\n              process.title = 'browser';\n              process.browser = true;\n              process.env = {};\n              process.argv = [];\n              process.version = '';\n              process.versions = {};\n              function noop() {\n              }\n              process.on = noop;\n              process.addListener = noop;\n              process.once = noop;\n              process.off = noop;\n              process.removeListener = noop;\n              process.removeAllListeners = noop;\n              process.emit = noop;\n              process.prependListener = noop;\n              process.prependOnceListener = noop;\n              process.listeners = function (name) {\n                return [];\n              };\n              process.binding = function (name) {\n                throw new Error('process.binding is not supported');\n              };\n              process.cwd = function () {\n                return '/';\n              };\n              process.chdir = function (dir) {\n                throw new Error('process.chdir is not supported');\n              };\n              process.umask = function () {\n                return 0;\n              };\n            },\n            {}\n          ],\n          2: [\n            function (require, module, exports) {\n              (function (setImmediate) {\n                (function (root) {\n                  var setTimeoutFunc = setTimeout;\n                  function noop() {\n                  }\n                  function bind(fn, thisArg) {\n                    return function () {\n                      fn.apply(thisArg, arguments);\n                    };\n                  }\n                  function Promise(fn) {\n                    if (typeof this !== 'object')\n                      throw new TypeError('Promises must be constructed via new');\n                    if (typeof fn !== 'function')\n                      throw new TypeError('not a function');\n                    this._state = 0;\n                    this._handled = false;\n                    this._value = undefined;\n                    this._deferreds = [];\n                    doResolve(fn, this);\n                  }\n                  function handle(self, deferred) {\n                    while (self._state === 3) {\n                      self = self._value;\n                    }\n                    if (self._state === 0) {\n                      self._deferreds.push(deferred);\n                      return;\n                    }\n                    self._handled = true;\n                    Promise._immediateFn(function () {\n                      var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n                      if (cb === null) {\n                        (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                        return;\n                      }\n                      var ret;\n                      try {\n                        ret = cb(self._value);\n                      } catch (e) {\n                        reject(deferred.promise, e);\n                        return;\n                      }\n                      resolve(deferred.promise, ret);\n                    });\n                  }\n                  function resolve(self, newValue) {\n                    try {\n                      if (newValue === self)\n                        throw new TypeError('A promise cannot be resolved with itself.');\n                      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                        var then = newValue.then;\n                        if (newValue instanceof Promise) {\n                          self._state = 3;\n                          self._value = newValue;\n                          finale(self);\n                          return;\n                        } else if (typeof then === 'function') {\n                          doResolve(bind(then, newValue), self);\n                          return;\n                        }\n                      }\n                      self._state = 1;\n                      self._value = newValue;\n                      finale(self);\n                    } catch (e) {\n                      reject(self, e);\n                    }\n                  }\n                  function reject(self, newValue) {\n                    self._state = 2;\n                    self._value = newValue;\n                    finale(self);\n                  }\n                  function finale(self) {\n                    if (self._state === 2 && self._deferreds.length === 0) {\n                      Promise._immediateFn(function () {\n                        if (!self._handled) {\n                          Promise._unhandledRejectionFn(self._value);\n                        }\n                      });\n                    }\n                    for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                      handle(self, self._deferreds[i]);\n                    }\n                    self._deferreds = null;\n                  }\n                  function Handler(onFulfilled, onRejected, promise) {\n                    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                    this.promise = promise;\n                  }\n                  function doResolve(fn, self) {\n                    var done = false;\n                    try {\n                      fn(function (value) {\n                        if (done)\n                          return;\n                        done = true;\n                        resolve(self, value);\n                      }, function (reason) {\n                        if (done)\n                          return;\n                        done = true;\n                        reject(self, reason);\n                      });\n                    } catch (ex) {\n                      if (done)\n                        return;\n                      done = true;\n                      reject(self, ex);\n                    }\n                  }\n                  Promise.prototype['catch'] = function (onRejected) {\n                    return this.then(null, onRejected);\n                  };\n                  Promise.prototype.then = function (onFulfilled, onRejected) {\n                    var prom = new this.constructor(noop);\n                    handle(this, new Handler(onFulfilled, onRejected, prom));\n                    return prom;\n                  };\n                  Promise.all = function (arr) {\n                    var args = Array.prototype.slice.call(arr);\n                    return new Promise(function (resolve, reject) {\n                      if (args.length === 0)\n                        return resolve([]);\n                      var remaining = args.length;\n                      function res(i, val) {\n                        try {\n                          if (val && (typeof val === 'object' || typeof val === 'function')) {\n                            var then = val.then;\n                            if (typeof then === 'function') {\n                              then.call(val, function (val) {\n                                res(i, val);\n                              }, reject);\n                              return;\n                            }\n                          }\n                          args[i] = val;\n                          if (--remaining === 0) {\n                            resolve(args);\n                          }\n                        } catch (ex) {\n                          reject(ex);\n                        }\n                      }\n                      for (var i = 0; i < args.length; i++) {\n                        res(i, args[i]);\n                      }\n                    });\n                  };\n                  Promise.resolve = function (value) {\n                    if (value && typeof value === 'object' && value.constructor === Promise) {\n                      return value;\n                    }\n                    return new Promise(function (resolve) {\n                      resolve(value);\n                    });\n                  };\n                  Promise.reject = function (value) {\n                    return new Promise(function (resolve, reject) {\n                      reject(value);\n                    });\n                  };\n                  Promise.race = function (values) {\n                    return new Promise(function (resolve, reject) {\n                      for (var i = 0, len = values.length; i < len; i++) {\n                        values[i].then(resolve, reject);\n                      }\n                    });\n                  };\n                  Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                    setImmediate(fn);\n                  } : function (fn) {\n                    setTimeoutFunc(fn, 0);\n                  };\n                  Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                    if (typeof console !== 'undefined' && console) {\n                      console.warn('Possible Unhandled Promise Rejection:', err);\n                    }\n                  };\n                  Promise._setImmediateFn = function _setImmediateFn(fn) {\n                    Promise._immediateFn = fn;\n                  };\n                  Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                    Promise._unhandledRejectionFn = fn;\n                  };\n                  if (typeof module !== 'undefined' && module.exports) {\n                    module.exports = Promise;\n                  } else if (!root.Promise) {\n                    root.Promise = Promise;\n                  }\n                }(this));\n              }.call(this, require('timers').setImmediate));\n            },\n            { 'timers': 3 }\n          ],\n          3: [\n            function (require, module, exports) {\n              (function (setImmediate, clearImmediate) {\n                var nextTick = require('process/browser.js').nextTick;\n                var apply = Function.prototype.apply;\n                var slice = Array.prototype.slice;\n                var immediateIds = {};\n                var nextImmediateId = 0;\n                exports.setTimeout = function () {\n                  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n                };\n                exports.setInterval = function () {\n                  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n                };\n                exports.clearTimeout = exports.clearInterval = function (timeout) {\n                  timeout.close();\n                };\n                function Timeout(id, clearFn) {\n                  this._id = id;\n                  this._clearFn = clearFn;\n                }\n                Timeout.prototype.unref = Timeout.prototype.ref = function () {\n                };\n                Timeout.prototype.close = function () {\n                  this._clearFn.call(window, this._id);\n                };\n                exports.enroll = function (item, msecs) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = msecs;\n                };\n                exports.unenroll = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = -1;\n                };\n                exports._unrefActive = exports.active = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  var msecs = item._idleTimeout;\n                  if (msecs >= 0) {\n                    item._idleTimeoutId = setTimeout(function onTimeout() {\n                      if (item._onTimeout)\n                        item._onTimeout();\n                    }, msecs);\n                  }\n                };\n                exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n                  var id = nextImmediateId++;\n                  var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n                  immediateIds[id] = true;\n                  nextTick(function onNextTick() {\n                    if (immediateIds[id]) {\n                      if (args) {\n                        fn.apply(null, args);\n                      } else {\n                        fn.call(null);\n                      }\n                      exports.clearImmediate(id);\n                    }\n                  });\n                  return id;\n                };\n                exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n                  delete immediateIds[id];\n                };\n              }.call(this, require('timers').setImmediate, require('timers').clearImmediate));\n            },\n            {\n              'process/browser.js': 1,\n              'timers': 3\n            }\n          ],\n          4: [\n            function (require, module, exports) {\n              var promisePolyfill = require('promise-polyfill');\n              var Global = function () {\n                if (typeof window !== 'undefined') {\n                  return window;\n                } else {\n                  return Function('return this;')();\n                }\n              }();\n              module.exports = { boltExport: Global.Promise || promisePolyfill };\n            },\n            { 'promise-polyfill': 2 }\n          ]\n        }, {}, [4])(4);\n      }));\n    }(undefined, exports$1, module, undefined));\n    var Promise = module.exports.boltExport;\n\n    var nu = function (baseFn) {\n      var data = Option.none();\n      var callbacks = [];\n      var map = function (f) {\n        return nu(function (nCallback) {\n          get(function (data) {\n            nCallback(f(data));\n          });\n        });\n      };\n      var get = function (nCallback) {\n        if (isReady()) {\n          call(nCallback);\n        } else {\n          callbacks.push(nCallback);\n        }\n      };\n      var set = function (x) {\n        data = Option.some(x);\n        run(callbacks);\n        callbacks = [];\n      };\n      var isReady = function () {\n        return data.isSome();\n      };\n      var run = function (cbs) {\n        each(cbs, call);\n      };\n      var call = function (cb) {\n        data.each(function (x) {\n          domGlobals.setTimeout(function () {\n            cb(x);\n          }, 0);\n        });\n      };\n      baseFn(set);\n      return {\n        get: get,\n        map: map,\n        isReady: isReady\n      };\n    };\n    var pure = function (a) {\n      return nu(function (callback) {\n        callback(a);\n      });\n    };\n    var LazyValue = {\n      nu: nu,\n      pure: pure\n    };\n\n    var errorReporter = function (err) {\n      domGlobals.setTimeout(function () {\n        throw err;\n      }, 0);\n    };\n    var make = function (run) {\n      var get = function (callback) {\n        run().then(callback, errorReporter);\n      };\n      var map = function (fab) {\n        return make(function () {\n          return run().then(fab);\n        });\n      };\n      var bind = function (aFutureB) {\n        return make(function () {\n          return run().then(function (v) {\n            return aFutureB(v).toPromise();\n          });\n        });\n      };\n      var anonBind = function (futureB) {\n        return make(function () {\n          return run().then(function () {\n            return futureB.toPromise();\n          });\n        });\n      };\n      var toLazy = function () {\n        return LazyValue.nu(get);\n      };\n      var toCached = function () {\n        var cache = null;\n        return make(function () {\n          if (cache === null) {\n            cache = run();\n          }\n          return cache;\n        });\n      };\n      var toPromise = run;\n      return {\n        map: map,\n        bind: bind,\n        anonBind: anonBind,\n        toLazy: toLazy,\n        toCached: toCached,\n        toPromise: toPromise,\n        get: get\n      };\n    };\n    var nu$1 = function (baseFn) {\n      return make(function () {\n        return new Promise(baseFn);\n      });\n    };\n    var pure$1 = function (a) {\n      return make(function () {\n        return Promise.resolve(a);\n      });\n    };\n    var Future = {\n      nu: nu$1,\n      pure: pure$1\n    };\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n    var delayedConfirm = function (editor, message, callback) {\n      var rng = editor.selection.getRng();\n      global$4.setEditorTimeout(editor, function () {\n        editor.windowManager.confirm(message, function (state) {\n          editor.selection.setRng(rng);\n          callback(state);\n        });\n      });\n    };\n    var tryEmailTransform = function (data) {\n      var url = data.href;\n      var suggestMailTo = url.indexOf('@') > 0 && url.indexOf('//') === -1 && url.indexOf('mailto:') === -1;\n      return suggestMailTo ? Option.some({\n        message: 'The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?',\n        preprocess: function (oldData) {\n          return __assign(__assign({}, oldData), { href: 'mailto:' + url });\n        }\n      }) : Option.none();\n    };\n    var tryProtocolTransform = function (assumeExternalTargets) {\n      return function (data) {\n        var url = data.href;\n        var suggestProtocol = assumeExternalTargets === 1 && !Utils.hasProtocol(url) || assumeExternalTargets === 0 && /^\\s*www[\\.|\\d\\.]/i.test(url);\n        return suggestProtocol ? Option.some({\n          message: 'The URL you entered seems to be an external link. Do you want to add the required http:// prefix?',\n          preprocess: function (oldData) {\n            return __assign(__assign({}, oldData), { href: 'http://' + url });\n          }\n        }) : Option.none();\n      };\n    };\n    var preprocess = function (editor, assumeExternalTargets, data) {\n      return findMap([\n        tryEmailTransform,\n        tryProtocolTransform(assumeExternalTargets)\n      ], function (f) {\n        return f(data);\n      }).fold(function () {\n        return Future.pure(data);\n      }, function (transform) {\n        return Future.nu(function (callback) {\n          delayedConfirm(editor, transform.message, function (state) {\n            callback(state ? transform.preprocess(data) : data);\n          });\n        });\n      });\n    };\n    var DialogConfirms = { preprocess: preprocess };\n\n    var getAnchors = function (editor) {\n      var anchorNodes = editor.dom.select('a:not([href])');\n      var anchors = bind(anchorNodes, function (anchor) {\n        var id = anchor.name || anchor.id;\n        return id ? [{\n            text: id,\n            value: '#' + id\n          }] : [];\n      });\n      return anchors.length > 0 ? Option.some([{\n          text: 'None',\n          value: ''\n        }].concat(anchors)) : Option.none();\n    };\n    var AnchorListOptions = { getAnchors: getAnchors };\n\n    var getClasses = function (editor) {\n      var list = Settings.getLinkClassList(editor);\n      if (list.length > 0) {\n        return ListOptions.sanitize(list);\n      }\n      return Option.none();\n    };\n    var ClassListOptions = { getClasses: getClasses };\n\n    var global$5 = tinymce.util.Tools.resolve('tinymce.util.XHR');\n\n    var parseJson = function (text) {\n      try {\n        return Option.some(JSON.parse(text));\n      } catch (err) {\n        return Option.none();\n      }\n    };\n    var getLinks = function (editor) {\n      var extractor = function (item) {\n        return editor.convertURL(item.value || item.url, 'href');\n      };\n      var linkList = Settings.getLinkList(editor);\n      return Future.nu(function (callback) {\n        if (isString(linkList)) {\n          global$5.send({\n            url: linkList,\n            success: function (text) {\n              return callback(parseJson(text));\n            },\n            error: function (_) {\n              return callback(Option.none());\n            }\n          });\n        } else if (isFunction(linkList)) {\n          linkList(function (output) {\n            return callback(Option.some(output));\n          });\n        } else {\n          callback(Option.from(linkList));\n        }\n      }).map(function (optItems) {\n        return optItems.bind(ListOptions.sanitizeWith(extractor)).map(function (items) {\n          if (items.length > 0) {\n            return [{\n                text: 'None',\n                value: ''\n              }].concat(items);\n          } else {\n            return items;\n          }\n        });\n      });\n    };\n    var LinkListOptions = { getLinks: getLinks };\n\n    var getRels = function (editor, initialTarget) {\n      var list = Settings.getRelList(editor);\n      if (list.length > 0) {\n        var isTargetBlank_1 = initialTarget.is('_blank');\n        var enforceSafe = Settings.allowUnsafeLinkTarget(editor) === false;\n        var safeRelExtractor = function (item) {\n          return Utils.applyRelTargetRules(ListOptions.getValue(item), isTargetBlank_1);\n        };\n        var sanitizer = enforceSafe ? ListOptions.sanitizeWith(safeRelExtractor) : ListOptions.sanitize;\n        return sanitizer(list);\n      }\n      return Option.none();\n    };\n    var RelOptions = { getRels: getRels };\n\n    var fallbacks = [\n      {\n        text: 'Current window',\n        value: ''\n      },\n      {\n        text: 'New window',\n        value: '_blank'\n      }\n    ];\n    var getTargets = function (editor) {\n      var list = Settings.getTargetList(editor);\n      if (isArray(list)) {\n        return ListOptions.sanitize(list).orThunk(function () {\n          return Option.some(fallbacks);\n        });\n      } else if (list === false) {\n        return Option.none();\n      }\n      return Option.some(fallbacks);\n    };\n    var TargetOptions = { getTargets: getTargets };\n\n    var nonEmptyAttr = function (dom, elem, name) {\n      var val = dom.getAttrib(elem, name);\n      return val !== null && val.length > 0 ? Option.some(val) : Option.none();\n    };\n    var extractFromAnchor = function (editor, anchor) {\n      var dom = editor.dom;\n      var onlyText = Utils.isOnlyTextSelected(editor.selection.getContent());\n      var text = onlyText ? Option.some(Utils.getAnchorText(editor.selection, anchor)) : Option.none();\n      var url = anchor ? Option.some(dom.getAttrib(anchor, 'href')) : Option.none();\n      var target = anchor ? Option.from(dom.getAttrib(anchor, 'target')) : Option.none();\n      var rel = nonEmptyAttr(dom, anchor, 'rel');\n      var linkClass = nonEmptyAttr(dom, anchor, 'class');\n      var title = nonEmptyAttr(dom, anchor, 'title');\n      return {\n        url: url,\n        text: text,\n        title: title,\n        target: target,\n        rel: rel,\n        linkClass: linkClass\n      };\n    };\n    var collect = function (editor, linkNode) {\n      return LinkListOptions.getLinks(editor).map(function (links) {\n        var anchor = extractFromAnchor(editor, linkNode);\n        return {\n          anchor: anchor,\n          catalogs: {\n            targets: TargetOptions.getTargets(editor),\n            rels: RelOptions.getRels(editor, anchor.target),\n            classes: ClassListOptions.getClasses(editor),\n            anchor: AnchorListOptions.getAnchors(editor),\n            link: links\n          },\n          optNode: Option.from(linkNode),\n          flags: { titleEnabled: Settings.shouldShowLinkTitle(editor) }\n        };\n      });\n    };\n    var DialogInfo = { collect: collect };\n\n    var handleSubmit = function (editor, info, assumeExternalTargets) {\n      return function (api) {\n        var data = api.getData();\n        if (!data.url.value) {\n          Utils.unlink(editor);\n          api.close();\n          return;\n        }\n        var getChangedValue = function (key) {\n          return Option.from(data[key]).filter(function (value) {\n            return !info.anchor[key].is(value);\n          });\n        };\n        var changedData = {\n          href: data.url.value,\n          text: getChangedValue('text'),\n          target: getChangedValue('target'),\n          rel: getChangedValue('rel'),\n          class: getChangedValue('linkClass'),\n          title: getChangedValue('title')\n        };\n        var attachState = {\n          href: data.url.value,\n          attach: data.url.meta !== undefined && data.url.meta.attach ? data.url.meta.attach : function () {\n          }\n        };\n        DialogConfirms.preprocess(editor, assumeExternalTargets, changedData).get(function (pData) {\n          Utils.link(editor, attachState, pData);\n        });\n        api.close();\n      };\n    };\n    var collectData = function (editor) {\n      var anchorNode = Utils.getAnchorElement(editor);\n      return DialogInfo.collect(editor, anchorNode);\n    };\n    var getInitialData = function (info, defaultTarget) {\n      return {\n        url: {\n          value: info.anchor.url.getOr(''),\n          meta: {\n            attach: function () {\n            },\n            text: info.anchor.url.fold(function () {\n              return '';\n            }, function () {\n              return info.anchor.text.getOr('');\n            }),\n            original: { value: info.anchor.url.getOr('') }\n          }\n        },\n        text: info.anchor.text.getOr(''),\n        title: info.anchor.title.getOr(''),\n        anchor: info.anchor.url.getOr(''),\n        link: info.anchor.url.getOr(''),\n        rel: info.anchor.rel.getOr(''),\n        target: info.anchor.target.or(defaultTarget).getOr(''),\n        linkClass: info.anchor.linkClass.getOr('')\n      };\n    };\n    var makeDialog = function (settings, onSubmit, editor) {\n      var urlInput = [{\n          name: 'url',\n          type: 'urlinput',\n          filetype: 'file',\n          label: 'URL'\n        }];\n      var displayText = settings.anchor.text.map(function () {\n        return {\n          name: 'text',\n          type: 'input',\n          label: 'Text to display'\n        };\n      }).toArray();\n      var titleText = settings.flags.titleEnabled ? [{\n          name: 'title',\n          type: 'input',\n          label: 'Title'\n        }] : [];\n      var defaultTarget = Option.from(Settings.getDefaultLinkTarget(editor));\n      var initialData = getInitialData(settings, defaultTarget);\n      var dialogDelta = DialogChanges.init(initialData, settings);\n      var catalogs = settings.catalogs;\n      var body = {\n        type: 'panel',\n        items: flatten([\n          urlInput,\n          displayText,\n          titleText,\n          cat([\n            catalogs.anchor.map(ListOptions.createUi('anchor', 'Anchors')),\n            catalogs.rels.map(ListOptions.createUi('rel', 'Rel')),\n            catalogs.targets.map(ListOptions.createUi('target', 'Open link in...')),\n            catalogs.link.map(ListOptions.createUi('link', 'Link list')),\n            catalogs.classes.map(ListOptions.createUi('linkClass', 'Class'))\n          ])\n        ])\n      };\n      return {\n        title: 'Insert/Edit Link',\n        size: 'normal',\n        body: body,\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: initialData,\n        onChange: function (api, _a) {\n          var name = _a.name;\n          dialogDelta.onChange(api.getData, { name: name }).each(function (newData) {\n            api.setData(newData);\n          });\n        },\n        onSubmit: onSubmit\n      };\n    };\n    var open$1 = function (editor) {\n      var data = collectData(editor);\n      data.map(function (info) {\n        var onSubmit = handleSubmit(editor, info, Settings.assumeExternalTargets(editor));\n        return makeDialog(info, onSubmit, editor);\n      }).get(function (spec) {\n        editor.windowManager.open(spec);\n      });\n    };\n    var Dialog = { open: open$1 };\n\n    var getLink = function (editor, elm) {\n      return editor.dom.getParent(elm, 'a[href]');\n    };\n    var getSelectedLink = function (editor) {\n      return getLink(editor, editor.selection.getStart());\n    };\n    var hasOnlyAltModifier = function (e) {\n      return e.altKey === true && e.shiftKey === false && e.ctrlKey === false && e.metaKey === false;\n    };\n    var gotoLink = function (editor, a) {\n      if (a) {\n        var href = Utils.getHref(a);\n        if (/^#/.test(href)) {\n          var targetEl = editor.$(href);\n          if (targetEl.length) {\n            editor.selection.scrollIntoView(targetEl[0], true);\n          }\n        } else {\n          OpenUrl.open(a.href);\n        }\n      }\n    };\n    var openDialog = function (editor) {\n      return function () {\n        Dialog.open(editor);\n      };\n    };\n    var gotoSelectedLink = function (editor) {\n      return function () {\n        gotoLink(editor, getSelectedLink(editor));\n      };\n    };\n    var leftClickedOnAHref = function (editor) {\n      return function (elm) {\n        var sel, rng, node;\n        if (Settings.hasContextToolbar(editor) && Utils.isLink(elm)) {\n          sel = editor.selection;\n          rng = sel.getRng();\n          node = rng.startContainer;\n          if (node.nodeType === 3 && sel.isCollapsed() && rng.startOffset > 0 && rng.startOffset < node.data.length) {\n            return true;\n          }\n        }\n        return false;\n      };\n    };\n    var setupGotoLinks = function (editor) {\n      editor.on('click', function (e) {\n        var link = getLink(editor, e.target);\n        if (link && global$2.metaKeyPressed(e)) {\n          e.preventDefault();\n          gotoLink(editor, link);\n        }\n      });\n      editor.on('keydown', function (e) {\n        var link = getSelectedLink(editor);\n        if (link && e.keyCode === 13 && hasOnlyAltModifier(e)) {\n          e.preventDefault();\n          gotoLink(editor, link);\n        }\n      });\n    };\n    var toggleActiveState = function (editor) {\n      return function (api) {\n        var nodeChangeHandler = function (e) {\n          return api.setActive(!editor.readonly && !!Utils.getAnchorElement(editor, e.element));\n        };\n        editor.on('NodeChange', nodeChangeHandler);\n        return function () {\n          return editor.off('NodeChange', nodeChangeHandler);\n        };\n      };\n    };\n    var toggleEnabledState = function (editor) {\n      return function (api) {\n        api.setDisabled(!Utils.hasLinks(editor.dom.getParents(editor.selection.getStart())));\n        var nodeChangeHandler = function (e) {\n          return api.setDisabled(!Utils.hasLinks(e.parents));\n        };\n        editor.on('NodeChange', nodeChangeHandler);\n        return function () {\n          return editor.off('NodeChange', nodeChangeHandler);\n        };\n      };\n    };\n    var Actions = {\n      openDialog: openDialog,\n      gotoSelectedLink: gotoSelectedLink,\n      leftClickedOnAHref: leftClickedOnAHref,\n      setupGotoLinks: setupGotoLinks,\n      toggleActiveState: toggleActiveState,\n      toggleEnabledState: toggleEnabledState\n    };\n\n    var register = function (editor) {\n      editor.addCommand('mceLink', function () {\n        if (Settings.useQuickLink(editor)) {\n          editor.fire('contexttoolbar-show', { toolbarKey: 'quicklink' });\n        } else {\n          Actions.openDialog(editor)();\n        }\n      });\n    };\n    var Commands = { register: register };\n\n    var setup = function (editor) {\n      editor.addShortcut('Meta+K', '', function () {\n        editor.execCommand('mceLink');\n      });\n    };\n    var Keyboard = { setup: setup };\n\n    var setupButtons = function (editor) {\n      editor.ui.registry.addToggleButton('link', {\n        icon: 'link',\n        tooltip: 'Insert/edit link',\n        onAction: Actions.openDialog(editor),\n        onSetup: Actions.toggleActiveState(editor)\n      });\n      editor.ui.registry.addButton('openlink', {\n        icon: 'new-tab',\n        tooltip: 'Open link',\n        onAction: Actions.gotoSelectedLink(editor),\n        onSetup: Actions.toggleEnabledState(editor)\n      });\n      editor.ui.registry.addButton('unlink', {\n        icon: 'unlink',\n        tooltip: 'Remove link',\n        onAction: function () {\n          return Utils.unlink(editor);\n        },\n        onSetup: Actions.toggleEnabledState(editor)\n      });\n    };\n    var setupMenuItems = function (editor) {\n      editor.ui.registry.addMenuItem('openlink', {\n        text: 'Open link',\n        icon: 'new-tab',\n        onAction: Actions.gotoSelectedLink(editor),\n        onSetup: Actions.toggleEnabledState(editor)\n      });\n      editor.ui.registry.addMenuItem('link', {\n        icon: 'link',\n        text: 'Link...',\n        shortcut: 'Meta+K',\n        onAction: Actions.openDialog(editor)\n      });\n      editor.ui.registry.addMenuItem('unlink', {\n        icon: 'unlink',\n        text: 'Remove link',\n        onAction: function () {\n          return Utils.unlink(editor);\n        },\n        onSetup: Actions.toggleEnabledState(editor)\n      });\n    };\n    var setupContextMenu = function (editor) {\n      var inLink = 'link unlink openlink';\n      var noLink = 'link';\n      editor.ui.registry.addContextMenu('link', {\n        update: function (element) {\n          return Utils.hasLinks(editor.dom.getParents(element, 'a')) ? inLink : noLink;\n        }\n      });\n    };\n    var setupContextToolbars = function (editor) {\n      var collapseSelectionToEnd = function (editor) {\n        editor.selection.collapse(false);\n      };\n      var onSetupLink = function (buttonApi) {\n        var node = editor.selection.getNode();\n        buttonApi.setDisabled(!Utils.getAnchorElement(editor, node));\n        return function () {\n        };\n      };\n      editor.ui.registry.addContextForm('quicklink', {\n        launch: {\n          type: 'contextformtogglebutton',\n          icon: 'link',\n          tooltip: 'Link',\n          onSetup: Actions.toggleActiveState(editor)\n        },\n        label: 'Link',\n        predicate: function (node) {\n          return !!Utils.getAnchorElement(editor, node) && Settings.hasContextToolbar(editor);\n        },\n        initValue: function () {\n          var elm = Utils.getAnchorElement(editor);\n          return !!elm ? Utils.getHref(elm) : '';\n        },\n        commands: [\n          {\n            type: 'contextformtogglebutton',\n            icon: 'link',\n            tooltip: 'Link',\n            primary: true,\n            onSetup: function (buttonApi) {\n              var node = editor.selection.getNode();\n              buttonApi.setActive(!!Utils.getAnchorElement(editor, node));\n              return Actions.toggleActiveState(editor)(buttonApi);\n            },\n            onAction: function (formApi) {\n              var anchor = Utils.getAnchorElement(editor);\n              var value = formApi.getValue();\n              if (!anchor) {\n                var attachState = {\n                  href: value,\n                  attach: function () {\n                  }\n                };\n                var onlyText = Utils.isOnlyTextSelected(editor.selection.getContent());\n                var text = onlyText ? Option.some(Utils.getAnchorText(editor.selection, anchor)).filter(function (t) {\n                  return t.length > 0;\n                }).or(Option.from(value)) : Option.none();\n                Utils.link(editor, attachState, {\n                  href: value,\n                  text: text,\n                  title: Option.none(),\n                  rel: Option.none(),\n                  target: Option.none(),\n                  class: Option.none()\n                });\n                formApi.hide();\n              } else {\n                editor.dom.setAttrib(anchor, 'href', value);\n                collapseSelectionToEnd(editor);\n                formApi.hide();\n              }\n            }\n          },\n          {\n            type: 'contextformbutton',\n            icon: 'unlink',\n            tooltip: 'Remove link',\n            onSetup: onSetupLink,\n            onAction: function (formApi) {\n              Utils.unlink(editor);\n              formApi.hide();\n            }\n          },\n          {\n            type: 'contextformbutton',\n            icon: 'new-tab',\n            tooltip: 'Open link',\n            onSetup: onSetupLink,\n            onAction: function (formApi) {\n              Actions.gotoSelectedLink(editor)();\n              formApi.hide();\n            }\n          }\n        ]\n      });\n    };\n    var Controls = {\n      setupButtons: setupButtons,\n      setupMenuItems: setupMenuItems,\n      setupContextMenu: setupContextMenu,\n      setupContextToolbars: setupContextToolbars\n    };\n\n    function Plugin () {\n      global$1.add('link', function (editor) {\n        Controls.setupButtons(editor);\n        Controls.setupMenuItems(editor);\n        Controls.setupContextMenu(editor);\n        Controls.setupContextToolbars(editor);\n        Actions.setupGotoLinks(editor);\n        Commands.register(editor);\n        Keyboard.setup(editor);\n      });\n    }\n\n    Plugin();\n\n}(window));\n"]}