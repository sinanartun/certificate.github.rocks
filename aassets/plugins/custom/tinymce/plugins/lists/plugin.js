!function(e){"use strict";var t,n,r=tinymce.util.Tools.resolve("tinymce.PluginManager"),o=function(){},i=function(e){return function(){return e}},u=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return!e.apply(null,t)}},s=i(!1),a=i(!0),c=function(){return f},f=function(){var e=function(e){return e.isNone()},t=function(e){return e()},n=function(e){return e},r={fold:function(e,t){return e()},is:s,isSome:s,isNone:a,getOr:n,getOrThunk:t,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:n,orThunk:t,map:c,each:o,bind:c,exists:s,forall:a,filter:c,equals:e,equals_:e,toArray:function(){return[]},toString:i("none()")};return Object.freeze&&Object.freeze(r),r}(),d=function(e){var t=i(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:a,isNone:s,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return d(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:f},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(s,function(t){return n(e,t)})}};return o},l={some:d,none:c,from:function(e){return null==e?f:d(e)}},m=function(e){return function(t){return function(e){if(null===e)return"null";var t=typeof e;return"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t}(t)===e}},g=m("string"),v=m("array"),p=m("boolean"),h=m("function"),N=m("number"),y=Array.prototype.slice,S=Array.prototype.push,O=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},C=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},b=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n},L=function(e,t,n){return C(e,function(e){n=t(n,e)}),n},T=function(e,t){for(var n=0,r=e.length;n<r;n++){var o=e[n];if(t(o,n))return l.some(o)}return l.none()},D=function(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!v(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);S.apply(t,e[n])}return t}(O(e,t))},E=function(e){return 0===e.length?l.none():l.some(e[0])},w=function(e){return 0===e.length?l.none():l.some(e[e.length-1])},k=(h(Array.from)&&Array.from,function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)}),A=function(t,n){return k(t,n,e.Node.DOCUMENT_POSITION_CONTAINED_BY)},x=function(e){var t=e,n=function(){return t};return{get:n,set:function(e){t=e},clone:function(){return x(n())}}},R=function(){return I(0,0)},I=function(e,t){return{major:e,minor:t}},_={nu:I,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?R():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return I(r(1),r(2))}(e,n)},unknown:R},B=function(e,t){return function(){return t===e}},P=function(e){var t=e.current;return{current:t,version:e.version,isEdge:B("Edge",t),isChrome:B("Chrome",t),isIE:B("IE",t),isOpera:B("Opera",t),isFirefox:B("Firefox",t),isSafari:B("Safari",t)}},M={unknown:function(){return P({current:void 0,version:_.unknown()})},nu:P,edge:i("Edge"),chrome:i("Chrome"),ie:i("IE"),opera:i("Opera"),firefox:i("Firefox"),safari:i("Safari")},U=function(e,t){return function(){return t===e}},F=function(e){var t=e.current;return{current:t,version:e.version,isWindows:U("Windows",t),isiOS:U("iOS",t),isAndroid:U("Android",t),isOSX:U("OSX",t),isLinux:U("Linux",t),isSolaris:U("Solaris",t),isFreeBSD:U("FreeBSD",t)}},j={unknown:function(){return F({current:void 0,version:_.unknown()})},nu:F,windows:i("Windows"),ios:i("iOS"),android:i("Android"),linux:i("Linux"),osx:i("OSX"),solaris:i("Solaris"),freebsd:i("FreeBSD")},H=function(e,t){var n=String(t).toLowerCase();return T(e,function(e){return e.search(n)})},$=function(e,t){return H(e,t).map(function(e){var n=_.detect(e.versionRegexes,t);return{current:e.name,version:n}})},W=function(e,t){return H(e,t).map(function(e){var n=_.detect(e.versionRegexes,t);return{current:e.name,version:n}})},q=function(e,t){return-1!==e.indexOf(t)},V=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,z=function(e){return function(t){return q(t,e)}},K=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return q(e,"edge/")&&q(e,"chrome")&&q(e,"safari")&&q(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,V],search:function(e){return q(e,"chrome")&&!q(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return q(e,"msie")||q(e,"trident")}},{name:"Opera",versionRegexes:[V,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:z("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:z("firefox")},{name:"Safari",versionRegexes:[V,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(q(e,"safari")||q(e,"mobile/"))&&q(e,"applewebkit")}}],X=[{name:"Windows",search:z("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return q(e,"iphone")||q(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:z("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:z("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:z("linux"),versionRegexes:[]},{name:"Solaris",search:z("sunos"),versionRegexes:[]},{name:"FreeBSD",search:z("freebsd"),versionRegexes:[]}],Q={browsers:i(K),oses:i(X)},Y=function(e,t){var n=Q.browsers(),r=Q.oses(),o=$(n,e).fold(M.unknown,M.nu),u=W(r,e).fold(j.unknown,j.nu),s=function(e,t,n,r){var o=e.isiOS()&&!0===/ipad/i.test(n),u=e.isiOS()&&!o,s=e.isiOS()||e.isAndroid(),a=s||r("(pointer:coarse)"),c=o||!u&&s&&r("(min-device-width:768px)"),f=u||s&&!c,d=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),l=!f&&!c&&!d;return{isiPad:i(o),isiPhone:i(u),isTablet:i(c),isPhone:i(f),isTouch:i(a),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:i(d),isDesktop:i(l)}}(u,o,e,t);return{browser:o,os:u,deviceType:s}},G=x(Y(e.navigator.userAgent,function(t){return e.window.matchMedia(t).matches})),J=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:i(e)}},Z={fromHtml:function(t,n){var r=(n||e.document).createElement("div");if(r.innerHTML=t,!r.hasChildNodes()||r.childNodes.length>1)throw e.console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return J(r.childNodes[0])},fromTag:function(t,n){var r=(n||e.document).createElement(t);return J(r)},fromText:function(t,n){var r=(n||e.document).createTextNode(t);return J(r)},fromDom:J,fromPoint:function(e,t,n){var r=e.dom();return l.from(r.elementFromPoint(t,n)).map(J)}},ee=(e.Node.ATTRIBUTE_NODE,e.Node.CDATA_SECTION_NODE,e.Node.COMMENT_NODE,e.Node.DOCUMENT_NODE,e.Node.DOCUMENT_TYPE_NODE,e.Node.DOCUMENT_FRAGMENT_NODE,e.Node.ELEMENT_NODE),te=(e.Node.TEXT_NODE,e.Node.PROCESSING_INSTRUCTION_NODE,e.Node.ENTITY_REFERENCE_NODE,e.Node.ENTITY_NODE,e.Node.NOTATION_NODE,ee),ne=function(e,t){return e.dom()===t.dom()},re=G.get().browser,oe=re.isIE()?function(e,t){return A(e.dom(),t.dom())}:function(e,t){var n=e.dom(),r=t.dom();return n!==r&&n.contains(r)},ie=function(e,t){var n=e.dom();if(n.nodeType!==te)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},ue=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),se=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),ae=tinymce.util.Tools.resolve("tinymce.util.VK"),ce=function(e,t,n){return e.isSome()&&t.isSome()?l.some(n(e.getOrDie(),t.getOrDie())):l.none()},fe=Object.keys,de=function(e){return l.from(e.dom().parentNode).map(Z.fromDom)},le=function(e){return O(e.dom().childNodes,Z.fromDom)},me=function(e,t){var n=e.dom().childNodes;return l.from(n[t]).map(Z.fromDom)},ge=function(e){return me(e,0)},ve=function(e){return me(e,e.dom().childNodes.length-1)},pe=(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}("element","offset"),function(e,t){de(e).each(function(n){n.dom().insertBefore(t.dom(),e.dom())})}),he=function(e,t){e.dom().appendChild(t.dom())},Ne=function(e,t){C(t,function(t){he(e,t)})},ye=function(e){var t=e.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},Se=function(e,t,n){return e.fire("ListMutation",{action:t,element:n})},Oe=void 0!==e.window?e.window:Function("return this;")(),Ce=function(e,t){return function(e,t){for(var n=null!=t?t:Oe,r=0;r<e.length&&null!=n;++r)n=n[e[r]];return n}(e.split("."),t)},be=function(e,t){var n=function(e,t){return Ce(e,t)}(e,t);if(null==n)throw new Error(e+" not available on this browser");return n},Le=function(e){return function(e){return be("HTMLElement",e)}(Ce("ownerDocument.defaultView",e)).prototype.isPrototypeOf(e)},Te=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),De=tinymce.util.Tools.resolve("tinymce.util.Tools"),Ee=function(e){return e&&"BR"===e.nodeName},we=function(e){return e&&3===e.nodeType},ke=function(e){return e&&/^(OL|UL|DL)$/.test(e.nodeName)},Ae=function(e){return e&&/^(OL|UL)$/.test(e.nodeName)},xe=function(e){return e&&/^(DT|DD)$/.test(e.nodeName)},Re=function(e){return e&&/^(LI|DT|DD)$/.test(e.nodeName)},Ie=function(e){return e&&/^(TH|TD)$/.test(e.nodeName)},_e=Ee,Be=function(e){return e.parentNode.firstChild===e},Pe=function(e,t){return t&&!!e.schema.getTextBlockElements()[t.nodeName]},Me=function(e,t){return e&&e.nodeName in t},Ue=function(e,t){return!!Ee(t)&&!(!e.isBlock(t.nextSibling)||Ee(t.previousSibling))},Fe=function(e,t,n){var r=e.isEmpty(t);return!(n&&e.select("span[data-mce-type=bookmark]",t).length>0)&&r},je=function(e,t){return e.isChildOf(t,e.getRoot())},He=function(e){var t=e.selection.getStart(!0);return e.dom.getParent(t,"OL,UL,DL",We(e,t))},$e=function(e){var t=e.selection.getSelectedBlocks();return De.grep(function(e,t){var n=De.map(t,function(t){var n=e.dom.getParent(t,"li,dd,dt",We(e,t));return n||t});return Te.unique(n)}(e,t),function(e){return Re(e)})},We=function(e,t){var n=e.dom.getParents(t,"TD,TH");return n.length>0?n[0]:e.getBody()},qe=function(e,t){var n=e.dom.getParents(t,"ol,ul",We(e,t));return w(n)},Ve=function(e,t){var n=O(t,function(t){return qe(e,t).getOr(t)});return Te.unique(n)},ze={isList:function(e){var t=He(e);return Le(t)},getParentList:He,getSelectedSubLists:function(e){var t=He(e),n=e.selection.getSelectedBlocks();return function(e,t){return e&&1===t.length&&t[0]===e}(t,n)?function(e){return De.grep(e.querySelectorAll("ol,ul,dl"),function(e){return ke(e)})}(t):De.grep(n,function(e){return ke(e)&&t!==e})},getSelectedListItems:$e,getClosestListRootElm:We,getSelectedDlItems:function(e){return b($e(e),xe)},getSelectedListRoots:function(e){var t=function(e){var t=qe(e,e.selection.getStart()),n=b(e.selection.getSelectedBlocks(),Ae);return t.toArray().concat(n)}(e);return Ve(e,t)}},Ke=function(e,t){var n,r,o,i,u=e.dom,s=e.schema.getBlockElements(),a=u.createFragment();if(e.settings.forced_root_block&&(o=e.settings.forced_root_block),o&&((r=u.create(o)).tagName===e.settings.forced_root_block&&u.setAttribs(r,e.settings.forced_root_block_attrs),Me(t.firstChild,s)||a.appendChild(r)),t)for(;n=t.firstChild;){var c=n.nodeName;i||"SPAN"===c&&"bookmark"===n.getAttribute("data-mce-type")||(i=!0),Me(n,s)?(a.appendChild(n),r=null):o?(r||(r=u.create(o),a.appendChild(r)),r.appendChild(n)):a.appendChild(n)}return e.settings.forced_root_block?i||r.appendChild(u.create("br",{"data-mce-bogus":"1"})):a.appendChild(u.create("br")),a},Xe=function(e){return e.dom().nodeName.toLowerCase()},Qe=(t=ee,function(e){return function(e){return e.dom().nodeType}(e)===t}),Ye=function(t,n){var r=t.dom();!function(e,t){for(var n=fe(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}}(n,function(t,n){!function(t,n,r){if(!(g(r)||p(r)||N(r)))throw e.console.error("Invalid call to Attr.set. Key ",n,":: Value ",r,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,r+"")}(r,n,t)})},Ge=function(e){return L(e.dom().attributes,function(e,t){return e[t.name]=t.value,e},{})},Je=function(t,n,r){if(!g(r))throw e.console.error("Invalid call to CSS.set. Property ",n,":: Value ",r,":: Element ",t),new Error("CSS value must be a string: "+r);(function(e){return void 0!==e.style&&h(e.style.getPropertyValue)})(t)&&t.style.setProperty(n,r)},Ze=function(e){return function(e,t){return Z.fromDom(e.dom().cloneNode(t))}(e,!0)},et=function(e,t){var n=function(e,t){var n=Z.fromTag(t),r=Ge(e);return Ye(n,r),n}(e,t);pe(e,n);var r=le(e);return Ne(n,r),ye(e),n},tt=function(e,t){he(e.item,t.list)},nt=function(e,t){var n={list:Z.fromTag(t,e),item:Z.fromTag("li",e)};return he(n.list,n.item),n},rt=function(e,t,n){var r=t.slice(0,n.depth);return w(r).each(function(t){!function(e,t){he(e.list,t),e.item=t}(t,function(e,t,n){var r=Z.fromTag("li",e);return Ye(r,t),Ne(r,n),r}(e,n.itemAttributes,n.content)),function(e,t){Xe(e.list)!==t.listType&&(e.list=et(e.list,t.listType)),Ye(e.list,t.listAttributes)}(t,n)}),r},ot=function(e,t,n){var r,o=function(e,t,n){for(var r=[],o=0;o<n;o++)r.push(nt(e,t.listType));return r}(e,n,n.depth-t.length);return function(e){for(var t=1;t<e.length;t++)tt(e[t-1],e[t])}(o),function(e,t){for(var n=0;n<e.length-1;n++)r=e[n].item,o="list-style-type",i="none",u=void 0,u=r.dom(),Je(u,o,i);var r,o,i,u;w(e).each(function(e){Ye(e.list,t.listAttributes),Ye(e.item,t.itemAttributes),Ne(e.item,t.content)})}(o,n),r=o,ce(w(t),E(r),tt),t.concat(o)},it=function(e){return ie(e,"OL,UL")},ut=function(e){return ge(e).map(it).getOr(!1)},st=function(e){return e.depth>0},at=function(e){return e.isSelected},ct=function(e){var t=le(e),n=ve(e).map(it).getOr(!1)?t.slice(0,-1):t;return O(n,Ze)},ft=Object.prototype.hasOwnProperty,dt=(n=function(e,t){return t},function(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<e.length;o++){var i=e[o];for(var u in i)ft.call(i,u)&&(r[u]=n(r[u],i[u]))}return r}),lt=function(e){C(e,function(t,n){(function(e,t){for(var n=e[t].depth,r=t-1;r>=0;r--){if(e[r].depth===n)return l.some(e[r]);if(e[r].depth<n)break}return l.none()})(e,n).each(function(e){var n,r;r=e,(n=t).listType=r.listType,n.listAttributes=dt({},r.listAttributes)})})},mt=function(e,t,n,r){return ge(r).filter(it).fold(function(){t.each(function(e){ne(e.start,r)&&n.set(!0)});var o=function(e,t,n){return de(e).filter(Qe).map(function(r){return{depth:t,isSelected:n,content:ct(e),itemAttributes:Ge(e),listAttributes:Ge(r),listType:Xe(r)}})}(r,e,n.get());t.each(function(e){ne(e.end,r)&&n.set(!1)});var i=ve(r).filter(it).map(function(r){return gt(e,t,n,r)}).getOr([]);return o.toArray().concat(i)},function(r){return gt(e,t,n,r)})},gt=function(e,t,n,r){return D(le(r),function(r){return(it(r)?gt:mt)(e+1,t,n,r)})},vt=function(t,n){return O(n,function(n){var r,o,i,u=(r=n.content,i=(o||e.document).createDocumentFragment(),C(r,function(e){i.appendChild(e.dom())}),Z.fromDom(i));return Z.fromDom(Ke(t,u.dom()))})},pt=function(e,t){return lt(t),function(e,t){var n=L(t,function(t,n){return n.depth>t.length?ot(e,t,n):rt(e,t,n)},[]);return E(n).map(function(e){return e.list})}(e.contentDocument,t).toArray()},ht=function(e){var t,n,r=O(ze.getSelectedListItems(e),Z.fromDom);return ce(T(r,u(ut)),T((t=r,(n=y.call(t,0)).reverse(),n),u(ut)),function(e,t){return{start:e,end:t}})},Nt=function(e,t,n){var r=function(e,t){var n=x(!1);return O(e,function(e){return{sourceList:e,entries:gt(0,t,n,e)}})}(t,ht(e));C(r,function(t){!function(e,t){C(b(e,at),function(e){return function(e,t){switch(e){case"Indent":t.depth++;break;case"Outdent":t.depth--;break;case"Flatten":t.depth=0}}(t,e)})}(t.entries,n);var r,o=function(e,t){return D(function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,u=e.length;i<u;i++){var s=e[i],a=t(s);a!==n&&(r.push(o),o=[]),n=a,o.push(s)}return 0!==o.length&&r.push(o),r}(t,st),function(t){return E(t).map(st).getOr(!1)?pt(e,t):vt(e,t)})}(e,t.entries);C(o,function(t){Se(e,"Indent"===n?"IndentList":"OutdentList",t.dom())}),r=t.sourceList,C(o,function(e){pe(r,e)}),ye(t.sourceList)})},yt=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),St=yt.DOM,Ot=function(e,t,n){var r,o,i,u,s,a;for(i=St.select('span[data-mce-type="bookmark"]',t),s=Ke(e,n),(r=St.createRng()).setStartAfter(n),r.setEndAfter(t),u=(o=r.extractContents()).firstChild;u;u=u.firstChild)if("LI"===u.nodeName&&e.dom.isEmpty(u)){St.remove(u);break}e.dom.isEmpty(o)||St.insertAfter(o,t),St.insertAfter(s,t),Fe(e.dom,n.parentNode)&&(a=n.parentNode,De.each(i,function(e){a.parentNode.insertBefore(e,n.parentNode)}),St.remove(a)),St.remove(n),Fe(e.dom,t)&&St.remove(t)},Ct=function(e){ie(e,"dt")&&et(e,"dd")},bt=function(e,t,n){C(n,"Indent"===t?Ct:function(t){return function(e,t){ie(t,"dd")?et(t,"dt"):ie(t,"dt")&&de(t).each(function(n){return Ot(e,n.dom(),t.dom())})}(e,t)})},Lt=function(e,t){if(we(e))return{container:e,offset:t};var n=ue.getNode(e,t);return we(n)?{container:n,offset:t>=e.childNodes.length?n.data.length:0}:n.previousSibling&&we(n.previousSibling)?{container:n.previousSibling,offset:n.previousSibling.data.length}:n.nextSibling&&we(n.nextSibling)?{container:n.nextSibling,offset:0}:{container:e,offset:t}},Tt=function(e){var t=e.cloneRange(),n=Lt(e.startContainer,e.startOffset);t.setStart(n.container,n.offset);var r=Lt(e.endContainer,e.endOffset);return t.setEnd(r.container,r.offset),t},Dt=function(e,t){var n=O(ze.getSelectedListRoots(e),Z.fromDom),r=O(ze.getSelectedDlItems(e),Z.fromDom),o=!1;if(n.length||r.length){var i=e.selection.getBookmark();Nt(e,n,t),bt(e,t,r),e.selection.moveToBookmark(i),e.selection.setRng(Tt(e.selection.getRng())),e.nodeChanged(),o=!0}return o},Et=function(e){return Dt(e,"Indent")},wt=function(e){return Dt(e,"Outdent")},kt=function(e){return Dt(e,"Flatten")},At=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),xt=yt.DOM,Rt=function(e){var t={},n=function(n){var r,o,i;o=e[n?"startContainer":"endContainer"],i=e[n?"startOffset":"endOffset"],1===o.nodeType&&(r=xt.create("span",{"data-mce-type":"bookmark"}),o.hasChildNodes()?(i=Math.min(i,o.childNodes.length-1),n?o.insertBefore(r,o.childNodes[i]):xt.insertAfter(r,o.childNodes[i])):o.appendChild(r),o=r,i=0),t[n?"startContainer":"endContainer"]=o,t[n?"startOffset":"endOffset"]=i};return n(!0),e.collapsed||n(),t},It=function(e){function t(t){var n,r,o;n=o=e[t?"startContainer":"endContainer"],r=e[t?"startOffset":"endOffset"],n&&(1===n.nodeType&&(r=function(e){for(var t=e.parentNode.firstChild,n=0;t;){if(t===e)return n;1===t.nodeType&&"bookmark"===t.getAttribute("data-mce-type")||n++,t=t.nextSibling}return-1}(n),n=n.parentNode,xt.remove(o),!n.hasChildNodes()&&xt.isBlock(n)&&n.appendChild(xt.create("br"))),e[t?"startContainer":"endContainer"]=n,e[t?"startOffset":"endOffset"]=r)}t(!0),t();var n=xt.createRng();return n.setStart(e.startContainer,e.startOffset),e.endContainer&&n.setEnd(e.endContainer,e.endOffset),Tt(n)},_t=function(e){return/\btox\-/.test(e.className)},Bt=function(e){switch(e){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},Pt=function(e,t){De.each(t,function(t,n){e.setAttribute(n,t)})},Mt=function(e,t,n){!function(e,t,n){var r=n["list-style-type"]?n["list-style-type"]:null;e.setStyle(t,"list-style-type",r)}(e,t,n),function(e,t,n){Pt(t,n["list-attributes"]),De.each(e.select("li",t),function(e){Pt(e,n["list-item-attributes"])})}(e,t,n)},Ut=function(e,t,n,r){var o,i;for(o=t[n?"startContainer":"endContainer"],i=t[n?"startOffset":"endOffset"],1===o.nodeType&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!n&&_e(o.nextSibling)&&(o=o.nextSibling);o.parentNode!==r;){if(Pe(e,o))return o;if(/^(TD|TH)$/.test(o.parentNode.nodeName))return o;o=o.parentNode}return o},Ft=function(e,t,n){void 0===n&&(n={});var r,o=e.selection.getRng(!0),i="LI",u=ze.getClosestListRootElm(e,e.selection.getStart(!0)),s=e.dom;"false"!==s.getContentEditable(e.selection.getNode())&&("DL"===(t=t.toUpperCase())&&(i="DT"),r=Rt(o),De.each(function(e,t,n){for(var r,o=[],i=e.dom,u=Ut(e,t,!0,n),s=Ut(e,t,!1,n),a=[],c=u;c&&(a.push(c),c!==s);c=c.nextSibling);return De.each(a,function(t){if(Pe(e,t))return o.push(t),void(r=null);if(i.isBlock(t)||_e(t))return _e(t)&&i.remove(t),void(r=null);var u=t.nextSibling;At.isBookmarkNode(t)&&(Pe(e,u)||!u&&t.parentNode===n)?r=null:(r||(r=i.create("p"),t.parentNode.insertBefore(r,t),o.push(r)),r.appendChild(t))}),o}(e,o,u),function(r){var o,u;(u=r.previousSibling)&&ke(u)&&u.nodeName===t&&function(e,t,n){var r=e.getStyle(t,"list-style-type"),o=n?n["list-style-type"]:"";return r===(o=null===o?"":o)}(s,u,n)?(o=u,r=s.rename(r,i),u.appendChild(r)):(o=s.create(t),r.parentNode.insertBefore(o,r),o.appendChild(r),r=s.rename(r,i)),function(e,t,n){De.each(n,function(n){var r;return e.setStyle(t,((r={})[n]="",r))})}(s,r,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),Mt(s,o,n),Ht(e.dom,o)}),e.selection.setRng(It(r)))},jt=function(e,t,n){return function(e,t){return e&&t&&ke(e)&&e.nodeName===t.nodeName}(t,n)&&function(e,t,n){return e.getStyle(t,"list-style-type",!0)===e.getStyle(n,"list-style-type",!0)}(e,t,n)&&(r=n,t.className===r.className);var r},Ht=function(e,t){var n,r;if(n=t.nextSibling,jt(e,t,n)){for(;r=n.firstChild;)t.appendChild(r);e.remove(n)}if(n=t.previousSibling,jt(e,t,n)){for(;r=n.lastChild;)t.insertBefore(r,t.firstChild);e.remove(n)}},$t=function(e,t,n,r,o){if(t.nodeName!==r||Wt(o)){var i=Rt(e.selection.getRng(!0));De.each([t].concat(n),function(t){!function(e,t,n,r){if(t.nodeName!==n){var o=e.dom.rename(t,n);Mt(e.dom,o,r),Se(e,Bt(n),o)}else Mt(e.dom,t,r),Se(e,Bt(n),t)}(e,t,r,o)}),e.selection.setRng(It(i))}else kt(e)},Wt=function(e){return"list-style-type"in e},qt={toggleList:function(e,t,n){var r=ze.getParentList(e),o=ze.getSelectedSubLists(e);n=n||{},r&&o.length>0?$t(e,r,o,t,n):function(e,t,n,r){if(t!==e.getBody())if(t)if(t.nodeName!==n||Wt(r)||_t(t)){var o=Rt(e.selection.getRng(!0));Mt(e.dom,t,r);var i=e.dom.rename(t,n);Ht(e.dom,i),e.selection.setRng(It(o)),Se(e,Bt(n),i)}else kt(e);else Ft(e,n,r),Se(e,Bt(n),t)}(e,r,t,n)},mergeWithAdjacentLists:Ht},Vt=yt.DOM,zt=function(e,t){var n,r=t.parentNode;"LI"===r.nodeName&&r.firstChild===t&&((n=r.previousSibling)&&"LI"===n.nodeName?(n.appendChild(t),Fe(e,r)&&Vt.remove(r)):Vt.setStyle(r,"listStyleType","none")),ke(r)&&(n=r.previousSibling)&&"LI"===n.nodeName&&n.appendChild(t)},Kt=function(e,t){De.each(De.grep(e.select("ol,ul",t)),function(t){zt(e,t)})},Xt=function(e,t,n,r){var o=t.startContainer,i=t.startOffset;if(we(o)&&(n?i<o.data.length:i>0))return o;var u=e.schema.getNonEmptyElements();1===o.nodeType&&(o=ue.getNode(o,i));var s=new se(o,r);for(n&&Ue(e.dom,o)&&s.next();o=s[n?"next":"prev2"]();){if("LI"===o.nodeName&&!o.hasChildNodes())return o;if(u[o.nodeName])return o;if(we(o)&&o.data.length>0)return o}},Qt=function(e,t){var n=t.childNodes;return 1===n.length&&!ke(n[0])&&e.isBlock(n[0])},Yt=function(e,t,n){var r,o;if(o=Qt(e,n)?n.firstChild:n,function(e,t){Qt(e,t)&&e.remove(t.firstChild,!0)}(e,t),!Fe(e,t,!0))for(;r=t.firstChild;)o.appendChild(r)},Gt=function(e,t,n){var r,o,i=t.parentNode;if(je(e,t)&&je(e,n)){ke(n.lastChild)&&(o=n.lastChild),i===n.lastChild&&_e(i.previousSibling)&&e.remove(i.previousSibling),(r=n.lastChild)&&_e(r)&&t.hasChildNodes()&&e.remove(r),Fe(e,n,!0)&&e.$(n).empty(),Yt(e,t,n),o&&n.appendChild(o);var u=oe(Z.fromDom(n),Z.fromDom(t))?e.getParents(t,ke,n):[];e.remove(t),C(u,function(t){Fe(e,t)&&t!==e.getRoot()&&e.remove(t)})}},Jt=function(e,t,n,r){var o=e.dom;if(o.isEmpty(r))!function(e,t,n){e.dom.$(n).empty(),Gt(e.dom,t,n),e.selection.setCursorLocation(n)}(e,n,r);else{var i=Rt(t);Gt(o,n,r),e.selection.setRng(It(i))}},Zt=function(e,t){var n=e.dom,r=e.selection,o=r.getStart(),i=ze.getClosestListRootElm(e,o),u=n.getParent(r.getStart(),"LI",i);if(u){var s=u.parentNode;if(s===e.getBody()&&Fe(n,s))return!0;var a=Tt(r.getRng()),c=n.getParent(Xt(e,a,t,i),"LI",i);if(c&&c!==u)return e.undoManager.transact(function(){t?Jt(e,a,c,u):Be(u)?wt(e):function(e,t,n,r){var o=Rt(t);Gt(e.dom,n,r);var i=It(o);e.selection.setRng(i)}(e,a,u,c)}),!0;if(!c&&!t&&0===a.startOffset&&0===a.endOffset)return e.undoManager.transact(function(){kt(e)}),!0}return!1},en=function(e,t){return Zt(e,t)||function(e,t){var n=e.dom,r=e.selection.getStart(),o=ze.getClosestListRootElm(e,r),i=n.getParent(r,n.isBlock,o);if(i&&n.isEmpty(i)){var u=Tt(e.selection.getRng()),s=n.getParent(Xt(e,u,t,o),"LI",o);if(s)return e.undoManager.transact(function(){!function(e,t,n){var r=e.getParent(t.parentNode,e.isBlock,n);e.remove(t),r&&e.isEmpty(r)&&e.remove(r)}(n,i,o),qt.mergeWithAdjacentLists(n,s.parentNode),e.selection.select(s,!0),e.selection.collapse(t)}),!0}return!1}(e,t)},tn=function(e,t){return e.selection.isCollapsed()?en(e,t):function(e){var t=e.selection.getStart(),n=ze.getClosestListRootElm(e,t);return!!(e.dom.getParent(t,"LI,DT,DD",n)||ze.getSelectedListItems(e).length>0)&&(e.undoManager.transact(function(){e.execCommand("Delete"),Kt(e.dom,e.getBody())}),!0)}(e)},nn=function(e){e.on("keydown",function(t){t.keyCode===ae.BACKSPACE?tn(e,!1)&&t.preventDefault():t.keyCode===ae.DELETE&&tn(e,!0)&&t.preventDefault()})},rn=tn,on={get:function(e){return{backspaceDelete:function(t){rn(e,t)}}}},un=function(e,t){return function(){var n=e.dom.getParent(e.selection.getStart(),"UL,OL,DL");return n&&n.nodeName===t}},sn={register:function(e){e.on("BeforeExecCommand",function(t){var n=t.command.toLowerCase();"indent"===n?Et(e):"outdent"===n&&wt(e)}),e.addCommand("InsertUnorderedList",function(t,n){qt.toggleList(e,"UL",n)}),e.addCommand("InsertOrderedList",function(t,n){qt.toggleList(e,"OL",n)}),e.addCommand("InsertDefinitionList",function(t,n){qt.toggleList(e,"DL",n)}),e.addCommand("RemoveList",function(){kt(e)}),e.addQueryStateHandler("InsertUnorderedList",un(e,"UL")),e.addQueryStateHandler("InsertOrderedList",un(e,"OL")),e.addQueryStateHandler("InsertDefinitionList",un(e,"DL"))}},an=function(e){return e.getParam("lists_indent_on_tab",!0)},cn={setup:function(e){an(e)&&function(e){e.on("keydown",function(t){t.keyCode!==ae.TAB||ae.metaKeyPressed(t)||e.undoManager.transact(function(){(t.shiftKey?wt(e):Et(e))&&t.preventDefault()})})}(e),nn(e)}},fn=function(e,t){return function(n){var r=function(e){var r=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n;return-1}(e.parents,Ie),o=-1!==r?e.parents.slice(0,r):e.parents,i=De.grep(o,ke);n.setActive(i.length>0&&i[0].nodeName===t&&!_t(i[0]))};return e.on("NodeChange",r),function(){return e.off("NodeChange",r)}}},dn={register:function(e){var t=function(t){return function(){return e.execCommand(t)}};(function(e,t){var n=e.settings.plugins?e.settings.plugins:"";return-1!==De.inArray(n.split(/[ ,]/),t)})(e,"advlist")||(e.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:t("InsertOrderedList"),onSetup:fn(e,"OL")}),e.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:t("InsertUnorderedList"),onSetup:fn(e,"UL")}))}};r.add("lists",function(e){return cn.setup(e),dn.register(e),sn.register(e),on.get(e)})}(window);
//# sourceMappingURL=plugin.js.map
