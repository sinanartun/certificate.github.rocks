{"version":3,"sources":["lists/plugin.js"],"names":["domGlobals","t","merger","global","tinymce","util","Tools","resolve","noop","constant","value","not","f","args","_i","arguments","length","apply","never","always","none","NONE","eq","o","isNone","call","thunk","id","n","me","fold","s","is","isSome","getOr","getOrThunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","Object","freeze","some","a","constant_a","self","v","elementEq","b","Option","from","isType","type","x","Array","prototype","isPrototypeOf","constructor","name","String","typeOf","isString","isArray","isBoolean","isFunction","isNumber","nativeSlice","slice","nativePush","push","xs","len","r","i","pred","foldl","acc","find","flatten","head","last","compareDocumentPosition","match","Node","DOCUMENT_POSITION_CONTAINED_BY","Cell","initial","get","set","clone","unknown","nu","major","minor","Version","detect","versionRegexes","agent","cleanedAgent","toLowerCase","regexes","test","firstMatch","group","Number","replace","find$1","isBrowser","current","nu$1","info","version","isEdge","isChrome","isIE","isOpera","isFirefox","isSafari","Browser","edge","chrome","ie","opera","firefox","safari","isOS","nu$2","isWindows","isiOS","isAndroid","isOSX","isLinux","isSolaris","isFreeBSD","OperatingSystem","windows","ios","android","linux","osx","solaris","freebsd","detect$1","candidates","userAgent","candidate","search","UaString","browsers","browser","oses","os","contains","str","substr","indexOf","normalVersionRegex","checkContains","target","uastring","PlatformInfo","PlatformDetection","mediaMatch","deviceType","isiPad","isiPhone","isMobile","isTouch","isTablet","isPhone","iOSwebview","isDesktop","isWebView","DeviceType","platform","navigator","query","window","matchMedia","matches","fromDom","node","dom","Element","fromHtml","html","scope","div","document","createElement","innerHTML","hasChildNodes","childNodes","console","error","fromTag","tag","fromText","text","createTextNode","fromPoint","docElm","y","doc","elementFromPoint","ELEMENT","ATTRIBUTE_NODE","CDATA_SECTION_NODE","COMMENT_NODE","DOCUMENT_NODE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT_NODE","ELEMENT_NODE","ELEMENT$1","TEXT_NODE","PROCESSING_INSTRUCTION_NODE","ENTITY_REFERENCE_NODE","ENTITY_NODE","NOTATION_NODE","e1","e2","contains$1","d1","d2","is$1","element","selector","nodeType","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","global$1","global$2","global$3","lift2","oa","ob","keys","parent","parentNode","children","child","index","cs","firstChild","lastChild","before","fields","Immutable","marker","insertBefore","append","appendChild","append$1","elements","remove","removeChild","fireListEvent","editor","action","fire","Global","Function","p","parts","path","split","Global$1","actual","unsafe","HTMLElement","htmlElement","global$4","global$5","isBr","nodeName","NodeType","schema","getTextBlockElements","blockElements","isBlock","nextSibling","previousSibling","elm","keepBookmarks","empty","isEmpty","select","isChildOf","getRoot","getParentList","selectionStart","selection","getStart","getParent","getClosestListRootElm","getSelectedListItems","selectedBlocks","getSelectedBlocks","grep","elms","listItemsElms","parentLi","unique","findParentListItemsNodes","block","parentTableCell","getParents","getBody","findLastParentListNode","parentLists","getUniqueListRoots","lists","listRoots","list","Selection","isList","getSelectedSubLists","parentList","isParentListSelected","querySelectorAll","findSubLists","getSelectedDlItems","getSelectedListRoots","selectedLists","firstList","subsequentLists","concat","getSelectedLists","createTextBlock","contentNode","textBlock","blockName","hasContentNode","getBlockElements","fragment","createFragment","settings","forced_root_block","create","tagName","setAttribs","forced_root_block_attrs","getAttribute","data-mce-bogus","isElement","setAll","attrs","obj","props","k","each$1","key","setAttribute","rawSet","attributes","attr","internalSet","property","style","getPropertyValue","isSupported","setProperty","deep","original","isDeep","cloneNode","clone$1","mutate","shallowAs","children$1","joinSegment","item","createSegment","listType","segment","writeShallow","cast","entry","newCast","depth","appendItem","content","createItem","itemAttributes","listAttributes","normalizeSegment","writeDeep","tail","segments","size","createSegments","joinSegments","populateSegments","isList$1","el","hasFirstChildList","isIndented","isSelected","cloneItemContent","li","hasOwnProperty","merge","old","objects","ret","j","curObject","normalizeEntries","entries","start","previousSiblingEntry","matchingEntry","source","parseItem","itemSelection","selectionState","currentItemEntry","createEntry","end","childListEntries","parseList","outdentedComposer","createDocumentFragment","indentedComposer","composeList","contentDocument","getItemSelection","selectedListItems","reverse","listIndentation","indentation","entrySets","sourceList","parseLists","entrySet","indentEntry","indentSelectedEntries","composedLists","wasType","groupBy","composeEntries","composedList","global$6","DOM","SplitList","ul","tmpRng","bookmarks","newBlock","targetNode","createRng","setStartAfter","setEndAfter","extractContents","insertAfter","indentDlItem","dlIndentation","dlItems","dl","outdentDlItem","getNormalizedPoint","container","offset","getNode","data","Range","rng","outRng","cloneRange","rangeStart","startContainer","startOffset","setStart","rangeEnd","endContainer","endOffset","setEnd","selectionIndentation","isHandled","bookmark","getBookmark","moveToBookmark","setRng","getRng","nodeChanged","indentListSelection","outdentListSelection","flattenListSelection","global$7","DOM$1","Bookmark","setupEndPoint","offsetNode","data-mce-type","Math","min","collapsed","restoreEndPoint","idx","nodeIndex","isCustomList","className","listToggleActionFromListName","listName","updateListWithDetails","detail","setStyle","updateListStyle","updateListAttrs","getEndPointNode","root","applyList","listItemName","getContentEditable","toUpperCase","textBlocks","startNode","endNode","siblings","isBookmarkNode","getSelectedTextBlocks","listBlock","sibling","sib","sibStyle","getStyle","detailStyle","hasCompatibleStyle","rename","styles","_a","removeStyles","mergeWithAdjacentLists","shouldMerge","list1","list2","isValidLists","hasSameListStyle","elm2","toggleMultipleLists","hasListStyleDetail","newList","updateList","ToggleList","toggleList","selectedSubLists","toggleSingleList","DOM$2","normalizeList","NormalizeLists","findNextCaretContainer","isForward","nonEmptyBlocks","getNonEmptyElements","walker","next","hasOnlyOneBlockChild","moveChildren","fromElm","toElm","targetElm","unwrapSingleBlockChild","mergeLiElements","listNode","$","nestedLists","mergeForward","fromLi","toLi","setCursorLocation","mergeIntoEmptyLi","backspaceDeleteFromListToListCaret","selectionStartElm","rng_1","otherLi_1","undoManager","transact","resolvedBookmark","mergeBackward","backspaceDeleteCaret","otherLi_2","parentBlock","removeBlock","collapse","backspaceDeleteIntoListCaret","backspaceDelete","isCollapsed","execCommand","backspaceDeleteRange","Delete","on","e","keyCode","BACKSPACE","preventDefault","DELETE","Api","queryListCommandState","Commands","register","cmd","command","addCommand","ui","addQueryStateHandler","Settings","getParam","Keyboard","setup","TAB","metaKeyPressed","shiftKey","setupTabKey","listState","buttonApi","nodeChangeHandler","tableCellIndex","predicate","findIndex","parents","setActive","off","Buttons","exec","plugin","plugins","inArray","hasPlugin","registry","addToggleButton","icon","active","tooltip","onAction","onSetup","add"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var not = function (f) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return !f.apply(null, args);\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isString = isType('string');\n    var isArray = isType('array');\n    var isBoolean = isType('boolean');\n    var isFunction = isType('function');\n    var isNumber = isType('number');\n\n    var nativeSlice = Array.prototype.slice;\n    var nativePush = Array.prototype.push;\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var groupBy = function (xs, f) {\n      if (xs.length === 0) {\n        return [];\n      } else {\n        var wasType = f(xs[0]);\n        var r = [];\n        var group = [];\n        for (var i = 0, len = xs.length; i < len; i++) {\n          var x = xs[i];\n          var type = f(x);\n          if (type !== wasType) {\n            r.push(group);\n            group = [];\n          }\n          wasType = type;\n          group.push(x);\n        }\n        if (group.length !== 0) {\n          r.push(group);\n        }\n        return r;\n      }\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var find = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Option.some(x);\n        }\n      }\n      return Option.none();\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      var output = map(xs, f);\n      return flatten(output);\n    };\n    var reverse = function (xs) {\n      var r = nativeSlice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n    var head = function (xs) {\n      return xs.length === 0 ? Option.none() : Option.some(xs[0]);\n    };\n    var last = function (xs) {\n      return xs.length === 0 ? Option.none() : Option.some(xs[xs.length - 1]);\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionPreceding = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_PRECEDING);\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n    var Node = {\n      documentPositionPreceding: documentPositionPreceding,\n      documentPositionContainedBy: documentPositionContainedBy\n    };\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      var clone = function () {\n        return Cell(get());\n      };\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$1 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu(group(1), group(2));\n    };\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown();\n      }\n      return find$1(versionRegexes, cleanedAgent);\n    };\n    var unknown = function () {\n      return nu(0, 0);\n    };\n    var nu = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu,\n      detect: detect,\n      unknown: unknown\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var isBrowser = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$1 = function () {\n      return nu$1({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$1 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge, current),\n        isChrome: isBrowser(chrome, current),\n        isIE: isBrowser(ie, current),\n        isOpera: isBrowser(opera, current),\n        isFirefox: isBrowser(firefox, current),\n        isSafari: isBrowser(safari, current)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$1,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var isOS = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$2 = function () {\n      return nu$2({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows, current),\n        isiOS: isOS(ios, current),\n        isAndroid: isOS(android, current),\n        isOSX: isOS(osx, current),\n        isLinux: isOS(linux, current),\n        isSolaris: isOS(solaris, current),\n        isFreeBSD: isOS(freebsd, current)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$2,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd)\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var contains = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains(uastring, 'edge/') && contains(uastring, 'chrome') && contains(uastring, 'safari') && contains(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains(uastring, 'chrome') && !contains(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains(uastring, 'msie') || contains(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains(uastring, 'safari') || contains(uastring, 'mobile/')) && contains(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains(uastring, 'iphone') || contains(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('os x'),\n        versionRegexes: [/.*?os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var detect$2 = function (userAgent, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var mediaMatch = function (query) {\n      return domGlobals.window.matchMedia(query).matches;\n    };\n    var platform = Cell(PlatformDetection.detect(domGlobals.navigator.userAgent, mediaMatch));\n    var detect$3 = function () {\n      return platform.get();\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        domGlobals.console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: constant(node) };\n    };\n    var fromPoint = function (docElm, x, y) {\n      var doc = docElm.dom();\n      return Option.from(doc.elementFromPoint(x, y)).map(fromDom);\n    };\n    var Element = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var ATTRIBUTE = domGlobals.Node.ATTRIBUTE_NODE;\n    var CDATA_SECTION = domGlobals.Node.CDATA_SECTION_NODE;\n    var COMMENT = domGlobals.Node.COMMENT_NODE;\n    var DOCUMENT = domGlobals.Node.DOCUMENT_NODE;\n    var DOCUMENT_TYPE = domGlobals.Node.DOCUMENT_TYPE_NODE;\n    var DOCUMENT_FRAGMENT = domGlobals.Node.DOCUMENT_FRAGMENT_NODE;\n    var ELEMENT = domGlobals.Node.ELEMENT_NODE;\n    var TEXT = domGlobals.Node.TEXT_NODE;\n    var PROCESSING_INSTRUCTION = domGlobals.Node.PROCESSING_INSTRUCTION_NODE;\n    var ENTITY_REFERENCE = domGlobals.Node.ENTITY_REFERENCE_NODE;\n    var ENTITY = domGlobals.Node.ENTITY_NODE;\n    var NOTATION = domGlobals.Node.NOTATION_NODE;\n\n    var ELEMENT$1 = ELEMENT;\n    var is = function (element, selector) {\n      var dom = element.dom();\n      if (dom.nodeType !== ELEMENT$1) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n\n    var eq = function (e1, e2) {\n      return e1.dom() === e2.dom();\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom();\n      var d2 = e2.dom();\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return Node.documentPositionContainedBy(e1.dom(), e2.dom());\n    };\n    var browser = detect$3().browser;\n    var contains$1 = browser.isIE() ? ieContains : regularContains;\n    var is$1 = is;\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.dom.RangeUtils');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.dom.TreeWalker');\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var lift2 = function (oa, ob, f) {\n      return oa.isSome() && ob.isSome() ? Option.some(f(oa.getOrDie(), ob.getOrDie())) : Option.none();\n    };\n\n    var fromElements = function (elements, scope) {\n      var doc = scope || domGlobals.document;\n      var fragment = doc.createDocumentFragment();\n      each(elements, function (element) {\n        fragment.appendChild(element.dom());\n      });\n      return Element.fromDom(fragment);\n    };\n\n    var Immutable = function () {\n      var fields = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        fields[_i] = arguments[_i];\n      }\n      return function () {\n        var values = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n        if (fields.length !== values.length) {\n          throw new Error('Wrong number of arguments to struct. Expected \"[' + fields.length + ']\", got ' + values.length + ' arguments');\n        }\n        var struct = {};\n        each(fields, function (name, i) {\n          struct[name] = constant(values[i]);\n        });\n        return struct;\n      };\n    };\n\n    var keys = Object.keys;\n    var each$1 = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n\n    var parent = function (element) {\n      return Option.from(element.dom().parentNode).map(Element.fromDom);\n    };\n    var children = function (element) {\n      return map(element.dom().childNodes, Element.fromDom);\n    };\n    var child = function (element, index) {\n      var cs = element.dom().childNodes;\n      return Option.from(cs[index]).map(Element.fromDom);\n    };\n    var firstChild = function (element) {\n      return child(element, 0);\n    };\n    var lastChild = function (element) {\n      return child(element, element.dom().childNodes.length - 1);\n    };\n    var spot = Immutable('element', 'offset');\n\n    var before = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom().insertBefore(element.dom(), marker.dom());\n      });\n    };\n    var append = function (parent, element) {\n      parent.dom().appendChild(element.dom());\n    };\n\n    var before$1 = function (marker, elements) {\n      each(elements, function (x) {\n        before(marker, x);\n      });\n    };\n    var append$1 = function (parent, elements) {\n      each(elements, function (x) {\n        append(parent, x);\n      });\n    };\n\n    var remove = function (element) {\n      var dom = element.dom();\n      if (dom.parentNode !== null) {\n        dom.parentNode.removeChild(dom);\n      }\n    };\n\n    var fireListEvent = function (editor, action, element) {\n      return editor.fire('ListMutation', {\n        action: action,\n        element: element\n      });\n    };\n\n    var Global = typeof domGlobals.window !== 'undefined' ? domGlobals.window : Function('return this;')();\n\n    var path = function (parts, scope) {\n      var o = scope !== undefined && scope !== null ? scope : Global;\n      for (var i = 0; i < parts.length && o !== undefined && o !== null; ++i) {\n        o = o[parts[i]];\n      }\n      return o;\n    };\n    var resolve = function (p, scope) {\n      var parts = p.split('.');\n      return path(parts, scope);\n    };\n\n    var unsafe = function (name, scope) {\n      return resolve(name, scope);\n    };\n    var getOrDie = function (name, scope) {\n      var actual = unsafe(name, scope);\n      if (actual === undefined || actual === null) {\n        throw new Error(name + ' not available on this browser');\n      }\n      return actual;\n    };\n    var Global$1 = { getOrDie: getOrDie };\n\n    var htmlElement = function (scope) {\n      return Global$1.getOrDie('HTMLElement', scope);\n    };\n    var isPrototypeOf = function (x) {\n      var scope = resolve('ownerDocument.defaultView', x);\n      return htmlElement(scope).prototype.isPrototypeOf(x);\n    };\n    var HTMLElement = { isPrototypeOf: isPrototypeOf };\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.dom.DomQuery');\n\n    var global$5 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var isTextNode = function (node) {\n      return node && node.nodeType === 3;\n    };\n    var isListNode = function (node) {\n      return node && /^(OL|UL|DL)$/.test(node.nodeName);\n    };\n    var isOlUlNode = function (node) {\n      return node && /^(OL|UL)$/.test(node.nodeName);\n    };\n    var isListItemNode = function (node) {\n      return node && /^(LI|DT|DD)$/.test(node.nodeName);\n    };\n    var isDlItemNode = function (node) {\n      return node && /^(DT|DD)$/.test(node.nodeName);\n    };\n    var isTableCellNode = function (node) {\n      return node && /^(TH|TD)$/.test(node.nodeName);\n    };\n    var isBr = function (node) {\n      return node && node.nodeName === 'BR';\n    };\n    var isFirstChild = function (node) {\n      return node.parentNode.firstChild === node;\n    };\n    var isLastChild = function (node) {\n      return node.parentNode.lastChild === node;\n    };\n    var isTextBlock = function (editor, node) {\n      return node && !!editor.schema.getTextBlockElements()[node.nodeName];\n    };\n    var isBlock = function (node, blockElements) {\n      return node && node.nodeName in blockElements;\n    };\n    var isBogusBr = function (dom, node) {\n      if (!isBr(node)) {\n        return false;\n      }\n      if (dom.isBlock(node.nextSibling) && !isBr(node.previousSibling)) {\n        return true;\n      }\n      return false;\n    };\n    var isEmpty = function (dom, elm, keepBookmarks) {\n      var empty = dom.isEmpty(elm);\n      if (keepBookmarks && dom.select('span[data-mce-type=bookmark]', elm).length > 0) {\n        return false;\n      }\n      return empty;\n    };\n    var isChildOfBody = function (dom, elm) {\n      return dom.isChildOf(elm, dom.getRoot());\n    };\n    var NodeType = {\n      isTextNode: isTextNode,\n      isListNode: isListNode,\n      isOlUlNode: isOlUlNode,\n      isDlItemNode: isDlItemNode,\n      isListItemNode: isListItemNode,\n      isTableCellNode: isTableCellNode,\n      isBr: isBr,\n      isFirstChild: isFirstChild,\n      isLastChild: isLastChild,\n      isTextBlock: isTextBlock,\n      isBlock: isBlock,\n      isBogusBr: isBogusBr,\n      isEmpty: isEmpty,\n      isChildOfBody: isChildOfBody\n    };\n\n    var getParentList = function (editor) {\n      var selectionStart = editor.selection.getStart(true);\n      return editor.dom.getParent(selectionStart, 'OL,UL,DL', getClosestListRootElm(editor, selectionStart));\n    };\n    var isParentListSelected = function (parentList, selectedBlocks) {\n      return parentList && selectedBlocks.length === 1 && selectedBlocks[0] === parentList;\n    };\n    var findSubLists = function (parentList) {\n      return global$5.grep(parentList.querySelectorAll('ol,ul,dl'), function (elm) {\n        return NodeType.isListNode(elm);\n      });\n    };\n    var getSelectedSubLists = function (editor) {\n      var parentList = getParentList(editor);\n      var selectedBlocks = editor.selection.getSelectedBlocks();\n      if (isParentListSelected(parentList, selectedBlocks)) {\n        return findSubLists(parentList);\n      } else {\n        return global$5.grep(selectedBlocks, function (elm) {\n          return NodeType.isListNode(elm) && parentList !== elm;\n        });\n      }\n    };\n    var findParentListItemsNodes = function (editor, elms) {\n      var listItemsElms = global$5.map(elms, function (elm) {\n        var parentLi = editor.dom.getParent(elm, 'li,dd,dt', getClosestListRootElm(editor, elm));\n        return parentLi ? parentLi : elm;\n      });\n      return global$4.unique(listItemsElms);\n    };\n    var getSelectedListItems = function (editor) {\n      var selectedBlocks = editor.selection.getSelectedBlocks();\n      return global$5.grep(findParentListItemsNodes(editor, selectedBlocks), function (block) {\n        return NodeType.isListItemNode(block);\n      });\n    };\n    var getSelectedDlItems = function (editor) {\n      return filter(getSelectedListItems(editor), NodeType.isDlItemNode);\n    };\n    var getClosestListRootElm = function (editor, elm) {\n      var parentTableCell = editor.dom.getParents(elm, 'TD,TH');\n      var root = parentTableCell.length > 0 ? parentTableCell[0] : editor.getBody();\n      return root;\n    };\n    var findLastParentListNode = function (editor, elm) {\n      var parentLists = editor.dom.getParents(elm, 'ol,ul', getClosestListRootElm(editor, elm));\n      return last(parentLists);\n    };\n    var getSelectedLists = function (editor) {\n      var firstList = findLastParentListNode(editor, editor.selection.getStart());\n      var subsequentLists = filter(editor.selection.getSelectedBlocks(), NodeType.isOlUlNode);\n      return firstList.toArray().concat(subsequentLists);\n    };\n    var getSelectedListRoots = function (editor) {\n      var selectedLists = getSelectedLists(editor);\n      return getUniqueListRoots(editor, selectedLists);\n    };\n    var getUniqueListRoots = function (editor, lists) {\n      var listRoots = map(lists, function (list) {\n        return findLastParentListNode(editor, list).getOr(list);\n      });\n      return global$4.unique(listRoots);\n    };\n    var isList = function (editor) {\n      var list = getParentList(editor);\n      return HTMLElement.isPrototypeOf(list);\n    };\n    var Selection = {\n      isList: isList,\n      getParentList: getParentList,\n      getSelectedSubLists: getSelectedSubLists,\n      getSelectedListItems: getSelectedListItems,\n      getClosestListRootElm: getClosestListRootElm,\n      getSelectedDlItems: getSelectedDlItems,\n      getSelectedListRoots: getSelectedListRoots\n    };\n\n    var createTextBlock = function (editor, contentNode) {\n      var dom = editor.dom;\n      var blockElements = editor.schema.getBlockElements();\n      var fragment = dom.createFragment();\n      var node, textBlock, blockName, hasContentNode;\n      if (editor.settings.forced_root_block) {\n        blockName = editor.settings.forced_root_block;\n      }\n      if (blockName) {\n        textBlock = dom.create(blockName);\n        if (textBlock.tagName === editor.settings.forced_root_block) {\n          dom.setAttribs(textBlock, editor.settings.forced_root_block_attrs);\n        }\n        if (!NodeType.isBlock(contentNode.firstChild, blockElements)) {\n          fragment.appendChild(textBlock);\n        }\n      }\n      if (contentNode) {\n        while (node = contentNode.firstChild) {\n          var nodeName = node.nodeName;\n          if (!hasContentNode && (nodeName !== 'SPAN' || node.getAttribute('data-mce-type') !== 'bookmark')) {\n            hasContentNode = true;\n          }\n          if (NodeType.isBlock(node, blockElements)) {\n            fragment.appendChild(node);\n            textBlock = null;\n          } else {\n            if (blockName) {\n              if (!textBlock) {\n                textBlock = dom.create(blockName);\n                fragment.appendChild(textBlock);\n              }\n              textBlock.appendChild(node);\n            } else {\n              fragment.appendChild(node);\n            }\n          }\n        }\n      }\n      if (!editor.settings.forced_root_block) {\n        fragment.appendChild(dom.create('br'));\n      } else {\n        if (!hasContentNode) {\n          textBlock.appendChild(dom.create('br', { 'data-mce-bogus': '1' }));\n        }\n      }\n      return fragment;\n    };\n\n    var name = function (element) {\n      var r = element.dom().nodeName;\n      return r.toLowerCase();\n    };\n    var type = function (element) {\n      return element.dom().nodeType;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isElement = isType$1(ELEMENT);\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        domGlobals.console.error('Invalid call to Attr.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var setAll = function (element, attrs) {\n      var dom = element.dom();\n      each$1(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n    var clone = function (element) {\n      return foldl(element.dom().attributes, function (acc, attr) {\n        acc[attr.name] = attr.value;\n        return acc;\n      }, {});\n    };\n\n    var isSupported = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var internalSet = function (dom, property, value) {\n      if (!isString(value)) {\n        domGlobals.console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n        throw new Error('CSS value must be a string: ' + value);\n      }\n      if (isSupported(dom)) {\n        dom.style.setProperty(property, value);\n      }\n    };\n    var set = function (element, property, value) {\n      var dom = element.dom();\n      internalSet(dom, property, value);\n    };\n\n    var clone$1 = function (original, isDeep) {\n      return Element.fromDom(original.dom().cloneNode(isDeep));\n    };\n    var deep = function (original) {\n      return clone$1(original, true);\n    };\n    var shallowAs = function (original, tag) {\n      var nu = Element.fromTag(tag);\n      var attributes = clone(original);\n      setAll(nu, attributes);\n      return nu;\n    };\n    var mutate = function (original, tag) {\n      var nu = shallowAs(original, tag);\n      before(original, nu);\n      var children$1 = children(original);\n      append$1(nu, children$1);\n      remove(original);\n      return nu;\n    };\n\n    var joinSegment = function (parent, child) {\n      append(parent.item, child.list);\n    };\n    var joinSegments = function (segments) {\n      for (var i = 1; i < segments.length; i++) {\n        joinSegment(segments[i - 1], segments[i]);\n      }\n    };\n    var appendSegments = function (head$1, tail) {\n      lift2(last(head$1), head(tail), joinSegment);\n    };\n    var createSegment = function (scope, listType) {\n      var segment = {\n        list: Element.fromTag(listType, scope),\n        item: Element.fromTag('li', scope)\n      };\n      append(segment.list, segment.item);\n      return segment;\n    };\n    var createSegments = function (scope, entry, size) {\n      var segments = [];\n      for (var i = 0; i < size; i++) {\n        segments.push(createSegment(scope, entry.listType));\n      }\n      return segments;\n    };\n    var populateSegments = function (segments, entry) {\n      for (var i = 0; i < segments.length - 1; i++) {\n        set(segments[i].item, 'list-style-type', 'none');\n      }\n      last(segments).each(function (segment) {\n        setAll(segment.list, entry.listAttributes);\n        setAll(segment.item, entry.itemAttributes);\n        append$1(segment.item, entry.content);\n      });\n    };\n    var normalizeSegment = function (segment, entry) {\n      if (name(segment.list) !== entry.listType) {\n        segment.list = mutate(segment.list, entry.listType);\n      }\n      setAll(segment.list, entry.listAttributes);\n    };\n    var createItem = function (scope, attr, content) {\n      var item = Element.fromTag('li', scope);\n      setAll(item, attr);\n      append$1(item, content);\n      return item;\n    };\n    var appendItem = function (segment, item) {\n      append(segment.list, item);\n      segment.item = item;\n    };\n    var writeShallow = function (scope, cast, entry) {\n      var newCast = cast.slice(0, entry.depth);\n      last(newCast).each(function (segment) {\n        var item = createItem(scope, entry.itemAttributes, entry.content);\n        appendItem(segment, item);\n        normalizeSegment(segment, entry);\n      });\n      return newCast;\n    };\n    var writeDeep = function (scope, cast, entry) {\n      var segments = createSegments(scope, entry, entry.depth - cast.length);\n      joinSegments(segments);\n      populateSegments(segments, entry);\n      appendSegments(cast, segments);\n      return cast.concat(segments);\n    };\n    var composeList = function (scope, entries) {\n      var cast = foldl(entries, function (cast, entry) {\n        return entry.depth > cast.length ? writeDeep(scope, cast, entry) : writeShallow(scope, cast, entry);\n      }, []);\n      return head(cast).map(function (segment) {\n        return segment.list;\n      });\n    };\n\n    var isList$1 = function (el) {\n      return is$1(el, 'OL,UL');\n    };\n    var hasFirstChildList = function (el) {\n      return firstChild(el).map(isList$1).getOr(false);\n    };\n    var hasLastChildList = function (el) {\n      return lastChild(el).map(isList$1).getOr(false);\n    };\n\n    var isIndented = function (entry) {\n      return entry.depth > 0;\n    };\n    var isSelected = function (entry) {\n      return entry.isSelected;\n    };\n    var cloneItemContent = function (li) {\n      var children$1 = children(li);\n      var content = hasLastChildList(li) ? children$1.slice(0, -1) : children$1;\n      return map(content, deep);\n    };\n    var createEntry = function (li, depth, isSelected) {\n      return parent(li).filter(isElement).map(function (list) {\n        return {\n          depth: depth,\n          isSelected: isSelected,\n          content: cloneItemContent(li),\n          itemAttributes: clone(li),\n          listAttributes: clone(list),\n          listType: name(list)\n        };\n      });\n    };\n\n    var indentEntry = function (indentation, entry) {\n      switch (indentation) {\n      case 'Indent':\n        entry.depth++;\n        break;\n      case 'Outdent':\n        entry.depth--;\n        break;\n      case 'Flatten':\n        entry.depth = 0;\n      }\n    };\n\n    var hasOwnProperty = Object.prototype.hasOwnProperty;\n    var shallow = function (old, nu) {\n      return nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n        for (var i = 0; i < objects.length; i++) {\n          objects[i] = arguments[i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (hasOwnProperty.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var merge = baseMerge(shallow);\n\n    var cloneListProperties = function (target, source) {\n      target.listType = source.listType;\n      target.listAttributes = merge({}, source.listAttributes);\n    };\n    var previousSiblingEntry = function (entries, start) {\n      var depth = entries[start].depth;\n      for (var i = start - 1; i >= 0; i--) {\n        if (entries[i].depth === depth) {\n          return Option.some(entries[i]);\n        }\n        if (entries[i].depth < depth) {\n          break;\n        }\n      }\n      return Option.none();\n    };\n    var normalizeEntries = function (entries) {\n      each(entries, function (entry, i) {\n        previousSiblingEntry(entries, i).each(function (matchingEntry) {\n          cloneListProperties(entry, matchingEntry);\n        });\n      });\n    };\n\n    var parseItem = function (depth, itemSelection, selectionState, item) {\n      return firstChild(item).filter(isList$1).fold(function () {\n        itemSelection.each(function (selection) {\n          if (eq(selection.start, item)) {\n            selectionState.set(true);\n          }\n        });\n        var currentItemEntry = createEntry(item, depth, selectionState.get());\n        itemSelection.each(function (selection) {\n          if (eq(selection.end, item)) {\n            selectionState.set(false);\n          }\n        });\n        var childListEntries = lastChild(item).filter(isList$1).map(function (list) {\n          return parseList(depth, itemSelection, selectionState, list);\n        }).getOr([]);\n        return currentItemEntry.toArray().concat(childListEntries);\n      }, function (list) {\n        return parseList(depth, itemSelection, selectionState, list);\n      });\n    };\n    var parseList = function (depth, itemSelection, selectionState, list) {\n      return bind(children(list), function (element) {\n        var parser = isList$1(element) ? parseList : parseItem;\n        var newDepth = depth + 1;\n        return parser(newDepth, itemSelection, selectionState, element);\n      });\n    };\n    var parseLists = function (lists, itemSelection) {\n      var selectionState = Cell(false);\n      var initialDepth = 0;\n      return map(lists, function (list) {\n        return {\n          sourceList: list,\n          entries: parseList(initialDepth, itemSelection, selectionState, list)\n        };\n      });\n    };\n\n    var outdentedComposer = function (editor, entries) {\n      return map(entries, function (entry) {\n        var content = fromElements(entry.content);\n        return Element.fromDom(createTextBlock(editor, content.dom()));\n      });\n    };\n    var indentedComposer = function (editor, entries) {\n      normalizeEntries(entries);\n      return composeList(editor.contentDocument, entries).toArray();\n    };\n    var composeEntries = function (editor, entries) {\n      return bind(groupBy(entries, isIndented), function (entries) {\n        var groupIsIndented = head(entries).map(isIndented).getOr(false);\n        return groupIsIndented ? indentedComposer(editor, entries) : outdentedComposer(editor, entries);\n      });\n    };\n    var indentSelectedEntries = function (entries, indentation) {\n      each(filter(entries, isSelected), function (entry) {\n        return indentEntry(indentation, entry);\n      });\n    };\n    var getItemSelection = function (editor) {\n      var selectedListItems = map(Selection.getSelectedListItems(editor), Element.fromDom);\n      return lift2(find(selectedListItems, not(hasFirstChildList)), find(reverse(selectedListItems), not(hasFirstChildList)), function (start, end) {\n        return {\n          start: start,\n          end: end\n        };\n      });\n    };\n    var listIndentation = function (editor, lists, indentation) {\n      var entrySets = parseLists(lists, getItemSelection(editor));\n      each(entrySets, function (entrySet) {\n        indentSelectedEntries(entrySet.entries, indentation);\n        var composedLists = composeEntries(editor, entrySet.entries);\n        each(composedLists, function (composedList) {\n          fireListEvent(editor, indentation === 'Indent' ? 'IndentList' : 'OutdentList', composedList.dom());\n        });\n        before$1(entrySet.sourceList, composedLists);\n        remove(entrySet.sourceList);\n      });\n    };\n\n    var global$6 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n    var DOM = global$6.DOM;\n    var splitList = function (editor, ul, li) {\n      var tmpRng, fragment, bookmarks, node, newBlock;\n      var removeAndKeepBookmarks = function (targetNode) {\n        global$5.each(bookmarks, function (node) {\n          targetNode.parentNode.insertBefore(node, li.parentNode);\n        });\n        DOM.remove(targetNode);\n      };\n      bookmarks = DOM.select('span[data-mce-type=\"bookmark\"]', ul);\n      newBlock = createTextBlock(editor, li);\n      tmpRng = DOM.createRng();\n      tmpRng.setStartAfter(li);\n      tmpRng.setEndAfter(ul);\n      fragment = tmpRng.extractContents();\n      for (node = fragment.firstChild; node; node = node.firstChild) {\n        if (node.nodeName === 'LI' && editor.dom.isEmpty(node)) {\n          DOM.remove(node);\n          break;\n        }\n      }\n      if (!editor.dom.isEmpty(fragment)) {\n        DOM.insertAfter(fragment, ul);\n      }\n      DOM.insertAfter(newBlock, ul);\n      if (NodeType.isEmpty(editor.dom, li.parentNode)) {\n        removeAndKeepBookmarks(li.parentNode);\n      }\n      DOM.remove(li);\n      if (NodeType.isEmpty(editor.dom, ul)) {\n        DOM.remove(ul);\n      }\n    };\n    var SplitList = { splitList: splitList };\n\n    var outdentDlItem = function (editor, item) {\n      if (is$1(item, 'dd')) {\n        mutate(item, 'dt');\n      } else if (is$1(item, 'dt')) {\n        parent(item).each(function (dl) {\n          return SplitList.splitList(editor, dl.dom(), item.dom());\n        });\n      }\n    };\n    var indentDlItem = function (item) {\n      if (is$1(item, 'dt')) {\n        mutate(item, 'dd');\n      }\n    };\n    var dlIndentation = function (editor, indentation, dlItems) {\n      if (indentation === 'Indent') {\n        each(dlItems, indentDlItem);\n      } else {\n        each(dlItems, function (item) {\n          return outdentDlItem(editor, item);\n        });\n      }\n    };\n\n    var getNormalizedPoint = function (container, offset) {\n      if (NodeType.isTextNode(container)) {\n        return {\n          container: container,\n          offset: offset\n        };\n      }\n      var node = global$1.getNode(container, offset);\n      if (NodeType.isTextNode(node)) {\n        return {\n          container: node,\n          offset: offset >= container.childNodes.length ? node.data.length : 0\n        };\n      } else if (node.previousSibling && NodeType.isTextNode(node.previousSibling)) {\n        return {\n          container: node.previousSibling,\n          offset: node.previousSibling.data.length\n        };\n      } else if (node.nextSibling && NodeType.isTextNode(node.nextSibling)) {\n        return {\n          container: node.nextSibling,\n          offset: 0\n        };\n      }\n      return {\n        container: container,\n        offset: offset\n      };\n    };\n    var normalizeRange = function (rng) {\n      var outRng = rng.cloneRange();\n      var rangeStart = getNormalizedPoint(rng.startContainer, rng.startOffset);\n      outRng.setStart(rangeStart.container, rangeStart.offset);\n      var rangeEnd = getNormalizedPoint(rng.endContainer, rng.endOffset);\n      outRng.setEnd(rangeEnd.container, rangeEnd.offset);\n      return outRng;\n    };\n    var Range = {\n      getNormalizedPoint: getNormalizedPoint,\n      normalizeRange: normalizeRange\n    };\n\n    var selectionIndentation = function (editor, indentation) {\n      var lists = map(Selection.getSelectedListRoots(editor), Element.fromDom);\n      var dlItems = map(Selection.getSelectedDlItems(editor), Element.fromDom);\n      var isHandled = false;\n      if (lists.length || dlItems.length) {\n        var bookmark = editor.selection.getBookmark();\n        listIndentation(editor, lists, indentation);\n        dlIndentation(editor, indentation, dlItems);\n        editor.selection.moveToBookmark(bookmark);\n        editor.selection.setRng(Range.normalizeRange(editor.selection.getRng()));\n        editor.nodeChanged();\n        isHandled = true;\n      }\n      return isHandled;\n    };\n    var indentListSelection = function (editor) {\n      return selectionIndentation(editor, 'Indent');\n    };\n    var outdentListSelection = function (editor) {\n      return selectionIndentation(editor, 'Outdent');\n    };\n    var flattenListSelection = function (editor) {\n      return selectionIndentation(editor, 'Flatten');\n    };\n\n    var global$7 = tinymce.util.Tools.resolve('tinymce.dom.BookmarkManager');\n\n    var DOM$1 = global$6.DOM;\n    var createBookmark = function (rng) {\n      var bookmark = {};\n      var setupEndPoint = function (start) {\n        var offsetNode, container, offset;\n        container = rng[start ? 'startContainer' : 'endContainer'];\n        offset = rng[start ? 'startOffset' : 'endOffset'];\n        if (container.nodeType === 1) {\n          offsetNode = DOM$1.create('span', { 'data-mce-type': 'bookmark' });\n          if (container.hasChildNodes()) {\n            offset = Math.min(offset, container.childNodes.length - 1);\n            if (start) {\n              container.insertBefore(offsetNode, container.childNodes[offset]);\n            } else {\n              DOM$1.insertAfter(offsetNode, container.childNodes[offset]);\n            }\n          } else {\n            container.appendChild(offsetNode);\n          }\n          container = offsetNode;\n          offset = 0;\n        }\n        bookmark[start ? 'startContainer' : 'endContainer'] = container;\n        bookmark[start ? 'startOffset' : 'endOffset'] = offset;\n      };\n      setupEndPoint(true);\n      if (!rng.collapsed) {\n        setupEndPoint();\n      }\n      return bookmark;\n    };\n    var resolveBookmark = function (bookmark) {\n      function restoreEndPoint(start) {\n        var container, offset, node;\n        var nodeIndex = function (container) {\n          var node = container.parentNode.firstChild, idx = 0;\n          while (node) {\n            if (node === container) {\n              return idx;\n            }\n            if (node.nodeType !== 1 || node.getAttribute('data-mce-type') !== 'bookmark') {\n              idx++;\n            }\n            node = node.nextSibling;\n          }\n          return -1;\n        };\n        container = node = bookmark[start ? 'startContainer' : 'endContainer'];\n        offset = bookmark[start ? 'startOffset' : 'endOffset'];\n        if (!container) {\n          return;\n        }\n        if (container.nodeType === 1) {\n          offset = nodeIndex(container);\n          container = container.parentNode;\n          DOM$1.remove(node);\n          if (!container.hasChildNodes() && DOM$1.isBlock(container)) {\n            container.appendChild(DOM$1.create('br'));\n          }\n        }\n        bookmark[start ? 'startContainer' : 'endContainer'] = container;\n        bookmark[start ? 'startOffset' : 'endOffset'] = offset;\n      }\n      restoreEndPoint(true);\n      restoreEndPoint();\n      var rng = DOM$1.createRng();\n      rng.setStart(bookmark.startContainer, bookmark.startOffset);\n      if (bookmark.endContainer) {\n        rng.setEnd(bookmark.endContainer, bookmark.endOffset);\n      }\n      return Range.normalizeRange(rng);\n    };\n    var Bookmark = {\n      createBookmark: createBookmark,\n      resolveBookmark: resolveBookmark\n    };\n\n    var isCustomList = function (list) {\n      return /\\btox\\-/.test(list.className);\n    };\n\n    var listToggleActionFromListName = function (listName) {\n      switch (listName) {\n      case 'UL':\n        return 'ToggleUlList';\n      case 'OL':\n        return 'ToggleOlList';\n      case 'DL':\n        return 'ToggleDLList';\n      }\n    };\n\n    var updateListStyle = function (dom, el, detail) {\n      var type = detail['list-style-type'] ? detail['list-style-type'] : null;\n      dom.setStyle(el, 'list-style-type', type);\n    };\n    var setAttribs = function (elm, attrs) {\n      global$5.each(attrs, function (value, key) {\n        elm.setAttribute(key, value);\n      });\n    };\n    var updateListAttrs = function (dom, el, detail) {\n      setAttribs(el, detail['list-attributes']);\n      global$5.each(dom.select('li', el), function (li) {\n        setAttribs(li, detail['list-item-attributes']);\n      });\n    };\n    var updateListWithDetails = function (dom, el, detail) {\n      updateListStyle(dom, el, detail);\n      updateListAttrs(dom, el, detail);\n    };\n    var removeStyles = function (dom, element, styles) {\n      global$5.each(styles, function (style) {\n        var _a;\n        return dom.setStyle(element, (_a = {}, _a[style] = '', _a));\n      });\n    };\n    var getEndPointNode = function (editor, rng, start, root) {\n      var container, offset;\n      container = rng[start ? 'startContainer' : 'endContainer'];\n      offset = rng[start ? 'startOffset' : 'endOffset'];\n      if (container.nodeType === 1) {\n        container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n      }\n      if (!start && NodeType.isBr(container.nextSibling)) {\n        container = container.nextSibling;\n      }\n      while (container.parentNode !== root) {\n        if (NodeType.isTextBlock(editor, container)) {\n          return container;\n        }\n        if (/^(TD|TH)$/.test(container.parentNode.nodeName)) {\n          return container;\n        }\n        container = container.parentNode;\n      }\n      return container;\n    };\n    var getSelectedTextBlocks = function (editor, rng, root) {\n      var textBlocks = [], dom = editor.dom;\n      var startNode = getEndPointNode(editor, rng, true, root);\n      var endNode = getEndPointNode(editor, rng, false, root);\n      var block;\n      var siblings = [];\n      for (var node = startNode; node; node = node.nextSibling) {\n        siblings.push(node);\n        if (node === endNode) {\n          break;\n        }\n      }\n      global$5.each(siblings, function (node) {\n        if (NodeType.isTextBlock(editor, node)) {\n          textBlocks.push(node);\n          block = null;\n          return;\n        }\n        if (dom.isBlock(node) || NodeType.isBr(node)) {\n          if (NodeType.isBr(node)) {\n            dom.remove(node);\n          }\n          block = null;\n          return;\n        }\n        var nextSibling = node.nextSibling;\n        if (global$7.isBookmarkNode(node)) {\n          if (NodeType.isTextBlock(editor, nextSibling) || !nextSibling && node.parentNode === root) {\n            block = null;\n            return;\n          }\n        }\n        if (!block) {\n          block = dom.create('p');\n          node.parentNode.insertBefore(block, node);\n          textBlocks.push(block);\n        }\n        block.appendChild(node);\n      });\n      return textBlocks;\n    };\n    var hasCompatibleStyle = function (dom, sib, detail) {\n      var sibStyle = dom.getStyle(sib, 'list-style-type');\n      var detailStyle = detail ? detail['list-style-type'] : '';\n      detailStyle = detailStyle === null ? '' : detailStyle;\n      return sibStyle === detailStyle;\n    };\n    var applyList = function (editor, listName, detail) {\n      if (detail === void 0) {\n        detail = {};\n      }\n      var rng = editor.selection.getRng(true);\n      var bookmark;\n      var listItemName = 'LI';\n      var root = Selection.getClosestListRootElm(editor, editor.selection.getStart(true));\n      var dom = editor.dom;\n      if (dom.getContentEditable(editor.selection.getNode()) === 'false') {\n        return;\n      }\n      listName = listName.toUpperCase();\n      if (listName === 'DL') {\n        listItemName = 'DT';\n      }\n      bookmark = Bookmark.createBookmark(rng);\n      global$5.each(getSelectedTextBlocks(editor, rng, root), function (block) {\n        var listBlock, sibling;\n        sibling = block.previousSibling;\n        if (sibling && NodeType.isListNode(sibling) && sibling.nodeName === listName && hasCompatibleStyle(dom, sibling, detail)) {\n          listBlock = sibling;\n          block = dom.rename(block, listItemName);\n          sibling.appendChild(block);\n        } else {\n          listBlock = dom.create(listName);\n          block.parentNode.insertBefore(listBlock, block);\n          listBlock.appendChild(block);\n          block = dom.rename(block, listItemName);\n        }\n        removeStyles(dom, block, [\n          'margin',\n          'margin-right',\n          'margin-bottom',\n          'margin-left',\n          'margin-top',\n          'padding',\n          'padding-right',\n          'padding-bottom',\n          'padding-left',\n          'padding-top'\n        ]);\n        updateListWithDetails(dom, listBlock, detail);\n        mergeWithAdjacentLists(editor.dom, listBlock);\n      });\n      editor.selection.setRng(Bookmark.resolveBookmark(bookmark));\n    };\n    var isValidLists = function (list1, list2) {\n      return list1 && list2 && NodeType.isListNode(list1) && list1.nodeName === list2.nodeName;\n    };\n    var hasSameListStyle = function (dom, list1, list2) {\n      var targetStyle = dom.getStyle(list1, 'list-style-type', true);\n      var style = dom.getStyle(list2, 'list-style-type', true);\n      return targetStyle === style;\n    };\n    var hasSameClasses = function (elm1, elm2) {\n      return elm1.className === elm2.className;\n    };\n    var shouldMerge = function (dom, list1, list2) {\n      return isValidLists(list1, list2) && hasSameListStyle(dom, list1, list2) && hasSameClasses(list1, list2);\n    };\n    var mergeWithAdjacentLists = function (dom, listBlock) {\n      var sibling, node;\n      sibling = listBlock.nextSibling;\n      if (shouldMerge(dom, listBlock, sibling)) {\n        while (node = sibling.firstChild) {\n          listBlock.appendChild(node);\n        }\n        dom.remove(sibling);\n      }\n      sibling = listBlock.previousSibling;\n      if (shouldMerge(dom, listBlock, sibling)) {\n        while (node = sibling.lastChild) {\n          listBlock.insertBefore(node, listBlock.firstChild);\n        }\n        dom.remove(sibling);\n      }\n    };\n    var updateList = function (editor, list, listName, detail) {\n      if (list.nodeName !== listName) {\n        var newList = editor.dom.rename(list, listName);\n        updateListWithDetails(editor.dom, newList, detail);\n        fireListEvent(editor, listToggleActionFromListName(listName), newList);\n      } else {\n        updateListWithDetails(editor.dom, list, detail);\n        fireListEvent(editor, listToggleActionFromListName(listName), list);\n      }\n    };\n    var toggleMultipleLists = function (editor, parentList, lists, listName, detail) {\n      if (parentList.nodeName === listName && !hasListStyleDetail(detail)) {\n        flattenListSelection(editor);\n      } else {\n        var bookmark = Bookmark.createBookmark(editor.selection.getRng(true));\n        global$5.each([parentList].concat(lists), function (elm) {\n          updateList(editor, elm, listName, detail);\n        });\n        editor.selection.setRng(Bookmark.resolveBookmark(bookmark));\n      }\n    };\n    var hasListStyleDetail = function (detail) {\n      return 'list-style-type' in detail;\n    };\n    var toggleSingleList = function (editor, parentList, listName, detail) {\n      if (parentList === editor.getBody()) {\n        return;\n      }\n      if (parentList) {\n        if (parentList.nodeName === listName && !hasListStyleDetail(detail) && !isCustomList(parentList)) {\n          flattenListSelection(editor);\n        } else {\n          var bookmark = Bookmark.createBookmark(editor.selection.getRng(true));\n          updateListWithDetails(editor.dom, parentList, detail);\n          var newList = editor.dom.rename(parentList, listName);\n          mergeWithAdjacentLists(editor.dom, newList);\n          editor.selection.setRng(Bookmark.resolveBookmark(bookmark));\n          fireListEvent(editor, listToggleActionFromListName(listName), newList);\n        }\n      } else {\n        applyList(editor, listName, detail);\n        fireListEvent(editor, listToggleActionFromListName(listName), parentList);\n      }\n    };\n    var toggleList = function (editor, listName, detail) {\n      var parentList = Selection.getParentList(editor);\n      var selectedSubLists = Selection.getSelectedSubLists(editor);\n      detail = detail ? detail : {};\n      if (parentList && selectedSubLists.length > 0) {\n        toggleMultipleLists(editor, parentList, selectedSubLists, listName, detail);\n      } else {\n        toggleSingleList(editor, parentList, listName, detail);\n      }\n    };\n    var ToggleList = {\n      toggleList: toggleList,\n      mergeWithAdjacentLists: mergeWithAdjacentLists\n    };\n\n    var DOM$2 = global$6.DOM;\n    var normalizeList = function (dom, ul) {\n      var sibling;\n      var parentNode = ul.parentNode;\n      if (parentNode.nodeName === 'LI' && parentNode.firstChild === ul) {\n        sibling = parentNode.previousSibling;\n        if (sibling && sibling.nodeName === 'LI') {\n          sibling.appendChild(ul);\n          if (NodeType.isEmpty(dom, parentNode)) {\n            DOM$2.remove(parentNode);\n          }\n        } else {\n          DOM$2.setStyle(parentNode, 'listStyleType', 'none');\n        }\n      }\n      if (NodeType.isListNode(parentNode)) {\n        sibling = parentNode.previousSibling;\n        if (sibling && sibling.nodeName === 'LI') {\n          sibling.appendChild(ul);\n        }\n      }\n    };\n    var normalizeLists = function (dom, element) {\n      global$5.each(global$5.grep(dom.select('ol,ul', element)), function (ul) {\n        normalizeList(dom, ul);\n      });\n    };\n    var NormalizeLists = {\n      normalizeList: normalizeList,\n      normalizeLists: normalizeLists\n    };\n\n    var findNextCaretContainer = function (editor, rng, isForward, root) {\n      var node = rng.startContainer;\n      var offset = rng.startOffset;\n      if (NodeType.isTextNode(node) && (isForward ? offset < node.data.length : offset > 0)) {\n        return node;\n      }\n      var nonEmptyBlocks = editor.schema.getNonEmptyElements();\n      if (node.nodeType === 1) {\n        node = global$1.getNode(node, offset);\n      }\n      var walker = new global$2(node, root);\n      if (isForward) {\n        if (NodeType.isBogusBr(editor.dom, node)) {\n          walker.next();\n        }\n      }\n      while (node = walker[isForward ? 'next' : 'prev2']()) {\n        if (node.nodeName === 'LI' && !node.hasChildNodes()) {\n          return node;\n        }\n        if (nonEmptyBlocks[node.nodeName]) {\n          return node;\n        }\n        if (NodeType.isTextNode(node) && node.data.length > 0) {\n          return node;\n        }\n      }\n    };\n    var hasOnlyOneBlockChild = function (dom, elm) {\n      var childNodes = elm.childNodes;\n      return childNodes.length === 1 && !NodeType.isListNode(childNodes[0]) && dom.isBlock(childNodes[0]);\n    };\n    var unwrapSingleBlockChild = function (dom, elm) {\n      if (hasOnlyOneBlockChild(dom, elm)) {\n        dom.remove(elm.firstChild, true);\n      }\n    };\n    var moveChildren = function (dom, fromElm, toElm) {\n      var node, targetElm;\n      targetElm = hasOnlyOneBlockChild(dom, toElm) ? toElm.firstChild : toElm;\n      unwrapSingleBlockChild(dom, fromElm);\n      if (!NodeType.isEmpty(dom, fromElm, true)) {\n        while (node = fromElm.firstChild) {\n          targetElm.appendChild(node);\n        }\n      }\n    };\n    var mergeLiElements = function (dom, fromElm, toElm) {\n      var node, listNode;\n      var ul = fromElm.parentNode;\n      if (!NodeType.isChildOfBody(dom, fromElm) || !NodeType.isChildOfBody(dom, toElm)) {\n        return;\n      }\n      if (NodeType.isListNode(toElm.lastChild)) {\n        listNode = toElm.lastChild;\n      }\n      if (ul === toElm.lastChild) {\n        if (NodeType.isBr(ul.previousSibling)) {\n          dom.remove(ul.previousSibling);\n        }\n      }\n      node = toElm.lastChild;\n      if (node && NodeType.isBr(node) && fromElm.hasChildNodes()) {\n        dom.remove(node);\n      }\n      if (NodeType.isEmpty(dom, toElm, true)) {\n        dom.$(toElm).empty();\n      }\n      moveChildren(dom, fromElm, toElm);\n      if (listNode) {\n        toElm.appendChild(listNode);\n      }\n      var contains = contains$1(Element.fromDom(toElm), Element.fromDom(fromElm));\n      var nestedLists = contains ? dom.getParents(fromElm, NodeType.isListNode, toElm) : [];\n      dom.remove(fromElm);\n      each(nestedLists, function (list) {\n        if (NodeType.isEmpty(dom, list) && list !== dom.getRoot()) {\n          dom.remove(list);\n        }\n      });\n    };\n    var mergeIntoEmptyLi = function (editor, fromLi, toLi) {\n      editor.dom.$(toLi).empty();\n      mergeLiElements(editor.dom, fromLi, toLi);\n      editor.selection.setCursorLocation(toLi);\n    };\n    var mergeForward = function (editor, rng, fromLi, toLi) {\n      var dom = editor.dom;\n      if (dom.isEmpty(toLi)) {\n        mergeIntoEmptyLi(editor, fromLi, toLi);\n      } else {\n        var bookmark = Bookmark.createBookmark(rng);\n        mergeLiElements(dom, fromLi, toLi);\n        editor.selection.setRng(Bookmark.resolveBookmark(bookmark));\n      }\n    };\n    var mergeBackward = function (editor, rng, fromLi, toLi) {\n      var bookmark = Bookmark.createBookmark(rng);\n      mergeLiElements(editor.dom, fromLi, toLi);\n      var resolvedBookmark = Bookmark.resolveBookmark(bookmark);\n      editor.selection.setRng(resolvedBookmark);\n    };\n    var backspaceDeleteFromListToListCaret = function (editor, isForward) {\n      var dom = editor.dom, selection = editor.selection;\n      var selectionStartElm = selection.getStart();\n      var root = Selection.getClosestListRootElm(editor, selectionStartElm);\n      var li = dom.getParent(selection.getStart(), 'LI', root);\n      if (li) {\n        var ul = li.parentNode;\n        if (ul === editor.getBody() && NodeType.isEmpty(dom, ul)) {\n          return true;\n        }\n        var rng_1 = Range.normalizeRange(selection.getRng());\n        var otherLi_1 = dom.getParent(findNextCaretContainer(editor, rng_1, isForward, root), 'LI', root);\n        if (otherLi_1 && otherLi_1 !== li) {\n          editor.undoManager.transact(function () {\n            if (isForward) {\n              mergeForward(editor, rng_1, otherLi_1, li);\n            } else {\n              if (NodeType.isFirstChild(li)) {\n                outdentListSelection(editor);\n              } else {\n                mergeBackward(editor, rng_1, li, otherLi_1);\n              }\n            }\n          });\n          return true;\n        } else if (!otherLi_1) {\n          if (!isForward && rng_1.startOffset === 0 && rng_1.endOffset === 0) {\n            editor.undoManager.transact(function () {\n              flattenListSelection(editor);\n            });\n            return true;\n          }\n        }\n      }\n      return false;\n    };\n    var removeBlock = function (dom, block, root) {\n      var parentBlock = dom.getParent(block.parentNode, dom.isBlock, root);\n      dom.remove(block);\n      if (parentBlock && dom.isEmpty(parentBlock)) {\n        dom.remove(parentBlock);\n      }\n    };\n    var backspaceDeleteIntoListCaret = function (editor, isForward) {\n      var dom = editor.dom;\n      var selectionStartElm = editor.selection.getStart();\n      var root = Selection.getClosestListRootElm(editor, selectionStartElm);\n      var block = dom.getParent(selectionStartElm, dom.isBlock, root);\n      if (block && dom.isEmpty(block)) {\n        var rng = Range.normalizeRange(editor.selection.getRng());\n        var otherLi_2 = dom.getParent(findNextCaretContainer(editor, rng, isForward, root), 'LI', root);\n        if (otherLi_2) {\n          editor.undoManager.transact(function () {\n            removeBlock(dom, block, root);\n            ToggleList.mergeWithAdjacentLists(dom, otherLi_2.parentNode);\n            editor.selection.select(otherLi_2, true);\n            editor.selection.collapse(isForward);\n          });\n          return true;\n        }\n      }\n      return false;\n    };\n    var backspaceDeleteCaret = function (editor, isForward) {\n      return backspaceDeleteFromListToListCaret(editor, isForward) || backspaceDeleteIntoListCaret(editor, isForward);\n    };\n    var backspaceDeleteRange = function (editor) {\n      var selectionStartElm = editor.selection.getStart();\n      var root = Selection.getClosestListRootElm(editor, selectionStartElm);\n      var startListParent = editor.dom.getParent(selectionStartElm, 'LI,DT,DD', root);\n      if (startListParent || Selection.getSelectedListItems(editor).length > 0) {\n        editor.undoManager.transact(function () {\n          editor.execCommand('Delete');\n          NormalizeLists.normalizeLists(editor.dom, editor.getBody());\n        });\n        return true;\n      }\n      return false;\n    };\n    var backspaceDelete = function (editor, isForward) {\n      return editor.selection.isCollapsed() ? backspaceDeleteCaret(editor, isForward) : backspaceDeleteRange(editor);\n    };\n    var setup = function (editor) {\n      editor.on('keydown', function (e) {\n        if (e.keyCode === global$3.BACKSPACE) {\n          if (backspaceDelete(editor, false)) {\n            e.preventDefault();\n          }\n        } else if (e.keyCode === global$3.DELETE) {\n          if (backspaceDelete(editor, true)) {\n            e.preventDefault();\n          }\n        }\n      });\n    };\n    var Delete = {\n      setup: setup,\n      backspaceDelete: backspaceDelete\n    };\n\n    var get = function (editor) {\n      return {\n        backspaceDelete: function (isForward) {\n          Delete.backspaceDelete(editor, isForward);\n        }\n      };\n    };\n    var Api = { get: get };\n\n    var queryListCommandState = function (editor, listName) {\n      return function () {\n        var parentList = editor.dom.getParent(editor.selection.getStart(), 'UL,OL,DL');\n        return parentList && parentList.nodeName === listName;\n      };\n    };\n    var register = function (editor) {\n      editor.on('BeforeExecCommand', function (e) {\n        var cmd = e.command.toLowerCase();\n        if (cmd === 'indent') {\n          indentListSelection(editor);\n        } else if (cmd === 'outdent') {\n          outdentListSelection(editor);\n        }\n      });\n      editor.addCommand('InsertUnorderedList', function (ui, detail) {\n        ToggleList.toggleList(editor, 'UL', detail);\n      });\n      editor.addCommand('InsertOrderedList', function (ui, detail) {\n        ToggleList.toggleList(editor, 'OL', detail);\n      });\n      editor.addCommand('InsertDefinitionList', function (ui, detail) {\n        ToggleList.toggleList(editor, 'DL', detail);\n      });\n      editor.addCommand('RemoveList', function () {\n        flattenListSelection(editor);\n      });\n      editor.addQueryStateHandler('InsertUnorderedList', queryListCommandState(editor, 'UL'));\n      editor.addQueryStateHandler('InsertOrderedList', queryListCommandState(editor, 'OL'));\n      editor.addQueryStateHandler('InsertDefinitionList', queryListCommandState(editor, 'DL'));\n    };\n    var Commands = { register: register };\n\n    var shouldIndentOnTab = function (editor) {\n      return editor.getParam('lists_indent_on_tab', true);\n    };\n    var Settings = { shouldIndentOnTab: shouldIndentOnTab };\n\n    var setupTabKey = function (editor) {\n      editor.on('keydown', function (e) {\n        if (e.keyCode !== global$3.TAB || global$3.metaKeyPressed(e)) {\n          return;\n        }\n        editor.undoManager.transact(function () {\n          if (e.shiftKey ? outdentListSelection(editor) : indentListSelection(editor)) {\n            e.preventDefault();\n          }\n        });\n      });\n    };\n    var setup$1 = function (editor) {\n      if (Settings.shouldIndentOnTab(editor)) {\n        setupTabKey(editor);\n      }\n      Delete.setup(editor);\n    };\n    var Keyboard = { setup: setup$1 };\n\n    var findIndex = function (list, predicate) {\n      for (var index = 0; index < list.length; index++) {\n        var element = list[index];\n        if (predicate(element)) {\n          return index;\n        }\n      }\n      return -1;\n    };\n    var listState = function (editor, listName) {\n      return function (buttonApi) {\n        var nodeChangeHandler = function (e) {\n          var tableCellIndex = findIndex(e.parents, NodeType.isTableCellNode);\n          var parents = tableCellIndex !== -1 ? e.parents.slice(0, tableCellIndex) : e.parents;\n          var lists = global$5.grep(parents, NodeType.isListNode);\n          buttonApi.setActive(lists.length > 0 && lists[0].nodeName === listName && !isCustomList(lists[0]));\n        };\n        editor.on('NodeChange', nodeChangeHandler);\n        return function () {\n          return editor.off('NodeChange', nodeChangeHandler);\n        };\n      };\n    };\n    var register$1 = function (editor) {\n      var hasPlugin = function (editor, plugin) {\n        var plugins = editor.settings.plugins ? editor.settings.plugins : '';\n        return global$5.inArray(plugins.split(/[ ,]/), plugin) !== -1;\n      };\n      var exec = function (command) {\n        return function () {\n          return editor.execCommand(command);\n        };\n      };\n      if (!hasPlugin(editor, 'advlist')) {\n        editor.ui.registry.addToggleButton('numlist', {\n          icon: 'ordered-list',\n          active: false,\n          tooltip: 'Numbered list',\n          onAction: exec('InsertOrderedList'),\n          onSetup: listState(editor, 'OL')\n        });\n        editor.ui.registry.addToggleButton('bullist', {\n          icon: 'unordered-list',\n          active: false,\n          tooltip: 'Bullet list',\n          onAction: exec('InsertUnorderedList'),\n          onSetup: listState(editor, 'UL')\n        });\n      }\n    };\n    var Buttons = { register: register$1 };\n\n    function Plugin () {\n      global.add('lists', function (editor) {\n        Keyboard.setup(editor);\n        Buttons.register(editor);\n        Commands.register(editor);\n        return Api.get(editor);\n      });\n    }\n\n    Plugin();\n\n}(window));\n"]}