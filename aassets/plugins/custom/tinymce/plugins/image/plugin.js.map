{"version":3,"sources":["image/plugin.js"],"names":["domGlobals","eq","call","id","me","global$1","tinymce","util","Tools","resolve","noop","constant","value","identity","x","never","always","none","NONE","o","isNone","fold","n","s","is","isSome","getOr","getOrThunk","thunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","Object","freeze","some","a","constant_a","self","f","v","elementEq","b","Option","from","isType","type","t","Array","prototype","isPrototypeOf","constructor","name","String","typeOf","isString","isObject","isArray","isBoolean","isFunction","nativeSlice","slice","nativePush","push","flatten","xs","r","i","len","length","apply","__assign","assign","arguments","p","hasOwnProperty","this","exports$1","module","exports","define","require","amd","window","global","EphoxContactWrapper","e","c","u","code","1","cachedSetTimeout","cachedClearTimeout","process","defaultSetTimout","defaultClearTimeout","runTimeout","fun","setTimeout","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","concat","drainQueue","timeout","run","marker","runClearTimeout","Item","array","nextTick","args","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","2","setImmediate","root","setTimeoutFunc","Promise","fn","TypeError","_state","_handled","_value","_deferreds","doResolve","handle","deferred","_immediateFn","cb","onFulfilled","onRejected","ret","reject","promise","newValue","then","finale","thisArg","_unhandledRejectionFn","Handler","done","reason","ex","prom","all","arr","remaining","res","val","race","values","err","console","warn","_setImmediateFn","_setUnhandledRejectionFn","timers","3","clearImmediate","Function","immediateIds","nextImmediateId","Timeout","clearFn","_id","_clearFn","setInterval","clearInterval","close","unref","ref","enroll","item","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","process/browser.js","4","promisePolyfill","Global","boltExport","promise-polyfill","nu","baseFn","data","callbacks","get","nCallback","isReady","cbs","LazyValue","pure","callback","errorReporter","make","fab","aFutureB","toPromise","anonBind","futureB","toLazy","toCached","cache","Future","isValue","isError","opt","_","onValue","mapError","toOption","error","message","onError","Result","fromOption","wrap","delegate","bindFuture","resA","bindResult","mapResult","foldResult","whenError","whenValue","withTimeout","errorThunk","timedOut","timer","result","nu$2","worker","FutureResult","baseMerge","merger","objects","j","curObject","key","deepMerge","old","merge","makeItems","info","imageList","items","label","classList","filetype","hasDescription","hasImageTitle","hasDimensions","columns","hasImageCaption","MainTab","global$2","global$3","global$4","getUploadUrl","editor","getParam","getUploadHandler","Settings","hasUploadTab","hasAdvTab","getPrependUrl","getClassList","getImageList","hasUploadUrl","hasUploadHandler","getUploadBasePath","getUploadCredentials","parseIntAndGetMax","val1","val2","Math","max","parseInt","Utils","url","img","document","createElement","dimensions","parentNode","removeChild","onload","width","clientWidth","height","clientHeight","onerror","style","visibility","position","bottom","left","body","appendChild","src","replace","test","css","margin","splitMargin","split","send","success","text","JSON","parse","imgElm","selectImage","selection","select","nodeChanged","dom","setAttribs","blob","reader","FileReader","readAsDataURL","nodeName","hasAttribute","DOM","getHspace","image","marginLeft","marginRight","getVspace","marginTop","marginBottom","getBorder","borderWidth","getAttrib","getAttribute","getStyle","hasCaption","setAttrib","setAttribute","toggleCaption","figureElm","insertAfter","remove","removeFigure","create","class","contentEditable","wrapInFigure","normalizeStyle","normalizeCss","attrValue","removeAttribute","setSize","getSize","setHspace","pxValue","setVspace","setBorder","setBorderStyle","borderStyle","isFigure","elm","getStyleValue","hspace","vspace","border","getBorderStyle","read","alt","caption","updateProp","oldData","newData","set","normalized","write","_name","cssText","styles","mergedCss","compressed","serialize","getSelectedImage","getNode","getParent","splitTextBlock","figure","textBlock","node","schema","getTextBlockElements","getBody","insertImageAtCaret","focus","setContent","outerHTML","insertedElm","insertOrUpdateImage","syncSrcAttr","writeImageDataToSelection","isEmpty","setCursorLocation","deleteImage","global$5","getValue","sanitizeList","list","extractValue","out","menu","sanitizer","extracter","findEntryDelegate","findMap","isGroup","ListUtils","optList","pathJoin","path1","path2","Uploader","settings","defaultHandler","blobInfo","failure","progress","xhr","formData","XMLHttpRequest","open","withCredentials","credentials","upload","onprogress","loaded","total","status","json","responseText","location","basePath","FormData","append","filename","extend","handler","uploadBlob","AdvTab","inputMode","collect","urlListSanitizer","convertURL","futureImageList","completer","readImageDataFromSelection","prependURL","preUrl","UploadTab","fromImageData","meta","images","classes","borderstyle","fileinput","toImageData","addPrependUrl","api","getData","srcURL","prependUrl","substring","addPrependUrl2","setData","formFillFromMeta","entry","formFillFromMeta2","changeSrc","helpers","state","imageSize","size","calculateImageSize","prevImage","updateImagesDropdown","changeStyle2","parseStyle","serializeStyle","dataCopy","calcVSpace","calcHSpace","calcBorderWidth","calcBorderStyle","calcStyle","changeFileInput","block","unblock","file","blobUri","URL","createObjectURL","uploader","finalize","revokeObjectURL","dataUrl","createBlobCache","showTab","catch","alertErr","changeHandler","evt","prevAlt","changeImages","changeStyle","changeAStyle","closeHandler","makeDialogBody","tabs","makeDialog","createState","buttons","primary","initialData","onSubmit","onChange","onClose","submitHandler","undoManager","transact","editorUpload","uploadImagesAuto","documentBaseURI","toAbsolute","blobCache","base64","windowManager","alert","normalizeCss$1","stylesArg","Dialog","spec","Commands","register","addCommand","hasImageClass","className","attr","toggleContentEditableState","nodes","toggleContentEditable","getAll","FilterContent","setup","parser","addNodeFilter","serializer","Buttons","ui","registry","addToggleButton","icon","tooltip","onAction","onSetup","buttonApi","selectorChangedWithUnbind","setActive","unbind","addMenuItem","addContextMenu","update","element","add"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isString = isType('string');\n    var isObject = isType('object');\n    var isArray = isType('array');\n    var isBoolean = isType('boolean');\n    var isFunction = isType('function');\n\n    var nativeSlice = Array.prototype.slice;\n    var nativePush = Array.prototype.push;\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var head = function (xs) {\n      return xs.length === 0 ? Option.none() : Option.some(xs[0]);\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n\n    var exports$1 = {}, module = { exports: exports$1 };\n    (function (define, exports, module, require) {\n      (function (f) {\n        if (typeof exports === 'object' && typeof module !== 'undefined') {\n          module.exports = f();\n        } else if (typeof define === 'function' && define.amd) {\n          define([], f);\n        } else {\n          var g;\n          if (typeof window !== 'undefined') {\n            g = window;\n          } else if (typeof global !== 'undefined') {\n            g = global;\n          } else if (typeof self !== 'undefined') {\n            g = self;\n          } else {\n            g = this;\n          }\n          g.EphoxContactWrapper = f();\n        }\n      }(function () {\n        return function () {\n          function r(e, n, t) {\n            function o(i, f) {\n              if (!n[i]) {\n                if (!e[i]) {\n                  var c = 'function' == typeof require && require;\n                  if (!f && c)\n                    return c(i, !0);\n                  if (u)\n                    return u(i, !0);\n                  var a = new Error('Cannot find module \\'' + i + '\\'');\n                  throw a.code = 'MODULE_NOT_FOUND', a;\n                }\n                var p = n[i] = { exports: {} };\n                e[i][0].call(p.exports, function (r) {\n                  var n = e[i][1][r];\n                  return o(n || r);\n                }, p, p.exports, r, e, n, t);\n              }\n              return n[i].exports;\n            }\n            for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++)\n              o(t[i]);\n            return o;\n          }\n          return r;\n        }()({\n          1: [\n            function (require, module, exports) {\n              var process = module.exports = {};\n              var cachedSetTimeout;\n              var cachedClearTimeout;\n              function defaultSetTimout() {\n                throw new Error('setTimeout has not been defined');\n              }\n              function defaultClearTimeout() {\n                throw new Error('clearTimeout has not been defined');\n              }\n              (function () {\n                try {\n                  if (typeof setTimeout === 'function') {\n                    cachedSetTimeout = setTimeout;\n                  } else {\n                    cachedSetTimeout = defaultSetTimout;\n                  }\n                } catch (e) {\n                  cachedSetTimeout = defaultSetTimout;\n                }\n                try {\n                  if (typeof clearTimeout === 'function') {\n                    cachedClearTimeout = clearTimeout;\n                  } else {\n                    cachedClearTimeout = defaultClearTimeout;\n                  }\n                } catch (e) {\n                  cachedClearTimeout = defaultClearTimeout;\n                }\n              }());\n              function runTimeout(fun) {\n                if (cachedSetTimeout === setTimeout) {\n                  return setTimeout(fun, 0);\n                }\n                if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n                  cachedSetTimeout = setTimeout;\n                  return setTimeout(fun, 0);\n                }\n                try {\n                  return cachedSetTimeout(fun, 0);\n                } catch (e) {\n                  try {\n                    return cachedSetTimeout.call(null, fun, 0);\n                  } catch (e) {\n                    return cachedSetTimeout.call(this, fun, 0);\n                  }\n                }\n              }\n              function runClearTimeout(marker) {\n                if (cachedClearTimeout === clearTimeout) {\n                  return clearTimeout(marker);\n                }\n                if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n                  cachedClearTimeout = clearTimeout;\n                  return clearTimeout(marker);\n                }\n                try {\n                  return cachedClearTimeout(marker);\n                } catch (e) {\n                  try {\n                    return cachedClearTimeout.call(null, marker);\n                  } catch (e) {\n                    return cachedClearTimeout.call(this, marker);\n                  }\n                }\n              }\n              var queue = [];\n              var draining = false;\n              var currentQueue;\n              var queueIndex = -1;\n              function cleanUpNextTick() {\n                if (!draining || !currentQueue) {\n                  return;\n                }\n                draining = false;\n                if (currentQueue.length) {\n                  queue = currentQueue.concat(queue);\n                } else {\n                  queueIndex = -1;\n                }\n                if (queue.length) {\n                  drainQueue();\n                }\n              }\n              function drainQueue() {\n                if (draining) {\n                  return;\n                }\n                var timeout = runTimeout(cleanUpNextTick);\n                draining = true;\n                var len = queue.length;\n                while (len) {\n                  currentQueue = queue;\n                  queue = [];\n                  while (++queueIndex < len) {\n                    if (currentQueue) {\n                      currentQueue[queueIndex].run();\n                    }\n                  }\n                  queueIndex = -1;\n                  len = queue.length;\n                }\n                currentQueue = null;\n                draining = false;\n                runClearTimeout(timeout);\n              }\n              process.nextTick = function (fun) {\n                var args = new Array(arguments.length - 1);\n                if (arguments.length > 1) {\n                  for (var i = 1; i < arguments.length; i++) {\n                    args[i - 1] = arguments[i];\n                  }\n                }\n                queue.push(new Item(fun, args));\n                if (queue.length === 1 && !draining) {\n                  runTimeout(drainQueue);\n                }\n              };\n              function Item(fun, array) {\n                this.fun = fun;\n                this.array = array;\n              }\n              Item.prototype.run = function () {\n                this.fun.apply(null, this.array);\n              };\n              process.title = 'browser';\n              process.browser = true;\n              process.env = {};\n              process.argv = [];\n              process.version = '';\n              process.versions = {};\n              function noop() {\n              }\n              process.on = noop;\n              process.addListener = noop;\n              process.once = noop;\n              process.off = noop;\n              process.removeListener = noop;\n              process.removeAllListeners = noop;\n              process.emit = noop;\n              process.prependListener = noop;\n              process.prependOnceListener = noop;\n              process.listeners = function (name) {\n                return [];\n              };\n              process.binding = function (name) {\n                throw new Error('process.binding is not supported');\n              };\n              process.cwd = function () {\n                return '/';\n              };\n              process.chdir = function (dir) {\n                throw new Error('process.chdir is not supported');\n              };\n              process.umask = function () {\n                return 0;\n              };\n            },\n            {}\n          ],\n          2: [\n            function (require, module, exports) {\n              (function (setImmediate) {\n                (function (root) {\n                  var setTimeoutFunc = setTimeout;\n                  function noop() {\n                  }\n                  function bind(fn, thisArg) {\n                    return function () {\n                      fn.apply(thisArg, arguments);\n                    };\n                  }\n                  function Promise(fn) {\n                    if (typeof this !== 'object')\n                      throw new TypeError('Promises must be constructed via new');\n                    if (typeof fn !== 'function')\n                      throw new TypeError('not a function');\n                    this._state = 0;\n                    this._handled = false;\n                    this._value = undefined;\n                    this._deferreds = [];\n                    doResolve(fn, this);\n                  }\n                  function handle(self, deferred) {\n                    while (self._state === 3) {\n                      self = self._value;\n                    }\n                    if (self._state === 0) {\n                      self._deferreds.push(deferred);\n                      return;\n                    }\n                    self._handled = true;\n                    Promise._immediateFn(function () {\n                      var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n                      if (cb === null) {\n                        (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                        return;\n                      }\n                      var ret;\n                      try {\n                        ret = cb(self._value);\n                      } catch (e) {\n                        reject(deferred.promise, e);\n                        return;\n                      }\n                      resolve(deferred.promise, ret);\n                    });\n                  }\n                  function resolve(self, newValue) {\n                    try {\n                      if (newValue === self)\n                        throw new TypeError('A promise cannot be resolved with itself.');\n                      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                        var then = newValue.then;\n                        if (newValue instanceof Promise) {\n                          self._state = 3;\n                          self._value = newValue;\n                          finale(self);\n                          return;\n                        } else if (typeof then === 'function') {\n                          doResolve(bind(then, newValue), self);\n                          return;\n                        }\n                      }\n                      self._state = 1;\n                      self._value = newValue;\n                      finale(self);\n                    } catch (e) {\n                      reject(self, e);\n                    }\n                  }\n                  function reject(self, newValue) {\n                    self._state = 2;\n                    self._value = newValue;\n                    finale(self);\n                  }\n                  function finale(self) {\n                    if (self._state === 2 && self._deferreds.length === 0) {\n                      Promise._immediateFn(function () {\n                        if (!self._handled) {\n                          Promise._unhandledRejectionFn(self._value);\n                        }\n                      });\n                    }\n                    for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                      handle(self, self._deferreds[i]);\n                    }\n                    self._deferreds = null;\n                  }\n                  function Handler(onFulfilled, onRejected, promise) {\n                    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                    this.promise = promise;\n                  }\n                  function doResolve(fn, self) {\n                    var done = false;\n                    try {\n                      fn(function (value) {\n                        if (done)\n                          return;\n                        done = true;\n                        resolve(self, value);\n                      }, function (reason) {\n                        if (done)\n                          return;\n                        done = true;\n                        reject(self, reason);\n                      });\n                    } catch (ex) {\n                      if (done)\n                        return;\n                      done = true;\n                      reject(self, ex);\n                    }\n                  }\n                  Promise.prototype['catch'] = function (onRejected) {\n                    return this.then(null, onRejected);\n                  };\n                  Promise.prototype.then = function (onFulfilled, onRejected) {\n                    var prom = new this.constructor(noop);\n                    handle(this, new Handler(onFulfilled, onRejected, prom));\n                    return prom;\n                  };\n                  Promise.all = function (arr) {\n                    var args = Array.prototype.slice.call(arr);\n                    return new Promise(function (resolve, reject) {\n                      if (args.length === 0)\n                        return resolve([]);\n                      var remaining = args.length;\n                      function res(i, val) {\n                        try {\n                          if (val && (typeof val === 'object' || typeof val === 'function')) {\n                            var then = val.then;\n                            if (typeof then === 'function') {\n                              then.call(val, function (val) {\n                                res(i, val);\n                              }, reject);\n                              return;\n                            }\n                          }\n                          args[i] = val;\n                          if (--remaining === 0) {\n                            resolve(args);\n                          }\n                        } catch (ex) {\n                          reject(ex);\n                        }\n                      }\n                      for (var i = 0; i < args.length; i++) {\n                        res(i, args[i]);\n                      }\n                    });\n                  };\n                  Promise.resolve = function (value) {\n                    if (value && typeof value === 'object' && value.constructor === Promise) {\n                      return value;\n                    }\n                    return new Promise(function (resolve) {\n                      resolve(value);\n                    });\n                  };\n                  Promise.reject = function (value) {\n                    return new Promise(function (resolve, reject) {\n                      reject(value);\n                    });\n                  };\n                  Promise.race = function (values) {\n                    return new Promise(function (resolve, reject) {\n                      for (var i = 0, len = values.length; i < len; i++) {\n                        values[i].then(resolve, reject);\n                      }\n                    });\n                  };\n                  Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                    setImmediate(fn);\n                  } : function (fn) {\n                    setTimeoutFunc(fn, 0);\n                  };\n                  Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                    if (typeof console !== 'undefined' && console) {\n                      console.warn('Possible Unhandled Promise Rejection:', err);\n                    }\n                  };\n                  Promise._setImmediateFn = function _setImmediateFn(fn) {\n                    Promise._immediateFn = fn;\n                  };\n                  Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                    Promise._unhandledRejectionFn = fn;\n                  };\n                  if (typeof module !== 'undefined' && module.exports) {\n                    module.exports = Promise;\n                  } else if (!root.Promise) {\n                    root.Promise = Promise;\n                  }\n                }(this));\n              }.call(this, require('timers').setImmediate));\n            },\n            { 'timers': 3 }\n          ],\n          3: [\n            function (require, module, exports) {\n              (function (setImmediate, clearImmediate) {\n                var nextTick = require('process/browser.js').nextTick;\n                var apply = Function.prototype.apply;\n                var slice = Array.prototype.slice;\n                var immediateIds = {};\n                var nextImmediateId = 0;\n                exports.setTimeout = function () {\n                  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n                };\n                exports.setInterval = function () {\n                  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n                };\n                exports.clearTimeout = exports.clearInterval = function (timeout) {\n                  timeout.close();\n                };\n                function Timeout(id, clearFn) {\n                  this._id = id;\n                  this._clearFn = clearFn;\n                }\n                Timeout.prototype.unref = Timeout.prototype.ref = function () {\n                };\n                Timeout.prototype.close = function () {\n                  this._clearFn.call(window, this._id);\n                };\n                exports.enroll = function (item, msecs) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = msecs;\n                };\n                exports.unenroll = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = -1;\n                };\n                exports._unrefActive = exports.active = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  var msecs = item._idleTimeout;\n                  if (msecs >= 0) {\n                    item._idleTimeoutId = setTimeout(function onTimeout() {\n                      if (item._onTimeout)\n                        item._onTimeout();\n                    }, msecs);\n                  }\n                };\n                exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n                  var id = nextImmediateId++;\n                  var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n                  immediateIds[id] = true;\n                  nextTick(function onNextTick() {\n                    if (immediateIds[id]) {\n                      if (args) {\n                        fn.apply(null, args);\n                      } else {\n                        fn.call(null);\n                      }\n                      exports.clearImmediate(id);\n                    }\n                  });\n                  return id;\n                };\n                exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n                  delete immediateIds[id];\n                };\n              }.call(this, require('timers').setImmediate, require('timers').clearImmediate));\n            },\n            {\n              'process/browser.js': 1,\n              'timers': 3\n            }\n          ],\n          4: [\n            function (require, module, exports) {\n              var promisePolyfill = require('promise-polyfill');\n              var Global = function () {\n                if (typeof window !== 'undefined') {\n                  return window;\n                } else {\n                  return Function('return this;')();\n                }\n              }();\n              module.exports = { boltExport: Global.Promise || promisePolyfill };\n            },\n            { 'promise-polyfill': 2 }\n          ]\n        }, {}, [4])(4);\n      }));\n    }(undefined, exports$1, module, undefined));\n    var Promise = module.exports.boltExport;\n\n    var nu = function (baseFn) {\n      var data = Option.none();\n      var callbacks = [];\n      var map = function (f) {\n        return nu(function (nCallback) {\n          get(function (data) {\n            nCallback(f(data));\n          });\n        });\n      };\n      var get = function (nCallback) {\n        if (isReady()) {\n          call(nCallback);\n        } else {\n          callbacks.push(nCallback);\n        }\n      };\n      var set = function (x) {\n        data = Option.some(x);\n        run(callbacks);\n        callbacks = [];\n      };\n      var isReady = function () {\n        return data.isSome();\n      };\n      var run = function (cbs) {\n        each(cbs, call);\n      };\n      var call = function (cb) {\n        data.each(function (x) {\n          domGlobals.setTimeout(function () {\n            cb(x);\n          }, 0);\n        });\n      };\n      baseFn(set);\n      return {\n        get: get,\n        map: map,\n        isReady: isReady\n      };\n    };\n    var pure = function (a) {\n      return nu(function (callback) {\n        callback(a);\n      });\n    };\n    var LazyValue = {\n      nu: nu,\n      pure: pure\n    };\n\n    var errorReporter = function (err) {\n      domGlobals.setTimeout(function () {\n        throw err;\n      }, 0);\n    };\n    var make = function (run) {\n      var get = function (callback) {\n        run().then(callback, errorReporter);\n      };\n      var map = function (fab) {\n        return make(function () {\n          return run().then(fab);\n        });\n      };\n      var bind = function (aFutureB) {\n        return make(function () {\n          return run().then(function (v) {\n            return aFutureB(v).toPromise();\n          });\n        });\n      };\n      var anonBind = function (futureB) {\n        return make(function () {\n          return run().then(function () {\n            return futureB.toPromise();\n          });\n        });\n      };\n      var toLazy = function () {\n        return LazyValue.nu(get);\n      };\n      var toCached = function () {\n        var cache = null;\n        return make(function () {\n          if (cache === null) {\n            cache = run();\n          }\n          return cache;\n        });\n      };\n      var toPromise = run;\n      return {\n        map: map,\n        bind: bind,\n        anonBind: anonBind,\n        toLazy: toLazy,\n        toCached: toCached,\n        toPromise: toPromise,\n        get: get\n      };\n    };\n    var nu$1 = function (baseFn) {\n      return make(function () {\n        return new Promise(baseFn);\n      });\n    };\n    var pure$1 = function (a) {\n      return make(function () {\n        return Promise.resolve(a);\n      });\n    };\n    var Future = {\n      nu: nu$1,\n      pure: pure$1\n    };\n\n    var value = function (o) {\n      var is = function (v) {\n        return o === v;\n      };\n      var or = function (opt) {\n        return value(o);\n      };\n      var orThunk = function (f) {\n        return value(o);\n      };\n      var map = function (f) {\n        return value(f(o));\n      };\n      var mapError = function (f) {\n        return value(o);\n      };\n      var each = function (f) {\n        f(o);\n      };\n      var bind = function (f) {\n        return f(o);\n      };\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n      var exists = function (f) {\n        return f(o);\n      };\n      var forall = function (f) {\n        return f(o);\n      };\n      var toOption = function () {\n        return Option.some(o);\n      };\n      return {\n        is: is,\n        isValue: always,\n        isError: never,\n        getOr: constant(o),\n        getOrThunk: constant(o),\n        getOrDie: constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOption: toOption\n      };\n    };\n    var error = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n      var getOrDie = function () {\n        return die(String(message))();\n      };\n      var or = function (opt) {\n        return opt;\n      };\n      var orThunk = function (f) {\n        return f();\n      };\n      var map = function (f) {\n        return error(message);\n      };\n      var mapError = function (f) {\n        return error(f(message));\n      };\n      var bind = function (f) {\n        return error(message);\n      };\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n      return {\n        is: never,\n        isValue: never,\n        isError: always,\n        getOr: identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOption: Option.none\n      };\n    };\n    var fromOption = function (opt, err) {\n      return opt.fold(function () {\n        return error(err);\n      }, value);\n    };\n    var Result = {\n      value: value,\n      error: error,\n      fromOption: fromOption\n    };\n\n    var wrap = function (delegate) {\n      var toCached = function () {\n        return wrap(delegate.toCached());\n      };\n      var bindFuture = function (f) {\n        return wrap(delegate.bind(function (resA) {\n          return resA.fold(function (err) {\n            return Future.pure(Result.error(err));\n          }, function (a) {\n            return f(a);\n          });\n        }));\n      };\n      var bindResult = function (f) {\n        return wrap(delegate.map(function (resA) {\n          return resA.bind(f);\n        }));\n      };\n      var mapResult = function (f) {\n        return wrap(delegate.map(function (resA) {\n          return resA.map(f);\n        }));\n      };\n      var mapError = function (f) {\n        return wrap(delegate.map(function (resA) {\n          return resA.mapError(f);\n        }));\n      };\n      var foldResult = function (whenError, whenValue) {\n        return delegate.map(function (res) {\n          return res.fold(whenError, whenValue);\n        });\n      };\n      var withTimeout = function (timeout, errorThunk) {\n        return wrap(Future.nu(function (callback) {\n          var timedOut = false;\n          var timer = domGlobals.setTimeout(function () {\n            timedOut = true;\n            callback(Result.error(errorThunk()));\n          }, timeout);\n          delegate.get(function (result) {\n            if (!timedOut) {\n              domGlobals.clearTimeout(timer);\n              callback(result);\n            }\n          });\n        }));\n      };\n      return __assign(__assign({}, delegate), {\n        toCached: toCached,\n        bindFuture: bindFuture,\n        bindResult: bindResult,\n        mapResult: mapResult,\n        mapError: mapError,\n        foldResult: foldResult,\n        withTimeout: withTimeout\n      });\n    };\n    var nu$2 = function (worker) {\n      return wrap(Future.nu(worker));\n    };\n    var value$1 = function (value) {\n      return wrap(Future.pure(Result.value(value)));\n    };\n    var error$1 = function (error) {\n      return wrap(Future.pure(Result.error(error)));\n    };\n    var fromResult = function (result) {\n      return wrap(Future.pure(result));\n    };\n    var fromFuture = function (future) {\n      return wrap(future.map(Result.value));\n    };\n    var fromPromise = function (promise) {\n      return nu$2(function (completer) {\n        promise.then(function (value) {\n          completer(Result.value(value));\n        }, function (error) {\n          completer(Result.error(error));\n        });\n      });\n    };\n    var FutureResult = {\n      nu: nu$2,\n      wrap: wrap,\n      pure: value$1,\n      value: value$1,\n      error: error$1,\n      fromResult: fromResult,\n      fromFuture: fromFuture,\n      fromPromise: fromPromise\n    };\n\n    var hasOwnProperty = Object.prototype.hasOwnProperty;\n    var shallow = function (old, nu) {\n      return nu;\n    };\n    var deep = function (old, nu) {\n      var bothObjects = isObject(old) && isObject(nu);\n      return bothObjects ? deepMerge(old, nu) : nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n        for (var i = 0; i < objects.length; i++) {\n          objects[i] = arguments[i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (hasOwnProperty.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var deepMerge = baseMerge(deep);\n    var merge = baseMerge(shallow);\n\n    var makeItems = function (info) {\n      var imageUrl = {\n        name: 'src',\n        type: 'urlinput',\n        filetype: 'image',\n        label: 'Source'\n      };\n      var imageList = info.imageList.map(function (items) {\n        return {\n          name: 'images',\n          type: 'selectbox',\n          label: 'Image list',\n          items: items\n        };\n      });\n      var imageDescription = {\n        name: 'alt',\n        type: 'input',\n        label: 'Image description'\n      };\n      var imageTitle = {\n        name: 'title',\n        type: 'input',\n        label: 'Image title'\n      };\n      var imageDimensions = {\n        name: 'dimensions',\n        type: 'sizeinput'\n      };\n      var classList = info.classList.map(function (items) {\n        return {\n          name: 'classes',\n          type: 'selectbox',\n          label: 'Class',\n          items: items\n        };\n      });\n      var caption = {\n        type: 'label',\n        label: 'Caption',\n        items: [{\n            type: 'checkbox',\n            name: 'caption',\n            label: 'Show caption'\n          }]\n      };\n      return flatten([\n        [imageUrl],\n        imageList.toArray(),\n        info.hasDescription ? [imageDescription] : [],\n        info.hasImageTitle ? [imageTitle] : [],\n        info.hasDimensions ? [imageDimensions] : [],\n        [{\n            type: 'grid',\n            columns: 2,\n            items: flatten([\n              classList.toArray(),\n              info.hasImageCaption ? [caption] : []\n            ])\n          }]\n      ]);\n    };\n    var makeTab = function (info) {\n      return {\n        title: 'General',\n        name: 'general',\n        items: makeItems(info)\n      };\n    };\n    var MainTab = {\n      makeTab: makeTab,\n      makeItems: makeItems\n    };\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.util.XHR');\n\n    var hasDimensions = function (editor) {\n      return editor.getParam('image_dimensions', true, 'boolean');\n    };\n    var hasAdvTab = function (editor) {\n      return editor.getParam('image_advtab', false, 'boolean');\n    };\n    var hasUploadTab = function (editor) {\n      return editor.getParam('image_uploadtab', true, 'boolean');\n    };\n    var getPrependUrl = function (editor) {\n      return editor.getParam('image_prepend_url', '', 'string');\n    };\n    var getClassList = function (editor) {\n      return editor.getParam('image_class_list');\n    };\n    var hasDescription = function (editor) {\n      return editor.getParam('image_description', true, 'boolean');\n    };\n    var hasImageTitle = function (editor) {\n      return editor.getParam('image_title', false, 'boolean');\n    };\n    var hasImageCaption = function (editor) {\n      return editor.getParam('image_caption', false, 'boolean');\n    };\n    var getImageList = function (editor) {\n      return editor.getParam('image_list', false);\n    };\n    var hasUploadUrl = function (editor) {\n      return !!getUploadUrl(editor);\n    };\n    var hasUploadHandler = function (editor) {\n      return !!getUploadHandler(editor);\n    };\n    var getUploadUrl = function (editor) {\n      return editor.getParam('images_upload_url', '', 'string');\n    };\n    var getUploadHandler = function (editor) {\n      return editor.getParam('images_upload_handler', undefined, 'function');\n    };\n    var getUploadBasePath = function (editor) {\n      return editor.getParam('images_upload_base_path', undefined, 'string');\n    };\n    var getUploadCredentials = function (editor) {\n      return editor.getParam('images_upload_credentials', false, 'boolean');\n    };\n    var Settings = {\n      hasDimensions: hasDimensions,\n      hasUploadTab: hasUploadTab,\n      hasAdvTab: hasAdvTab,\n      getPrependUrl: getPrependUrl,\n      getClassList: getClassList,\n      hasDescription: hasDescription,\n      hasImageTitle: hasImageTitle,\n      hasImageCaption: hasImageCaption,\n      getImageList: getImageList,\n      hasUploadUrl: hasUploadUrl,\n      hasUploadHandler: hasUploadHandler,\n      getUploadUrl: getUploadUrl,\n      getUploadHandler: getUploadHandler,\n      getUploadBasePath: getUploadBasePath,\n      getUploadCredentials: getUploadCredentials\n    };\n\n    var parseIntAndGetMax = function (val1, val2) {\n      return Math.max(parseInt(val1, 10), parseInt(val2, 10));\n    };\n    var getImageSize = function (url, callback) {\n      var img = domGlobals.document.createElement('img');\n      var done = function (dimensions) {\n        if (img.parentNode) {\n          img.parentNode.removeChild(img);\n        }\n        callback(dimensions);\n      };\n      img.onload = function () {\n        var width = parseIntAndGetMax(img.width, img.clientWidth);\n        var height = parseIntAndGetMax(img.height, img.clientHeight);\n        var dimensions = {\n          width: width,\n          height: height\n        };\n        done(Result.value(dimensions));\n      };\n      img.onerror = function () {\n        done(Result.error('Failed to get image dimensions for: ' + url));\n      };\n      var style = img.style;\n      style.visibility = 'hidden';\n      style.position = 'fixed';\n      style.bottom = style.left = '0px';\n      style.width = style.height = 'auto';\n      domGlobals.document.body.appendChild(img);\n      img.src = url;\n    };\n    var removePixelSuffix = function (value) {\n      if (value) {\n        value = value.replace(/px$/, '');\n      }\n      return value;\n    };\n    var addPixelSuffix = function (value) {\n      if (value.length > 0 && /^[0-9]+$/.test(value)) {\n        value += 'px';\n      }\n      return value;\n    };\n    var mergeMargins = function (css) {\n      if (css.margin) {\n        var splitMargin = String(css.margin).split(' ');\n        switch (splitMargin.length) {\n        case 1:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[0];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[0];\n          css['margin-left'] = css['margin-left'] || splitMargin[0];\n          break;\n        case 2:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[1];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[0];\n          css['margin-left'] = css['margin-left'] || splitMargin[1];\n          break;\n        case 3:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[1];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[2];\n          css['margin-left'] = css['margin-left'] || splitMargin[1];\n          break;\n        case 4:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[1];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[2];\n          css['margin-left'] = css['margin-left'] || splitMargin[3];\n        }\n        delete css.margin;\n      }\n      return css;\n    };\n    var createImageList = function (editor, callback) {\n      var imageList = Settings.getImageList(editor);\n      if (typeof imageList === 'string') {\n        global$4.send({\n          url: imageList,\n          success: function (text) {\n            callback(JSON.parse(text));\n          }\n        });\n      } else if (typeof imageList === 'function') {\n        imageList(callback);\n      } else {\n        callback(imageList);\n      }\n    };\n    var waitLoadImage = function (editor, data, imgElm) {\n      var selectImage = function () {\n        imgElm.onload = imgElm.onerror = null;\n        if (editor.selection) {\n          editor.selection.select(imgElm);\n          editor.nodeChanged();\n        }\n      };\n      imgElm.onload = function () {\n        if (!data.width && !data.height && Settings.hasDimensions(editor)) {\n          editor.dom.setAttribs(imgElm, {\n            width: String(imgElm.clientWidth),\n            height: String(imgElm.clientHeight)\n          });\n        }\n        selectImage();\n      };\n      imgElm.onerror = selectImage;\n    };\n    var blobToDataUri = function (blob) {\n      return new global$3(function (resolve, reject) {\n        var reader = new domGlobals.FileReader();\n        reader.onload = function () {\n          resolve(reader.result);\n        };\n        reader.onerror = function () {\n          reject(reader.error.message);\n        };\n        reader.readAsDataURL(blob);\n      });\n    };\n    var isPlaceholderImage = function (imgElm) {\n      return imgElm.nodeName === 'IMG' && (imgElm.hasAttribute('data-mce-object') || imgElm.hasAttribute('data-mce-placeholder'));\n    };\n    var Utils = {\n      getImageSize: getImageSize,\n      removePixelSuffix: removePixelSuffix,\n      addPixelSuffix: addPixelSuffix,\n      mergeMargins: mergeMargins,\n      createImageList: createImageList,\n      waitLoadImage: waitLoadImage,\n      blobToDataUri: blobToDataUri,\n      isPlaceholderImage: isPlaceholderImage\n    };\n\n    var DOM = global$2.DOM;\n    var getHspace = function (image) {\n      if (image.style.marginLeft && image.style.marginRight && image.style.marginLeft === image.style.marginRight) {\n        return Utils.removePixelSuffix(image.style.marginLeft);\n      } else {\n        return '';\n      }\n    };\n    var getVspace = function (image) {\n      if (image.style.marginTop && image.style.marginBottom && image.style.marginTop === image.style.marginBottom) {\n        return Utils.removePixelSuffix(image.style.marginTop);\n      } else {\n        return '';\n      }\n    };\n    var getBorder = function (image) {\n      if (image.style.borderWidth) {\n        return Utils.removePixelSuffix(image.style.borderWidth);\n      } else {\n        return '';\n      }\n    };\n    var getAttrib = function (image, name) {\n      if (image.hasAttribute(name)) {\n        return image.getAttribute(name);\n      } else {\n        return '';\n      }\n    };\n    var getStyle = function (image, name) {\n      return image.style[name] ? image.style[name] : '';\n    };\n    var hasCaption = function (image) {\n      return image.parentNode !== null && image.parentNode.nodeName === 'FIGURE';\n    };\n    var setAttrib = function (image, name, value) {\n      image.setAttribute(name, value);\n    };\n    var wrapInFigure = function (image) {\n      var figureElm = DOM.create('figure', { class: 'image' });\n      DOM.insertAfter(figureElm, image);\n      figureElm.appendChild(image);\n      figureElm.appendChild(DOM.create('figcaption', { contentEditable: 'true' }, 'Caption'));\n      figureElm.contentEditable = 'false';\n    };\n    var removeFigure = function (image) {\n      var figureElm = image.parentNode;\n      DOM.insertAfter(image, figureElm);\n      DOM.remove(figureElm);\n    };\n    var toggleCaption = function (image) {\n      if (hasCaption(image)) {\n        removeFigure(image);\n      } else {\n        wrapInFigure(image);\n      }\n    };\n    var normalizeStyle = function (image, normalizeCss) {\n      var attrValue = image.getAttribute('style');\n      var value = normalizeCss(attrValue !== null ? attrValue : '');\n      if (value.length > 0) {\n        image.setAttribute('style', value);\n        image.setAttribute('data-mce-style', value);\n      } else {\n        image.removeAttribute('style');\n      }\n    };\n    var setSize = function (name, normalizeCss) {\n      return function (image, name, value) {\n        if (image.style[name]) {\n          image.style[name] = Utils.addPixelSuffix(value);\n          normalizeStyle(image, normalizeCss);\n        } else {\n          setAttrib(image, name, value);\n        }\n      };\n    };\n    var getSize = function (image, name) {\n      if (image.style[name]) {\n        return Utils.removePixelSuffix(image.style[name]);\n      } else {\n        return getAttrib(image, name);\n      }\n    };\n    var setHspace = function (image, value) {\n      var pxValue = Utils.addPixelSuffix(value);\n      image.style.marginLeft = pxValue;\n      image.style.marginRight = pxValue;\n    };\n    var setVspace = function (image, value) {\n      var pxValue = Utils.addPixelSuffix(value);\n      image.style.marginTop = pxValue;\n      image.style.marginBottom = pxValue;\n    };\n    var setBorder = function (image, value) {\n      var pxValue = Utils.addPixelSuffix(value);\n      image.style.borderWidth = pxValue;\n    };\n    var setBorderStyle = function (image, value) {\n      image.style.borderStyle = value;\n    };\n    var getBorderStyle = function (image) {\n      return getStyle(image, 'borderStyle');\n    };\n    var isFigure = function (elm) {\n      return elm.nodeName === 'FIGURE';\n    };\n    var isImage = function (elm) {\n      return elm.nodeName === 'IMG';\n    };\n    var defaultData = function () {\n      return {\n        src: '',\n        alt: '',\n        title: '',\n        width: '',\n        height: '',\n        class: '',\n        style: '',\n        caption: false,\n        hspace: '',\n        vspace: '',\n        border: '',\n        borderStyle: ''\n      };\n    };\n    var getStyleValue = function (normalizeCss, data) {\n      var image = domGlobals.document.createElement('img');\n      setAttrib(image, 'style', data.style);\n      if (getHspace(image) || data.hspace !== '') {\n        setHspace(image, data.hspace);\n      }\n      if (getVspace(image) || data.vspace !== '') {\n        setVspace(image, data.vspace);\n      }\n      if (getBorder(image) || data.border !== '') {\n        setBorder(image, data.border);\n      }\n      if (getBorderStyle(image) || data.borderStyle !== '') {\n        setBorderStyle(image, data.borderStyle);\n      }\n      return normalizeCss(image.getAttribute('style'));\n    };\n    var create = function (normalizeCss, data) {\n      var image = domGlobals.document.createElement('img');\n      write(normalizeCss, merge(data, { caption: false }), image);\n      setAttrib(image, 'alt', data.alt);\n      if (data.caption) {\n        var figure = DOM.create('figure', { class: 'image' });\n        figure.appendChild(image);\n        figure.appendChild(DOM.create('figcaption', { contentEditable: 'true' }, 'Caption'));\n        figure.contentEditable = 'false';\n        return figure;\n      } else {\n        return image;\n      }\n    };\n    var read = function (normalizeCss, image) {\n      return {\n        src: getAttrib(image, 'src'),\n        alt: getAttrib(image, 'alt'),\n        title: getAttrib(image, 'title'),\n        width: getSize(image, 'width'),\n        height: getSize(image, 'height'),\n        class: getAttrib(image, 'class'),\n        style: normalizeCss(getAttrib(image, 'style')),\n        caption: hasCaption(image),\n        hspace: getHspace(image),\n        vspace: getVspace(image),\n        border: getBorder(image),\n        borderStyle: getStyle(image, 'borderStyle')\n      };\n    };\n    var updateProp = function (image, oldData, newData, name, set) {\n      if (newData[name] !== oldData[name]) {\n        set(image, name, newData[name]);\n      }\n    };\n    var normalized = function (set, normalizeCss) {\n      return function (image, name, value) {\n        set(image, value);\n        normalizeStyle(image, normalizeCss);\n      };\n    };\n    var write = function (normalizeCss, newData, image) {\n      var oldData = read(normalizeCss, image);\n      updateProp(image, oldData, newData, 'caption', function (image, _name, _value) {\n        return toggleCaption(image);\n      });\n      updateProp(image, oldData, newData, 'src', setAttrib);\n      updateProp(image, oldData, newData, 'alt', setAttrib);\n      updateProp(image, oldData, newData, 'title', setAttrib);\n      updateProp(image, oldData, newData, 'width', setSize('width', normalizeCss));\n      updateProp(image, oldData, newData, 'height', setSize('height', normalizeCss));\n      updateProp(image, oldData, newData, 'class', setAttrib);\n      updateProp(image, oldData, newData, 'style', normalized(function (image, value) {\n        return setAttrib(image, 'style', value);\n      }, normalizeCss));\n      updateProp(image, oldData, newData, 'hspace', normalized(setHspace, normalizeCss));\n      updateProp(image, oldData, newData, 'vspace', normalized(setVspace, normalizeCss));\n      updateProp(image, oldData, newData, 'border', normalized(setBorder, normalizeCss));\n      updateProp(image, oldData, newData, 'borderStyle', normalized(setBorderStyle, normalizeCss));\n    };\n\n    var normalizeCss = function (editor, cssText) {\n      var css = editor.dom.styles.parse(cssText);\n      var mergedCss = Utils.mergeMargins(css);\n      var compressed = editor.dom.styles.parse(editor.dom.styles.serialize(mergedCss));\n      return editor.dom.styles.serialize(compressed);\n    };\n    var getSelectedImage = function (editor) {\n      var imgElm = editor.selection.getNode();\n      var figureElm = editor.dom.getParent(imgElm, 'figure.image');\n      if (figureElm) {\n        return editor.dom.select('img', figureElm)[0];\n      }\n      if (imgElm && (imgElm.nodeName !== 'IMG' || Utils.isPlaceholderImage(imgElm))) {\n        return null;\n      }\n      return imgElm;\n    };\n    var splitTextBlock = function (editor, figure) {\n      var dom = editor.dom;\n      var textBlock = dom.getParent(figure.parentNode, function (node) {\n        return editor.schema.getTextBlockElements()[node.nodeName];\n      }, editor.getBody());\n      if (textBlock) {\n        return dom.split(textBlock, figure);\n      } else {\n        return figure;\n      }\n    };\n    var readImageDataFromSelection = function (editor) {\n      var image = getSelectedImage(editor);\n      return image ? read(function (css) {\n        return normalizeCss(editor, css);\n      }, image) : defaultData();\n    };\n    var insertImageAtCaret = function (editor, data) {\n      var elm = create(function (css) {\n        return normalizeCss(editor, css);\n      }, data);\n      editor.dom.setAttrib(elm, 'data-mce-id', '__mcenew');\n      editor.focus();\n      editor.selection.setContent(elm.outerHTML);\n      var insertedElm = editor.dom.select('*[data-mce-id=\"__mcenew\"]')[0];\n      editor.dom.setAttrib(insertedElm, 'data-mce-id', null);\n      if (isFigure(insertedElm)) {\n        var figure = splitTextBlock(editor, insertedElm);\n        editor.selection.select(figure);\n      } else {\n        editor.selection.select(insertedElm);\n      }\n    };\n    var syncSrcAttr = function (editor, image) {\n      editor.dom.setAttrib(image, 'src', image.getAttribute('src'));\n    };\n    var deleteImage = function (editor, image) {\n      if (image) {\n        var elm = editor.dom.is(image.parentNode, 'figure.image') ? image.parentNode : image;\n        editor.dom.remove(elm);\n        editor.focus();\n        editor.nodeChanged();\n        if (editor.dom.isEmpty(editor.getBody())) {\n          editor.setContent('');\n          editor.selection.setCursorLocation();\n        }\n      }\n    };\n    var writeImageDataToSelection = function (editor, data) {\n      var image = getSelectedImage(editor);\n      write(function (css) {\n        return normalizeCss(editor, css);\n      }, data, image);\n      syncSrcAttr(editor, image);\n      if (isFigure(image.parentNode)) {\n        var figure = image.parentNode;\n        splitTextBlock(editor, figure);\n        editor.selection.select(image.parentNode);\n      } else {\n        editor.selection.select(image);\n        Utils.waitLoadImage(editor, data, image);\n      }\n    };\n    var insertOrUpdateImage = function (editor, data) {\n      var image = getSelectedImage(editor);\n      if (image) {\n        if (data.src) {\n          writeImageDataToSelection(editor, data);\n        } else {\n          deleteImage(editor, image);\n        }\n      } else if (data.src) {\n        insertImageAtCaret(editor, data);\n      }\n    };\n\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Option.none();\n    };\n\n    var global$5 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var getValue = function (item) {\n      return isString(item.value) ? item.value : '';\n    };\n    var sanitizeList = function (list, extractValue) {\n      var out = [];\n      global$5.each(list, function (item) {\n        var text = isString(item.text) ? item.text : isString(item.title) ? item.title : '';\n        if (item.menu !== undefined) {\n          var items = sanitizeList(item.menu, extractValue);\n          out.push({\n            text: text,\n            items: items\n          });\n        } else {\n          var value = extractValue(item);\n          out.push({\n            text: text,\n            value: value\n          });\n        }\n      });\n      return out;\n    };\n    var sanitizer = function (extracter) {\n      if (extracter === void 0) {\n        extracter = getValue;\n      }\n      return function (list) {\n        if (list) {\n          return Option.from(list).map(function (list) {\n            return sanitizeList(list, extracter);\n          });\n        } else {\n          return Option.none();\n        }\n      };\n    };\n    var sanitize = function (list) {\n      return sanitizer(getValue)(list);\n    };\n    var isGroup = function (item) {\n      return Object.prototype.hasOwnProperty.call(item, 'items');\n    };\n    var findEntryDelegate = function (list, value) {\n      return findMap(list, function (item) {\n        if (isGroup(item)) {\n          return findEntryDelegate(item.items, value);\n        } else if (item.value === value) {\n          return Option.some(item);\n        } else {\n          return Option.none();\n        }\n      });\n    };\n    var findEntry = function (optList, value) {\n      return optList.bind(function (list) {\n        return findEntryDelegate(list, value);\n      });\n    };\n    var ListUtils = {\n      sanitizer: sanitizer,\n      sanitize: sanitize,\n      findEntry: findEntry\n    };\n\n    var pathJoin = function (path1, path2) {\n      if (path1) {\n        return path1.replace(/\\/$/, '') + '/' + path2.replace(/^\\//, '');\n      }\n      return path2;\n    };\n    function Uploader (settings) {\n      var defaultHandler = function (blobInfo, success, failure, progress) {\n        var xhr, formData;\n        xhr = new domGlobals.XMLHttpRequest();\n        xhr.open('POST', settings.url);\n        xhr.withCredentials = settings.credentials;\n        xhr.upload.onprogress = function (e) {\n          progress(e.loaded / e.total * 100);\n        };\n        xhr.onerror = function () {\n          failure('Image upload failed due to a XHR Transport error. Code: ' + xhr.status);\n        };\n        xhr.onload = function () {\n          var json;\n          if (xhr.status < 200 || xhr.status >= 300) {\n            failure('HTTP Error: ' + xhr.status);\n            return;\n          }\n          json = JSON.parse(xhr.responseText);\n          if (!json || typeof json.location !== 'string') {\n            failure('Invalid JSON: ' + xhr.responseText);\n            return;\n          }\n          success(pathJoin(settings.basePath, json.location));\n        };\n        formData = new domGlobals.FormData();\n        formData.append('file', blobInfo.blob(), blobInfo.filename());\n        xhr.send(formData);\n      };\n      var uploadBlob = function (blobInfo, handler) {\n        return new global$3(function (resolve, reject) {\n          try {\n            handler(blobInfo, resolve, reject, noop);\n          } catch (ex) {\n            reject(ex.message);\n          }\n        });\n      };\n      var isDefaultHandler = function (handler) {\n        return handler === defaultHandler;\n      };\n      var upload = function (blobInfo) {\n        return !settings.url && isDefaultHandler(settings.handler) ? global$3.reject('Upload url missing from the settings.') : uploadBlob(blobInfo, settings.handler);\n      };\n      settings = global$5.extend({\n        credentials: false,\n        handler: defaultHandler\n      }, settings);\n      return { upload: upload };\n    }\n\n    var makeTab$1 = function (info) {\n      return {\n        title: 'Advanced',\n        name: 'advanced',\n        items: [\n          {\n            type: 'input',\n            label: 'Style',\n            name: 'style'\n          },\n          {\n            type: 'grid',\n            columns: 2,\n            items: [\n              {\n                type: 'input',\n                label: 'Vertical space',\n                name: 'vspace',\n                inputMode: 'numeric'\n              },\n              {\n                type: 'input',\n                label: 'Horizontal space',\n                name: 'hspace',\n                inputMode: 'numeric'\n              },\n              {\n                type: 'input',\n                label: 'Border width',\n                name: 'border',\n                inputMode: 'numeric'\n              },\n              {\n                type: 'selectbox',\n                name: 'borderstyle',\n                label: 'Border style',\n                items: [\n                  {\n                    text: 'Select...',\n                    value: ''\n                  },\n                  {\n                    text: 'Solid',\n                    value: 'solid'\n                  },\n                  {\n                    text: 'Dotted',\n                    value: 'dotted'\n                  },\n                  {\n                    text: 'Dashed',\n                    value: 'dashed'\n                  },\n                  {\n                    text: 'Double',\n                    value: 'double'\n                  },\n                  {\n                    text: 'Groove',\n                    value: 'groove'\n                  },\n                  {\n                    text: 'Ridge',\n                    value: 'ridge'\n                  },\n                  {\n                    text: 'Inset',\n                    value: 'inset'\n                  },\n                  {\n                    text: 'Outset',\n                    value: 'outset'\n                  },\n                  {\n                    text: 'None',\n                    value: 'none'\n                  },\n                  {\n                    text: 'Hidden',\n                    value: 'hidden'\n                  }\n                ]\n              }\n            ]\n          }\n        ]\n      };\n    };\n    var AdvTab = { makeTab: makeTab$1 };\n\n    var collect = function (editor) {\n      var urlListSanitizer = ListUtils.sanitizer(function (item) {\n        return editor.convertURL(item.value || item.url, 'src');\n      });\n      var futureImageList = Future.nu(function (completer) {\n        Utils.createImageList(editor, function (imageList) {\n          completer(urlListSanitizer(imageList).map(function (items) {\n            return flatten([\n              [{\n                  text: 'None',\n                  value: ''\n                }],\n              items\n            ]);\n          }));\n        });\n      });\n      var classList = ListUtils.sanitize(Settings.getClassList(editor));\n      var hasAdvTab = Settings.hasAdvTab(editor);\n      var hasUploadTab = Settings.hasUploadTab(editor);\n      var hasUploadUrl = Settings.hasUploadUrl(editor);\n      var hasUploadHandler = Settings.hasUploadHandler(editor);\n      var image = readImageDataFromSelection(editor);\n      var hasDescription = Settings.hasDescription(editor);\n      var hasImageTitle = Settings.hasImageTitle(editor);\n      var hasDimensions = Settings.hasDimensions(editor);\n      var hasImageCaption = Settings.hasImageCaption(editor);\n      var url = Settings.getUploadUrl(editor);\n      var basePath = Settings.getUploadBasePath(editor);\n      var credentials = Settings.getUploadCredentials(editor);\n      var handler = Settings.getUploadHandler(editor);\n      var prependURL = Option.some(Settings.getPrependUrl(editor)).filter(function (preUrl) {\n        return isString(preUrl) && preUrl.length > 0;\n      });\n      return futureImageList.map(function (imageList) {\n        return {\n          image: image,\n          imageList: imageList,\n          classList: classList,\n          hasAdvTab: hasAdvTab,\n          hasUploadTab: hasUploadTab,\n          hasUploadUrl: hasUploadUrl,\n          hasUploadHandler: hasUploadHandler,\n          hasDescription: hasDescription,\n          hasImageTitle: hasImageTitle,\n          hasDimensions: hasDimensions,\n          hasImageCaption: hasImageCaption,\n          url: url,\n          basePath: basePath,\n          credentials: credentials,\n          handler: handler,\n          prependURL: prependURL\n        };\n      });\n    };\n\n    var makeTab$2 = function (info) {\n      var items = [{\n          type: 'dropzone',\n          name: 'fileinput'\n        }];\n      return {\n        title: 'Upload',\n        name: 'upload',\n        items: items\n      };\n    };\n    var UploadTab = { makeTab: makeTab$2 };\n\n    var createState = function (info) {\n      return {\n        prevImage: ListUtils.findEntry(info.imageList, info.image.src),\n        prevAlt: info.image.alt,\n        open: true\n      };\n    };\n    var fromImageData = function (image) {\n      return {\n        src: {\n          value: image.src,\n          meta: {}\n        },\n        images: image.src,\n        alt: image.alt,\n        title: image.title,\n        dimensions: {\n          width: image.width,\n          height: image.height\n        },\n        classes: image.class,\n        caption: image.caption,\n        style: image.style,\n        vspace: image.vspace,\n        border: image.border,\n        hspace: image.hspace,\n        borderstyle: image.borderStyle,\n        fileinput: []\n      };\n    };\n    var toImageData = function (data) {\n      return {\n        src: data.src.value,\n        alt: data.alt,\n        title: data.title,\n        width: data.dimensions.width,\n        height: data.dimensions.height,\n        class: data.classes,\n        style: data.style,\n        caption: data.caption,\n        hspace: data.hspace,\n        vspace: data.vspace,\n        border: data.border,\n        borderStyle: data.borderstyle\n      };\n    };\n    var addPrependUrl2 = function (info, srcURL) {\n      if (!/^(?:[a-zA-Z]+:)?\\/\\//.test(srcURL)) {\n        return info.prependURL.bind(function (prependUrl) {\n          if (srcURL.substring(0, prependUrl.length) !== prependUrl) {\n            return Option.some(prependUrl + srcURL);\n          }\n          return Option.none();\n        });\n      }\n      return Option.none();\n    };\n    var addPrependUrl = function (info, api) {\n      var data = api.getData();\n      addPrependUrl2(info, data.src.value).each(function (srcURL) {\n        api.setData({\n          src: {\n            value: srcURL,\n            meta: data.src.meta\n          }\n        });\n      });\n    };\n    var formFillFromMeta2 = function (info, data, meta) {\n      if (info.hasDescription && isString(meta.alt)) {\n        data.alt = meta.alt;\n      }\n      if (info.hasImageTitle && isString(meta.title)) {\n        data.title = meta.title;\n      }\n      if (info.hasDimensions) {\n        if (isString(meta.width)) {\n          data.dimensions.width = meta.width;\n        }\n        if (isString(meta.height)) {\n          data.dimensions.height = meta.height;\n        }\n      }\n      if (isString(meta.class)) {\n        ListUtils.findEntry(info.classList, meta.class).each(function (entry) {\n          data.classes = entry.value;\n        });\n      }\n      if (info.hasImageCaption) {\n        if (isBoolean(meta.caption)) {\n          data.caption = meta.caption;\n        }\n      }\n      if (info.hasAdvTab) {\n        if (isString(meta.vspace)) {\n          data.vspace = meta.vspace;\n        }\n        if (isString(meta.border)) {\n          data.border = meta.border;\n        }\n        if (isString(meta.hspace)) {\n          data.hspace = meta.hspace;\n        }\n        if (isString(meta.borderstyle)) {\n          data.borderstyle = meta.borderstyle;\n        }\n      }\n    };\n    var formFillFromMeta = function (info, api) {\n      var data = api.getData();\n      var meta = data.src.meta;\n      if (meta !== undefined) {\n        var newData = deepMerge({}, data);\n        formFillFromMeta2(info, newData, meta);\n        api.setData(newData);\n      }\n    };\n    var calculateImageSize = function (helpers, info, state, api) {\n      var data = api.getData();\n      var url = data.src.value;\n      var meta = data.src.meta || {};\n      if (!meta.width && !meta.height && info.hasDimensions) {\n        helpers.imageSize(url).get(function (result) {\n          result.each(function (size) {\n            if (state.open) {\n              api.setData({ dimensions: size });\n            }\n          });\n        });\n      }\n    };\n    var updateImagesDropdown = function (info, state, api) {\n      var data = api.getData();\n      var image = ListUtils.findEntry(info.imageList, data.src.value);\n      state.prevImage = image;\n      api.setData({\n        images: image.map(function (entry) {\n          return entry.value;\n        }).getOr('')\n      });\n    };\n    var changeSrc = function (helpers, info, state, api) {\n      addPrependUrl(info, api);\n      formFillFromMeta(info, api);\n      calculateImageSize(helpers, info, state, api);\n      updateImagesDropdown(info, state, api);\n    };\n    var changeImages = function (helpers, info, state, api) {\n      var data = api.getData();\n      var image = ListUtils.findEntry(info.imageList, data.images);\n      image.each(function (img) {\n        var updateAlt = data.alt === '' || state.prevImage.map(function (image) {\n          return image.text === data.alt;\n        }).getOr(false);\n        if (updateAlt) {\n          if (img.value === '') {\n            api.setData({\n              src: img,\n              alt: state.prevAlt\n            });\n          } else {\n            api.setData({\n              src: img,\n              alt: img.text\n            });\n          }\n        } else {\n          api.setData({ src: img });\n        }\n      });\n      state.prevImage = image;\n      changeSrc(helpers, info, state, api);\n    };\n    var calcVSpace = function (css) {\n      var matchingTopBottom = css['margin-top'] && css['margin-bottom'] && css['margin-top'] === css['margin-bottom'];\n      return matchingTopBottom ? Utils.removePixelSuffix(String(css['margin-top'])) : '';\n    };\n    var calcHSpace = function (css) {\n      var matchingLeftRight = css['margin-right'] && css['margin-left'] && css['margin-right'] === css['margin-left'];\n      return matchingLeftRight ? Utils.removePixelSuffix(String(css['margin-right'])) : '';\n    };\n    var calcBorderWidth = function (css) {\n      return css['border-width'] ? Utils.removePixelSuffix(String(css['border-width'])) : '';\n    };\n    var calcBorderStyle = function (css) {\n      return css['border-style'] ? String(css['border-style']) : '';\n    };\n    var calcStyle = function (parseStyle, serializeStyle, css) {\n      return serializeStyle(parseStyle(serializeStyle(css)));\n    };\n    var changeStyle2 = function (parseStyle, serializeStyle, data) {\n      var css = Utils.mergeMargins(parseStyle(data.style));\n      var dataCopy = deepMerge({}, data);\n      dataCopy.vspace = calcVSpace(css);\n      dataCopy.hspace = calcHSpace(css);\n      dataCopy.border = calcBorderWidth(css);\n      dataCopy.borderstyle = calcBorderStyle(css);\n      dataCopy.style = calcStyle(parseStyle, serializeStyle, css);\n      return dataCopy;\n    };\n    var changeStyle = function (helpers, api) {\n      var data = api.getData();\n      var newData = changeStyle2(helpers.parseStyle, helpers.serializeStyle, data);\n      api.setData(newData);\n    };\n    var changeAStyle = function (helpers, info, api) {\n      var data = deepMerge(fromImageData(info.image), api.getData());\n      var style = getStyleValue(helpers.normalizeCss, toImageData(data));\n      api.setData({ style: style });\n    };\n    var changeFileInput = function (helpers, info, state, api) {\n      var data = api.getData();\n      api.block('Uploading image');\n      head(data.fileinput).fold(function () {\n        api.unblock();\n      }, function (file) {\n        var blobUri = domGlobals.URL.createObjectURL(file);\n        var uploader = Uploader({\n          url: info.url,\n          basePath: info.basePath,\n          credentials: info.credentials,\n          handler: info.handler\n        });\n        var finalize = function () {\n          api.unblock();\n          domGlobals.URL.revokeObjectURL(blobUri);\n        };\n        Utils.blobToDataUri(file).then(function (dataUrl) {\n          var blobInfo = helpers.createBlobCache(file, blobUri, dataUrl);\n          uploader.upload(blobInfo).then(function (url) {\n            api.setData({\n              src: {\n                value: url,\n                meta: {}\n              }\n            });\n            api.showTab('general');\n            changeSrc(helpers, info, state, api);\n            finalize();\n          }).catch(function (err) {\n            finalize();\n            helpers.alertErr(api, err);\n          });\n        });\n      });\n    };\n    var changeHandler = function (helpers, info, state) {\n      return function (api, evt) {\n        if (evt.name === 'src') {\n          changeSrc(helpers, info, state, api);\n        } else if (evt.name === 'images') {\n          changeImages(helpers, info, state, api);\n        } else if (evt.name === 'alt') {\n          state.prevAlt = api.getData().alt;\n        } else if (evt.name === 'style') {\n          changeStyle(helpers, api);\n        } else if (evt.name === 'vspace' || evt.name === 'hspace' || evt.name === 'border' || evt.name === 'borderstyle') {\n          changeAStyle(helpers, info, api);\n        } else if (evt.name === 'fileinput') {\n          changeFileInput(helpers, info, state, api);\n        }\n      };\n    };\n    var closeHandler = function (state) {\n      return function () {\n        state.open = false;\n      };\n    };\n    var makeDialogBody = function (info) {\n      if (info.hasAdvTab || info.hasUploadUrl || info.hasUploadHandler) {\n        var tabPanel = {\n          type: 'tabpanel',\n          tabs: flatten([\n            [MainTab.makeTab(info)],\n            info.hasAdvTab ? [AdvTab.makeTab(info)] : [],\n            info.hasUploadTab && (info.hasUploadUrl || info.hasUploadHandler) ? [UploadTab.makeTab(info)] : []\n          ])\n        };\n        return tabPanel;\n      } else {\n        var panel = {\n          type: 'panel',\n          items: MainTab.makeItems(info)\n        };\n        return panel;\n      }\n    };\n    var makeDialog = function (helpers) {\n      return function (info) {\n        var state = createState(info);\n        return {\n          title: 'Insert/Edit Image',\n          size: 'normal',\n          body: makeDialogBody(info),\n          buttons: [\n            {\n              type: 'cancel',\n              name: 'cancel',\n              text: 'Cancel'\n            },\n            {\n              type: 'submit',\n              name: 'save',\n              text: 'Save',\n              primary: true\n            }\n          ],\n          initialData: fromImageData(info.image),\n          onSubmit: helpers.onSubmit(info),\n          onChange: changeHandler(helpers, info, state),\n          onClose: closeHandler(state)\n        };\n      };\n    };\n    var submitHandler = function (editor) {\n      return function (info) {\n        return function (api) {\n          var data = deepMerge(fromImageData(info.image), api.getData());\n          editor.undoManager.transact(function () {\n            insertOrUpdateImage(editor, toImageData(data));\n          });\n          editor.editorUpload.uploadImagesAuto();\n          api.close();\n        };\n      };\n    };\n    var imageSize = function (editor) {\n      return function (url) {\n        return FutureResult.nu(function (completer) {\n          Utils.getImageSize(editor.documentBaseURI.toAbsolute(url), function (data) {\n            var result = data.map(function (dimensions) {\n              return {\n                width: String(dimensions.width),\n                height: String(dimensions.height)\n              };\n            });\n            completer(result);\n          });\n        });\n      };\n    };\n    var createBlobCache = function (editor) {\n      return function (file, blobUri, dataUrl) {\n        return editor.editorUpload.blobCache.create({\n          blob: file,\n          blobUri: blobUri,\n          name: file.name ? file.name.replace(/\\.[^\\.]+$/, '') : null,\n          base64: dataUrl.split(',')[1]\n        });\n      };\n    };\n    var alertErr = function (editor) {\n      return function (api, message) {\n        editor.windowManager.alert(message, api.close);\n      };\n    };\n    var normalizeCss$1 = function (editor) {\n      return function (cssText) {\n        return normalizeCss(editor, cssText);\n      };\n    };\n    var parseStyle = function (editor) {\n      return function (cssText) {\n        return editor.dom.parseStyle(cssText);\n      };\n    };\n    var serializeStyle = function (editor) {\n      return function (stylesArg, name) {\n        return editor.dom.serializeStyle(stylesArg, name);\n      };\n    };\n    var Dialog = function (editor) {\n      var helpers = {\n        onSubmit: submitHandler(editor),\n        imageSize: imageSize(editor),\n        createBlobCache: createBlobCache(editor),\n        alertErr: alertErr(editor),\n        normalizeCss: normalizeCss$1(editor),\n        parseStyle: parseStyle(editor),\n        serializeStyle: serializeStyle(editor)\n      };\n      var open = function () {\n        return collect(editor).map(makeDialog(helpers)).get(function (spec) {\n          editor.windowManager.open(spec);\n        });\n      };\n      return { open: open };\n    };\n\n    var register = function (editor) {\n      editor.addCommand('mceImage', Dialog(editor).open);\n    };\n    var Commands = { register: register };\n\n    var hasImageClass = function (node) {\n      var className = node.attr('class');\n      return className && /\\bimage\\b/.test(className);\n    };\n    var toggleContentEditableState = function (state) {\n      return function (nodes) {\n        var i = nodes.length;\n        var toggleContentEditable = function (node) {\n          node.attr('contenteditable', state ? 'true' : null);\n        };\n        while (i--) {\n          var node = nodes[i];\n          if (hasImageClass(node)) {\n            node.attr('contenteditable', state ? 'false' : null);\n            global$5.each(node.getAll('figcaption'), toggleContentEditable);\n          }\n        }\n      };\n    };\n    var setup = function (editor) {\n      editor.on('PreInit', function () {\n        editor.parser.addNodeFilter('figure', toggleContentEditableState(true));\n        editor.serializer.addNodeFilter('figure', toggleContentEditableState(false));\n      });\n    };\n    var FilterContent = { setup: setup };\n\n    var register$1 = function (editor) {\n      editor.ui.registry.addToggleButton('image', {\n        icon: 'image',\n        tooltip: 'Insert/edit image',\n        onAction: Dialog(editor).open,\n        onSetup: function (buttonApi) {\n          return editor.selection.selectorChangedWithUnbind('img:not([data-mce-object],[data-mce-placeholder]),figure.image', buttonApi.setActive).unbind;\n        }\n      });\n      editor.ui.registry.addMenuItem('image', {\n        icon: 'image',\n        text: 'Image...',\n        onAction: Dialog(editor).open\n      });\n      editor.ui.registry.addContextMenu('image', {\n        update: function (element) {\n          return isFigure(element) || isImage(element) && !Utils.isPlaceholderImage(element) ? ['image'] : [];\n        }\n      });\n    };\n    var Buttons = { register: register$1 };\n\n    function Plugin () {\n      global$1.add('image', function (editor) {\n        FilterContent.setup(editor);\n        Buttons.register(editor);\n        Commands.register(editor);\n      });\n    }\n\n    Plugin();\n\n}(window));\n"]}