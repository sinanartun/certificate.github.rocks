{"version":3,"sources":["table/plugin.js"],"names":["domGlobals","Cell","initial","value","get","set","v","clone","noop","compose","fa","fb","args","_i","arguments","length","apply","constant","identity","x","curry","fn","initialArgs","restArgs","all","concat","not","f","never","always","none","NONE","eq","o","isNone","call","thunk","id","n","me","fold","s","is","isSome","getOr","getOrThunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","Object","freeze","some","a","constant_a","self","elementEq","b","Option","from","global","tinymce","util","Tools","resolve","isType","type","t","Array","prototype","isPrototypeOf","constructor","name","String","typeOf","isString","isArray","isBoolean","isFunction","isNumber","nativeSlice","slice","nativeIndexOf","indexOf","nativePush","push","contains","xs","ts","pred","i","len","r","foldr","acc","eachr","foldl","find","findIndex","flatten","output","reverse","keys","hasOwnProperty","each$1","obj","props","k","map$1","tupleMap","tuple","key","has","Immutable","fields","values","struct","sort","arr","reqMessage","required","join","unsuppMessage","unsupported","validateStrArr","label","array","checkDupes","everything","sorted","d","MixedBag","optional","keys$1","req","opt","COMMENT","Node","ATTRIBUTE_NODE","CDATA_SECTION_NODE","COMMENT_NODE","DOCUMENT","DOCUMENT_NODE","ELEMENT","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT_NODE","ELEMENT_NODE","TEXT","TEXT_NODE","PROCESSING_INSTRUCTION_NODE","ENTITY_REFERENCE_NODE","ENTITY_NODE","NOTATION_NODE","window","Function","element","dom","nodeName","toLowerCase","nodeType","isType$1","isComment","isElement","isText","rawSet","console","error","setAttribute","setAll","attrs","get$1","getAttribute","has$1","hasAttribute","remove","removeAttribute","attributes","attr","checkRange","str","substr","start","contains$1","startsWith","prefix","isSupported","style","getPropertyValue","cached","called","fromDom","node","Element","fromHtml","html","scope","div","document","createElement","innerHTML","hasChildNodes","childNodes","fromTag","tag","fromText","text","createTextNode","fromPoint","docElm","y","doc","elementFromPoint","inBody","parentNode","ownerDocument","body","getBody","internalSet","property","setProperty","set$1","setAll$1","css","get$2","getComputedStyle","getUnsafeProperty","getRaw","raw","remove$1","removeProperty","internalRemove","replace","compareDocumentPosition","match","DOCUMENT_POSITION_CONTAINED_BY","__assign","assign","p","this","unknown","nu","major","minor","Version","detect","versionRegexes","agent","cleanedAgent","regexes","test","firstMatch","group","Number","find$1","isBrowser","current","nu$1","info","version","isEdge","isChrome","isIE","isOpera","isFirefox","isSafari","Browser","edge","chrome","ie","opera","firefox","safari","isOS","nu$2","isWindows","isiOS","isAndroid","isOSX","isLinux","isSolaris","isFreeBSD","OperatingSystem","windows","ios","android","linux","osx","solaris","freebsd","detect$1","candidates","userAgent","candidate","search","UaString","browsers","browser","oses","os","normalVersionRegex","checkContains","target","uastring","PlatformInfo","PlatformDetection","mediaMatch","deviceType","isiPad","isiPhone","isMobile","isTouch","isTablet","isPhone","iOSwebview","isDesktop","isWebView","DeviceType","platform","navigator","query","matchMedia","matches","detect$3","ELEMENT$1","DOCUMENT$1","selector","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","bypassSelector","childElementCount","e1","e2","contains$2","d1","d2","is$1","owner","parent","parents","isRoot","stop","ret","rawParent","prevSibling","previousSibling","nextSibling","children","child","index","cs","before","marker","insertBefore","after","append","prepend","firstChild","appendChild","wrap","wrapper","after$1","elements","e","append$1","empty","textContent","rogue","remove$2","removeChild","unwrap","children$1","grid","address","detail","detailnew","extended","rowdata","elementnew","rowdatanew","rowcells","rowdetails","bounds","descendants","predicate","result","ancestors$1","ancestors","children$2","descendants$1","base","querySelectorAll","ClosestOrAncestor","ancestor","el","ancestor$1","child$2","child$1","descendant$1","querySelector","one","closest$1","filterFirstLayer","LayerSelector","firstLayer","lookup","tags","elm","neighbours","neighbourCells","neighbourRows","parseInt","TableLookup","cell","firstCell","cells","table","row","rows","notCell","rowProp","colProp","rowsCount","cols","DetailsList","parentSection","parentName","rowspan","colspan","example","section","column","filterItems","warehouse","Warehouse","generate","list","access","maxRows","maxColumns","details","currentRow","j","cc","newpos","Math","max","grid$1","getAt","findItem","item","comparator","filtered","justCells","w","statsStruct","makeCell","seenSelected","rowIndex","td","CopySelected","selectedSelector","isSelected","house","stats","totalColumns","columns","minRow","minCol","maxRow","maxCol","startRow","endRow","startCol","endCol","findSelectedStats","unselectedCells","totalRows","fillInGaps","emptyRows","clean","api","getOption","nodeValue","NodeValue","get$3","set$2","getEnd","elementsWithCursorPosition","isCursorPosition","trim","first","descend","child_1","res","last$1","descendantRtl","clone$1","original","isDeep","cloneNode","shallow","deep","copy$1","shallowAs","cloneChildren","createCell","replica","pasteReplace","newRow","TableFill","cellOperations","mutate","formatsToClone","prev","source","sourceDom","targetDom","docu","formats","lastNode","oldCell","newCell","firstText","formatSelector","last","clonedFormat","cloneFormats","cssText","gap","paste","isWithin","finishCol","finishRow","CellBounds","leftEdge","rightEdge","topEdge","bottomEdge","isRect","detailIsWithin","getAnyBox","startCell","finishCell","startCoords","finishCoords","sc","fc","detailA","detailB","min","CellGroup","CellFinder","finish","inside","innerCell","c1","c2","getWarehouse","TablePositions","deltaRow","deltaColumn","firstTable","lastTable","optStartCell","optLastCell","lastCell","TagBoundaries","DomUniverse","up","closest","down","styles","copyTo","destination","as","insert","afterAll","appendAll","create","comparePosition","other","getText","setText","isBoundary","isEmptyTag","leftRight","brokenPath","bisect","universe","ind","unsafeOne","look","head","tail","commonElement","end","eq$1","ancestors$2","ps1","ps2","prune","path","pruned1","pruned2","shared","firstpath","secondpath","Parent","sharedOne","all$1","subset","ancs","common","finder","ps","topDown","startIndex","endIndex","sIndex","eIndex","unsafeSubset","breakToLeft","parts","prior","breakToRight","second","breakPath","isTop","breaker","next","splits","fallback","breakage","extra","left","right","nextChild","DomParent","_universe","u","c","Identified","lookupTable","container","identify","getIsRoot","rootTable","boxes","startTable","finishTable","ancestorCells","lca","lcaTable","finishAncestorCells","startAncestorCells","CellSelection","retrieve","sels","shiftSelection","firstSelectedSelector","lastSelectedSelector","box","getLast","identified","expandTo","getEdges","tbl","TableSelection","edges","firstAncestor","lastAncestor","fA","lA","selected","Ephemera","attributeSelector","firstSelected","lastSelected","Adt","cases","constructors","adt","acase","count","argLength","branches","branchKeys","reqKey","log","params","type$1","multiple","single","SelectionTypes","cata","subject","onNone","onMultiple","onSingle","selection","selections","CellOperations","_env","noMenu","mergable","unmergable","paste$1","TableTargets","forMenu","pasteRows","clipboard","generators","Clipboard","registerEvents","editor","actions","cellSelection","on","preventDefault","extractSelected","content","format","innerText","getTextContent","serializer","serialize","serializeElements","getParent","getStart","domCell","getDoc","targets","pasteCells","rng","setRng","focus","clear","Dimension","getOffset","parseFloat","aggregate","properties","val","isNaN","h","getOuter","cumulativeInclusions","api$1","getBoundingClientRect","height","offsetHeight","get$4","api$2","offsetWidth","get$5","getOuter$1","platform$1","getProp","px","num","toNumber","RuntimeSize","paddingTop","paddingBottom","borderTop","borderBottom","getCalculatedHeight","genericSizeRegex","percentageBasedSizeRegex","pixelBasedSizeRegex","setHeight","amount","normalizePixelSize","getter","setter","suffix","number","newSize","total","floor","convert","getTotalHeight","getHeightValue","getSpan","getRawWidth","width","normalizePercentageWidth","cellWidth","tableSize","pixelWidth","Sizes","setPixelWidth","setPercentageWidth","getPixelWidth","pixelMatch","exec","percentMatch","normalizePixelWidth","choosePixelSize","getPercentageWidth","intWidth","choosePercentageSize","getGenericWidth","unit","setGenericWidth","getHeight","get$6","CellMutations","main","newWidth","top","translate","Position","firstDefinedOrZero","absolute","win","defaultView","documentElement","offsetLeft","offsetTop","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","viewport","boxPosition","rowInfo","colInfo","rtlEdge","ltrEdge","getLeftEdge","getRightEdge","getTop","getTopEdge","getBottomEdge","findPositions","getInnerEdge","getOuterEdge","lines","cellOption","lastLine","BarPositions","delta","positions","optElements","rtl","step","ltr","ResizeDirection","TableDirection","directionAt","auto","isRtl","merger","TableGridSize","input","cat","findMap","setIfNot","ignore","Redraw","newRows","newCells","renderOrRemoveSection","gridSection","sectionName","tb","isNew","tr","renderSection","removeSection","headSection","bodySection","footSection","clonedCell","read","split","supports","classList","add$1","clazz","add","remove$4","remove$3","add$2","cleanClass","get$7","has$2","range","deduce","rest","aa","extras","abs","decide","getBlock","isSingle","getFallback","inBlock","Blocks","rowsArr","col","namespace","dashNamespace","Styles","Bar","blocker","position","data-column","role","data-row","resizeBar","resizeRowBar","resizeColBar","destroy","wire","previous","drawBar","origin","cpOption","cp","bar","refreshGrid","hdirection","vdirection","rowPositions","tableWidth","rowBar","refreshRow","colPositions","tableHeight","colBar","refreshCol","each$2","bars","Bars","setCells","gridRow","getCell","GridRow","addCell","mutateCell","getCellElement","mapCells","cellLength","findDiff","comp","TableGrid","restOfRow","getRow","endColIndex","restOfColumn","getColumn","endRowIndex","Transitions","seen","ri","ci","updateSeen","rowCells","deriveRows","rendered","findRow","toDetailList","findInWarehouse","run","operation","extract","adjustment","postAction","genWrappers","direction","model","fromWarehouse","cursor","out","newElements","onCell","onPasteRows","lc","onCells","isValue","isError","_","onValue","mapError","toOption","message","onError","Result","fromOption","err","fill","generator","rowFill","repititions","repeat","_row","colFill","Fitment","startAddress","gridA","gridB","rowRemainder","colRemainder","colRequired","rowRequired","rowDelta","colDelta","colLengthA","colLengthB","fillCols","MergingOperations","substitution","isToReplace","currentCell","uniqueCells","replacement","_loop_1","_loop_2","sub","isSpanning","matching","TableMerge","fittedGrid","mergeTables","fittedNewGrid","secondDelta","fittedOldGrid","ModificationOperations","between","ex","exampleRow","exampleCol","replaceIn","isTarget","notStartRow","colIndex","notStartColumn","TransformOperations","targetRow","only","middle","ColumnContext","Deltas","context","neighbours$1","zero","onChange","newNext","minCellWidth","newThis","diffx","onLeft","singleColumnWidth","_prev","size","getSpan$1","CellUtils","hasColspan","hasRowspan","minWidth","minHeight","getInt","getRaw$1","getRawW","getRawH","getWidthFrom","getWidth","backups","deduced","getDeduced","getHeightFrom","ColumnSizes","getRawWidths","getPixelWidths","getPercentageWidths","getPixelHeights","getRawHeights","measures","Recalculations","widths","heights","pixelSize","getCellDelta","getWidths","setElementWidth","setTableWidth","newWidths","_delta","chooseSize","floatWidth","_newWidths","change","percentageSize","fallbackWidth","TableSize","getWarehouse$1","getTableWarehouse","Adjustments","deltas","dx","newSizes","newHeights","dy","newCellSizes","newRowSizes","baseWith","handleUnsupported","invalidKeys","validate","incorrect","invalidTypeMessage","handleExact","exactly","verifyGenerators","elementToData","Generators","toData","nuFrom","data","recent","getOrInit","makeNew","replaceOrInit","combine","blockList","isBlock","tagName","Structure","universe$1","DomStructure","TableContent","isBr","markCell","rightSiblingIsBlock","rightSibling","contents","advancedBr","outcome","elementFromGrid","findIn","bundle","uniqueRows","currentDetail","uniqueColumns","gridifyRows","pasteDetails","wh","resize","TableOperations","insertRowBefore","targetIndex","newGrid","insertRowsBefore","newG","insertRowAfter","insertRowsAfter","insertColumnBefore","insertColumnsBefore","insertColumnAfter","insertColumnsAfter","splitCellIntoColumns","splitCellIntoRows","eraseColumns","_comparator","_genWrappers","eraseRows","makeColumnHeader","unmakeColumnHeader","makeRowHeader","unmakeRowHeader","mergeCells","_warehouse","unmergeCells","nuGrid","pasteRowsBefore","mergedGrid","pasteRowsAfter","getBody$1","getPixelWidth$1","getPixelHeight","addSizeSuffix","removeDataStyle","dataStyleCells","ltr$1","rtl$1","Direction","getDirection","defaultStyles","border-collapse","defaultAttributes","border","getDefaultAttributes","getParam","getDefaultStyles","hasTabNavigation","hasAdvancedCellTab","hasAdvancedRowTab","hasAdvancedTableTab","shouldStyleWithCss","getTableClassList","isPixelsForced","getCloneElements","cloneElements","fireNewRow","fire","fireNewCell","fireObjectResizeStart","fireObjectResized","fireTableSelectionChange","otherCells","fireTableSelectionClear","TableActions","lazyWire","isTableBody","execute","guard","createRng","setStart","setEnd","deleteRow","deleteColumn","CopyRows","selectedCells","slicedGrid","slicedDetails","global$1","Styles$1","formatter","firstChildStyle","elms","currentStyle","getStyle","checkChildren","select","extractAdvancedStyles","rgbToHex","toHex","borderwidth","borderstyle","bordercolor","backgroundcolor","getAlignment","alignments","formatName","dataName","alignmentData","matchNode","getHAlignment","getVAlignment","Helpers","inputList","itemCallback","startItems","appendItems","menuItem","title","menu","baseData","comparisonData","items","itemValue","itemKey","comparisonValue","dialogName","advTabItems","hasAdvTableTab","getAttrib","cellspacing","cellpadding","optBorderWidth","getBorder","caption","class","align","celltype","spacing","padding","borderWidth","advStyle","borderStyle","borderColor","bgColor","extractAdvancedStyleData","children$3","CellDialogGeneralTab","rowClassList","getCellClassList","classes","textStyle","getCssText","block","getClassList","classlist","DomModifier","normal","setAttrib","setStyle","prop","ifTruthy","updateSimpleProps","modifiers","updateAdvancedProps","applyToSingle","cellElm","rename","halign","valign","applyToMultiple","onSubmitCellForm","getData","close","undoManager","transact","CellDialog","cellsData","dialogTabPanel","tabs","dialogPanel","windowManager","open","buttons","primary","initialData","onSubmit","formChildren","RowDialogGeneralTab","getRowClassList","getClassList$1","onSubmitRowForm","oldData","createModifier","rowElm","toType","tableElm","oldParentElm","parentElm","insertAfter","switchRowType","modifier","updateAdvancedProps$1","RowDialog","rowsData","hasOwnProperty$1","merge$3","old","objects","curObject","global$2","DefaultRenderOptions","percentages","render$1","rowHeaders","columnHeaders","renderOpts","tbody","trs","placeCaretInCell","collapse","InsertTable","options","get$8","insertContent","fireEvents","selectFirstCellInTable","TableDialogGeneralTab","hasClasses","insertNewTable","rowColCountItems","inputMode","appearanceItems","hasAppearanceOptions","classListItem","styleTDTH","onSubmitTableForm","captionElm","border-width","border-color","serializeStyle","setAttribs","applyDataToElement","addVisual","TableDialog","generalPanel","dialogBody","getSelectionStartFromSelector","getSelectionStartCell","getSelectionStartCellOrCaption","each$3","Commands","registerCommands","clipboardRows","getTableFromCell","getSize","actOnSelection","beforeSize","oldSize","resizeChange","copyRowSelection","pasteOnSelection","clonedRows","mceTableSplitCells","mceTableMergeCells","mceTableInsertRowBefore","mceTableInsertRowAfter","mceTableInsertColBefore","mceTableInsertColAfter","mceTableDeleteCol","mceTableDeleteRow","mceTableCutRow","mceTableCopyRow","mceTablePasteRowBefore","mceTablePasteRowAfter","mceTableDelete","cellOrCaption","isEmpty","setContent","setCursorLocation","nodeChanged","func","addCommand","mceInsertTable","mceTableProps","mceTableRowProps","mceTableCellProps","ResizeWire","view","editable","Event","handlers","handler","unbind","trigger","event","Events","typeDefs","registry","fromRawEvent","rawEvent","stopPropagation","prevent","kill","mkEvent","clientX","clientY","binder","useCapture","wrapped","handle","addEventListener","removeEventListener","filter$1","bind$2","bind$1","Styles$2","DragMode","DragSink","DragApi","MouseDrag","compare","sink","dragApi","settings","layerClass","Blocker","mdown","forceDrop","mup","drop","mmove","move","mout","delayDrop","mutation","InDrag","events","onEvent","mode","update","reset","Movement","noDragState","inDragState","dragState","off","isOn","Dragging","rate","timer","active","movement","throttledDrop","cancel","clearTimeout","throttle","setTimeout","runIfActive","go","Dragger","BarMutation","drag","delegate","Mutation","xDelta","yDelta","isContentEditableTrue","resizeBarDragging","BarManager","resizing","hoverTable","getResizer","_dataRow","_dataCol","currentCol","getDelta","dir","adjustHeight","adjustWidth","startAdjust","mousedown","findClosestEditableTable","findClosestContentEditable","mouseover","refresh","hideBars","showBars","TableResize","manager","beforeResize","afterResize","startDrag","TableWire","inline","margin","createContainer","calculatePercentageWidth","getResizeHandler","startW","startRawW","selectionRng","isTable","lazyResize","rawWire","objectResizing","hasObjectResizing","hasTableResizeBars","sz","getRng","rawTable","targetElm","tableHasPercentage","isPercentagesForced","tablePercentage","enforcePercentage","percentW","targetPercentW","newCellSizes_1","newCellSize","readonly","adt$1","CellLocation","detect$4","CellNavigation","SimRange","adt$2","Situ","onBefore","onOn","onAfter","situ","adt$3","domRange","relative","exact","Selection","exactFromRange","simRange","soffset","foffset","getWin","startContainer","startSitu","finishSitu","getStart$1","selectNodeContentsUsing","selectNodeContents","relativeToNative","createRange","setStartBefore","setStartAfter","setEndBefore","setEndAfter","setFinish","exactToNative","toRect","rect","bottom","adt$4","fromRange","startOffset","endContainer","endOffset","diagnose","ranges","collapsed","rev","doDiagnose","getRanges","asLtrRange","inRect","locateOffset","textnode","rangeForOffset","offset","rectForOffset","maxX","curDeltaX","searchForPoint","locateNode","selectNode","rects","getClientRects","locate","nodes","searchInChildren","getCollapseDirection","createCollapsedNode","collapseDirection","locateInElement","cursorRange","locateInEmpty","searchTextNodes","boundedX","boundedY","locate$1","availableSearch","caretPositionFromPoint","pos","offsetNode","caretRangeFromPoint","beforeSpecial","name$1","preprocessRelative","preprocessExact","after$3","makeRange","same","doSetNativeRange","getSelection","removeAllRanges","addRange","doSetRange","setRangeFromRelative","setBaseAndExtent","extend","setLegacyRtlRange","toNative","getDomRange","preprocess","doGetExact","anchor","anchorNode","focusNode","anchorOffset","focusOffset","rangeCount","firstRng","getRangeAt","lastRng","readRange","setToElement","get$a","sel","getExact","getFirstRect$1","getFirstRect","getAtPoint","fromPoint$1","global$3","forward","backward","getCellFirstCursorPosition","getNewRowCursorPosition","rootElements","TabContext","keyCode","TAB","body_1","isRoot_1","shiftKey","Response","Situs","Util","convertToRange","makeSitus","detect$5","selectRange","cellSel","KeySelection","sync","annotations","newSels","clearBeforeUpdate","traverse","backtrack","_direction","transition","sidestep","advance","sibling","successors","go$1","rules","succ","rule","Walkers","hone","isLeaf","seekLeft","seekRight","universe$2","before$4","before$3","after$5","after$4","point","adt$5","success","failedUp","failedDown","isRow","BeforeAfter","verify","bridge","beforeOffset","afterOffset","failure","afterCell","beforeCell","beforeBounds","getRect","afterBounds","isOverlapping","_sharedRow","onSuccess","onFailedUp","onFailedDown","inParent","gatherer","cand","gather","handleParent","findBr","br","adjacent","BrTags","handleBr","tgt","analysis","nu$3","Carets","moveUp","caret","moveDown","moveBottomTo","moveTopTo","getBottom","toCaret","getElemBox","Rectangles","getRangedRect","getPartialBox","adt$6","retry","inOutsideBlock","isOutside","upMovement","adjuster","guessBox","higherCaret","downMovement","lowerCaret","adjustTil","numRetries","isAtTable","adjustForTable","situsFromPoint","guess","newCaret","moved","adjusted","getInnerHeight","checkScroll","scrollBy","Retries","tryUp","tryDown","ieTryUp","ieTryDown","getJumpSize","platform$2","scan","tryCursor","situs","fromSitus","tryAgain","tryAt","otherRetry","ieRetry","TableKeys","brNeighbour","findSpot","spot","detection","inSameTable","simulate","VerticalMovement","precheck","seekLeft$1","lastOffset","seekRight$1","findCell","KeyDirection","isKey","keycode","isUp","isDown","SelectionKeys","isBackward","isForward","isNavigation","Rect","sr","WindowBridge","exactAdt","clearSelection","setSelection","setExact","setRelativeSelection","setRelative","selectContents","innerHeight","getScrollY","_DOC","by","rc","platform$3","InputHandlers","mouse","clearState","mouseup","_event","MouseSelection","keyboard","clearToNavigate","keydown","realEvent","which","attempts","keyup","external","remove$7","remove$5","SelectionAnnotation","byClass","ephemera","addSelectionClass","removeSelectionClasses","byAttr","onSelection","onClear","removeSelectionAttributes","addSelectionAttribute","OtherCells","getOtherCells","upOrLeftCells","upGrid","upDetails","slicedCells","getUpOrLeftCells","downOrRightCells","downGrid","downDetails","getDownOrRightCells","hasInternalTarget","Selections","getSelectionTargets","changeHandlers","findTargets","resetTargets","onSetup","isDisabled","setDisabled","onSetupTable","onSetupCellOrRow","onSetupMergeable","onSetupUnmergeable","Buttons","addButtons","selectionTargets","ui","addMenuButton","tooltip","icon","fetch","callback","cmd","command","execCommand","addButton","onAction","addToolbars","toolbar","getToolbar","addContextToolbar","MenuItems","addMenuItems","insertTableAction","_a","numRows","numColumns","tableProperties","deleteTable","rowItems","getSubmenuItems","columnItems","cellItems","hasTableGrid","addMenuItem","addNestedMenuItem","fancytype","addContextMenu","getApi","resizeHandler","menuItems","insertTable","setClipboardRows","sugarRows","getClipboardRows","Plugin","handlerStruct","mouseHandlers","keyHandlers","lastTarget","lastTimeStamp","handleResponse","response","hasShiftKey","ns","wrappedEvent","wrapEvent","isMouseEvent","isLeftMouse","button","mouseDown","mouseOver","mouseUp","doubleTap","touchEnd","lT","lTS","timeStamp","CellSelection$1","addTempAttr"],"mappings":"CAQC,SAAUA,GACP,aAEA,IAAIC,EAAO,SAAUC,GACnB,IAAIC,EAAQD,EACRE,EAAM,WACR,OAAOD,GAQT,MAAO,CACLC,IAAKA,EACLC,IARQ,SAAUC,GAClBH,EAAQG,GAQRC,MANU,WACV,OAAON,EAAKG,QASZI,EAAO,aAEPC,EAAU,SAAUC,EAAIC,GAC1B,OAAO,WAEL,IADA,IAAIC,EAAO,GACFC,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCD,EAAKC,GAAMC,UAAUD,GAEvB,OAAOH,EAAGC,EAAGK,MAAM,KAAMJ,MAGzBK,EAAW,SAAUd,GACvB,OAAO,WACL,OAAOA,IAGPe,EAAW,SAAUC,GACvB,OAAOA,GAET,SAASC,EAAMC,GAEb,IADA,IAAIC,EAAc,GACTT,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCS,EAAYT,EAAK,GAAKC,UAAUD,GAElC,OAAO,WAEL,IADA,IAAIU,EAAW,GACNV,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCU,EAASV,GAAMC,UAAUD,GAE3B,IAAIW,EAAMF,EAAYG,OAAOF,GAC7B,OAAOF,EAAGL,MAAM,KAAMQ,IAG1B,IAAIE,EAAM,SAAUC,GAClB,OAAO,WAEL,IADA,IAAIf,EAAO,GACFC,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCD,EAAKC,GAAMC,UAAUD,GAEvB,OAAQc,EAAEX,MAAM,KAAMJ,KAQtBgB,EAAQX,GAAS,GACjBY,EAASZ,GAAS,GAElBa,EAAO,WACT,OAAOC,GAELA,EAAO,WACT,IAAIC,EAAK,SAAUC,GACjB,OAAOA,EAAEC,UAEPC,EAAO,SAAUC,GACnB,OAAOA,KAELC,EAAK,SAAUC,GACjB,OAAOA,GAELC,EAAK,CACPC,KAAM,SAAUF,EAAGG,GACjB,OAAOH,KAETI,GAAId,EACJe,OAAQf,EACRM,OAAQL,EACRe,MAAOP,EACPQ,WAAYV,EACZW,SAAU,SAAUC,GAClB,MAAM,IAAIC,MAAMD,GAAO,oCAEzBE,UAAWhC,EAAS,MACpBiC,eAAgBjC,OAASkC,GACzBC,GAAIf,EACJgB,QAASlB,EACTmB,IAAKxB,EACLyB,KAAM/C,EACNgD,KAAM1B,EACN2B,OAAQ7B,EACR8B,OAAQ7B,EACR8B,OAAQ7B,EACR8B,OAAQ5B,EACR6B,QAAS7B,EACT8B,QAAS,WACP,MAAO,IAETC,SAAU9C,EAAS,WAKrB,OAHI+C,OAAOC,QACTD,OAAOC,OAAO1B,GAETA,EA1CE,GA4CP2B,EAAO,SAAUC,GACnB,IAAIC,EAAanD,EAASkD,GACtBE,EAAO,WACT,OAAO9B,GAELiB,EAAO,SAAU7B,GACnB,OAAOA,EAAEwC,IAEP5B,EAAK,CACPC,KAAM,SAAUF,EAAGG,GACjB,OAAOA,EAAE0B,IAEXzB,GAAI,SAAUpC,GACZ,OAAO6D,IAAM7D,GAEfqC,OAAQd,EACRK,OAAQN,EACRgB,MAAOwB,EACPvB,WAAYuB,EACZtB,SAAUsB,EACVnB,UAAWmB,EACXlB,eAAgBkB,EAChBhB,GAAIiB,EACJhB,QAASgB,EACTf,IAAK,SAAU3B,GACb,OAAOuC,EAAKvC,EAAEwC,KAEhBZ,KAAM,SAAU5B,GACdA,EAAEwC,IAEJX,KAAMA,EACNC,OAAQD,EACRE,OAAQF,EACRG,OAAQ,SAAUhC,GAChB,OAAOA,EAAEwC,GAAK5B,EAAKR,GAErB+B,QAAS,WACP,MAAO,CAACK,IAEVJ,SAAU,WACR,MAAO,QAAUI,EAAI,KAEvBP,OAAQ,SAAU3B,GAChB,OAAOA,EAAES,GAAGyB,IAEdN,QAAS,SAAU5B,EAAGqC,GACpB,OAAOrC,EAAEO,KAAKZ,EAAO,SAAU2C,GAC7B,OAAOD,EAAUH,EAAGI,OAI1B,OAAOhC,GAKLiC,EAAS,CACXN,KAAMA,EACNpC,KAAMA,EACN2C,KANS,SAAUtE,GACnB,OAAOA,MAAAA,EAAwC4B,EAAOmC,EAAK/D,KAQzDuE,EAASC,QAAQC,KAAKC,MAAMC,QAAQ,yBAepCC,EAAS,SAAUC,GACrB,OAAO,SAAU7E,GACf,OAfS,SAAUgB,GACrB,GAAU,OAANA,EACF,MAAO,OAET,IAAI8D,SAAW9D,EACf,MAAU,WAAN8D,IAAmBC,MAAMC,UAAUC,cAAcjE,IAAMA,EAAEkE,aAAsC,UAAvBlE,EAAEkE,YAAYC,MACjF,QAEC,WAANL,IAAmBM,OAAOJ,UAAUC,cAAcjE,IAAMA,EAAEkE,aAAsC,WAAvBlE,EAAEkE,YAAYC,MAClF,SAEFL,EAIEO,CAAOrF,KAAW6E,IAGzBS,EAAWV,EAAO,UAClBW,EAAUX,EAAO,SACjBY,EAAYZ,EAAO,WACnBa,EAAab,EAAO,YACpBc,EAAWd,EAAO,UAElBe,EAAcZ,MAAMC,UAAUY,MAC9BC,EAAgBd,MAAMC,UAAUc,QAChCC,EAAahB,MAAMC,UAAUgB,KAI7BC,EAAW,SAAUC,EAAIlF,GAC3B,OAJyBmF,EAIPD,EAJWpB,EAIP9D,EAHf6E,EAAc7D,KAAKmE,EAAIrB,IAGF,EAJb,IAAUqB,EAAIrB,GAM3BxB,EAAS,SAAU4C,EAAIE,GACzB,IAAK,IAAIC,EAAI,EAAGC,EAAMJ,EAAGtF,OAAQyF,EAAIC,EAAKD,IAAK,CAE7C,GAAID,EADIF,EAAGG,GACCA,GACV,OAAO,EAGX,OAAO,GAELlD,EAAM,SAAU+C,EAAI1E,GAGtB,IAFA,IAAI8E,EAAMJ,EAAGtF,OACT2F,EAAI,IAAIxB,MAAMuB,GACTD,EAAI,EAAGA,EAAIC,EAAKD,IAAK,CAC5B,IAAIrF,EAAIkF,EAAGG,GACXE,EAAEF,GAAK7E,EAAER,EAAGqF,GAEd,OAAOE,GAELnD,EAAO,SAAU8C,EAAI1E,GACvB,IAAK,IAAI6E,EAAI,EAAGC,EAAMJ,EAAGtF,OAAQyF,EAAIC,EAAKD,IAAK,CAE7C7E,EADQ0E,EAAGG,GACNA,KASL7C,EAAS,SAAU0C,EAAIE,GAEzB,IADA,IAAIG,EAAI,GACCF,EAAI,EAAGC,EAAMJ,EAAGtF,OAAQyF,EAAIC,EAAKD,IAAK,CAC7C,IAAIrF,EAAIkF,EAAGG,GACPD,EAAKpF,EAAGqF,IACVE,EAAEP,KAAKhF,GAGX,OAAOuF,GAELC,EAAQ,SAAUN,EAAI1E,EAAGiF,GAI3B,OApBU,SAAUP,EAAI1E,GACxB,IAAK,IAAI6E,EAAIH,EAAGtF,OAAS,EAAGyF,GAAK,EAAGA,IAElC7E,EADQ0E,EAAGG,GACNA,GAcPK,CAAMR,EAAI,SAAUlF,GAClByF,EAAMjF,EAAEiF,EAAKzF,KAERyF,GAELE,EAAQ,SAAUT,EAAI1E,EAAGiF,GAI3B,OAHArD,EAAK8C,EAAI,SAAUlF,GACjByF,EAAMjF,EAAEiF,EAAKzF,KAERyF,GAELG,EAAO,SAAUV,EAAIE,GACvB,IAAK,IAAIC,EAAI,EAAGC,EAAMJ,EAAGtF,OAAQyF,EAAIC,EAAKD,IAAK,CAC7C,IAAIrF,EAAIkF,EAAGG,GACX,GAAID,EAAKpF,EAAGqF,GACV,OAAOhC,EAAON,KAAK/C,GAGvB,OAAOqD,EAAO1C,QAEZkF,EAAY,SAAUX,EAAIE,GAC5B,IAAK,IAAIC,EAAI,EAAGC,EAAMJ,EAAGtF,OAAQyF,EAAIC,EAAKD,IAAK,CAE7C,GAAID,EADIF,EAAGG,GACCA,GACV,OAAOhC,EAAON,KAAKsC,GAGvB,OAAOhC,EAAO1C,QAEZmF,EAAU,SAAUZ,GAEtB,IADA,IAAIK,EAAI,GACCF,EAAI,EAAGC,EAAMJ,EAAGtF,OAAQyF,EAAIC,IAAOD,EAAG,CAC7C,IAAKd,EAAQW,EAAGG,IACd,MAAM,IAAIxD,MAAM,oBAAsBwD,EAAI,6BAA+BH,GAE3EH,EAAWlF,MAAM0F,EAAGL,EAAGG,IAEzB,OAAOE,GAELlD,EAAO,SAAU6C,EAAI1E,GACvB,IAAIuF,EAAS5D,EAAI+C,EAAI1E,GACrB,OAAOsF,EAAQC,IAEbxD,EAAS,SAAU2C,EAAIE,GACzB,IAAK,IAAIC,EAAI,EAAGC,EAAMJ,EAAGtF,OAAQyF,EAAIC,IAAOD,EAAG,CAE7C,IAAmB,IAAfD,EADIF,EAAGG,GACCA,GACV,OAAO,EAGX,OAAO,GAELW,EAAU,SAAUd,GACtB,IAAIK,EAAIZ,EAAY3D,KAAKkE,EAAI,GAE7B,OADAK,EAAES,UACKT,GASLU,GAJSxB,EAAWV,MAAMT,OAAQS,MAAMT,KAIjCT,OAAOoD,MACdC,EAAiBrD,OAAOqD,eACxBC,EAAS,SAAUC,EAAK5F,GAE1B,IADA,IAAI6F,EAAQJ,EAAKG,GACRE,EAAI,EAAGhB,EAAMe,EAAMzG,OAAQ0G,EAAIhB,EAAKgB,IAAK,CAChD,IAAIjB,EAAIgB,EAAMC,GAEd9F,EADQ4F,EAAIf,GACPA,KAGLkB,EAAQ,SAAUH,EAAK5F,GACzB,OAAOgG,EAASJ,EAAK,SAAUpG,EAAGqF,GAChC,MAAO,CACLiB,EAAGjB,EACHlG,EAAGqB,EAAER,EAAGqF,OAIVmB,EAAW,SAAUJ,EAAK5F,GAC5B,IAAI+E,EAAI,GAKR,OAJAY,EAAOC,EAAK,SAAUpG,EAAGqF,GACvB,IAAIoB,EAAQjG,EAAER,EAAGqF,GACjBE,EAAEkB,EAAMH,GAAKG,EAAMtH,IAEdoG,GAELtG,EAAM,SAAUmH,EAAKM,GACvB,OAAOC,EAAIP,EAAKM,GAAOrD,EAAOC,KAAK8C,EAAIM,IAAQrD,EAAO1C,QAEpDgG,EAAM,SAAUP,EAAKM,GACvB,OAAOR,EAAelF,KAAKoF,EAAKM,IAG9BE,EAAY,WAEd,IADA,IAAIC,EAAS,GACJnH,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCmH,EAAOnH,GAAMC,UAAUD,GAEzB,OAAO,WAEL,IADA,IAAIoH,EAAS,GACJpH,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCoH,EAAOpH,GAAMC,UAAUD,GAEzB,GAAImH,EAAOjH,SAAWkH,EAAOlH,OAC3B,MAAM,IAAIiC,MAAM,mDAAqDgF,EAAOjH,OAAS,WAAakH,EAAOlH,OAAS,cAEpH,IAAImH,EAAS,GAIb,OAHA3E,EAAKyE,EAAQ,SAAU1C,EAAMkB,GAC3B0B,EAAO5C,GAAQrE,EAASgH,EAAOzB,MAE1B0B,IAIPC,EAAO,SAAUC,GACnB,OAAOA,EAAIrC,MAAM,GAAGoC,QAElBE,EAAa,SAAUC,EAAUlB,GACnC,MAAM,IAAIpE,MAAM,sBAAwBmF,EAAKG,GAAUC,KAAK,MAAQ,8CAAgDJ,EAAKf,GAAMmB,KAAK,MAAQ,MAE1IC,EAAgB,SAAUC,GAC5B,MAAM,IAAIzF,MAAM,gCAAkCmF,EAAKM,GAAaF,KAAK,QAEvEG,EAAiB,SAAUC,EAAOC,GACpC,IAAKlD,EAAQkD,GACX,MAAM,IAAI5F,MAAM,OAAS2F,EAAQ,kCAAoCC,EAAQ,KAE/ErF,EAAKqF,EAAO,SAAUzE,GACpB,IAAKsB,EAAStB,GACZ,MAAM,IAAInB,MAAM,aAAemB,EAAI,WAAawE,EAAQ,gCAO1DE,EAAa,SAAUC,GACzB,IAAIC,EAASZ,EAAKW,GACP/B,EAAKgC,EAAQ,SAAUtG,EAAG+D,GACnC,OAAOA,EAAIuC,EAAOhI,OAAS,GAAK0B,IAAMsG,EAAOvC,EAAI,KAE9CjD,KAAK,SAAUyF,GAClB,MAAM,IAAIhG,MAAM,cAAgBgG,EAAI,mDAAqDD,EAAOR,KAAK,MAAQ,SAI7GU,EAAW,SAAUX,EAAUY,GACjC,IAAIJ,EAAaR,EAAS7G,OAAOyH,GACjC,GAA0B,IAAtBJ,EAAW/H,OACb,MAAM,IAAIiC,MAAM,6DAKlB,OAHA0F,EAAe,WAAYJ,GAC3BI,EAAe,WAAYQ,GAC3BL,EAAWC,GACJ,SAAUvB,GACf,IAAI4B,EAAS/B,EAAKG,GACJ7D,EAAO4E,EAAU,SAAUc,GACvC,OAAOhD,EAAS+C,EAAQC,MAGxBf,EAAWC,EAAUa,GAEvB,IAAIV,EAAc9E,EAAOwF,EAAQ,SAAUtB,GACzC,OAAQzB,EAAS0C,EAAYjB,KAE3BY,EAAY1H,OAAS,GACvByH,EAAcC,GAEhB,IAAI/B,EAAI,GAOR,OANAnD,EAAK+E,EAAU,SAAUc,GACvB1C,EAAE0C,GAAOnI,EAASsG,EAAI6B,MAExB7F,EAAK2F,EAAU,SAAUG,GACvB3C,EAAE2C,GAAOpI,EAAS+C,OAAOmB,UAAUkC,eAAelF,KAAKoF,EAAK8B,GAAO7E,EAAON,KAAKqD,EAAI8B,IAAQ7E,EAAO1C,UAE7F4E,IAMP4C,GAFYtJ,EAAWuJ,KAAKC,eACZxJ,EAAWuJ,KAAKE,mBACtBzJ,EAAWuJ,KAAKG,cAC1BC,EAAW3J,EAAWuJ,KAAKK,cAG3BC,GAFgB7J,EAAWuJ,KAAKO,mBACZ9J,EAAWuJ,KAAKQ,uBAC1B/J,EAAWuJ,KAAKS,cAC1BC,GAAOjK,EAAWuJ,KAAKW,UAQvB5E,IAPyBtF,EAAWuJ,KAAKY,4BACtBnK,EAAWuJ,KAAKa,sBAC1BpK,EAAWuJ,KAAKc,YACdrK,EAAWuJ,KAAKe,mBAEW,IAAtBtK,EAAWuK,OAAyBvK,EAAWuK,OAASC,SAAS,eAATA,GAEjE,SAAUC,GAEnB,OADQA,EAAQC,MAAMC,SACbC,gBAEP5F,GAAO,SAAUyF,GACnB,OAAOA,EAAQC,MAAMG,UAEnBC,GAAW,SAAU7F,GACvB,OAAO,SAAUwF,GACf,OAAOzF,GAAKyF,KAAaxF,IAGzB8F,GAAY,SAAUN,GACxB,OAAOzF,GAAKyF,KAAanB,GAA6B,aAAlBhE,GAAKmF,IAEvCO,GAAYF,GAASjB,GACrBoB,GAASH,GAASb,IAElBiB,GAAS,SAAUR,EAAK7C,EAAK1H,GAC/B,KAAIsF,EAAStF,IAAUwF,EAAUxF,IAAU0F,EAAS1F,IAIlD,MADAH,EAAWmL,QAAQC,MAAM,iCAAkCvD,EAAK,YAAa1H,EAAO,cAAeuK,GAC7F,IAAI1H,MAAM,kCAHhB0H,EAAIW,aAAaxD,EAAK1H,EAAQ,KAM9BE,GAAM,SAAUoK,EAAS5C,EAAK1H,GAChC+K,GAAOT,EAAQC,MAAO7C,EAAK1H,IAEzBmL,GAAS,SAAUb,EAASc,GAC9B,IAAIb,EAAMD,EAAQC,MAClBpD,EAAOiE,EAAO,SAAUjL,EAAGmH,GACzByD,GAAOR,EAAKjD,EAAGnH,MAGfkL,GAAQ,SAAUf,EAAS5C,GAC7B,IAAIvH,EAAImK,EAAQC,MAAMe,aAAa5D,GACnC,OAAa,OAANvH,OAAa6C,EAAY7C,GAE9BoL,GAAQ,SAAUjB,EAAS5C,GAC7B,IAAI6C,EAAMD,EAAQC,MAClB,SAAOA,IAAOA,EAAIiB,eAAejB,EAAIiB,aAAa9D,IAEhD+D,GAAS,SAAUnB,EAAS5C,GAC9B4C,EAAQC,MAAMmB,gBAAgBhE,IAE5BtH,GAAQ,SAAUkK,GACpB,OAAO3D,EAAM2D,EAAQC,MAAMoB,WAAY,SAAUlF,EAAKmF,GAEpD,OADAnF,EAAImF,EAAKzG,MAAQyG,EAAK5L,MACfyG,GACN,KAGDoF,GAAa,SAAUC,EAAKC,EAAQC,GACtC,MAAe,KAAXD,KAGAD,EAAIlL,OAASmL,EAAOnL,SAGhBkL,EAAIC,OAAOC,EAAOA,EAAQD,EAAOnL,UAC5BmL,GAEXE,GAAa,SAAUH,EAAKC,GAC9B,OAAgC,IAAzBD,EAAIhG,QAAQiG,IAEjBG,GAAa,SAAUJ,EAAKK,GAC9B,OAAON,GAAWC,EAAKK,EAAQ,IAS7BC,GAAc,SAAU7B,GAC1B,YAAqBvH,IAAduH,EAAI8B,OAAuB5G,EAAW8E,EAAI8B,MAAMC,mBAGrDC,GAAS,SAAU/K,GACrB,IACI+E,EADAiG,GAAS,EAEb,OAAO,WAEL,IADA,IAAI/L,EAAO,GACFC,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCD,EAAKC,GAAMC,UAAUD,GAMvB,OAJK8L,IACHA,GAAS,EACTjG,EAAI/E,EAAEX,MAAM,KAAMJ,IAEb8F,IAwBPkG,GAAU,SAAUC,GACtB,GAAIA,MAAAA,EACF,MAAM,IAAI7J,MAAM,oCAElB,MAAO,CAAE0H,IAAKzJ,EAAS4L,KAMrBC,GAAU,CACZC,SA/Ba,SAAUC,EAAMC,GAC7B,IACIC,GADMD,GAASjN,EAAWmN,UAChBC,cAAc,OAE5B,GADAF,EAAIG,UAAYL,GACXE,EAAII,iBAAmBJ,EAAIK,WAAWxM,OAAS,EAElD,MADAf,EAAWmL,QAAQC,MAAM,wCAAyC4B,GAC5D,IAAIhK,MAAM,qCAElB,OAAO4J,GAAQM,EAAIK,WAAW,KAwB9BC,QAtBY,SAAUC,EAAKR,GAC3B,IACIJ,GADMI,GAASjN,EAAWmN,UACfC,cAAcK,GAC7B,OAAOb,GAAQC,IAoBfa,SAlBa,SAAUC,EAAMV,GAC7B,IACIJ,GADMI,GAASjN,EAAWmN,UACfS,eAAeD,GAC9B,OAAOf,GAAQC,IAgBfD,QAASA,GACTiB,UATc,SAAUC,EAAQ3M,EAAG4M,GACnC,IAAIC,EAAMF,EAAOpD,MACjB,OAAOlG,EAAOC,KAAKuJ,EAAIC,iBAAiB9M,EAAG4M,IAAIzK,IAAIsJ,MAUjDsB,GAAS,SAAUzD,GACrB,IAAIC,EAAMO,GAAOR,GAAWA,EAAQC,MAAMyD,WAAa1D,EAAQC,MAC/D,OAAOA,MAAAA,GAAqCA,EAAI0D,cAAcC,KAAKjI,SAASsE,IAE1E2D,GAAO3B,GAAO,WAChB,OAAO4B,GAAQxB,GAAQF,QAAQ5M,EAAWmN,aAExCmB,GAAU,SAAUN,GACtB,IAAIzJ,EAAIyJ,EAAItD,MAAM2D,KAClB,GAAI9J,MAAAA,EACF,MAAM,IAAIvB,MAAM,6BAElB,OAAO8J,GAAQF,QAAQrI,IAGrBgK,GAAc,SAAU7D,EAAK8D,EAAUrO,GACzC,IAAKsF,EAAStF,GAEZ,MADAH,EAAWmL,QAAQC,MAAM,qCAAsCoD,EAAU,YAAarO,EAAO,cAAeuK,GACtG,IAAI1H,MAAM,+BAAiC7C,GAE/CoM,GAAY7B,IACdA,EAAI8B,MAAMiC,YAAYD,EAAUrO,IAQhCuO,GAAQ,SAAUjE,EAAS+D,EAAUrO,GACvC,IAAIuK,EAAMD,EAAQC,MAClB6D,GAAY7D,EAAK8D,EAAUrO,IAEzBwO,GAAW,SAAUlE,EAASmE,GAChC,IAAIlE,EAAMD,EAAQC,MAClBpD,EAAOsH,EAAK,SAAUtO,EAAGmH,GACvB8G,GAAY7D,EAAKjD,EAAGnH,MAGpBuO,GAAQ,SAAUpE,EAAS+D,GAC7B,IAAI9D,EAAMD,EAAQC,MAEdhE,EADS1G,EAAWuK,OAAOuE,iBAAiBpE,GACjC+B,iBAAiB+B,GAC5BlO,EAAU,KAANoG,GAAawH,GAAOzD,GAA8C/D,EAAnCqI,GAAkBrE,EAAK8D,GAC9D,OAAa,OAANlO,OAAa6C,EAAY7C,GAE9ByO,GAAoB,SAAUrE,EAAK8D,GACrC,OAAOjC,GAAY7B,GAAOA,EAAI8B,MAAMC,iBAAiB+B,GAAY,IAE/DQ,GAAS,SAAUvE,EAAS+D,GAC9B,IAAI9D,EAAMD,EAAQC,MACduE,EAAMF,GAAkBrE,EAAK8D,GACjC,OAAOhK,EAAOC,KAAKwK,GAAKtL,OAAO,SAAU+C,GACvC,OAAOA,EAAE3F,OAAS,KAGlBmO,GAAW,SAAUzE,EAAS+D,IAhCb,SAAU9D,EAAK8D,GAC9BjC,GAAY7B,IACdA,EAAI8B,MAAM2C,eAAeX,GAgC3BY,CADU3E,EAAQC,MACE8D,GAChB9C,GAAMjB,EAAS,UAA8C,KAA7Be,GAAMf,EAAS,SAxHxC4E,QAAQ,aAAc,KAyH/BzD,GAAOnB,EAAS,UAWhB6E,GAA0B,SAAUnL,EAAGI,EAAGgL,GAC5C,OAAkD,IAA1CpL,EAAEmL,wBAAwB/K,GAAKgL,IAQrChG,GAH8B,SAAUpF,EAAGI,GAC7C,OAAO+K,GAAwBnL,EAAGI,EAAGvE,EAAWuJ,KAAKiG,iCAOnDC,GAAW,WAUb,OATAA,GAAWzL,OAAO0L,QAAU,SAAkBzK,GAC5C,IAAK,IAAIxC,EAAG+D,EAAI,EAAGlE,EAAIxB,UAAUC,OAAQyF,EAAIlE,EAAGkE,IAE9C,IAAK,IAAImJ,KADTlN,EAAI3B,UAAU0F,GAERxC,OAAOmB,UAAUkC,eAAelF,KAAKM,EAAGkN,KAC1C1K,EAAE0K,GAAKlN,EAAEkN,IAEf,OAAO1K,IAEOjE,MAAM4O,KAAM9O,YAgC1B+O,GAAU,WACZ,OAAOC,GAAG,EAAG,IAEXA,GAAK,SAAUC,EAAOC,GACxB,MAAO,CACLD,MAAOA,EACPC,MAAOA,IAGPC,GAAU,CACZH,GAAIA,GACJI,OAlBW,SAAUC,EAAgBC,GACrC,IAAIC,EAAe9K,OAAO6K,GAAOxF,cACjC,OAA8B,IAA1BuF,EAAepP,OACV8O,KAhBE,SAAUS,EAASF,GAC9B,IAAI1J,EAVW,SAAU4J,EAAS7N,GAClC,IAAK,IAAI+D,EAAI,EAAGA,EAAI8J,EAAQvP,OAAQyF,IAAK,CACvC,IAAIrF,EAAImP,EAAQ9J,GAChB,GAAIrF,EAAEoP,KAAK9N,GACT,OAAOtB,GAMHqP,CAAWF,EAASF,GAC5B,IAAK1J,EACH,MAAO,CACLqJ,MAAO,EACPC,MAAO,GAGX,IAAIS,EAAQ,SAAUjK,GACpB,OAAOkK,OAAON,EAAMf,QAAQ3I,EAAG,IAAMF,KAEvC,OAAOsJ,GAAGW,EAAM,GAAIA,EAAM,IAOnBE,CAAOR,EAAgBE,IAc9BR,QAASA,IASPe,GAAY,SAAUtL,EAAMuL,GAC9B,OAAO,WACL,OAAOA,IAAYvL,IASnBwL,GAAO,SAAUC,GACnB,IAAIF,EAAUE,EAAKF,QAEnB,MAAO,CACLA,QAASA,EACTG,QAHYD,EAAKC,QAIjBC,OAAQL,GAvBD,OAuBiBC,GACxBK,SAAUN,GAvBD,SAuBmBC,GAC5BM,KAAMP,GAvBD,KAuBeC,GACpBO,QAASR,GAvBD,QAuBkBC,GAC1BQ,UAAWT,GAvBD,UAuBoBC,GAC9BS,SAAUV,GAvBD,SAuBmBC,KAG5BU,GAAU,CACZ1B,QArBc,WACd,OAAOiB,GAAK,CACVD,aAAS1N,EACT6N,QAASf,GAAQJ,aAmBnBC,GAAIgB,GACJU,KAAMvQ,EAlCG,QAmCTwQ,OAAQxQ,EAlCG,UAmCXyQ,GAAIzQ,EAlCG,MAmCP0Q,MAAO1Q,EAlCG,SAmCV2Q,QAAS3Q,EAlCG,WAmCZ4Q,OAAQ5Q,EAlCG,WA4CT6Q,GAAO,SAAUxM,EAAMuL,GACzB,OAAO,WACL,OAAOA,IAAYvL,IASnByM,GAAO,SAAUhB,GACnB,IAAIF,EAAUE,EAAKF,QAEnB,MAAO,CACLA,QAASA,EACTG,QAHYD,EAAKC,QAIjBgB,UAAWF,GAxBD,UAwBejB,GACzBoB,MAAOH,GAxBD,MAwBWjB,GACjBqB,UAAWJ,GAxBD,UAwBejB,GACzBsB,MAAOL,GAvBD,MAuBWjB,GACjBuB,QAASN,GAzBD,QAyBajB,GACrBwB,UAAWP,GAxBD,UAwBejB,GACzByB,UAAWR,GAxBD,UAwBejB,KAGzB0B,GAAkB,CACpB1C,QAtBc,WACd,OAAOkC,GAAK,CACVlB,aAAS1N,EACT6N,QAASf,GAAQJ,aAoBnBC,GAAIiC,GACJS,QAASvR,EApCG,WAqCZwR,IAAKxR,EApCG,OAqCRyR,QAASzR,EApCG,WAqCZ0R,MAAO1R,EApCG,SAqCV2R,IAAK3R,EApCG,OAqCR4R,QAAS5R,EApCG,WAqCZ6R,QAAS7R,EApCG,YA6DV8R,GAAW,SAAUC,EAAYC,GACnC,IAAI7C,EAAQ7K,OAAO0N,GAAWrI,cAC9B,OAAO7D,EAAKiM,EAAY,SAAUE,GAChC,OAAOA,EAAUC,OAAO/C,MAqBxBgD,GAlBgB,SAAUC,EAAUJ,GACtC,OAAOF,GAASM,EAAUJ,GAAW3P,IAAI,SAAUgQ,GACjD,IAAItC,EAAUf,GAAQC,OAAOoD,EAAQnD,eAAgB8C,GACrD,MAAO,CACLpC,QAASyC,EAAQhO,KACjB0L,QAASA,MAaXoC,GATW,SAAUG,EAAMN,GAC7B,OAAOF,GAASQ,EAAMN,GAAW3P,IAAI,SAAUkQ,GAC7C,IAAIxC,EAAUf,GAAQC,OAAOsD,EAAGrD,eAAgB8C,GAChD,MAAO,CACLpC,QAAS2C,EAAGlO,KACZ0L,QAASA,MASXyC,GAAqB,sCACrBC,GAAgB,SAAUC,GAC5B,OAAO,SAAUC,GACf,OAAOxH,GAAWwH,EAAUD,KAG5BN,GAAW,CACb,CACE/N,KAAM,OACN6K,eAAgB,CAAC,kCACjBgD,OAAQ,SAAUS,GAChB,OAAOxH,GAAWwH,EAAU,UAAYxH,GAAWwH,EAAU,WAAaxH,GAAWwH,EAAU,WAAaxH,GAAWwH,EAAU,iBAGrI,CACEtO,KAAM,SACN6K,eAAgB,CACd,kCACAsD,IAEFN,OAAQ,SAAUS,GAChB,OAAOxH,GAAWwH,EAAU,YAAcxH,GAAWwH,EAAU,iBAGnE,CACEtO,KAAM,KACN6K,eAAgB,CACd,iCACA,8BAEFgD,OAAQ,SAAUS,GAChB,OAAOxH,GAAWwH,EAAU,SAAWxH,GAAWwH,EAAU,aAGhE,CACEtO,KAAM,QACN6K,eAAgB,CACdsD,GACA,kCAEFN,OAAQO,GAAc,UAExB,CACEpO,KAAM,UACN6K,eAAgB,CAAC,uCACjBgD,OAAQO,GAAc,YAExB,CACEpO,KAAM,SACN6K,eAAgB,CACdsD,GACA,iCAEFN,OAAQ,SAAUS,GAChB,OAAQxH,GAAWwH,EAAU,WAAaxH,GAAWwH,EAAU,aAAexH,GAAWwH,EAAU,kBAIrGL,GAAO,CACT,CACEjO,KAAM,UACN6N,OAAQO,GAAc,OACtBvD,eAAgB,CAAC,0CAEnB,CACE7K,KAAM,MACN6N,OAAQ,SAAUS,GAChB,OAAOxH,GAAWwH,EAAU,WAAaxH,GAAWwH,EAAU,SAEhEzD,eAAgB,CACd,sCACA,+BACA,wCAGJ,CACE7K,KAAM,UACN6N,OAAQO,GAAc,WACtBvD,eAAgB,CAAC,sCAEnB,CACE7K,KAAM,MACN6N,OAAQO,GAAc,QACtBvD,eAAgB,CAAC,mCAEnB,CACE7K,KAAM,QACN6N,OAAQO,GAAc,SACtBvD,eAAgB,IAElB,CACE7K,KAAM,UACN6N,OAAQO,GAAc,SACtBvD,eAAgB,IAElB,CACE7K,KAAM,UACN6N,OAAQO,GAAc,WACtBvD,eAAgB,KAGhB0D,GAAe,CACjBR,SAAUpS,EAASoS,IACnBE,KAAMtS,EAASsS,KAebO,GAZW,SAAUb,EAAWc,GAClC,IAAIV,EAAWQ,GAAaR,WACxBE,EAAOM,GAAaN,OACpBD,EAAUF,GAAuBC,EAAUJ,GAAWzQ,KAAK+O,GAAQ1B,QAAS0B,GAAQzB,IACpF0D,EAAKJ,GAAkBG,EAAMN,GAAWzQ,KAAK+P,GAAgB1C,QAAS0C,GAAgBzC,IACtFkE,EAlKW,SAAUR,EAAIF,EAASL,EAAWc,GACjD,IAAIE,EAAST,EAAGvB,UAAuC,IAA5B,QAAQ1B,KAAK0C,GACpCiB,EAAWV,EAAGvB,UAAYgC,EAC1BE,EAAWX,EAAGvB,SAAWuB,EAAGtB,YAC5BkC,EAAUD,GAAYJ,EAAW,oBACjCM,EAAWJ,IAAWC,GAAYC,GAAYJ,EAAW,4BACzDO,EAAUJ,GAAYC,IAAaE,EACnCE,EAAajB,EAAQhC,YAAckC,EAAGvB,UAAyC,IAA9B,UAAU1B,KAAK0C,GAChEuB,GAAaF,IAAYD,IAAaE,EAC1C,MAAO,CACLN,OAAQhT,EAASgT,GACjBC,SAAUjT,EAASiT,GACnBG,SAAUpT,EAASoT,GACnBC,QAASrT,EAASqT,GAClBF,QAASnT,EAASmT,GAClBlC,UAAWsB,EAAGtB,UACdD,MAAOuB,EAAGvB,MACVwC,UAAWxT,EAASsT,GACpBC,UAAWvT,EAASuT,IAgJLE,CAAWlB,EAAIF,EAASL,EAAWc,GACpD,MAAO,CACLT,QAASA,EACTE,GAAIA,EACJQ,WAAYA,IAQZW,GAAW1U,EAAK6T,GAAyB9T,EAAW4U,UAAU3B,UAHjD,SAAU4B,GACzB,OAAO7U,EAAWuK,OAAOuK,WAAWD,GAAOE,WAGzCC,GAAW,WACb,OAAOL,GAASvU,OAGd6U,GAAYpL,EACZqL,GAAavL,EACbjH,GAAK,SAAU+H,EAAS0K,GAC1B,IAAIzK,EAAMD,EAAQC,MAClB,GAAIA,EAAIG,WAAaoK,GACnB,OAAO,EAEP,IAAIG,EAAO1K,EACX,QAAqBvH,IAAjBiS,EAAKL,QACP,OAAOK,EAAKL,QAAQI,GACf,QAA+BhS,IAA3BiS,EAAKC,kBACd,OAAOD,EAAKC,kBAAkBF,GACzB,QAAmChS,IAA/BiS,EAAKE,sBACd,OAAOF,EAAKE,sBAAsBH,GAC7B,QAAgChS,IAA5BiS,EAAKG,mBACd,OAAOH,EAAKG,mBAAmBJ,GAE/B,MAAM,IAAInS,MAAM,mCAIlBwS,GAAiB,SAAU9K,GAC7B,OAAOA,EAAIG,WAAaoK,IAAavK,EAAIG,WAAaqK,IAAwC,IAA1BxK,EAAI+K,mBAWtEzT,GAAK,SAAU0T,EAAIC,GACrB,OAAOD,EAAGhL,QAAUiL,EAAGjL,OAWrBkL,GADUZ,KAAW1B,QACAnC,OAJR,SAAUuE,EAAIC,GAC7B,OAAOpM,GAAiCmM,EAAGhL,MAAOiL,EAAGjL,QANjC,SAAUgL,EAAIC,GAClC,IAAIE,EAAKH,EAAGhL,MACRoL,EAAKH,EAAGjL,MACZ,OAAOmL,IAAOC,GAAaD,EAAGzP,SAAS0P,IAOrCC,GAAOrT,GAEPsT,GAAQ,SAAUvL,GACpB,OAAOqC,GAAQF,QAAQnC,EAAQC,MAAM0D,gBAKnC6H,GAAS,SAAUxL,GACrB,OAAOjG,EAAOC,KAAKgG,EAAQC,MAAMyD,YAAY7K,IAAIwJ,GAAQF,UAEvDsJ,GAAU,SAAUzL,EAAS0L,GAI/B,IAHA,IAAIC,EAAOxQ,EAAWuQ,GAAUA,EAASvU,EACrC8I,EAAMD,EAAQC,MACd2L,EAAM,GACgB,OAAnB3L,EAAIyD,iBAA0ChL,IAAnBuH,EAAIyD,YAA0B,CAC9D,IAAImI,EAAY5L,EAAIyD,WAChBwB,EAAI7C,GAAQF,QAAQ0J,GAExB,GADAD,EAAIlQ,KAAKwJ,IACO,IAAZyG,EAAKzG,GACP,MAEAjF,EAAM4L,EAGV,OAAOD,GAELE,GAAc,SAAU9L,GAC1B,OAAOjG,EAAOC,KAAKgG,EAAQC,MAAM8L,iBAAiBlT,IAAIwJ,GAAQF,UAE5D6J,GAAc,SAAUhM,GAC1B,OAAOjG,EAAOC,KAAKgG,EAAQC,MAAM+L,aAAanT,IAAIwJ,GAAQF,UAExD8J,GAAW,SAAUjM,GACvB,OAAOnH,EAAImH,EAAQC,MAAM6C,WAAYT,GAAQF,UAE3C+J,GAAQ,SAAUlM,EAASmM,GAC7B,IAAIC,EAAKpM,EAAQC,MAAM6C,WACvB,OAAO/I,EAAOC,KAAKoS,EAAGD,IAAQtT,IAAIwJ,GAAQF,UAOxCkK,IAFO/O,EAAU,UAAW,UAEnB,SAAUgP,EAAQtM,GACdwL,GAAOc,GACbxT,KAAK,SAAUjD,GACtBA,EAAEoK,MAAMsM,aAAavM,EAAQC,MAAOqM,EAAOrM,WAG3CuM,GAAQ,SAAUF,EAAQtM,GACdgM,GAAYM,GAClBvU,KAAK,WACIyT,GAAOc,GACbxT,KAAK,SAAUjD,GACtB4W,GAAO5W,EAAGmK,MAEX,SAAUnK,GACXwW,GAAOxW,EAAGmK,MAGV0M,GAAU,SAAUlB,EAAQxL,IAtBf,SAAUA,GACzB,OAAOkM,GAAMlM,EAAS,IAsBH2M,CAAWnB,GACjBzT,KAAK,WAChB0U,GAAOjB,EAAQxL,IACd,SAAUnK,GACX2V,EAAOvL,MAAMsM,aAAavM,EAAQC,MAAOpK,EAAEoK,UAG3CwM,GAAS,SAAUjB,EAAQxL,GAC7BwL,EAAOvL,MAAM2M,YAAY5M,EAAQC,QAE/B4M,GAAO,SAAU7M,EAAS8M,GAC5BT,GAAOrM,EAAS8M,GAChBL,GAAOK,EAAS9M,IAQd+M,GAAU,SAAUT,EAAQU,GAC9BlU,EAAKkU,EAAU,SAAUtW,EAAGqF,GAC1B,IAAIkR,EAAU,IAANlR,EAAUuQ,EAASU,EAASjR,EAAI,GACxCyQ,GAAMS,EAAGvW,MAGTwW,GAAW,SAAU1B,EAAQwB,GAC/BlU,EAAKkU,EAAU,SAAUtW,GACvB+V,GAAOjB,EAAQ9U,MAIfyW,GAAQ,SAAUnN,GACpBA,EAAQC,MAAMmN,YAAc,GAC5BtU,EAAKmT,GAASjM,GAAU,SAAUqN,GAChCC,GAASD,MAGTC,GAAW,SAAUtN,GACvB,IAAIC,EAAMD,EAAQC,MACK,OAAnBA,EAAIyD,YACNzD,EAAIyD,WAAW6J,YAAYtN,IAG3BuN,GAAS,SAAUV,GACrB,IA9BuBR,EA8BnBmB,EAAaxB,GAASa,GACtBW,EAAWnX,OAAS,IA/BDgW,EAgCZQ,EA/BXhU,EA+BoB2U,EA/BL,SAAU/W,GACvB2V,GAAOC,EAAQ5V,MAgCjB4W,GAASR,IAKPY,IAFYpQ,EAAU,QAAS,UAClBA,EAAU,QAAS,UACzBA,EAAU,OAAQ,YACzBqQ,GAAUrQ,EAAU,MAAO,UAE3BsQ,IADStQ,EAAU,IAAK,KACfA,EAAU,UAAW,UAAW,YACzCuQ,GAAYvQ,EAAU,UAAW,UAAW,UAAW,SACvDwQ,GAAWxQ,EAAU,UAAW,UAAW,UAAW,MAAO,UAC7DyQ,GAAUzQ,EAAU,UAAW,QAAS,WACxC0Q,GAAa1Q,EAAU,UAAW,SAClC2Q,GAAa3Q,EAAU,UAAW,QAAS,UAAW,SACtD4Q,GAAW5Q,EAAU,QAAS,WAC9B6Q,GAAa7Q,EAAU,UAAW,WAClC8Q,GAAS9Q,EAAU,WAAY,WAAY,YAAa,aAQxD+Q,GAAc,SAAU7L,EAAO8L,GACjC,IAAIC,EAAS,GAOb,OANAzV,EAAKmT,GAASzJ,GAAQ,SAAU9L,GAC1B4X,EAAU5X,KACZ6X,EAASA,EAAOvX,OAAO,CAACN,KAE1B6X,EAASA,EAAOvX,OAAOqX,GAAY3X,EAAG4X,MAEjCC,GAGLC,GAAc,SAAUhM,EAAOkI,EAAUgB,GAC3C,OAlBc,SAAUlJ,EAAO8L,EAAW5C,GAC1C,OAAOxS,EAAOuS,GAAQjJ,EAAOkJ,GAAS4C,GAiB/BG,CAAUjM,EAAO,SAAUyK,GAChC,OAAOhV,GAAGgV,EAAGvC,IACZgB,IAEDgD,GAAa,SAAUlM,EAAOkI,GAChC,OApBe,SAAUlI,EAAO8L,GAChC,OAAOpV,EAAO+S,GAASzJ,GAAQ8L,GAmBxBb,CAAWjL,EAAO,SAAUyK,GACjC,OAAOhV,GAAGgV,EAAGvC,MAGbiE,GAAgB,SAAUnM,EAAOkI,GACnC,OApLQ,SAAUA,EAAUlI,GAC5B,IAAIoM,OAAiBlW,IAAV8J,EAAsBjN,EAAWmN,SAAWF,EAAMvC,MAC7D,OAAO8K,GAAe6D,GAAQ,GAAK/V,EAAI+V,EAAKC,iBAAiBnE,GAAWrI,GAAQF,SAkLzEpL,CAAI2T,EAAUlI,IAGvB,SAASsM,GAAmB7W,EAAI8W,EAAUvM,EAAO9I,EAAGgS,GAClD,OAAOzT,EAAGuK,EAAO9I,GAAKK,EAAON,KAAK+I,GAASrH,EAAWuQ,IAAWA,EAAOlJ,GAASzI,EAAO1C,OAAS0X,EAASvM,EAAO9I,EAAGgS,GAGtH,IAAIqD,GAAW,SAAUvM,EAAO8L,EAAW5C,GAGzC,IAFA,IAAI1L,EAAUwC,EAAMvC,MAChB0L,EAAOxQ,EAAWuQ,GAAUA,EAASlV,GAAS,GAC3CwJ,EAAQ0D,YAAY,CACzB1D,EAAUA,EAAQ0D,WAClB,IAAIsL,EAAK3M,GAAQF,QAAQnC,GACzB,GAAIsO,EAAUU,GACZ,OAAOjV,EAAON,KAAKuV,GACd,GAAIrD,EAAKqD,GACd,MAGJ,OAAOjV,EAAO1C,QAgCZ4X,GAAa,SAAUzM,EAAOkI,EAAUgB,GAC1C,OAAOqD,GAASvM,EAAO,SAAUyK,GAC/B,OAAOhV,GAAGgV,EAAGvC,IACZgB,IAEDwD,GAAU,SAAU1M,EAAOkI,GAC7B,OA9BY,SAAUlI,EAAO8L,GAK7B,OADahS,EAAKkG,EAAMvC,MAAM6C,WAHnB,SAAUV,GACnB,OAAOkM,EAAUjM,GAAQF,QAAQC,MAGrBvJ,IAAIwJ,GAAQF,SAyBnBgN,CAAQ3M,EAAO,SAAUyK,GAC9B,OAAOhV,GAAGgV,EAAGvC,MAGb0E,GAAe,SAAU5M,EAAOkI,GAClC,OA9OQ,SAAUA,EAAUlI,GAC5B,IAAIoM,OAAiBlW,IAAV8J,EAAsBjN,EAAWmN,SAAWF,EAAMvC,MAC7D,OAAO8K,GAAe6D,GAAQ7U,EAAO1C,OAAS0C,EAAOC,KAAK4U,EAAKS,cAAc3E,IAAW7R,IAAIwJ,GAAQF,SA4O7FmN,CAAI5E,EAAUlI,IAEnB+M,GAAY,SAAU/M,EAAOkI,EAAUgB,GACzC,OAAOoD,GAAkB7W,GAAIgX,GAAYzM,EAAOkI,EAAUgB,IAMxD8D,GAAmB,SAAUhN,EAAOkI,EAAU4D,GAChD,OAAOvV,EAAKkT,GAASzJ,GAAQ,SAAU9L,GACrC,OAAOuB,GAAGvB,EAAGgU,GAAY4D,EAAU5X,GAAK,CAACA,GAAK,GAAK8Y,GAAiB9Y,EAAGgU,EAAU4D,MAGjFmB,GAAgB,CAClBC,WATe,SAAUlN,EAAOkI,GAChC,OAAO8E,GAAiBhN,EAAOkI,EAAUlU,GAAS,KASlDgZ,iBAAkBA,IAGhBG,GAAS,SAAUC,EAAM5P,EAAS0L,GAIpC,QAHe,IAAXA,IACFA,EAASvU,GAEPuU,EAAO1L,GACT,OAAOjG,EAAO1C,OAEhB,GAAIsE,EAASiU,EAAM/U,GAAKmF,IACtB,OAAOjG,EAAON,KAAKuG,GAKrB,OAAOiP,GAAWjP,EAAS4P,EAAK9R,KAAK,KAHZ,SAAU+R,GACjC,OAAO5X,GAAG4X,EAAK,UAAYnE,EAAOmE,MAsBlCC,GAAa,SAAUpF,EAAU1K,GACnC,OAAOwL,GAAOxL,GAASnH,IAAI,SAAU2S,GACnC,OAAOkD,GAAWlD,EAAQd,MAG1BqF,GAAiBpZ,EAAMmZ,GAAY,SACnCE,GAAgBrZ,EAAMmZ,GAAY,MAalCxO,GAAO,SAAUtB,EAAS+D,GAC5B,OAAOkM,SAASlP,GAAMf,EAAS+D,GAAW,KAOxCmM,GAAc,CAChBC,KA9CS,SAAUnQ,EAAS0L,GAC5B,OAAOiE,GAAO,CACZ,KACA,MACC3P,EAAS0L,IA2CZ0E,UAtBc,SAAUrB,GACxB,OAAOK,GAAaL,EAAU,UAsB9BsB,MA1CU,SAAUtB,GACpB,OAAOU,GAAcC,WAAWX,EAAU,UA0C1CgB,eAAgBA,GAChBO,MAtBU,SAAUtQ,EAAS0L,GAC7B,OAAO6D,GAAUvP,EAAS,QAAS0L,IAsBnC6E,IApBQ,SAAUvQ,EAAS0L,GAC3B,OAAOiE,GAAO,CAAC,MAAO3P,EAAS0L,IAoB/B8E,KAlBS,SAAUzB,GACnB,OAAOU,GAAcC,WAAWX,EAAU,OAkB1C0B,QA5CY,SAAUzQ,EAAS0L,GAC/B,OAAOiE,GAAO,CACZ,UACA,KACA,QACA,QACA,SACC3P,EAAS0L,IAsCZsE,cAAeA,GACf1O,KAAMA,GACNoM,KAhBW,SAAU1N,EAAS0Q,EAASC,GACvC,IAAIC,EAAYtP,GAAKtB,EAAS0Q,GAC1BG,EAAOvP,GAAKtB,EAAS2Q,GACzB,OAAOjD,GAAKkD,EAAWC,KA2CrBC,GA3BY,SAAUR,GACxB,IAAIE,EAAON,GAAYM,KAAKF,GAC5B,OAAOzX,EAAI2X,EAAM,SAAUD,GACzB,IAAIvQ,EAAUuQ,EAEVQ,EADWvF,GAAOxL,GACOnH,IAAI,SAAUqM,GACzC,IAAI8L,EAAanW,GAAKqK,GACtB,MAAsB,UAAf8L,GAAyC,UAAfA,GAAyC,UAAfA,EAAyBA,EAAa,UAChG7Y,MAAM,SACLkY,EAAQxX,EAAIqX,GAAYG,MAAME,GAAM,SAAUJ,GAChD,IAAIc,EAAUhQ,GAAMkP,EAAM,WAAaF,SAASlP,GAAMoP,EAAM,WAAY,IAAM,EAC1Ee,EAAUjQ,GAAMkP,EAAM,WAAaF,SAASlP,GAAMoP,EAAM,WAAY,IAAM,EAC9E,OAAOvC,GAAOuC,EAAMc,EAASC,KAE/B,OAAOnD,GAAQ/N,EAASqQ,EAAOU,MAa/BD,GAViB,SAAUN,EAAMW,GACnC,OAAOtY,EAAI2X,EAAM,SAAUD,GACzB,IAAIF,EAAQxX,EAAIqX,GAAYG,MAAME,GAAM,SAAUJ,GAChD,IAAIc,EAAUhQ,GAAMkP,EAAM,WAAaF,SAASlP,GAAMoP,EAAM,WAAY,IAAM,EAC1Ee,EAAUjQ,GAAMkP,EAAM,WAAaF,SAASlP,GAAMoP,EAAM,WAAY,IAAM,EAC9E,OAAOvC,GAAOuC,EAAMc,EAASC,KAE/B,OAAOnD,GAAQwC,EAAKF,EAAOc,EAAQC,cAQnChU,GAAM,SAAUmT,EAAKc,GACvB,OAAOd,EAAM,IAAMc,GAYjBC,GAAc,SAAUC,EAAWjD,GACrC,IAAIvX,EAAMgC,EAAKwY,EAAUxa,MAAO,SAAUkF,GACxC,OAAOA,EAAEoU,UAEX,OAAOnX,EAAOnC,EAAKuX,IAyCjBkD,GAAY,CACdC,SAxCa,SAAUC,GACvB,IAAIC,EAAS,GACTtB,EAAQ,GACRuB,EAAUF,EAAKpb,OACfub,EAAa,EACjB/Y,EAAK4Y,EAAM,SAAUI,EAAS7V,GAC5B,IAAI8V,EAAa,GACjBjZ,EAAKgZ,EAAQzB,QAAS,SAAUzC,GAE9B,IADA,IAAIlM,EAAQ,OACqBhJ,IAA1BiZ,EAAOvU,GAAInB,EAAGyF,KACnBA,IAGF,IADA,IAAI0E,EAAU0H,GAASF,EAAO5N,UAAW4N,EAAOqD,UAAWrD,EAAOsD,UAAWjV,EAAGyF,GACvE3F,EAAI,EAAGA,EAAI6R,EAAOsD,UAAWnV,IACpC,IAAK,IAAIiW,EAAI,EAAGA,EAAIpE,EAAOqD,UAAWe,IAAK,CACzC,IACIC,EAAKvQ,EAAQ3F,EACbmW,EAAS9U,GAFJnB,EAAI+V,EAEQC,GACrBN,EAAOO,GAAU9L,EACjByL,EAAaM,KAAKC,IAAIP,EAAYI,EAAK,GAG3CF,EAAWrW,KAAK0K,KAElBiK,EAAM3U,KAAKqS,GAAQ+D,EAAQ9R,UAAW+R,EAAYD,EAAQV,cAE5D,IAAIiB,EAAS3E,GAAKkE,EAASC,GAC3B,MAAO,CACLnE,KAAMlX,EAAS6b,GACfV,OAAQnb,EAASmb,GACjB5a,IAAKP,EAAS6Z,KAWhBiC,MAzDU,SAAUf,EAAWhB,EAAKc,GACpC,IAAI7M,EAAM+M,EAAUI,SAASvU,GAAImT,EAAKc,IACtC,YAAe3Y,IAAR8L,EAAoBzK,EAAON,KAAK+K,GAAOzK,EAAO1C,QAwDrDkb,SAtDa,SAAUhB,EAAWiB,EAAMC,GACxC,IAAIC,EAAWpB,GAAYC,EAAW,SAAU3D,GAC9C,OAAO6E,EAAWD,EAAM5E,EAAO5N,aAEjC,OAAO0S,EAASpc,OAAS,EAAIyD,EAAON,KAAKiZ,EAAS,IAAM3Y,EAAO1C,QAmD/Dia,YAAaA,GACbqB,UAXc,SAAUpB,GACxB,IAAIf,EAAO3X,EAAI0Y,EAAUxa,MAAO,SAAU6b,GACxC,OAAOA,EAAEvC,UAEX,OAAO7T,EAAQgU,KAUbqC,GAAcvV,EAAU,SAAU,SAAU,SAAU,UA4BtDwV,GAAW,SAAUpB,EAAMqB,EAAcC,GAC3C,IAAIzC,EAAMmB,EAAKsB,GAAUhT,UACrBiT,EAAK5Q,GAAQU,QAAQ,MACzB0J,GAAOwG,EAAI5Q,GAAQU,QAAQ,QACnBgQ,EAAetG,GAASC,IAC9B6D,EAAK0C,IAmDLC,GAhBU,SAAU5C,EAAO6C,GAC7B,IAAIC,EAAa,SAAUxF,GACzB,OAAO3V,GAAG2V,EAAO5N,UAAWmT,IAE1BzB,EAAOZ,GAAsBR,GAC7B+C,EAAQ7B,GAAUC,SAASC,GAC3B4B,EAzEkB,SAAUD,EAAOD,GACvC,IAAIG,EAAeF,EAAM3F,OAAO8F,UAE5BC,EADYJ,EAAM3F,OAAO8C,OAEzBkD,EAASH,EACTI,EAAS,EACTC,EAAS,EAmBb,OAlBA/W,EAAOwW,EAAM1B,SAAU,SAAU/D,GAC/B,GAAIwF,EAAWxF,GAAS,CACtB,IAAIiG,EAAWjG,EAAO2C,MAClBuD,EAASD,EAAWjG,EAAOqD,UAAY,EACvC8C,EAAWnG,EAAOyD,SAClB2C,EAASD,EAAWnG,EAAOsD,UAAY,EACvC2C,EAAWJ,EACbA,EAASI,EACAC,EAASH,IAClBA,EAASG,GAEPC,EAAWL,EACbA,EAASK,EACAC,EAASJ,IAClBA,EAASI,MAIRnB,GAAYY,EAAQC,EAAQC,EAAQC,GAgD/BK,CAAkBZ,EAAOD,GACjC1I,EAAW,UAAYyI,EAAmB,YAAmBA,EAAmB,IAChFe,EAAkBzE,GAAcD,iBAAiBc,EAAO,QAAS,SAAUH,GAC7E,OAAOlY,GAAGkY,EAAMzF,KAKlB,OAHA5R,EAAKob,EAAiB5G,IA5CP,SAAUoE,EAAM2B,EAAOC,EAAOF,GAG7C,IAFA,IAAIG,EAAeF,EAAM3F,OAAO8F,UAC5BW,EAAYd,EAAM3F,OAAO8C,OACpBzU,EAAI,EAAGA,EAAIoY,EAAWpY,IAE7B,IADA,IAAIgX,GAAe,EACVf,EAAI,EAAGA,EAAIuB,EAAcvB,IAC1BjW,EAAIuX,EAAMG,UAAY1X,EAAIuX,EAAMK,UAAY3B,EAAIsB,EAAMI,UAAY1B,EAAIsB,EAAMM,WACjEpC,GAAUc,MAAMe,EAAOtX,EAAGiW,GAAG9Y,OAAOka,GAAY3b,SAE7Dqb,GAASpB,EAAMqB,EAAchX,GAE7BgX,GAAe,GAkCvBqB,CAAW1C,EAAM2B,EAAOC,EAAOF,GA5BrB,SAAU9C,EAAOgD,GAC3B,IAAIe,EAAYnb,EAAOuW,GAAcC,WAAWY,EAAO,MAAO,SAAUC,GACtE,OAAuC,IAAhCA,EAAItQ,MAAM+K,oBAEnBlS,EAAKub,EAAW/G,IACZgG,EAAMI,WAAaJ,EAAMM,UAAYN,EAAMG,WAAaH,EAAMK,UAChE7a,EAAK2W,GAAcC,WAAWY,EAAO,SAAU,SAAUH,GACvDhP,GAAOgP,EAAM,WACbhP,GAAOgP,EAAM,aAGjBhP,GAAOmP,EAAO,SACdnP,GAAOmP,EAAO,UACd7L,GAAS6L,EAAO,SAChB7L,GAAS6L,EAAO,UAehBgE,CAAMhE,EAAOgD,GACNhD,GA2BT,IAAIiE,GAvBJ,SAAoBtc,EAAI4C,GACtB,IAMI2Z,EAAY,SAAUxU,GACxB,OAAO/H,EAAG+H,GAAWjG,EAAOC,KAAKgG,EAAQC,MAAMwU,WAAa1a,EAAO1C,QAQrE,MAAO,CACL1B,IAhBQ,SAAUqK,GAClB,IAAK/H,EAAG+H,GACN,MAAM,IAAIzH,MAAM,gBAAkBsC,EAAO,eAAiBA,EAAO,SAEnE,OAAO2Z,EAAUxU,GAAS7H,MAAM,KAahCqc,UAAWA,EACX5e,IATQ,SAAUoK,EAAStK,GAC3B,IAAKuC,EAAG+H,GACN,MAAM,IAAIzH,MAAM,oBAAsBsC,EAAO,eAAiBA,EAAO,SAEvEmF,EAAQC,MAAMwU,UAAY/e,IASpBgf,CAAUlU,GAAQ,QACxBmU,GAAQ,SAAU3U,GACpB,OAAOuU,GAAI5e,IAAIqK,IAEbwU,GAAY,SAAUxU,GACxB,OAAOuU,GAAIC,UAAUxU,IAEnB4U,GAAQ,SAAU5U,EAAStK,GAC7B6e,GAAI3e,IAAIoK,EAAStK,IAGfmf,GAAS,SAAU7U,GACrB,MAAyB,QAAlBnF,GAAKmF,GAAqB,EAAIwU,GAAUxU,GAASjI,KAAK,WAC3D,OAAOkU,GAASjM,GAAS1J,QACxB,SAAUT,GACX,OAAOA,EAAES,UASTwe,GAA6B,CAC/B,MACA,MAEEC,GAAmB,SAAUpK,GAE/B,OAVO6J,GAS8C7J,GAThCzR,OAAO,SAAUgK,GACpC,OAA8B,IAAvBA,EAAK8R,OAAO1e,QAAgB4M,EAAK1H,QAHjC,MAGkD,IACxDtD,UAQyByD,EAASmZ,GAA4Bja,GAAK8P,KAGpEsK,GAAQ,SAAUjV,GACpB,OA1WgCsO,EA0WLyG,IAzWvBG,EAAU,SAAU9S,GACtB,IAAK,IAAIrG,EAAI,EAAGA,EAAIqG,EAAKU,WAAWxM,OAAQyF,IAAK,CAC/C,IAAIoZ,EAAU9S,GAAQF,QAAQC,EAAKU,WAAW/G,IAC9C,GAAIuS,EAAU6G,GACZ,OAAOpb,EAAON,KAAK0b,GAErB,IAAIC,EAAMF,EAAQ9S,EAAKU,WAAW/G,IAClC,GAAIqZ,EAAIld,SACN,OAAOkd,EAGX,OAAOrb,EAAO1C,SA8VE2I,EA5VGC,OAdN,IAAiBqO,EAC5B4G,GA2WFG,GAAS,SAAUrV,GACrB,OAAOsV,GAActV,EAAS+U,KAE5BO,GAAgB,SAAU9S,EAAO8L,GACnC,IAAI4G,EAAU,SAAUlV,GAEtB,IADA,IAAIyN,EAAaxB,GAASjM,GACjBjE,EAAI0R,EAAWnX,OAAS,EAAGyF,GAAK,EAAGA,IAAK,CAC/C,IAAImQ,EAAQuB,EAAW1R,GACvB,GAAIuS,EAAUpC,GACZ,OAAOnS,EAAON,KAAKyS,GAErB,IAAIkJ,EAAMF,EAAQhJ,GAClB,GAAIkJ,EAAIld,SACN,OAAOkd,EAGX,OAAOrb,EAAO1C,QAEhB,OAAO6d,EAAQ1S,IAGb+S,GAAU,SAAUC,EAAUC,GAChC,OAAOpT,GAAQF,QAAQqT,EAASvV,MAAMyV,UAAUD,KAE9CE,GAAU,SAAUH,GACtB,OAAOD,GAAQC,GAAU,IAEvBI,GAAO,SAAUJ,GACnB,OAAOD,GAAQC,GAAU,IAQvBK,GAAS,SAAUL,EAAUxS,GAC/B,IAAIqC,EAPU,SAAUmQ,EAAUxS,GAClC,IAAIqC,EAAKhD,GAAQU,QAAQC,GACrB3B,EAAavL,GAAM0f,GAEvB,OADA3U,GAAOwE,EAAIhE,GACJgE,EAGEyQ,CAAUN,EAAUxS,GACzB+S,EAAgB9J,GAAS2J,GAAKJ,IAElC,OADAtI,GAAS7H,EAAI0Q,GACN1Q,GAGL2Q,GAAa,WACf,IAAI/C,EAAK5Q,GAAQU,QAAQ,MAEzB,OADA0J,GAAOwG,EAAI5Q,GAAQU,QAAQ,OACpBkQ,GAELrO,GAAU,SAAUuL,EAAMnN,EAAKlC,GACjC,IAAImV,EAAUJ,GAAO1F,EAAMnN,GAQ3B,OAPAnG,EAAOiE,EAAO,SAAUjL,EAAGmH,GACf,OAANnH,EACFsL,GAAO8U,EAASjZ,GAEhBpH,GAAIqgB,EAASjZ,EAAGnH,KAGbogB,GAELC,GAAe,SAAU/F,GAC3B,OAAOA,GAELgG,GAAS,SAAU5S,GACrB,OAAO,WACL,OAAOlB,GAAQU,QAAQ,KAAMQ,EAAItD,SA+DjCmW,GAAY,CACdC,eA9CmB,SAAUC,EAAQ/S,EAAKgT,GA8B1C,MAAO,CACLhG,IAAK4F,GAAO5S,GACZ4M,KA/BY,SAAUqG,GACtB,IAvgCiBC,EAAQvN,EACvBwN,EACAC,EAqgCEC,EAAOrL,GAAMiL,EAAKxW,WAClBiT,EAAK5Q,GAAQU,QAAQlI,GAAK2b,EAAKxW,WAAY4W,EAAK3W,OAChD4W,EAAUN,EAAepe,MAAM,CACjC,SACA,KACA,IACA,IACA,OACA,OACA,KACA,KACA,KACA,KACA,KACA,KACA,IACA,QAEE2e,EAAWD,EAAQvgB,OAAS,EAnCjB,SAAUygB,EAASC,EAASH,GAE7C,OADc5B,GAAM8B,GACLle,IAAI,SAAUoe,GAC3B,IAAIC,EAAiBL,EAAQ/Y,KAAK,KAC9B2N,EAAU+C,GAAYyI,EAAWC,EAAgB,SAAUlX,GAC7D,OAAOzI,GAAGyI,EAAS+W,KAErB,OAAO7a,EAAMuP,EAAS,SAAU0L,EAAM3L,GACpC,IAAI4L,EAAezB,GAAQnK,GAG3B,OAFArK,GAAOiW,EAAc,mBACrB3K,GAAO0K,EAAMC,GACNA,GACNJ,KACF7e,MAAM6e,GAsB6BK,CAAab,EAAKxW,UAAWiT,EAAI4D,GAAW5D,EAQhF,OAPAxG,GAAOqK,EAAUzU,GAAQU,QAAQ,OA1hChB0T,EA2hCZD,EAAKxW,UA3hCekJ,EA2hCJ+J,EA1hCnByD,EAAYD,EAAOxW,MACnB0W,EAAYzN,EAAOjJ,MACnB6B,GAAY4U,IAAc5U,GAAY6U,KACxCA,EAAU5U,MAAMuV,QAAUZ,EAAU3U,MAAMuV,SAwhC1C7S,GAASwO,EAAI,UACU,IAAnBuD,EAAKtF,WACPzM,GAAS+R,EAAKxW,UAAW,SAE3BsW,EAAOE,EAAKxW,UAAWiT,GAChBA,GAKPrO,QAASA,GACT2S,IAAKvB,KAaPwB,MAVU,SAAUjU,GACpB,MAAO,CACLgN,IAAK4F,GAAO5S,GACZ4M,KAAM6F,GACNpR,QAASsR,GACTqB,IAAKvB,MAsBLyB,GAAW,SAAUrJ,EAAQR,GAC/B,OAAOA,EAAOyD,UAAYjD,EAAO2F,YAAcnG,EAAOyD,SAAWzD,EAAOsD,UAAY,GAAK9C,EAAOsJ,aAAe9J,EAAO2C,OAASnC,EAAOyF,YAAcjG,EAAO2C,MAAQ3C,EAAOqD,UAAY,GAAK7C,EAAOuJ,aAYhMC,GApBc,SAAUxJ,EAAQR,GAClC,IAAIiK,EAAWjK,EAAOyD,SAClByG,EAAYlK,EAAOyD,SAAWzD,EAAOsD,UAAY,EACjD6G,EAAUnK,EAAO2C,MACjByH,EAAapK,EAAO2C,MAAQ3C,EAAOqD,UAAY,EACnD,OAAO4G,GAAYzJ,EAAOsJ,aAAeI,GAAa1J,EAAO2F,YAAegE,GAAW3J,EAAOuJ,aAAeK,GAAc5J,EAAOyF,YAehI+D,GAVgB,SAAUrG,EAAWnD,GAGvC,IAFA,IAAI6J,GAAS,EACTC,EAAiBvhB,EAAM8gB,GAAUrJ,GAC5BrS,EAAIqS,EAAOyF,WAAY9X,GAAKqS,EAAOuJ,YAAa5b,IACvD,IAAK,IAAIiW,EAAI5D,EAAO2F,WAAY/B,GAAK5D,EAAOsJ,YAAa1F,IACvDiG,EAASA,GAAUzG,GAAUc,MAAMf,EAAWxV,EAAGiW,GAAGhZ,OAAOkf,GAG/D,OAAOD,EAASle,EAAON,KAAK2U,GAAUrU,EAAO1C,QAW3C8gB,GAAY,SAAU5G,EAAW6G,EAAWC,GAC9C,IAAIC,EAAc9G,GAAUe,SAAShB,EAAW6G,EAAW7gB,IACvDghB,EAAe/G,GAAUe,SAAShB,EAAW8G,EAAY9gB,IAC7D,OAAO+gB,EAAYvf,KAAK,SAAUyf,GAChC,OAAOD,EAAa1f,IAAI,SAAU4f,GAChC,OARoBC,EAQHF,EARYG,EAQRF,EAPlBrK,GAAO+D,KAAKyG,IAAIF,EAAQnI,MAAOoI,EAAQpI,OAAQ4B,KAAKyG,IAAIF,EAAQrH,SAAUsH,EAAQtH,UAAWc,KAAKC,IAAIsG,EAAQnI,MAAQmI,EAAQzH,UAAY,EAAG0H,EAAQpI,MAAQoI,EAAQ1H,UAAY,GAAIkB,KAAKC,IAAIsG,EAAQrH,SAAWqH,EAAQxH,UAAY,EAAGyH,EAAQtH,SAAWsH,EAAQzH,UAAY,IADxQ,IAAUwH,EAASC,OAiB/BE,GACSV,GADTU,GALS,SAAUtH,EAAW6G,EAAWC,GAC3C,OAAOF,GAAU5G,EAAW6G,EAAWC,GAAYtf,KAAK,SAAUqV,GAChE,OAAOwJ,GAAyBrG,EAAWnD,MAkC3C0K,GA1BS,SAAUvH,EAAWpB,EAAMI,EAAKc,GAC3C,OAAOG,GAAUe,SAAShB,EAAWpB,EAAM5Y,IAAIwB,KAAK,SAAU6U,GAC5D,IAAIiG,EAAWtD,EAAM,EAAI3C,EAAO2C,MAAQ3C,EAAOqD,UAAY,EAAIrD,EAAO2C,MAClEwD,EAAW1C,EAAS,EAAIzD,EAAOyD,SAAWzD,EAAOsD,UAAY,EAAItD,EAAOyD,SAE5E,OADWG,GAAUc,MAAMf,EAAWsC,EAAWtD,EAAKwD,EAAW1C,GACrDxY,IAAI,SAAU0F,GACxB,OAAOA,EAAEyB,eAoBX8Y,GAhBa,SAAUvH,EAAW7P,EAAOqX,GAC3C,OAAOF,GAAoBtH,EAAW7P,EAAOqX,GAAQlgB,IAAI,SAAUuV,GACjE,IAAI4K,EAASxH,GAAUF,YAAYC,EAAW5a,EAAMihB,GAAwBxJ,IAC5E,OAAOvV,EAAImgB,EAAQ,SAAUpL,GAC3B,OAAOA,EAAO5N,eAYhB8Y,GARa,SAAUvH,EAAW0H,GAIpC,OAAOzH,GAAUe,SAAShB,EAAW0H,EAHjB,SAAUC,EAAIC,GAChC,OAAOhO,GAAWgO,EAAID,KAEuCrgB,IAAI,SAAU+U,GAC3E,OAAOA,EAAO5N,aAiCdoZ,GAAe,SAAU9I,GAC3B,IAAIoB,EAAOZ,GAAsBR,GACjC,OAAOkB,GAAUC,SAASC,IAExB2H,GA5BW,SAAUlJ,EAAMmJ,EAAUC,GACvC,OAAOrJ,GAAYI,MAAMH,GAAMpX,KAAK,SAAUuX,GAC5C,IAAIiB,EAAY6H,GAAa9I,GAC7B,OAAOwI,GAAkBvH,EAAWpB,EAAMmJ,EAAUC,MAyBpDF,GAtBe,SAAU/I,EAAO2E,EAAOkC,GACzC,IAAI5F,EAAY6H,GAAa9I,GAC7B,OAAOwI,GAAsBvH,EAAW0D,EAAOkC,IAoB7CkC,GAlBmB,SAAU/I,EAAO2E,EAAOuE,EAAYrC,EAAMsC,GAC/D,IAAIlI,EAAY6H,GAAa9I,GACzBoJ,EAAeniB,GAAG+Y,EAAOkJ,GAAczf,EAAON,KAAKwb,GAAS6D,GAAsBvH,EAAW0D,GAC7F0E,EAAcpiB,GAAG+Y,EAAOmJ,GAAa1f,EAAON,KAAK0d,GAAQ2B,GAAsBvH,EAAW4F,GAC9F,OAAOuC,EAAa3gB,KAAK,SAAUqf,GACjC,OAAOuB,EAAY5gB,KAAK,SAAU6gB,GAChC,OAAOd,GAAsBvH,EAAW6G,EAAWwB,QAYrDP,GARW,SAAU/I,EAAO2E,EAAOkC,GACrC,IAAI5F,EAAY6H,GAAa9I,GAC7B,OAAOuI,GAAiBtH,EAAW0D,EAAOkC,IAaxC0C,GAAgB,CAClB,OACA,IACA,MACA,UACA,QACA,aACA,SACA,SACA,SACA,MACA,UACA,KACA,KACA,KACA,QACA,QACA,QACA,QACA,UACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,aACA,MACA,WAGF,SAASC,KAkCP,MAAO,CACLC,GAAIvjB,EAAS,CACXkU,SAAUuE,GACV+K,QAASzK,GACTjB,UAAWS,GACXhY,IAAK0U,KAEPwO,KAAMzjB,EAAS,CACbkU,SAAUiE,GACVL,UAAWD,KAEb6L,OAAQ1jB,EAAS,CACfb,IAAKyO,GACLG,OAAQA,GACR3O,IAAKqO,GACL9C,OAAQsD,KAEV3D,MAAOtK,EAAS,CACdb,IAAKoL,GACLnL,IAAKA,GACLuL,OAAQA,GACRgZ,OAzBmB,SAAU1D,EAAQ2D,GACvC,IAAIC,EAAKvkB,GAAM2gB,GACf5V,GAAOuZ,EAAaC,MAyBpBC,OAAQ9jB,EAAS,CACf6V,OAAQA,GACRG,MAAOA,GACP+N,SAAUxN,GACVN,OAAQA,GACR+N,UAAWtN,GACXR,QAASA,GACTG,KAAMA,KAER1L,OAAQ3K,EAAS,CACfgX,OAAQA,GACRrM,OAAQmM,KAEVmN,OAAQjkB,EAAS,CACf6O,GAAIhD,GAAQU,QACZjN,MAvEU,SAAUkK,GACtB,OAAOqC,GAAQF,QAAQnC,EAAQC,MAAMyV,WAAU,KAuE7CxS,KAAMb,GAAQY,WAEhBmH,MAAO5T,EAAS,CACdkkB,gBAjDkB,SAAU1a,EAAS2a,GACvC,OAAO3a,EAAQC,MAAM4E,wBAAwB8V,EAAM1a,QAiDjD6L,YAAaA,GACbE,YAAaA,KAEfjI,SAAUvN,EAAS,CACjByV,SAAUA,GACVpR,KAAMA,GACN2Q,OAAQA,GACR9I,SAhFW,SAAU1C,GACvB,OAAOA,EAAQC,MAAM0D,eAgFnBnD,OAAQA,GACRF,UAAWA,GACXC,UAAWA,GACXqa,QAASjG,GACTkG,QAASjG,GACTkG,WAnFa,SAAU9a,GACzB,QAAKO,GAAUP,KAGO,SAAlBnF,GAAKmF,IAGFrE,EAASke,GAAehf,GAAKmF,MA6ElC+a,WA3Ea,SAAU/a,GACzB,QAAKO,GAAUP,IAGRrE,EAAS,CACd,KACA,MACA,KACA,SACCd,GAAKmF,OAoERzI,GAAIA,GACJU,GAAIqT,IAIR,IAAI0P,GAAY1d,EAAU,OAAQ,SAC9B2d,GAAa3d,EAAU,QAAS,SAAU,UAC1C4d,GAAS,SAAUC,EAAU3P,EAAQU,GACvC,IAAID,EAAWkP,EAASpX,WAAWkI,SAAST,GAE5C,OADYjP,EAAU0P,EAAUtV,EAAMwkB,EAAS5jB,GAAI2U,IACtCrT,IAAI,SAAUuiB,GACzB,MAAO,CACL/O,OAAQ7V,EAASyV,EAAS3Q,MAAM,EAAG8f,IACnC5O,MAAOhW,EAASyV,EAAS3Q,MAAM8f,EAAM,QAkDvCC,GAAY,SAAUF,EAAUG,EAAMC,EAAMC,GAC9C,IAAI9Z,EAAQ4Z,EAAKH,EAAUI,GAC3B,OAAOrf,EAAMsf,EAAM,SAAU1hB,EAAGJ,GAC9B,IAAI0M,EAAUkV,EAAKH,EAAUzhB,GAC7B,OAAO+hB,GAAcN,EAAUrhB,EAAGsM,IACjC1E,IAED+Z,GAAgB,SAAUN,EAAUzZ,EAAOga,GAC7C,OAAOha,EAAM3I,KAAK,SAAUf,GAC1B,OAAO0jB,EAAIxiB,OAAOvC,EAAMwkB,EAAS5jB,GAAIS,OAIrC2jB,GAAO,SAAUR,EAAU3I,GAC7B,OAAO7b,EAAMwkB,EAAS5jB,GAAIib,IA0BxBoJ,GAAc,SAAUT,EAAUzZ,EAAOga,EAAKhQ,QACjC,IAAXA,IACFA,EAASvU,GAEX,IAAI0kB,EAAM,CAACna,GAAO1K,OAAOmkB,EAASpB,KAAKhjB,IAAI2K,IACvCoa,EAAM,CAACJ,GAAK1kB,OAAOmkB,EAASpB,KAAKhjB,IAAI2kB,IACrCK,EAAQ,SAAUC,GAEpB,OADYzf,EAAUyf,EAAMtQ,GACf3T,KAAK,WAChB,OAAOikB,GACN,SAAUZ,GACX,OAAOY,EAAK1gB,MAAM,EAAG8f,EAAM,MAG3Ba,EAAUF,EAAMF,GAChBK,EAAUH,EAAMD,GAChBK,EAAS7f,EAAK2f,EAAS,SAAUvlB,GACnC,OAAOsC,EAAOkjB,EAASP,GAAKR,EAAUzkB,MAExC,MAAO,CACL0lB,UAAW5lB,EAASylB,GACpBI,WAAY7lB,EAAS0lB,GACrBC,OAAQ3lB,EAAS2lB,KAoBjBG,GAAS,CACXC,UAtFW,SAAUpB,EAAUG,EAAMtO,GACrC,OAAOA,EAAS1W,OAAS,EANf,SAAU6kB,EAAUG,EAAMtO,EAAU9V,GAG9C,OAAOA,EAAEikB,EAAUG,EAFRtO,EAAS,GACTA,EAAS1R,MAAM,IAIGkhB,CAAMrB,EAAUG,EAAMtO,EAAUqO,IAAathB,EAAO1C,QAsFjFolB,OAnBW,SAAUtB,EAAUzZ,EAAOga,GACtC,IAAIgB,EAAOd,GAAYT,EAAUzZ,EAAOga,GACxC,OAAOgB,EAAKP,SAASpjB,KAAK,SAAUojB,GAClC,OApDe,SAAUhB,EAAUwB,EAAQd,EAAKC,GAClD,IAAI7P,EAAWkP,EAASpX,WAAWkI,SAAS0Q,GAC5C,GAAIxB,EAAS5jB,GAAGolB,EAAQd,EAAI,IAC1B,OAAO9hB,EAAON,KAAK,CAACoiB,EAAI,KAE1B,GAAIV,EAAS5jB,GAAGolB,EAAQb,EAAI,IAC1B,OAAO/hB,EAAON,KAAK,CAACqiB,EAAI,KAE1B,IAAIc,EAAS,SAAUC,GACrB,IAAIC,EAAUpgB,EAAQmgB,GAClB1Q,EAAQ5P,EAAUugB,EAASnB,GAAKR,EAAUwB,IAASxkB,OAAO,GAC1Dqa,EAAOrG,EAAQ2Q,EAAQxmB,OAAS,EAAIwmB,EAAQ3Q,EAAQ,GAAK2Q,EAAQ3Q,GACrE,OAAO5P,EAAU0P,EAAU0P,GAAKR,EAAU3I,KAExCuK,EAAaH,EAAOf,GACpBmB,EAAWJ,EAAOd,GACtB,OAAOiB,EAAWhkB,KAAK,SAAUkkB,GAC/B,OAAOD,EAASnkB,IAAI,SAAUqkB,GAC5B,IAAIjI,EAAQ9C,KAAKyG,IAAIqE,EAAQC,GACzB/F,EAAOhF,KAAKC,IAAI6K,EAAQC,GAC5B,OAAOjR,EAAS3Q,MAAM2Z,EAAOkC,EAAO,OAgC/BgG,CAAahC,EAAUgB,EAAQO,EAAKN,YAAaM,EAAKL,iBAiB/D5N,UAZWmN,GAaXwB,YA5HgB,SAAUjC,EAAU3P,EAAQU,GAC5C,OAAOgP,GAAOC,EAAU3P,EAAQU,GAAOrT,IAAI,SAAUwkB,GACnD,IAAIC,EAAQnC,EAASV,SAAS3kB,MAAM0V,GAIpC,OAHA2P,EAASb,SAASE,UAAU8C,EAAOD,EAAMhR,SAASrV,OAAO,CAACkV,KAC1DiP,EAASb,SAASE,UAAUhP,EAAQ6R,EAAM7Q,SAC1C2O,EAASb,SAASjO,OAAOb,EAAQ8R,GAC1BtC,GAAUsC,EAAO9R,MAuH1B+R,aArIiB,SAAUpC,EAAU3P,EAAQU,GAC7C,OAAOgP,GAAOC,EAAU3P,EAAQU,GAAOrT,IAAI,SAAUwkB,GACnD,IAAIG,EAASrC,EAASV,SAAS3kB,MAAM0V,GAGrC,OAFA2P,EAASb,SAASE,UAAUgD,EAAQH,EAAM7Q,SAC1C2O,EAASb,SAAS9N,MAAMhB,EAAQgS,GACzBxC,GAAUxP,EAAQgS,MAiI3BC,UArHc,SAAUtC,EAAU3I,EAAMkL,EAAOC,GAC/C,IAAIC,EAAO,SAAU1R,EAAOlG,EAAO6X,GACjC,IAAIC,EAAW7C,GAAW/O,EAAOnS,EAAO1C,OAAQwmB,GAChD,OAAIH,EAAMxR,GACD+O,GAAW/O,EAAOlG,EAAO6X,GAEzB1C,EAASpX,WAAWyH,OAAOU,GAAOnT,KAAK,SAAUyS,GACtD,OAAOmS,EAAQxC,EAAU3P,EAAQU,GAAOrT,IAAI,SAAUklB,GACpD,IAAIC,EAAQ,CAAC,CACT/I,MAAO8I,EAASE,KAChBT,OAAQO,EAASG,QAEjBC,EAAYT,EAAMlS,GAAUA,EAASuS,EAASE,OAClD,OAAOL,EAAKO,EAAWpkB,EAAON,KAAKskB,EAASG,SAAUL,EAAO7mB,OAAOgnB,QAErE7lB,MAAM2lB,IAGb,OAAOF,EAAKpL,EAAMzY,EAAO1C,OAAQ,MAsG/B8jB,GAAWrB,KAuBXsE,GAAY,CACd7B,UAvBgB,SAAUjB,EAAMtO,GAChC,OAAOsP,GAAOC,UAAUpB,GAAU,SAAUkD,EAAWre,GACrD,OAAOsb,EAAKtb,IACXgN,IAqBHyP,OAnBa,SAAU/a,EAAOqX,GAC9B,OAAOuD,GAAOG,OAAOtB,GAAUzZ,EAAOqX,IAmBtCtK,UAjBgB,SAAU/M,EAAOqX,EAAQrN,GACzC,OAAO4Q,GAAO7N,UAAU0M,GAAUzZ,EAAOqX,EAAQrN,IAiBjD0R,YAfkB,SAAU5R,EAAQU,GACpC,OAAOoQ,GAAOc,YAAYjC,GAAU3P,EAAQU,IAe5CqR,aAbmB,SAAU/R,EAAQU,GACrC,OAAOoQ,GAAOiB,aAAapC,GAAU3P,EAAQU,IAa7CuR,UAXgB,SAAUvR,EAAOwR,EAAOC,GACxC,OAAOrB,GAAOmB,UAAUtC,GAAUjP,EAAOwR,EAAO,SAAUY,EAAGpZ,EAAGqZ,GAC9D,OAAOZ,EAAQzY,EAAGqZ,OAiBlBC,GAAa,CAAE/D,OALNjc,EAAS,CACpB,QACA,QACA,UACC,KAGCigB,GAAc,SAAUC,GAC1B,OAAOzP,GAAWyP,EAAW,UAE3BC,GAAW,SAAUjd,EAAOqX,EAAQrN,GACtC,IAAIkT,EAAY,SAAUC,GACxB,OAAO,SAAU7e,GACf,YAAkBtH,IAAXgT,GAAwBA,EAAO1L,IAAYzI,GAAGyI,EAAS6e,KAGlE,OAAItnB,GAAGmK,EAAOqX,GACLhf,EAAON,KAAK+kB,GAAW/D,OAAO,CACnCqE,MAAO/kB,EAAON,KAAK,CAACiI,IACpBA,MAAOA,EACPqX,OAAQA,KAGH0F,GAAY/c,GAAO3I,KAAK,SAAUgmB,GACvC,OAAON,GAAY1F,GAAQhgB,KAAK,SAAUimB,GACxC,GAAIznB,GAAGwnB,EAAYC,GACjB,OAAOjlB,EAAON,KAAK+kB,GAAW/D,OAAO,CACnCqE,MAAOzF,GAA0B0F,EAAYrd,EAAOqX,GACpDrX,MAAOA,EACPqX,OAAQA,KAEL,GAAI5N,GAAW4T,EAAYC,GAAc,CAC9C,IACI3G,GADA4G,EAAgBzQ,GAAYuK,EAAQ,QAAS6F,EAAUG,KAC5BzoB,OAAS,EAAI2oB,EAAcA,EAAc3oB,OAAS,GAAKyiB,EACtF,OAAOhf,EAAON,KAAK+kB,GAAW/D,OAAO,CACnCqE,MAAOzF,GAAgC0F,EAAYrd,EAAOqd,EAAYhG,EAAQiG,GAC9Etd,MAAOA,EACPqX,OAAQV,KAEL,GAAIlN,GAAW6T,EAAaD,GAAa,CAC9C,IAAIE,EACA7G,GADA6G,EAAgBzQ,GAAY9M,EAAO,QAASkd,EAAUI,KAC5B1oB,OAAS,EAAI2oB,EAAcA,EAAc3oB,OAAS,GAAKoL,EACrF,OAAO3H,EAAON,KAAK+kB,GAAW/D,OAAO,CACnCqE,MAAOzF,GAAgC2F,EAAatd,EAAOqd,EAAYhG,EAAQiG,GAC/Etd,MAAOA,EACPqX,OAAQX,KAGV,OAAOgG,GAAU3P,UAAU/M,EAAOqX,GAAQoD,SAASpjB,KAAK,SAAUmmB,GAChE,OAAO3P,GAAU2P,EAAK,QAASxT,GAAQ3S,KAAK,SAAUomB,GACpD,IAAIC,EAAsB5Q,GAAYuK,EAAQ,QAAS6F,EAAUO,IAC7D9G,EAAa+G,EAAoB9oB,OAAS,EAAI8oB,EAAoBA,EAAoB9oB,OAAS,GAAKyiB,EACpGsG,EAAqB7Q,GAAY9M,EAAO,QAASkd,EAAUO,IAC3D/G,EAAYiH,EAAmB/oB,OAAS,EAAI+oB,EAAmBA,EAAmB/oB,OAAS,GAAKoL,EACpG,OAAO3H,EAAON,KAAK+kB,GAAW/D,OAAO,CACnCqE,MAAOzF,GAAgC8F,EAAUzd,EAAOqd,EAAYhG,EAAQiG,GAC5Etd,MAAO0W,EACPW,OAAQV,cAwDpBiH,GAAgB,CAClBX,SAAUA,GACVY,SAjDa,SAAUb,EAAWhU,GAClC,IAAI8U,EAAO7Q,GAAc+P,EAAWhU,GACpC,OAAO8U,EAAKlpB,OAAS,EAAIyD,EAAON,KAAK+lB,GAAQzlB,EAAO1C,QAgDpDooB,eAVmB,SAAUX,EAAOxF,EAAUC,EAAamG,EAAuBC,GAClF,OArCY,SAAUb,EAAOa,GAC7B,OAAOrjB,EAAKwiB,EAAO,SAAUc,GAC3B,OAAO3nB,GAAG2nB,EAAKD,KAmCVE,CAAQf,EAAOa,GAAsB5mB,KAAK,SAAUoe,GACzD,OAAOkC,GAAsBlC,EAAMmC,EAAUC,GAAaxgB,KAAK,SAAUggB,GACvE,OAlBS,SAAUA,EAAQ2G,GAC/B,OAAOzQ,GAAW8J,EAAQ,SAAShgB,KAAK,SAAUuX,GAChD,OAAOlB,GAAakB,EAAOoP,GAAuB3mB,KAAK,SAAU2I,GAC/D,OAAOid,GAASjd,EAAOqX,GAAQhgB,KAAK,SAAU+mB,GAC5C,OAAOA,EAAWhB,QAAQjmB,IAAI,SAAUimB,GACtC,MAAO,CACLA,MAAOtoB,EAASsoB,GAChBpd,MAAOlL,EAASspB,EAAWpe,SAC3BqX,OAAQviB,EAASspB,EAAW/G,mBAU3BgH,CAAShH,EAAQ2G,QAQ5BM,SA1Ca,SAAUtB,EAAWgB,EAAuBC,GACzD,OAAOvQ,GAAasP,EAAWgB,GAAuB3mB,KAAK,SAAUkc,GACnE,OAAO7F,GAAasP,EAAWiB,GAAsB5mB,KAAK,SAAUoe,GAClE,OAAOiH,GAAU7B,UAAUkC,GAAa,CACtCxJ,EACAkC,IACCte,IAAI,SAAUonB,GACf,MAAO,CACLhL,MAAOze,EAASye,GAChBkC,KAAM3gB,EAAS2gB,GACf7G,MAAO9Z,EAASypB,YAoDtBC,GAjBa,SAAUxB,EAAWhU,GACpC,OAAO4U,GAAcC,SAASb,EAAWhU,IAgBvCwV,GAdc,SAAUxB,EAAWgB,EAAuBC,GAC5D,OAAOL,GAAcU,SAAStB,EAAWgB,EAAuBC,GAAsB5mB,KAAK,SAAUonB,GACnG,IAAIzU,EAAS,SAAUqD,GACrB,OAAOxX,GAAGmnB,EAAW3P,IAEnBqR,EAAgBnR,GAAWkR,EAAMlL,QAAS,0BAA2BvJ,GACrE2U,EAAepR,GAAWkR,EAAMhJ,OAAQ,0BAA2BzL,GACvE,OAAO0U,EAAcrnB,KAAK,SAAUunB,GAClC,OAAOD,EAAatnB,KAAK,SAAUwnB,GACjC,OAAOhpB,GAAG+oB,EAAIC,GAAMlH,GAAsB8G,EAAM7P,QAAS6P,EAAMlL,QAASkL,EAAMhJ,QAAUpd,EAAO1C,cAUnGmpB,GAAW,oBAOXC,GAAW,CACbD,SAAUhqB,EAASgqB,IACnBrN,iBAAkB3c,EARG,+CASrBkqB,kBAAmBlqB,EARG,uBAStBmqB,cAAenqB,EARG,2BASlBkpB,sBAAuBlpB,EARG,2DAS1BoqB,aAAcpqB,EARG,0BASjBmpB,qBAAsBnpB,EARG,0DA8EvBqqB,GAnEa,SAAUC,GACzB,IAAK7lB,EAAQ6lB,GACX,MAAM,IAAIvoB,MAAM,0BAElB,GAAqB,IAAjBuoB,EAAMxqB,OACR,MAAM,IAAIiC,MAAM,mCAElB,IAAIwoB,EAAe,GACfC,EAAM,GAyDV,OAxDAloB,EAAKgoB,EAAO,SAAUG,EAAOC,GAC3B,IAAIxiB,EAAS/B,EAAKskB,GAClB,GAAsB,IAAlBviB,EAAOpI,OACT,MAAM,IAAIiC,MAAM,kCAElB,IAAI6E,EAAMsB,EAAO,GACbhJ,EAAQurB,EAAM7jB,GAClB,QAAiB1E,IAAbsoB,EAAI5jB,GACN,MAAM,IAAI7E,MAAM,0BAA4B6E,GACvC,GAAY,SAARA,EACT,MAAM,IAAI7E,MAAM,yCACX,IAAK0C,EAAQvF,GAClB,MAAM,IAAI6C,MAAM,mCAElBwoB,EAAarlB,KAAK0B,GAClB4jB,EAAI5jB,GAAO,WACT,IAAI+jB,EAAY9qB,UAAUC,OAC1B,GAAI6qB,IAAczrB,EAAMY,OACtB,MAAM,IAAIiC,MAAM,qCAAuC6E,EAAM,cAAgB1H,EAAMY,OAAS,KAAOZ,EAAQ,UAAYyrB,GAGzH,IADA,IAAIhrB,EAAO,IAAIsE,MAAM0mB,GACZplB,EAAI,EAAGA,EAAI5F,EAAKG,OAAQyF,IAC/B5F,EAAK4F,GAAK1F,UAAU0F,GAetB,MAAO,CACLhE,KAAM,WACJ,GAAI1B,UAAUC,SAAWwqB,EAAMxqB,OAC7B,MAAM,IAAIiC,MAAM,+CAAiDuoB,EAAMxqB,OAAS,SAAWD,UAAUC,QAGvG,OADaD,UAAU6qB,GACT3qB,MAAM,KAAMJ,IAE5B2O,MArBU,SAAUsc,GACpB,IAAIC,EAAa1kB,EAAKykB,GACtB,GAAIL,EAAazqB,SAAW+qB,EAAW/qB,OACrC,MAAM,IAAIiC,MAAM,iDAAmDwoB,EAAajjB,KAAK,KAAO,aAAeujB,EAAWvjB,KAAK,MAK7H,IAHc7E,EAAO8nB,EAAc,SAAUO,GAC3C,OAAO3lB,EAAS0lB,EAAYC,KAG5B,MAAM,IAAI/oB,MAAM,gEAAkE8oB,EAAWvjB,KAAK,MAAQ,eAAiBijB,EAAajjB,KAAK,OAE/I,OAAOsjB,EAAShkB,GAAK7G,MAAM,KAAMJ,IAWjCorB,IAAK,SAAUrjB,GACb3I,EAAWmL,QAAQ6gB,IAAIrjB,EAAO,CAC5B6iB,aAAcA,EACdnmB,YAAawC,EACbokB,OAAQrrB,SAMX6qB,GAILS,GAASZ,GAAa,CACxB,CAAExpB,KAAM,IACR,CAAEqqB,SAAU,CAAC,aACb,CAAEC,OAAQ,CAAC,gBAKTC,GAAiB,CACnBC,KAJS,SAAUC,EAASC,EAAQC,EAAYC,GAChD,OAAOH,EAAQ/pB,KAAKgqB,EAAQC,EAAYC,IAIxC5qB,KAAMoqB,GAAOpqB,KACbqqB,SAAUD,GAAOC,SACjBC,OAAQF,GAAOE,QAGbO,GAAY,SAAU/R,EAAMgS,GAC9B,OAAOP,GAAeC,KAAKM,EAAWxsB,MAAOa,EAAS,IAAKC,EAAUD,EAAS,CAAC2Z,MAsB7EiS,GAbW,SAAU9R,EAAO6R,GAC9B,OAAOP,GAAeC,KAAKM,EAAWxsB,MAAOoE,EAAO1C,KAAM,SAAUgZ,EAAOgS,GACzE,OAAqB,IAAjBhS,EAAM/Z,OACDyD,EAAO1C,OAET6oB,GAA2B5P,EAAOmQ,GAASf,wBAAyBe,GAASd,wBAAwB5mB,KAAK,SAAUqV,GACzH,OAAOiC,EAAM/Z,OAAS,EAAIyD,EAAON,KAAK,CACpC2U,OAAQ5X,EAAS4X,GACjBiC,MAAO7Z,EAAS6Z,KACbtW,EAAO1C,UAEb0C,EAAO1C,OAER+qB,GApBa,SAAUjS,EAAMgS,GAC/B,IAGI5Z,EAAa2Z,GAAU/R,EAAMgS,GACjC,OAAO5Z,EAAWjS,OAAS,GAAK2C,EAAOsP,EAJzB,SAAUoC,GACtB,OAAO1J,GAAM0J,EAAM,YAAcsF,SAASlP,GAAM4J,EAAM,WAAY,IAAM,GAAK1J,GAAM0J,EAAM,YAAcsF,SAASlP,GAAM4J,EAAM,WAAY,IAAM,IAGlF5Q,EAAON,KAAK8O,GAAcxO,EAAO1C,QAe7F+qB,GAGSF,GAGTI,GAAS,SAAUnS,GACrB,MAAO,CACLnQ,QAASxJ,EAAS2Z,GAClBoS,SAAUxoB,EAAO1C,KACjBmrB,WAAYzoB,EAAO1C,KACnB6qB,UAAW1rB,EAAS,CAAC2Z,MAcrBsS,GAAUnlB,EAAU,UAAW,YAAa,cAW5ColB,GAAe,CACjBJ,OAAQA,GACRK,QAxBY,SAAUR,EAAY7R,EAAOH,GACzC,MAAO,CACLnQ,QAASxJ,EAAS2Z,GAClBoS,SAAU/rB,EAAS4rB,GAAwB9R,EAAO6R,IAClDK,WAAYhsB,EAAS4rB,GAA0BjS,EAAMgS,IACrDD,UAAW1rB,EAAS4rB,GAAyBjS,EAAMgS,MAoBrD1R,QAjBc,SAAUzQ,GACxB,OAAOsiB,GAAOtiB,IAiBdwX,MAAOiL,GACPG,UAfc,SAAUT,EAAY7R,EAAOH,EAAM0S,EAAWC,GAC5D,MAAO,CACL9iB,QAASxJ,EAAS2Z,GAClBoS,SAAUxoB,EAAO1C,KACjBmrB,WAAYzoB,EAAO1C,KACnB6qB,UAAW1rB,EAAS4rB,GAAyBjS,EAAMgS,IACnDU,UAAWrsB,EAASqsB,GACpBC,WAAYtsB,EAASssB,MA+DrBC,GAAY,CAAEC,eArCG,SAAUC,EAAQd,EAAYe,EAASC,GAC1DF,EAAOG,GAAG,mBAAoB,SAAUnW,IAOlB,IAAhBA,EAAEiV,WACJN,GAAeC,KAAKM,EAAWxsB,MAAOI,EAPjB,SAAUsa,GAC/BpD,EAAEoW,iBAlBc,SAAUhT,GAC9B,OAAOH,GAAYI,MAAMD,EAAM,IAAIxX,IAAI+c,IAAM/c,IAAI,SAAUod,GACzD,MAAO,CAAC/C,GAAqB+C,EAASwK,GAASC,wBAiB7C4C,CAAgBjT,GAAOvX,KAAK,SAAUkU,GACpCC,EAAEsW,QAAuB,SAAbtW,EAAEuW,OAVD,SAAUxW,GAC7B,OAAOnU,EAAImU,EAAU,SAAUhN,GAC7B,OAAOA,EAAQC,MAAMwjB,YACpB3lB,KAAK,IAOgC4lB,CAAe1W,GAfjC,SAAUiW,EAAQjW,GACxC,OAAOnU,EAAImU,EAAU,SAAU6C,GAC7B,OAAOoT,EAAOf,UAAUyB,WAAWC,UAAU/T,EAAI5P,MAAO,MACvDnC,KAAK,IAY2D+lB,CAAkBZ,EAAQjW,MAI3BjX,KAGlEktB,EAAOG,GAAG,mBAAoB,SAAUnW,IAClB,IAAhBA,EAAEiV,YAAkC,IAAZjV,EAAEuK,OACdzd,EAAOC,KAAKipB,EAAOhjB,IAAI6jB,UAAUb,EAAOf,UAAU6B,WAAY,UACpEjrB,KAAK,SAAUkrB,GACrB,IAAI7T,EAAO9N,GAAQF,QAAQ6hB,GAC3B9T,GAAYI,MAAMH,GAAMrX,KAAK,SAAUwX,GACrC,IA1wBiB/N,EAAMC,EAE3BC,EAwwBQuK,EAAW9T,GA1wBEqJ,EA0wBgB0K,EAAEsW,SAxwBvC9gB,GADMD,GAASjN,EAAWmN,UAChBC,cAAc,QACxBC,UAAYL,EACT0J,GAAS5J,GAAQF,QAAQM,KAswBqB,SAAU8gB,GACrD,MAAyB,SAAlB1oB,GAAK0oB,KAEd,GAAwB,IAApBvW,EAAS1W,QAAsC,UAAtBuE,GAAKmS,EAAS,IAAiB,CAC1DC,EAAEoW,iBACF,IAAI9f,EAAMlB,GAAQF,QAAQ8gB,EAAOgB,UAC7BnB,EAAa1M,GAAUoB,MAAMjU,GAC7B2gB,EAAUxB,GAAalL,MAAMrH,EAAMnD,EAAS,GAAI8V,GACpDI,EAAQiB,WAAW7T,EAAO4T,GAASprB,KAAK,SAAUsrB,GAChDnB,EAAOf,UAAUmC,OAAOD,GACxBnB,EAAOqB,QACPnB,EAAcoB,MAAMjU,cAUlC,SAASkU,GAAW3pB,EAAM4pB,GACxB,IASI9uB,EAAM,SAAUqK,GAClB,IAAI/D,EAAIwoB,EAAUzkB,GAClB,GAAI/D,GAAK,GAAW,OAANA,EAAY,CACxB,IAAIkI,EAAMC,GAAMpE,EAASnF,GACzB,OAAO6pB,WAAWvgB,IAAQ,EAE5B,OAAOlI,GAGL0oB,EAAY,SAAU3kB,EAAS4kB,GACjC,OAAOvoB,EAAMuoB,EAAY,SAAUzoB,EAAK4H,GACtC,IAAI8gB,EAAMzgB,GAAMpE,EAAS+D,GACrBrO,OAAgBgD,IAARmsB,EAAoB,EAAI5U,SAAS4U,EAAK,IAClD,OAAOC,MAAMpvB,GAASyG,EAAMA,EAAMzG,GACjC,IAOL,MAAO,CACLE,IA/BQ,SAAUoK,EAAS+kB,GAC3B,IAAK3pB,EAAS2pB,KAAOA,EAAEjgB,MAAM,YAC3B,MAAM,IAAIvM,MAAMsC,EAAO,wDAA0DkqB,GAEnF,IAAI9kB,EAAMD,EAAQC,MACd6B,GAAY7B,KACdA,EAAI8B,MAAMlH,GAAQkqB,EAAI,OA0BxBpvB,IAAKA,EACLqvB,SAhBarvB,EAiBbgvB,UAAWA,EACXvS,IAVQ,SAAUpS,EAAStK,EAAOkvB,GAClC,IAAIK,EAAuBN,EAAU3kB,EAAS4kB,GAE9C,OADkBlvB,EAAQuvB,EAAuBvvB,EAAQuvB,EAAuB,IAYpF,IAAIC,GAAQV,GAAU,SAAU,SAAUxkB,GACxC,IAAIC,EAAMD,EAAQC,MAClB,OAAOwD,GAAOzD,GAAWC,EAAIklB,wBAAwBC,OAASnlB,EAAIolB,eAEhEC,GAAQ,SAAUtlB,GACpB,OAAOklB,GAAMvvB,IAAIqK,IAEfglB,GAAW,SAAUhlB,GACvB,OAAOklB,GAAMF,SAAShlB,IAGpBulB,GAAQf,GAAU,QAAS,SAAUxkB,GACvC,OAAOA,EAAQC,MAAMulB,cAEnBC,GAAQ,SAAUzlB,GACpB,OAAOulB,GAAM5vB,IAAIqK,IAEf0lB,GAAa,SAAU1lB,GACzB,OAAOulB,GAAMP,SAAShlB,IAGpB2lB,GAAapb,KAQbqb,GAAU,SAAU/V,EAAKhV,EAAMijB,GACjC,OALa,SAAU+H,EAAI/H,GAC3B,IAAIgI,EAAMpB,WAAWmB,GACrB,OAAOf,MAAMgB,GAAOhI,EAAWgI,EAGxBC,CAAS3hB,GAAMyL,EAAKhV,GAAOijB,IAkBhCkI,GAHY,SAAU7V,GACxB,OAvBOwV,GAAW9c,QAAQnC,QAAUif,GAAW9c,QAAQrC,SAS/B,SAAU2J,GAClC,IAAI8V,EAAaL,GAAQzV,EAAM,cAAe,GAC1C+V,EAAgBN,GAAQzV,EAAM,iBAAkB,GAChDgW,EAAYP,GAAQzV,EAAM,mBAAoB,GAC9CiW,EAAeR,GAAQzV,EAAM,sBAAuB,GACpDiV,EAASjV,EAAKlQ,MAAMklB,wBAAwBC,OAGhD,MAAqB,eAFLhhB,GAAM+L,EAAM,cAEQiV,EAASA,EAASa,EAAaC,GADrDC,EAAYC,GAOAC,CAAoBlW,GAAQyV,GAAQzV,EAAM,SAAUmV,GAAMnV,KAOlFmW,GAAmB,uBACnBC,GAA2B,iBAC3BC,GAAsB,qBAOtBC,GAAY,SAAUtW,EAAMuW,GAC9BziB,GAAMkM,EAAM,SAAUuW,EAAS,OAe7BC,GAAqB,SAAUjxB,EAAOya,EAAMyW,EAAQC,GACtD,IA7kEuBrlB,EAAKslB,EA6kExBC,EAAS9W,SAASva,EAAO,IAC7B,OA7kEO6L,GADgBC,EA8kEP9L,EA9kEYoxB,EA8kEL,IA7kEQtlB,EAAIlL,OAASwwB,EAAOxwB,SA6kEL,UAAfuE,GAAKsV,GAVxB,SAAUA,EAAM4W,EAAQH,EAAQC,GAC5C,IAAIG,EAAU9W,GAAYI,MAAMH,GAAMtX,IAAI,SAAUyX,GAClD,IAAI2W,EAAQL,EAAOtW,GACnB,OAAO6B,KAAK+U,MAAMH,EAAS,IAAME,KAChC9uB,MAAM4uB,GAET,OADAF,EAAO1W,EAAM6W,GACNA,EAIiDG,CAAQhX,EAAM4W,EAAQH,EAAQC,GAAUE,GAE9FK,GAAiB,SAAUjX,GAC7B,IAAIza,EAlBe,SAAUya,GAC7B,OAAO5L,GAAO4L,EAAM,UAAU/X,WAAW,WACvC,OAAO4tB,GAAsB7V,GAAQ,OAgB3BkX,CAAelX,GAC3B,OAAKza,EAGEixB,GAAmBjxB,EAAOya,EAAMmV,GAAOmB,IAFrCnB,GAAMnV,IASbmX,GAAU,SAAUnX,EAAM5V,GAC5B,OAAO0G,GAAMkP,EAAM5V,GAAQ0V,SAASlP,GAAMoP,EAAM5V,GAAO,IAAM,GAE3DgtB,GAAc,SAAUvnB,GAE1B,OADeuE,GAAOvE,EAAS,SACfjI,KAAK,WACnB,OAAOgC,EAAOC,KAAK+G,GAAMf,EAAS,WACjC,SAAUwnB,GACX,OAAOztB,EAAON,KAAK+tB,MAGnBC,GAA2B,SAAUC,EAAWC,GAClD,OAAOD,EAAYC,EAAUC,aAAe,KA+D1CC,GAAQ,CACVtB,yBAA0B/vB,EAAS+vB,IACnCC,oBAAqBhwB,EAASgwB,IAC9BsB,cApHkB,SAAU3X,EAAMuW,GAClCziB,GAAMkM,EAAM,QAASuW,EAAS,OAoH9BqB,mBAlHuB,SAAU5X,EAAMuW,GACvCziB,GAAMkM,EAAM,QAASuW,EAAS,MAkH9BD,UAAWA,GACXuB,cAlCkB,SAAU7X,EAAMwX,GAElC,OADYJ,GAAYpX,GACXpY,KAAK,WAChB,OAAO0tB,GAAMtV,IACZ,SAAUyC,GACX,OAjBkB,SAAU5S,EAASwnB,EAAOG,GAC9C,IAAIM,EAAazB,GAAoB0B,KAAKV,GAC1C,GAAmB,OAAfS,EACF,OAAOhY,SAASgY,EAAW,GAAI,IAEjC,IAAIE,EAAe5B,GAAyB2B,KAAKV,GACjD,OAAqB,OAAjBW,EAToB,SAAUT,EAAWC,GAC7C,OAAOD,EAAY,IAAMC,EAAUC,aAU1BQ,CADU1D,WAAWyD,EAAa,IACFR,GAElClC,GAAMzlB,GAOJqoB,CAAgBlY,EAAMyC,EAAG+U,MA8BlCW,mBA3DuB,SAAUnY,EAAMwX,GAEvC,OADYJ,GAAYpX,GACXpY,KAAK,WAChB,IAAIwwB,EAAW9C,GAAMtV,GACrB,OAAOsX,GAAyBc,EAAUZ,IACzC,SAAU/U,GACX,OAfuB,SAAU5S,EAASwnB,EAAOG,GACnD,IAAIQ,EAAe5B,GAAyB2B,KAAKV,GACjD,GAAqB,OAAjBW,EACF,OAAOzD,WAAWyD,EAAa,IAE/B,IAAII,EAAW9C,GAAMzlB,GACrB,OAAOynB,GAAyBc,EAAUZ,GASnCa,CAAqBrY,EAAMyC,EAAG+U,MAsDvCc,gBAzBoB,SAAUtY,GAE9B,OADYoX,GAAYpX,GACXpX,KAAK,SAAU6Z,GAC1B,IAAI9N,EAAQwhB,GAAiB4B,KAAKtV,GAClC,OAAc,OAAV9N,EACK/K,EAAON,KAAK,CACjB+tB,MAAOhxB,EAASkuB,WAAW5f,EAAM,KACjC4jB,KAAMlyB,EAASsO,EAAM,MAGhB/K,EAAO1C,UAgBlBsxB,gBAZoB,SAAUxY,EAAMuW,EAAQgC,GAC5CzkB,GAAMkM,EAAM,QAASuW,EAASgC,IAY9BE,UA9BgB,SAAUzY,GAC1B,OA7DU,SAAUA,EAAM5V,EAAMrD,GAGhC,OAFQA,EAAEiZ,GACCmX,GAAQnX,EAAM5V,GA2DlBsuB,CAAM1Y,EAAM,UAAWiX,KA8B9BG,YAAaA,IAWXuB,GARQ,SAAUC,EAAMpO,GACdkN,GAAMY,gBAAgBM,GAC5BjwB,KAAK,SAAU8Z,GACnB,IAAIoW,EAAWpW,EAAE4U,QAAU,EAC3BK,GAAMc,gBAAgBI,EAAMC,EAAUpW,EAAE8V,QACxCb,GAAMc,gBAAgBhO,EAAOqO,EAAUpW,EAAE8V,WAKzCzsB,GAAI,SAAUgiB,EAAMgL,GAItB,MAAO,CACLhL,KAAMznB,EAASynB,GACfgL,IAAKzyB,EAASyyB,GACdC,UANc,SAAUxyB,EAAG4M,GAC3B,OAAOrH,GAAEgiB,EAAOvnB,EAAGuyB,EAAM3lB,MAQzB6lB,GAAWltB,GAMXmtB,GAAqB,SAAU1vB,EAAGI,GACpC,YAAapB,IAANgB,EAAkBA,OAAUhB,IAANoB,EAAkBA,EAAI,GAEjDuvB,GAAW,SAAUrpB,GACvB,IAAIuD,EAAMvD,EAAQC,MAAM0D,cACpBC,EAAOL,EAAIK,KACX0lB,EAAM/lB,EAAIgmB,YACVhnB,EAAOgB,EAAIimB,gBACf,GAAI5lB,IAAS5D,EAAQC,MACnB,OAAOkpB,GAASvlB,EAAK6lB,WAAY7lB,EAAK8lB,WAExC,IAAIC,EAAYP,GAAmBE,EAAIM,YAAarnB,EAAKonB,WACrDE,EAAaT,GAAmBE,EAAIQ,YAAavnB,EAAKsnB,YACtDE,EAAYX,GAAmB7mB,EAAKwnB,UAAWnmB,EAAKmmB,WACpDC,EAAaZ,GAAmB7mB,EAAKynB,WAAYpmB,EAAKomB,YAC1D,OAAOC,GAASjqB,GAASkpB,UAAUW,EAAaG,EAAYL,EAAYI,IAEtEE,GAAW,SAAUjqB,GACvB,IAAIC,EAAMD,EAAQC,MAEd2D,EADM3D,EAAI0D,cACCC,KACf,OAAIA,IAAS3D,EACJkpB,GAASvlB,EAAK6lB,WAAY7lB,EAAK8lB,WAEnCjmB,GAAOzD,GA5BI,SAAUC,GAC1B,IAAI2f,EAAM3f,EAAIklB,wBACd,OAAOgE,GAASvJ,EAAI3B,KAAM2B,EAAIqJ,KA6BvBiB,CAAYjqB,GAFVkpB,GAAS,EAAG,IAKnBgB,GAAU7sB,EAAU,MAAO,KAC3B8sB,GAAU9sB,EAAU,MAAO,KAC3B+sB,GAAU,SAAUla,GAEtB,OADUkZ,GAASlZ,GACR8N,OAASyH,GAAWvV,IAE7Bma,GAAU,SAAUna,GACtB,OAAOkZ,GAASlZ,GAAM8N,QAEpBsM,GAAc,SAAUpe,EAAOgE,GACjC,OAAOia,GAAQje,EAAOme,GAAQna,KAE5Bqa,GAAe,SAAUre,EAAOgE,GAClC,OAAOia,GAAQje,EAAOke,GAAQla,KAE5Bsa,GAAS,SAAUta,GACrB,OAAOkZ,GAASlZ,GAAM8Y,OAEpByB,GAAa,SAAUve,EAAOgE,GAChC,OAAOga,GAAQhe,EAAOse,GAAOta,KAE3Bwa,GAAgB,SAAUxe,EAAOgE,GACnC,OAAOga,GAAQhe,EAAOse,GAAOta,GAAQ6U,GAAS7U,KAE5Cya,GAAgB,SAAUC,EAAcC,EAAc3sB,GACxD,GAAqB,IAAjBA,EAAM7H,OACR,MAAO,GAET,IAAIy0B,EAAQlyB,EAAIsF,EAAM7C,MAAM,GAAI,SAAU0vB,EAAY7e,GACpD,OAAO6e,EAAWnyB,IAAI,SAAUsX,GAC9B,OAAO0a,EAAa1e,EAAOgE,OAG3B8a,EAAW9sB,EAAMA,EAAM7H,OAAS,GAAGuC,IAAI,SAAUsX,GACnD,OAAO2a,EAAa3sB,EAAM7H,OAAS,EAAG6Z,KAExC,OAAO4a,EAAM/zB,OAAO,CAACi0B,KA0BnBC,GAAe,CACjB9F,OAtBW,CACX+F,MAAO10B,EACP20B,UAAW,SAAUC,GACnB,OAAOT,GAAcF,GAAYC,GAAeU,IAElDtkB,KAAM0jB,IAkBNa,IATQ,CACRH,MAlBW,SAAUI,GACrB,OAAQA,GAkBRxkB,KAAMsjB,GACNe,UAAW,SAAUC,GACnB,OAAOT,GAAcJ,GAAcD,GAAac,KAMlDG,IAjBQ,CACRL,MAAO10B,EACPsQ,KAAMujB,GACNc,UAAW,SAAUC,GACnB,OAAOT,GAAcL,GAAaC,GAAca,MAgBhDI,GAAkB,CACpBD,IAAKN,GAAaM,IAClBF,IAAKJ,GAAaI,KAGpB,SAASI,GAAgBC,GACvB,IAAIC,EAAO,SAAUtb,GACnB,OAAOqb,EAAYrb,GAAOub,QAAUJ,GAAgBH,IAAMG,GAAgBD,KAW5E,MAAO,CACLL,MAVU,SAAUzE,EAAQpW,GAC5B,OAAOsb,EAAKtb,GAAO6a,MAAMzE,EAAQpW,IAUjCvJ,KALS,SAAUoJ,GACnB,OAAOyb,EAAKzb,GAAMpJ,KAAKoJ,IAKvBib,UATc,SAAUva,EAAMP,GAC9B,OAAOsb,EAAKtb,GAAO8a,UAAUva,EAAMP,KAYvC,IA62F0Bwb,GAx2FtBC,GALc,SAAUzb,GAC1B,IAAI0b,EAAQlb,GAAsBR,GAElC,OADgBkB,GAAUC,SAASua,GAClBte,QAIfue,GAAM,SAAUtuB,GAKlB,IAJA,IAAI1B,EAAI,GACJP,EAAO,SAAUhF,GACnBuF,EAAEP,KAAKhF,IAEAqF,EAAI,EAAGA,EAAI4B,EAAIrH,OAAQyF,IAC9B4B,EAAI5B,GAAGjD,KAAK4C,GAEd,OAAOO,GAELiwB,GAAU,SAAUvuB,EAAKzG,GAC3B,IAAK,IAAI6E,EAAI,EAAGA,EAAI4B,EAAIrH,OAAQyF,IAAK,CACnC,IAAIE,EAAI/E,EAAEyG,EAAI5B,GAAIA,GAClB,GAAIE,EAAE/D,SACJ,OAAO+D,EAGX,OAAOlC,EAAO1C,QAGZ80B,GAAW,SAAUnsB,EAAS+D,EAAUrO,EAAO02B,GAC7C12B,IAAU02B,EACZjrB,GAAOnB,EAAS+D,GAEhBnO,GAAIoK,EAAS+D,EAAUrO,IA8EvB22B,GA3ES,SAAU/b,EAAO5C,GAC5B,IAAI4e,EAAU,GACVC,EAAW,GA6BXC,EAAwB,SAAUC,EAAaC,GAC7CD,EAAYn2B,OAAS,EA7BP,SAAUm2B,EAAaC,GACzC,IAAItb,EAAUlC,GAAQoB,EAAOoc,GAAat0B,WAAW,WACnD,IAAIu0B,EAAKtqB,GAAQU,QAAQ2pB,EAAanhB,GAAM+E,GAAOrQ,OAEnD,OADAwM,GAAO6D,EAAOqc,GACPA,IAETxf,GAAMiE,GACN,IAAIZ,EAAO3X,EAAI4zB,EAAa,SAAUlc,GAChCA,EAAIqc,SACNN,EAAQ5wB,KAAK6U,EAAIvQ,WAEnB,IAAI6sB,EAAKtc,EAAIvQ,UAUb,OATAmN,GAAM0f,GACN/zB,EAAKyX,EAAIF,QAAS,SAAUF,GACtBA,EAAKyc,SACPL,EAAS7wB,KAAKyU,EAAKnQ,WAErBmsB,GAAShc,EAAKnQ,UAAW,UAAWmQ,EAAKe,UAAW,GACpDib,GAAShc,EAAKnQ,UAAW,UAAWmQ,EAAKc,UAAW,GACpDxE,GAAOogB,EAAI1c,EAAKnQ,aAEX6sB,IAET3f,GAASkE,EAASZ,GAOhBsc,CAAcL,EAAaC,GALX,SAAUA,GAC5Bxd,GAAQoB,EAAOoc,GAAa5zB,KAAKwU,IAM/Byf,CAAcL,IAGdM,EAAc,GACdC,EAAc,GACdC,EAAc,GAiBlB,OAhBAp0B,EAAK4U,EAAM,SAAU6C,GACnB,OAAQA,EAAIa,WACZ,IAAK,QACH4b,EAAYtxB,KAAK6U,GACjB,MACF,IAAK,QACH0c,EAAYvxB,KAAK6U,GACjB,MACF,IAAK,QACH2c,EAAYxxB,KAAK6U,MAIrBic,EAAsBQ,EAAa,SACnCR,EAAsBS,EAAa,SACnCT,EAAsBU,EAAa,SAC5B,CACLZ,QAAS91B,EAAS81B,GAClBC,SAAU/1B,EAAS+1B,KAgBnBF,GAbS,SAAU3e,GAWrB,OAVW7U,EAAI6U,EAAM,SAAU6C,GAC7B,IAAIsc,EAAKlX,GAAQpF,EAAIvQ,WAOrB,OANAlH,EAAKyX,EAAIF,QAAS,SAAUF,GAC1B,IAAIgd,EAAavX,GAAKzF,EAAKnQ,WAC3BmsB,GAASgB,EAAY,UAAWhd,EAAKe,UAAW,GAChDib,GAASgB,EAAY,UAAWhd,EAAKc,UAAW,GAChDxE,GAAOogB,EAAIM,KAENN,KASPO,GAAO,SAAUptB,EAASsB,GAC5B,IAAI5L,EAAQqL,GAAMf,EAASsB,GAC3B,YAAiB5I,IAAVhD,GAAiC,KAAVA,EAAe,GAAKA,EAAM23B,MAAM,MAoB5DC,GAAW,SAAUttB,GACvB,YAAmCtH,IAA5BsH,EAAQC,MAAMstB,WAKnBC,GAAQ,SAAUxtB,EAASytB,GAC7B,OAzBQ,SAAUztB,EAASsB,EAAM1J,GACjC,IACIyN,EADM+nB,GAAKptB,EAASsB,GACXtK,OAAO,CAACY,IAErB,OADAhC,GAAIoK,EAASsB,EAAM+D,EAAGvH,KAAK,OACpB,EAqBA4vB,CAAI1tB,EAAS,QAASytB,IAE3BE,GAAW,SAAU3tB,EAASytB,GAChC,OAtBa,SAAUztB,EAASsB,EAAM1J,GACtC,IAAIyN,EAAKnM,EAAOk0B,GAAKptB,EAASsB,GAAO,SAAUzL,GAC7C,OAAOA,IAAM+B,IAOf,OALIyN,EAAG/O,OAAS,EACdV,GAAIoK,EAASsB,EAAM+D,EAAGvH,KAAK,MAE3BqD,GAAOnB,EAASsB,IAEX,EAaAssB,CAAS5tB,EAAS,QAASytB,IAGhCI,GAAQ,SAAU7tB,EAASytB,GACzBH,GAASttB,GACXA,EAAQC,MAAMstB,UAAUG,IAAID,GAE5BD,GAAMxtB,EAASytB,IAGfK,GAAa,SAAU9tB,GAEA,KADTstB,GAASttB,GAAWA,EAAQC,MAAMstB,UAlBxC,SAAUvtB,GACpB,OAAOotB,GAAKptB,EAAS,SAiByC+tB,CAAM/tB,IACtD1J,QACZ6K,GAAOnB,EAAS,UAYhBguB,GAAQ,SAAUhuB,EAASytB,GAC7B,OAAOH,GAASttB,IAAYA,EAAQC,MAAMstB,UAAU5xB,SAAS8xB,IAU3DQ,GAAQ,SAAUvsB,EAAOga,GAE3B,IADA,IAAIzf,EAAI,GACCF,EAAI2F,EAAO3F,EAAI2f,EAAK3f,IAC3BE,EAAEP,KAAKK,GAET,OAAOE,GAELiyB,GAAS,SAAUtyB,EAAIuQ,GACzB,GAAIA,EAAQ,GAAKA,GAASvQ,EAAGtF,OAAS,EACpC,OAAOyD,EAAO1C,OAEhB,IAAI+O,EAAUxK,EAAGuQ,GAAOpU,KAAK,WAC3B,IAAIo2B,EAAOzxB,EAAQd,EAAGN,MAAM,EAAG6Q,IAC/B,OAAO+f,GAAQiC,EAAM,SAAUz0B,EAAGqC,GAChC,OAAOrC,EAAEb,IAAI,SAAUu1B,GACrB,MAAO,CACL14B,MAAO04B,EACPjD,MAAOpvB,EAAI,QAIhB,SAAUwiB,GACX,OAAOxkB,EAAON,KAAK,CACjB/D,MAAO6oB,EACP4M,MAAO,MAGPvN,EAAOhiB,EAAGuQ,EAAQ,GAAGpU,KAAK,WAC5B,IAAIo2B,EAAOvyB,EAAGN,MAAM6Q,EAAQ,GAC5B,OAAO+f,GAAQiC,EAAM,SAAUz0B,EAAGqC,GAChC,OAAOrC,EAAEb,IAAI,SAAUu1B,GACrB,MAAO,CACL14B,MAAO04B,EACPjD,MAAOpvB,EAAI,QAIhB,SAAUlE,GACX,OAAOkC,EAAON,KAAK,CACjB/D,MAAOmC,EACPszB,MAAO,MAGX,OAAO/kB,EAAQrN,KAAK,SAAUwlB,GAC5B,OAAOX,EAAK/kB,IAAI,SAAUhB,GACxB,IAAIw2B,EAASx2B,EAAEszB,MAAQ5M,EAAE4M,MACzB,OAAOhZ,KAAKmc,IAAIz2B,EAAEnC,MAAQ6oB,EAAE7oB,OAAS24B,OA4BvCE,GAAS,SAAUC,EAAUC,EAAUC,GACzC,IAAIC,EAAUH,IAKd,OAJoBlyB,EAAKqyB,EAASF,GACD71B,QAAQ,WACvC,OAAOmB,EAAOC,KAAK20B,EAAQ,IAAI/1B,QAAQ81B,KAErB71B,IAAI,SAAU+U,GAChC,OAAOA,EAAO5N,aA0Bd4uB,GAxDU,SAAUrd,GACtB,IAAI7D,EAAO6D,EAAU7D,OACjBmD,EAAOod,GAAM,EAAGvgB,EAAK8F,WACrBqb,EAAUZ,GAAM,EAAGvgB,EAAK8C,QAC5B,OAAO3X,EAAIgY,EAAM,SAAUie,GAgBzB,OAAOP,GAfQ,WACb,OAAOx1B,EAAK81B,EAAS,SAAU5yB,GAC7B,OAAOuV,GAAUc,MAAMf,EAAWtV,EAAG6yB,GAAK51B,OAAO,SAAU0U,GACzD,OAAOA,EAAOyD,WAAayd,IAC1B/2B,KAAKvB,EAAS,IAAK,SAAUoX,GAC9B,MAAO,CAACA,QAIC,SAAUA,GACvB,OAA4B,IAArBA,EAAOsD,WAEE,WAChB,OAAOM,GAAUc,MAAMf,EAAW,EAAGud,QAsCvCF,GAvBS,SAAUrd,GACrB,IAAI7D,EAAO6D,EAAU7D,OACjBmhB,EAAUZ,GAAM,EAAGvgB,EAAK8C,QACxBK,EAAOod,GAAM,EAAGvgB,EAAK8F,WACzB,OAAO3a,EAAIg2B,EAAS,SAAUte,GAgB5B,OAAOge,GAfQ,WACb,OAAOx1B,EAAK8X,EAAM,SAAU0N,GAC1B,OAAO/M,GAAUc,MAAMf,EAAWhB,EAAKgO,GAAGrlB,OAAO,SAAU0U,GACzD,OAAOA,EAAO2C,QAAUA,IACvBxY,KAAKvB,EAAS,IAAK,SAAUoX,GAC9B,MAAO,CAACA,QAIC,SAAUA,GACvB,OAA4B,IAArBA,EAAOqD,WAEE,WAChB,OAAOO,GAAUc,MAAMf,EAAWhB,EAAK,QAUzCpM,GAAM,SAAU4qB,GAClB,IAAIC,EAAgBD,EAAUnqB,QAAQ,MAAO,KAI7C,MAAO,CAAEvK,QAHK,SAAUmH,GACtB,OAAOwtB,EAAgB,IAAMxtB,KAK7B0Y,GAAS/V,GAAI,iBACb8qB,GAAS,CAAE50B,QAAS6f,GAAO7f,SAgC3B60B,GA9BM,SAAU7d,EAAQ3a,EAAG4M,EAAGsP,EAAGmS,GACnC,IAAIoK,EAAU9sB,GAAQU,QAAQ,OAY9B,OAXAmB,GAASirB,EAAS,CAChBC,SAAU,WACVnR,KAAMvnB,EAAIkc,EAAI,EAAI,KAClBqW,IAAK3lB,EAAI,KACT8hB,OAAQL,EAAI,KACZyC,MAAO5U,EAAI,OAEb/R,GAAOsuB,EAAS,CACdE,cAAehe,EACfie,KAAQ,iBAEHH,GAiBLD,GAfQ,SAAUjzB,EAAGvF,EAAG4M,EAAGsP,EAAGmS,GAChC,IAAIoK,EAAU9sB,GAAQU,QAAQ,OAY9B,OAXAmB,GAASirB,EAAS,CAChBC,SAAU,WACVnR,KAAMvnB,EAAI,KACVuyB,IAAK3lB,EAAIyhB,EAAI,EAAI,KACjBK,OAAQL,EAAI,KACZyC,MAAO5U,EAAI,OAEb/R,GAAOsuB,EAAS,CACdI,WAAYtzB,EACZqzB,KAAQ,iBAEHH,GAOLK,GAAYP,GAAO50B,QAAQ,eAC3Bo1B,GAAeR,GAAO50B,QAAQ,gBAC9Bq1B,GAAeT,GAAO50B,QAAQ,gBAE9Bs1B,GAAU,SAAUC,GACtB,IAAIC,EAAWlhB,GAAcihB,EAAKpkB,SAAU,IAAMgkB,IAClD12B,EAAK+2B,EAAUviB,KAEbwiB,GAAU,SAAUF,EAAMxE,EAAW3Q,GACvC,IAAIsV,EAASH,EAAKG,SAClBj3B,EAAKsyB,EAAW,SAAU4E,EAAUj0B,GAClCi0B,EAASl3B,KAAK,SAAUm3B,GACtB,IAAIC,EAAMzV,EAAOsV,EAAQE,GACzBpC,GAAMqC,EAAKV,IACX/iB,GAAOmjB,EAAKpkB,SAAU0kB,QAkBxBC,GAAc,SAAUP,EAAMtf,EAAOE,EAAMK,EAAMuf,EAAYC,GAC/D,IAAIjB,EAAW/F,GAAS/Y,IART,SAAUsf,EAAMU,EAAclB,EAAUmB,GACvDT,GAAQF,EAAMU,EAAc,SAAUP,EAAQE,GAC5C,IAAIO,EAAStB,GAAQe,EAAG1f,MAAO6e,EAASnR,OAAS8R,EAAO9R,OAAQgS,EAAG3sB,IAAMysB,EAAO9G,MAAOsH,EAxBvE,GA0BhB,OADA1C,GAAM2C,EAAQf,IACPe,IAMTC,CAAWb,EADQpf,EAAKla,OAAS,EAAI85B,EAAWhF,UAAU5a,EAAMF,GAAS,GAC1C8e,EAAU1J,GAAWpV,IAjBrC,SAAUsf,EAAMc,EAActB,EAAUuB,GACvDb,GAAQF,EAAMc,EAAc,SAAUX,EAAQE,GAC5C,IAAIW,EAAS1B,GAAQe,EAAGnB,MAAOmB,EAAGv5B,IAAMq5B,EAAO9R,OAAQmR,EAASnG,MAAQ8G,EAAO9G,MAjB/D,EAiBqF0H,GAErG,OADA9C,GAAM+C,EAAQlB,IACPkB,IAeTC,CAAWjB,EADQ/e,EAAKva,OAAS,EAAI+5B,EAAWjF,UAAUva,EAAMP,GAAS,GAC1C8e,EAAUpK,GAAS1U,KAUhDwgB,GAAS,SAAUlB,EAAM14B,GAC3B,IAAI65B,EAAOpiB,GAAcihB,EAAKpkB,SAAU,IAAMgkB,IAC9C12B,EAAKi4B,EAAM75B,IAkBT85B,GA5BU,SAAUpB,EAAMtf,EAAO8f,EAAYC,GAC/CV,GAAQC,GACR,IAAIle,EAAOZ,GAAsBR,GAC7BiB,EAAYC,GAAUC,SAASC,GAC/BlB,EAAOoe,GAAYrd,GACnBV,EAAO+d,GAAerd,GAC1B4e,GAAYP,EAAMtf,EAAOE,EAAMK,EAAMuf,EAAYC,IAsB/CW,GAhBO,SAAUpB,GACnBkB,GAAOlB,EAAM,SAAUM,GACrBjsB,GAAMisB,EAAK,UAAW,WActBc,GAXO,SAAUpB,GACnBkB,GAAOlB,EAAM,SAAUM,GACrBjsB,GAAMisB,EAAK,UAAW,YAStBc,GAIOrB,GAJPqB,GANW,SAAUhxB,GACvB,OAAOguB,GAAMhuB,EAASyvB,KAKpBuB,GAHW,SAAUhxB,GACvB,OAAOguB,GAAMhuB,EAAS0vB,KAsBpBuB,GAAW,SAAUC,EAAS7gB,GAChC,OAAOnC,GAASmC,EAAO6gB,EAAQ9f,YAO7B+f,GAAU,SAAUD,EAAS/kB,GAC/B,OAAO+kB,EAAQ7gB,QAAQlE,IAQrBilB,GAAU,CACZC,QA7BY,SAAUH,EAAS/kB,EAAOgE,GACtC,IAAIE,EAAQ6gB,EAAQ7gB,QAChBhE,EAASgE,EAAM/U,MAAM,EAAG6Q,GACxBK,EAAQ6D,EAAM/U,MAAM6Q,GACpBogB,EAAWlgB,EAAOrV,OAAO,CAACmZ,IAAOnZ,OAAOwV,GAC5C,OAAOykB,GAASC,EAAS3E,IAyBzB0E,SAAUA,GACVK,WAxBe,SAAUJ,EAAS/kB,EAAOgE,GAC7B+gB,EAAQ7gB,QACdlE,GAASgE,GAuBfghB,QAASA,GACTI,eAXmB,SAAUL,EAAS/kB,GACtC,OAAOglB,GAAQD,EAAS/kB,GAAOnM,WAW/BwxB,SApBa,SAAUN,EAASh6B,GAChC,IAAImZ,EAAQ6gB,EAAQ7gB,QAChBpU,EAAIpD,EAAIwX,EAAOnZ,GACnB,OAAOgX,GAASjS,EAAGi1B,EAAQ9f,YAkB3BqgB,WAVe,SAAUP,GACzB,OAAOA,EAAQ7gB,QAAQ/Z,SAoBrBo7B,GAAW,SAAU91B,EAAI+1B,GAC3B,GAAkB,IAAd/1B,EAAGtF,OACL,OAAO,EAET,IAAI2e,EAAQrZ,EAAG,GAIf,OAHYW,EAAUX,EAAI,SAAUlF,GAClC,OAAQi7B,EAAK1c,EAAMjV,UAAWtJ,EAAEsJ,aAErBjI,KAAK,WAChB,OAAO6D,EAAGtF,QACT,SAAU8kB,GACX,OAAOA,KAaPwW,GAVU,SAAUlkB,EAAM6C,EAAKc,EAAQoB,GACzC,IAAIof,EAlBO,SAAUnkB,EAAMvB,GAC3B,OAAOuB,EAAKvB,GAiBI2lB,CAAOpkB,EAAM6C,GAAKF,QAAQ/U,MAAM+V,GAC5C0gB,EAAcL,GAASG,EAAWpf,GAClCuf,EAzBU,SAAUtkB,EAAMvB,GAC9B,OAAOtT,EAAI6U,EAAM,SAAU6C,GACzB,OAAO6gB,GAAQD,QAAQ5gB,EAAKpE,KAuBX8lB,CAAUvkB,EAAM2D,GAAQ/V,MAAMiV,GAC7C2hB,EAAcR,GAASM,EAAcvf,GACzC,MAAO,CACLvB,QAAS1a,EAASu7B,GAClB9gB,QAASza,EAAS07B,KAgDlBC,GA3CY,SAAUzkB,EAAM+E,GAC9B,IAAI2f,EAAOv5B,EAAI6U,EAAM,SAAU6C,EAAK8hB,GAClC,OAAOx5B,EAAI0X,EAAIF,QAAS,SAAUye,EAAKwD,GACrC,OAAO,MAUX,OAAOz5B,EAAI6U,EAAM,SAAU6C,EAAK8hB,GAC9B,IAAIvgB,EAAU/Y,EAAKwX,EAAIF,QAAS,SAAUF,EAAMmiB,GAC9C,IAAqB,IAAjBF,EAAKC,GAAIC,GAAe,CAC1B,IAAI/jB,EAASqjB,GAAkBlkB,EAAM2kB,EAAIC,EAAI7f,GAE7C,OAZW,SAAU4f,EAAIC,EAAIrhB,EAASC,GAC1C,IAAK,IAAIjV,EAAIo2B,EAAIp2B,EAAIo2B,EAAKphB,EAAShV,IACjC,IAAK,IAAIsiB,EAAI+T,EAAI/T,EAAI+T,EAAKphB,EAASqN,IACjC6T,EAAKn2B,GAAGsiB,IAAK,EAQbgU,CAAWF,EAAIC,EAAI/jB,EAAO0C,UAAW1C,EAAO2C,WACrC,CAACrD,GAAUsC,EAAKnQ,UAAWuO,EAAO0C,UAAW1C,EAAO2C,UAAWf,EAAKyc,UAE3E,MAAO,KAGX,OAAOze,GAAW2D,EAASvB,EAAIa,cAoB/B+gB,GAjBS,SAAU5gB,EAAWuR,EAAY8J,GAE5C,IADA,IAAIlf,EAAO,GACF3R,EAAI,EAAGA,EAAIwV,EAAU7D,OAAO8C,OAAQzU,IAAK,CAEhD,IADA,IAAIy2B,EAAW,GACNxgB,EAAI,EAAGA,EAAIT,EAAU7D,OAAO8F,UAAWxB,IAAK,CACnD,IAAIhS,EAAUwR,GAAUc,MAAMf,EAAWxV,EAAGiW,GAAGnZ,IAAI,SAAU2Z,GAC3D,OAAOxE,GAAWwE,EAAKxS,UAAW4sB,KACjCx0B,WAAW,WACZ,OAAO4V,GAAW8U,EAAWvL,OAAO,KAEtCib,EAAS92B,KAAKsE,GAEhB,IAAIuQ,EAAMrC,GAASskB,EAAUjhB,EAAUxa,MAAMgF,GAAGqV,WAChD1D,EAAKhS,KAAK6U,GAEZ,OAAO7C,GAUL+kB,GAAa,SAAUC,EAAU5P,GAYnC,OAAOjqB,EAAI65B,EAAU,SAAU5gB,GAC7B,IAAIvB,EAZQ,SAAUuB,GAOtB,OANiBoa,GAAQpa,EAAS,SAAUlE,GAC1C,OAAOpC,GAAOoC,EAAO5N,WAAWnH,IAAI,SAAU0X,GAC5C,IAAIqc,EAAQphB,GAAO+E,GAAK9Y,SACxB,OAAOuW,GAAWuC,EAAKqc,OAGTx0B,WAAW,WAC3B,OAAO4V,GAAW8U,EAAWvS,OAAO,KAI5BoiB,CAAQ7gB,EAAQA,WAC1B,OAAO7D,GAAWsC,EAAIvQ,UAAW8R,EAAQA,UAAWA,EAAQV,UAAWb,EAAIqc,YAG3EgG,GAAe,SAAUllB,EAAMoV,GACjC,IAAI4P,EAAWP,GAAsBzkB,EAAMnW,IAC3C,OAAOk7B,GAAWC,EAAU5P,IAE1B+P,GAAkB,SAAUthB,EAAWvR,GACzC,IAAIjJ,EAAMyF,EAAQ3D,EAAI0Y,EAAUxa,MAAO,SAAUkF,GAC/C,OAAOA,EAAEoU,WAEX,OAAO/T,EAAKvF,EAAK,SAAUkW,GACzB,OAAO1V,GAAGyI,EAASiN,EAAEjN,cAGrB8yB,GAAM,SAAUC,EAAWC,EAASC,EAAYC,EAAYC,GAC9D,OAAO,SAAUvD,EAAMtf,EAAOpH,EAAQ4Z,EAAYsQ,GAChD,IAAIpH,EAAQlb,GAAsBR,GAC9BiB,EAAYC,GAAUC,SAASua,GAUnC,OATagH,EAAQzhB,EAAWrI,GAAQrQ,IAAI,SAAUyN,GACpD,IAAI+sB,EArCU,SAAU9hB,EAAWuR,GACvC,OAAOqP,GAAmB5gB,EAAWuR,GAAY,GAoCjCwQ,CAAc/hB,EAAWuR,GACjCvU,EAASwkB,EAAUM,EAAO/sB,EAAM/O,GAAI47B,EAAYrQ,IAChDpV,EAAOklB,GAAarkB,EAAOb,OAAQoV,GACvC,MAAO,CACLpV,KAAMlX,EAASkX,GACf6lB,OAAQhlB,EAAOglB,UAGLx7B,KAAK,WACjB,OAAOgC,EAAO1C,QACb,SAAUm8B,GACX,IAAIC,EAAcpH,GAAc/b,EAAOkjB,EAAI9lB,QAI3C,OAHAulB,EAAW3iB,EAAOkjB,EAAI9lB,OAAQ0lB,GAC9BF,EAAW5iB,GACX0gB,GAAapB,EAAMtf,EAAO4a,GAAa9F,OAAQgO,GACxCr5B,EAAON,KAAK,CACjB85B,OAAQC,EAAID,OACZjH,QAASmH,EAAYnH,QACrBC,SAAUkH,EAAYlH,eAK1BmH,GAAS,SAAUniB,EAAWrI,GAChC,OAAOgH,GAAYC,KAAKjH,EAAOlJ,WAAWjH,KAAK,SAAUoX,GACvD,OAAO0iB,GAAgBthB,EAAWpB,MAclCwjB,GAAc,SAAUpiB,EAAWrI,GACrC,IAAI4I,EAAUjZ,EAAIqQ,EAAOgZ,YAAa,SAAU/R,GAC9C,OAAOD,GAAYC,KAAKA,GAAMpX,KAAK,SAAU66B,GAC3C,OAAOf,GAAgBthB,EAAWqiB,OAGlCvjB,EAAQ4b,GAAIna,GAChB,OAAOzB,EAAM/Z,OAAS,EAAIyD,EAAON,KAAK,CACpC4W,MAAOA,EACPyS,WAAY5Z,EAAO4Z,WACnBD,UAAW3Z,EAAO2Z,YACf9oB,EAAO1C,QAQVw8B,GAAU,SAAUtiB,EAAWrI,GACjC,IAAI4I,EAAUjZ,EAAIqQ,EAAOgZ,YAAa,SAAU/R,GAC9C,OAAOD,GAAYC,KAAKA,GAAMpX,KAAK,SAAU66B,GAC3C,OAAOf,GAAgBthB,EAAWqiB,OAGlCvjB,EAAQ4b,GAAIna,GAChB,OAAOzB,EAAM/Z,OAAS,EAAIyD,EAAON,KAAK4W,GAAStW,EAAO1C,QAGpD3B,GAAQ,SAAU8B,GAkCpB,MAAO,CACLS,GAlCO,SAAUpC,GACjB,OAAO2B,IAAM3B,GAkCbi+B,QAAS18B,EACT28B,QAAS58B,EACTgB,MAAO3B,EAASgB,GAChBY,WAAY5B,EAASgB,GACrBa,SAAU7B,EAASgB,GACnBmB,GArCO,SAAUiG,GACjB,OAAOlJ,GAAM8B,IAqCboB,QAnCY,SAAU1B,GACtB,OAAOxB,GAAM8B,IAmCbO,KArBS,SAAUi8B,EAAGC,GACtB,OAAOA,EAAQz8B,IAqBfqB,IAlCQ,SAAU3B,GAClB,OAAOxB,GAAMwB,EAAEM,KAkCf08B,SAhCa,SAAUh9B,GACvB,OAAOxB,GAAM8B,IAgCbsB,KA9BS,SAAU5B,GACnBA,EAAEM,IA8BFuB,KA5BS,SAAU7B,GACnB,OAAOA,EAAEM,IA4BTwB,OAvBW,SAAU9B,GACrB,OAAOA,EAAEM,IAuBTyB,OArBW,SAAU/B,GACrB,OAAOA,EAAEM,IAqBT28B,SAnBa,WACb,OAAOp6B,EAAON,KAAKjC,MAqBnBmJ,GAAQ,SAAUyzB,GAyBpB,MAAO,CACLn8B,GAAId,EACJ28B,QAAS38B,EACT48B,QAAS38B,EACTe,MAAO1B,EACP2B,WA7Be,SAAUlB,GACzB,OAAOA,KA6BPmB,SA3Ba,WACb,OAj9GgBC,EAi9GLwC,OAAOs5B,GAh9Gb,WACL,MAAM,IAAI77B,MAAMD,OAFV,IAAUA,GA4+GhBK,GAzBO,SAAUiG,GACjB,OAAOA,GAyBPhG,QAvBY,SAAU1B,GACtB,OAAOA,KAuBPa,KAZS,SAAUs8B,EAASL,GAC5B,OAAOK,EAAQD,IAYfv7B,IAtBQ,SAAU3B,GAClB,OAAOyJ,GAAMyzB,IAsBbF,SApBa,SAAUh9B,GACvB,OAAOyJ,GAAMzJ,EAAEk9B,KAoBft7B,KAAM/C,EACNgD,KAnBS,SAAU7B,GACnB,OAAOyJ,GAAMyzB,IAmBbp7B,OAAQ7B,EACR8B,OAAQ7B,EACR+8B,SAAUp6B,EAAO1C,OAQjBi9B,GAAS,CACX5+B,MAAOA,GACPiL,MAAOA,GACP4zB,WARe,SAAU31B,EAAK41B,GAC9B,OAAO51B,EAAI7G,KAAK,WACd,OAAO4I,GAAM6zB,IACZ9+B,MA6BD++B,GAAO,SAAUpkB,EAAOqkB,GAC1B,OAAO77B,EAAIwX,EAAO,WAChB,OAAOrC,GAAW0mB,EAAUvkB,QAAQ,MAGpCwkB,GAAU,SAAUjnB,EAAMgZ,EAAQgO,GACpC,OAAOhnB,EAAK1W,OAzlBD,SAAU49B,EAAa19B,GAElC,IADA,IAAI+E,EAAI,GACCF,EAAI,EAAGA,EAAI64B,EAAa74B,IAC/BE,EAAEP,KAAKxE,EAAE6E,IAEX,OAAOE,EAolBY44B,CAAOnO,EAAQ,SAAUoO,GAC1C,OAAO1D,GAAQH,SAASvjB,EAAKA,EAAKpX,OAAS,GAAIm+B,GAAK/mB,EAAKA,EAAKpX,OAAS,GAAG+Z,QAASqkB,QAGnFK,GAAU,SAAUrnB,EAAMgZ,EAAQgO,GACpC,OAAO77B,EAAI6U,EAAM,SAAU6C,GACzB,OAAO6gB,GAAQH,SAAS1gB,EAAKA,EAAIF,QAAQrZ,OAAOy9B,GAAKxG,GAAM,EAAGvH,GAASgO,QAUvEM,GA3CU,SAAUC,EAAcC,EAAOC,GAC3C,GAAIF,EAAa1kB,OAAS2kB,EAAM5+B,QAAU2+B,EAAa5jB,SAAW+f,GAAQK,WAAWyD,EAAM,IACzF,OAAOZ,GAAO3zB,MAAM,mDAAqDs0B,EAAa1kB,MAAQ,aAAe0kB,EAAa5jB,UAE5H,IAAI+jB,EAAeF,EAAM55B,MAAM25B,EAAa1kB,OACxC8kB,EAAeD,EAAa,GAAG/kB,QAAQ/U,MAAM25B,EAAa5jB,UAC1DikB,EAAclE,GAAQK,WAAW0D,EAAM,IACvCI,EAAcJ,EAAM7+B,OACxB,OAAOg+B,GAAO5+B,MAAM,CAClB8/B,SAAUh/B,EAAS4+B,EAAa9+B,OAASi/B,GACzCE,SAAUj/B,EAAS6+B,EAAa/+B,OAASg/B,MAiCzCN,GA9Be,SAAUE,EAAOC,GAClC,IAAIO,EAAatE,GAAQK,WAAWyD,EAAM,IACtCS,EAAavE,GAAQK,WAAW0D,EAAM,IAC1C,MAAO,CACLK,SAAUh/B,EAAS,GACnBi/B,SAAUj/B,EAASk/B,EAAaC,KAyBhCX,GAPS,SAAUE,EAAO/J,EAAOuJ,GACnC,IAAIkB,EAAWzK,EAAMsK,WAAa,EAAIV,GAAUt+B,EAIhD,OAHe00B,EAAMqK,WAAa,EAAIb,GAAUl+B,GAC7Bm/B,EAASV,EAAO/iB,KAAKmc,IAAInD,EAAMsK,YAAaf,GACrBviB,KAAKmc,IAAInD,EAAMqK,YAAad,IAwEpEmB,GA/DQ,SAAUnoB,EAAMU,EAAQqE,EAAYqjB,GAC9C,GAAoB,IAAhBpoB,EAAKpX,OACP,OAAOoX,EAET,IAAK,IAAI3R,EAAIqS,EAAOyF,WAAY9X,GAAKqS,EAAOuJ,YAAa5b,IACvD,IAAK,IAAIiW,EAAI5D,EAAO2F,WAAY/B,GAAK5D,EAAOsJ,YAAa1F,IACvDof,GAAQE,WAAW5jB,EAAK3R,GAAIiW,EAAGhE,GAAW8nB,KAAgB,IAG9D,OAAOpoB,GAsDLmoB,GApDU,SAAUnoB,EAAMxE,EAAQuJ,EAAYqjB,GAEhD,IADA,IAAI7gB,GAAQ,EACHlZ,EAAI,EAAGA,EAAI2R,EAAKpX,OAAQyF,IAC/B,IAAK,IAAIiW,EAAI,EAAGA,EAAIof,GAAQK,WAAW/jB,EAAK,IAAKsE,IAAK,CACpD,IACI+jB,EAActjB,EADJ2e,GAAQG,eAAe7jB,EAAK3R,GAAIiW,GACR9I,IAClB,IAAhB6sB,IAAkC,IAAV9gB,EAC1Bmc,GAAQE,WAAW5jB,EAAK3R,GAAIiW,EAAGhE,GAAW8nB,KAAgB,KACjC,IAAhBC,IACT9gB,GAAQ,GAId,OAAOvH,GAuCLmoB,GA9BY,SAAUnoB,EAAMvB,EAAOsG,EAAYqjB,GACjD,GAAI3pB,EAAQ,GAAKA,EAAQuB,EAAKpX,OAAQ,CACpC,IACI+Z,EAVU,SAAUE,EAAKkC,GAC/B,OAAOpW,EAAMkU,EAAK,SAAU4d,EAAMhe,GAChC,OAAOnX,EAAOm1B,EAAM,SAAU6H,GAC5B,OAAOvjB,EAAWujB,EAAYh2B,UAAWmQ,EAAKnQ,aAC3CmuB,EAAOA,EAAKn3B,OAAO,CAACmZ,KACxB,IAKW8lB,CADOvoB,EAAKvB,EAAQ,GAAGkE,QACGoC,GACtC3Z,EAAKuX,EAAO,SAAUF,GAmBpB,IAlBA,IAAI+lB,EAAcn8B,EAAO1C,OACrB8+B,EAAU,SAAUp6B,GAatB,IAZA,IAAIq6B,EAAU,SAAUpkB,GACtB,IAAI5L,EAAUsH,EAAK3R,GAAGsU,QAAQ2B,GACZS,EAAWrM,EAAQpG,UAAWmQ,EAAKnQ,aAE/Ck2B,EAAYz+B,WACdy+B,EAAcn8B,EAAON,KAAKq8B,MAE5BI,EAAYp9B,KAAK,SAAUu9B,GACzBjF,GAAQE,WAAW5jB,EAAK3R,GAAIiW,EAAGhE,GAAWqoB,GAAK,QAI5CrkB,EAAI,EAAGA,EAAIof,GAAQK,WAAW/jB,EAAK,IAAKsE,IAC/CokB,EAAQpkB,IAGHjW,EAAIoQ,EAAOpQ,EAAI2R,EAAKpX,OAAQyF,IACnCo6B,EAAQp6B,KAId,OAAO2R,GAQL4oB,GAAa,SAAU5oB,EAAM6C,EAAKue,EAAKrc,GACzC,IACI8jB,EAAW5/B,EAAM8b,EADL2e,GAAQD,QAAQzjB,EAAK6C,GAAMue,GACA9uB,WACvC+R,EAAarE,EAAK6C,GACtB,OAAO7C,EAAKpX,OAAS,GAAK86B,GAAQK,WAAW1f,GAAc,IAAM+c,EAAM,GAAKyH,EAASnF,GAAQG,eAAexf,EAAY+c,EAAM,KAAOA,EAAM/c,EAAW1B,QAAQ/Z,OAAS,GAAKigC,EAASnF,GAAQG,eAAexf,EAAY+c,EAAM,KAAOve,EAAM,GAAKgmB,EAASnF,GAAQG,eAAe7jB,EAAK6C,EAAM,GAAIue,KAASve,EAAM7C,EAAKpX,OAAS,GAAKigC,EAASnF,GAAQG,eAAe7jB,EAAK6C,EAAM,GAAIue,MAoC9W0H,GAfU,SAAUvB,EAAcC,EAAOC,EAAOT,EAAWjiB,GAE7D,OADauiB,GAAgBC,EAAcC,EAAOC,GACpCt8B,IAAI,SAAUsyB,GAC1B,IAAIsL,EAAazB,GAAeE,EAAO/J,EAAOuJ,GAC9C,OAvBc,SAAUO,EAAcC,EAAOC,EAAOT,EAAWjiB,GAOjE,IANA,IAAIoB,EAAWohB,EAAa1kB,MACxBwD,EAAWkhB,EAAa5jB,SAGxByC,EAASD,EAFKshB,EAAM7+B,OAGpB0d,EAASD,EAFIqd,GAAQK,WAAW0D,EAAM,IAGjCl5B,EAAI4X,EAAU5X,EAAI6X,EAAQ7X,IACjC,IAAK,IAAIsiB,EAAIxK,EAAUwK,EAAIvK,EAAQuK,IAAK,CAClC+X,GAAWpB,EAAOj5B,EAAGsiB,EAAG9L,IAC1BojB,GAA0BX,EAAO9D,GAAQG,eAAe2D,EAAMj5B,GAAIsiB,GAAI9L,EAAYiiB,EAAUvkB,MAE9F,IAAI6G,EAAUoa,GAAQG,eAAe4D,EAAMl5B,EAAI4X,GAAW0K,EAAIxK,GAC1DmiB,EAAcxB,EAAU9vB,QAAQoS,GACpCoa,GAAQE,WAAW4D,EAAMj5B,GAAIsiB,EAAGvQ,GAAWkoB,GAAa,IAG5D,OAAOhB,EAMEwB,CAAYzB,EAAcwB,EAAYtB,EAAOT,EAAWjiB,MAW/D+jB,GARS,SAAUrqB,EAAO+oB,EAAOC,EAAOT,EAAWjiB,GACrDojB,GAA4BX,EAAO/oB,EAAOsG,EAAYiiB,EAAUvkB,MAChE,IAAIgb,EAAQ6J,GAAqBG,EAAOD,GACpCyB,EAAgB3B,GAAeG,EAAOhK,EAAOuJ,GAC7CkC,EAAc5B,GAAqBE,EAAOyB,GAC1CE,EAAgB7B,GAAeE,EAAO0B,EAAalC,GACvD,OAAOmC,EAAcv7B,MAAM,EAAG6Q,GAAOnV,OAAO2/B,GAAe3/B,OAAO6/B,EAAcv7B,MAAM6Q,EAAO0qB,EAAcvgC,UAsDzGwgC,GA/Cc,SAAUppB,EAAMvB,EAAOgF,EAASsB,EAAYqjB,GAC5D,IAAIzpB,EAASqB,EAAKpS,MAAM,EAAG6Q,GACvBK,EAAQkB,EAAKpS,MAAM6Q,GACnB4qB,EAAU3F,GAAQI,SAAS9jB,EAAKyD,GAAU,SAAU6lB,EAAIzY,GAG1D,OAFiBpS,EAAQ,GAAKA,EAAQuB,EAAKpX,QAAUmc,EAAW2e,GAAQG,eAAe7jB,EAAKvB,EAAQ,GAAIoS,GAAI6S,GAAQG,eAAe7jB,EAAKvB,GAAQoS,IACzH6S,GAAQD,QAAQzjB,EAAKvB,GAAQoS,GAAKvQ,GAAW8nB,EAAakB,EAAGh3B,UAAWyS,IAAa,KAG9G,OAAOpG,EAAOrV,OAAO,CAAC+/B,IAAU//B,OAAOwV,IAuCrCsqB,GArCiB,SAAUppB,EAAMvB,EAAOgF,EAASsB,EAAYqjB,GAC/D,OAAOj9B,EAAI6U,EAAM,SAAU6C,GACzB,IACI8lB,EADalqB,EAAQ,GAAKA,EAAQilB,GAAQK,WAAWlhB,IAAQkC,EAAW2e,GAAQG,eAAehhB,EAAKpE,EAAQ,GAAIilB,GAAQG,eAAehhB,EAAKpE,IACzHilB,GAAQD,QAAQ5gB,EAAKpE,GAAS6B,GAAW8nB,EAAa1E,GAAQG,eAAehhB,EAAKY,GAAUsB,IAAa,GAChI,OAAO2e,GAAQC,QAAQ9gB,EAAKpE,EAAOkqB,MAiCnCS,GA9BuB,SAAUppB,EAAMupB,EAAYC,EAAYzkB,EAAYqjB,GAC7E,IAAI3pB,EAAQ+qB,EAAa,EACzB,OAAOr+B,EAAI6U,EAAM,SAAU6C,EAAKxU,GAC9B,IACIs6B,EADet6B,IAAMk7B,EACAjpB,GAAW8nB,EAAa1E,GAAQG,eAAehhB,EAAK2mB,GAAazkB,IAAa,GAAQ2e,GAAQD,QAAQ5gB,EAAK2mB,GACpI,OAAO9F,GAAQC,QAAQ9gB,EAAKpE,EAAOkqB,MAyBnCS,GAtBoB,SAAUppB,EAAMupB,EAAYC,EAAYzkB,EAAYqjB,GAC1E,IAAI3pB,EAAQ8qB,EAAa,EACrB5qB,EAASqB,EAAKpS,MAAM,EAAG6Q,GACvBK,EAAQkB,EAAKpS,MAAM6Q,GACnB4qB,EAAU3F,GAAQI,SAAS9jB,EAAKupB,GAAa,SAAUD,EAAIj7B,GAE7D,OADmBA,IAAMm7B,EACHlpB,GAAW8nB,EAAakB,EAAGh3B,UAAWyS,IAAa,GAAQukB,IAEnF,OAAO3qB,EAAOrV,OAAO,CAAC+/B,IAAU//B,OAAOwV,IAcrCsqB,GAHe,SAAUppB,EAAMhM,EAAOqX,GACxC,OAAOrL,EAAKpS,MAAM,EAAGoG,GAAO1K,OAAO0W,EAAKpS,MAAMyd,EAAS,KAErD+d,GAZkB,SAAUppB,EAAMhM,EAAOqX,GAC3C,IAAIvI,EAAO3X,EAAI6U,EAAM,SAAU6C,GAC7B,IAAIF,EAAQE,EAAIF,QAAQ/U,MAAM,EAAGoG,GAAO1K,OAAOuZ,EAAIF,QAAQ/U,MAAMyd,EAAS,IAC1E,OAAO7K,GAASmC,EAAOE,EAAIa,aAE7B,OAAOlY,EAAOsX,EAAM,SAAUD,GAC5B,OAAOA,EAAIF,QAAQ/Z,OAAS,KAe5B6gC,GAAY,SAAUzpB,EAAMwW,EAASzR,EAAYqjB,GAMnD,OAAOj9B,EAAI6U,EAAM,SAAU6C,GACzB,OAAO6gB,GAAQI,SAASjhB,EAAK,SAAUJ,GACrC,OAPW,SAAUA,GACvB,OAAOnX,EAAOkrB,EAAS,SAAUhb,GAC/B,OAAOuJ,EAAWtC,EAAKnQ,UAAWkJ,EAAOlJ,aAKlCo3B,CAASjnB,GAAQnC,GAAW8nB,EAAa3lB,EAAKnQ,UAAWyS,IAAa,GAAQtC,OAIvFknB,GAAc,SAAU3pB,EAAMsF,EAAUskB,EAAU7kB,GACpD,YAA4D/Z,IAArD04B,GAAQG,eAAe7jB,EAAKsF,GAAWskB,IAA4BtkB,EAAW,GAAKP,EAAW2e,GAAQG,eAAe7jB,EAAKsF,EAAW,GAAIskB,GAAWlG,GAAQG,eAAe7jB,EAAKsF,GAAWskB,KAEhMC,GAAiB,SAAUhnB,EAAKpE,EAAOsG,GACzC,OAAOtG,EAAQ,GAAKsG,EAAW2e,GAAQG,eAAehhB,EAAKpE,EAAQ,GAAIilB,GAAQG,eAAehhB,EAAKpE,KAiBjGqrB,GAfgB,SAAU9pB,EAAMvB,EAAOsG,EAAYqjB,GACrD,IAAI5R,EAAUnrB,EAAK2U,EAAM,SAAU6C,EAAKxU,GAEtC,OADmBs7B,GAAY3pB,EAAM3R,EAAGoQ,EAAOsG,IAAe8kB,GAAehnB,EAAKpE,EAAOsG,GACnE,GAAK,CAAC2e,GAAQD,QAAQ5gB,EAAKpE,MAEnD,OAAOgrB,GAAUzpB,EAAMwW,EAASzR,EAAYqjB,IAU1C0B,GARa,SAAU9pB,EAAMvB,EAAOsG,EAAYqjB,GAClD,IAAI2B,EAAY/pB,EAAKvB,GACjB+X,EAAUnrB,EAAK0+B,EAAUpnB,QAAS,SAAUmC,EAAMzW,GAEpD,OADmBs7B,GAAY3pB,EAAMvB,EAAOpQ,EAAG0W,IAAe8kB,GAAeE,EAAW17B,EAAG0W,GACrE,GAAK,CAACD,KAE9B,OAAO2kB,GAAUzpB,EAAMwW,EAASzR,EAAYqjB,IAO1C9U,GAAMH,GAAa,CACrB,CAAExpB,KAAM,IACR,CAAEqgC,KAAM,CAAC,UACT,CACEzZ,KAAM,CACJ,QACA,SAGJ,CACE0Z,OAAQ,CACN,OACA,QACA,SAGJ,CACEzZ,MAAO,CACL,OACA,YAIF0Z,GAAgB5yB,GAAS,GAAIgc,IA4D7B6W,GAxCY,SAAU7L,EAAO3a,EAAQka,EAAM5D,GAC7C,IAAIpZ,EAASyd,EAAM1wB,MAAM,GACrBw8B,EApBa,SAAU9L,EAAO7f,GAClC,OAAqB,IAAjB6f,EAAM11B,OACDshC,GAAcvgC,OAEF,IAAjB20B,EAAM11B,OACDshC,GAAcF,KAAK,GAEd,IAAVvrB,EACKyrB,GAAc3Z,KAAK,EAAG,GAE3B9R,IAAU6f,EAAM11B,OAAS,EACpBshC,GAAc1Z,MAAM/R,EAAQ,EAAGA,GAEpCA,EAAQ,GAAKA,EAAQ6f,EAAM11B,OAAS,EAC/BshC,GAAcD,OAAOxrB,EAAQ,EAAGA,EAAOA,EAAQ,GAEjDyrB,GAAcvgC,OAIP0gC,CAAa/L,EAAO3a,GAC9B2mB,EAAO,SAAU75B,GACnB,OAAOtF,EAAIsF,EAAO3H,EAAS,KAEzBurB,EAASvrB,EAASwhC,EAAKzpB,IAIvB0pB,EAAW,SAAU9rB,EAAOyR,GAC9B,GAAI2N,GAAQ,EAAG,CACb,IAAI2M,EAAU/lB,KAAKC,IAAIuV,EAAUwQ,eAAgB5pB,EAAOqP,GAAQ2N,GAChE,OAAOyM,EAAKzpB,EAAOjT,MAAM,EAAG6Q,IAAQnV,OAAO,CACzCu0B,EACA2M,EAAU3pB,EAAOqP,KAChB5mB,OAAOghC,EAAKzpB,EAAOjT,MAAMsiB,EAAO,KAEnC,IAAIwa,EAAUjmB,KAAKC,IAAIuV,EAAUwQ,eAAgB5pB,EAAOpC,GAASof,GAC7D8M,EAAQ9pB,EAAOpC,GAASisB,EAC5B,OAAOJ,EAAKzpB,EAAOjT,MAAM,EAAG6Q,IAAQnV,OAAO,CACzCohC,EAAU7pB,EAAOpC,GACjBksB,IACCrhC,OAAOghC,EAAKzpB,EAAOjT,MAAMsiB,EAAO,MAGnC0a,EAASL,EAYb,OAAOH,EAAQ//B,KAAKgqB,EA/BP,SAAU5V,GACrB,OAAOwb,EAAU4Q,kBAAkBhqB,EAAOpC,GAAQof,IA8BhB+M,EAXrB,SAAUE,EAAOrsB,EAAOyR,GACrC,OAAOqa,EAAS9rB,EAAOyR,IAEX,SAAU4a,EAAOrsB,GAC7B,GAAIof,GAAQ,EACV,OAAOyM,EAAKzpB,EAAOjT,MAAM,EAAG6Q,IAAQnV,OAAO,CAACu0B,IAE5C,IAAIkN,EAAOtmB,KAAKC,IAAIuV,EAAUwQ,eAAgB5pB,EAAOpC,GAASof,GAC9D,OAAOyM,EAAKzpB,EAAOjT,MAAM,EAAG6Q,IAAQnV,OAAO,CAACyhC,EAAOlqB,EAAOpC,QAO5DusB,GAAY,SAAUvoB,EAAM5V,GAC9B,OAAO0G,GAAMkP,EAAM5V,IAAS0V,SAASlP,GAAMoP,EAAM5V,GAAO,IAAM,GAW5Do+B,GAAY,CACdC,WAVe,SAAUzoB,GACzB,OAAOuoB,GAAUvoB,EAAM,YAUvB0oB,WARe,SAAU1oB,GACzB,OAAOuoB,GAAUvoB,EAAM,YAQvB2oB,SAAUtiC,EAAS,IACnBuiC,UAAWviC,EAAS,IACpBwiC,OARW,SAAUh5B,EAAS+D,GAC9B,OAAOkM,SAAS7L,GAAMpE,EAAS+D,GAAW,MAUxCk1B,GAAW,SAAU9oB,EAAMpM,EAAU6iB,GACvC,OAAOriB,GAAO4L,EAAMpM,GAAUhM,KAAK,WACjC,OAAO6uB,EAAOzW,GAAQ,MACrB,SAAU3L,GACX,OAAOA,KAGP00B,GAAU,SAAU/oB,EAAMwX,GAC5B,OAAOsR,GAAS9oB,EAAM,QAAS,SAAUlD,GACvC,OAAO4a,GAAMG,cAAc/a,EAAG0a,MAG9BwR,GAAU,SAAUhpB,GACtB,OAAO8oB,GAAS9oB,EAAM,SAAU0X,GAAMe,YAEpCwQ,GAAe,SAAU7nB,EAAW6hB,EAAWiG,EAAUvb,EAAU6J,GACrE,IAAInU,EAAUob,GAAerd,GACzB+nB,EAAUzgC,EAAI2a,EAAS,SAAUwX,GACnC,OAAOA,EAAWnyB,IAAIu6B,EAAUrsB,QAElC,OAAOlO,EAAI2a,EAAS,SAAUwX,EAAYzM,GAExC,OADiByM,EAAW9xB,OAAOjC,EAAI0hC,GAAUC,aAC/B7gC,KAAK,WACrB,IAAIwhC,EAAUrL,GAAOoL,EAAS/a,GAC9B,OAAOT,EAASyb,IACf,SAAUppB,GACX,OAAOkpB,EAASlpB,EAAMwX,QAIxB6R,GAAa,SAAUD,GACzB,OAAOA,EAAQ1gC,IAAI,SAAU0F,GAC3B,OAAOA,EAAI,OACVpG,MAAM,KAmBPshC,GAAgB,SAAUloB,EAAW6hB,EAAWxK,EAAW9K,GAC7D,IAAItN,EAAOoe,GAAYrd,GACnB+nB,EAAUzgC,EAAI2X,EAAM,SAAUwa,GAChC,OAAOA,EAAWnyB,IAAIu6B,EAAUrsB,QAElC,OAAOlO,EAAI2X,EAAM,SAAUwa,EAAYzM,GAErC,OADcyM,EAAW9xB,OAAOjC,EAAI0hC,GAAUE,aAC/B9gC,KAAK,WAClB,IAAIwhC,EAAUrL,GAAOoL,EAAS/a,GAC9B,OAAOT,EAASyb,IACf,SAAUppB,GACX,OAAOyY,EAAUzY,QAYnBupB,GAAc,CAChBC,aAzCiB,SAAUpoB,EAAW6hB,EAAWzL,GACjD,OAAOyR,GAAa7nB,EAAW6hB,EAAW8F,GAASM,GAAY7R,IAyC/DiS,eA9BmB,SAAUroB,EAAW6hB,EAAWzL,GACnD,OAAOyR,GAAa7nB,EAAW6hB,EAAWvL,GAAMG,cAAe,SAAUuR,GACvE,OAAOA,EAAQnhC,WAAWuvB,EAAUwQ,eACnCxQ,IA4BHkS,oBAxCwB,SAAUtoB,EAAW6hB,EAAWzL,GACxD,OAAOyR,GAAa7nB,EAAW6hB,EAAWvL,GAAMS,mBAAoB,SAAUiR,GAC5E,OAAOA,EAAQxhC,KAAK,WAClB,OAAO4vB,EAAUwQ,gBAChB,SAAUzQ,GACX,OAAOA,EAAYC,EAAUC,aAAe,OAE7CD,IAkCHmS,gBAZoB,SAAUvoB,EAAW6hB,GACzC,OAAOqG,GAAcloB,EAAW6hB,EAAWvL,GAAMe,UAAW,SAAU2Q,GACpE,OAAOA,EAAQnhC,WAAWugC,GAAUI,cAWtCgB,cARkB,SAAUxoB,EAAW6hB,GACvC,OAAOqG,GAAcloB,EAAW6hB,EAAW+F,GAASK,MAUlDvS,GAAQ,SAAUvlB,EAAOga,EAAKse,GAEhC,IADA,IAAI/9B,EAAI,EACCF,EAAI2F,EAAO3F,EAAI2f,EAAK3f,IAC3BE,QAAqBvD,IAAhBshC,EAASj+B,GAAmBi+B,EAASj+B,GAAK,EAEjD,OAAOE,GAgCLg+B,GA9BmB,SAAU1oB,EAAW2oB,GAC1C,IAAInjC,EAAMya,GAAUmB,UAAUpB,GAC9B,OAAO1Y,EAAI9B,EAAK,SAAUoZ,GACxB,IAAIqX,EAAQP,GAAM9W,EAAKkB,SAAUlB,EAAKkB,SAAWlB,EAAKe,UAAWgpB,GACjE,MAAO,CACLl6B,QAASmQ,EAAKnQ,QACdwnB,MAAOhxB,EAASgxB,GAChBtW,QAASf,EAAKe,YAuBhB+oB,GAnBoB,SAAU1oB,EAAW4oB,GAC3C,IAAIpjC,EAAMya,GAAUmB,UAAUpB,GAC9B,OAAO1Y,EAAI9B,EAAK,SAAUoZ,GACxB,IAAIiV,EAAS6B,GAAM9W,EAAKI,MAAOJ,EAAKI,MAAQJ,EAAKc,UAAWkpB,GAC5D,MAAO,CACLn6B,QAASmQ,EAAKnQ,QACdolB,OAAQ5uB,EAAS4uB,GACjBnU,QAASd,EAAKc,YAYhBgpB,GARiB,SAAU1oB,EAAW4oB,GACxC,OAAOthC,EAAI0Y,EAAUxa,MAAO,SAAUwZ,EAAKxU,GACzC,MAAO,CACLiE,QAASuQ,EAAIvQ,QACbolB,OAAQ5uB,EAAS2jC,EAAQp+B,QAsC3Bq+B,GAAY,SAAU5S,GACxB,IAAI6S,EAAe5jC,EAWnB,MAAO,CACL+wB,MAAOhxB,EAASgxB,GAChBI,WAAYpxB,EAASgxB,GACrB8S,UAAWZ,GAAYE,eACvBS,aAAcA,EACd9B,kBAfsB,SAAU3lB,EAAGuY,GAEnC,MAAO,CADOhZ,KAAKC,IAAIumB,GAAUG,WAAYlmB,EAAIuY,GAC/BvY,IAclBulB,aAAcQ,GAAUG,SACxByB,gBAAiB1S,GAAMC,cACvB0S,cAdkB,SAAUlqB,EAAOmqB,EAAWC,GAC9C,IAAIzT,EAAQ/qB,EAAMu+B,EAAW,SAAU3gC,EAAGJ,GACxC,OAAOI,EAAIJ,GACV,GACHmuB,GAAMC,cAAcxX,EAAO2W,MAa3B0T,GAAa,SAAU36B,EAASwnB,GAClC,IAAIW,EAAeN,GAAMtB,2BAA2B2B,KAAKV,GACzD,GAAqB,OAAjBW,EACF,OAtDiB,SAAUX,EAAOxnB,GACpC,IAAI46B,EAAalW,WAAW8C,GACxBI,EAAanC,GAAMzlB,GAevB,MAAO,CACLwnB,MAAOhxB,EAASokC,GAChBhT,WAAYpxB,EAASoxB,GACrB0S,UAAWZ,GAAYG,oBACvBQ,aAlBiB,SAAUlP,GAC3B,OAAOA,EAAQvD,EAAa,KAkB5B2Q,kBAhBsB,SAAU3lB,EAAG8nB,GACnC,MAAO,CAAC,IAAM9nB,IAgBdulB,aAdiB,WACjB,OAAOQ,GAAUG,WAAalR,EAAa,KAc3C2S,gBAAiB1S,GAAME,mBACvByS,cAbkB,SAAUlqB,EAAOuqB,EAAY1P,GAC/C,IACI2P,EADQ3P,EAAQ,IACCyP,EACrB/S,GAAME,mBAAmBzX,EAAOsqB,EAAaE,KAuCtCC,CAAe5S,EAAa,GAAInoB,GAEzC,IAAIioB,EAAaJ,GAAMrB,sBAAsB0B,KAAKV,GAClD,GAAmB,OAAfS,EAAqB,CACvB,IAAIM,EAAWtY,SAASgY,EAAW,GAAI,IACvC,OAAOmS,GAAU7R,GAEnB,IAAIyS,EAAgBvV,GAAMzlB,GAC1B,OAAOo6B,GAAUY,IAWfC,GATe,SAAUj7B,GAE3B,OADY6nB,GAAMN,YAAYvnB,GACjBjI,KAAK,WAChB,IAAIijC,EAAgBvV,GAAMzlB,GAC1B,OAAOo6B,GAAUY,IAChB,SAAUpoB,GACX,OAAO+nB,GAAW36B,EAAS4S,MAK3BsoB,GAAiB,SAAUxpB,GAC7B,OAAOF,GAAUC,SAASC,IAOxBypB,GAAoB,SAAU7qB,GAChC,IAAIoB,EAAOZ,GAAsBR,GACjC,OAAO4qB,GAAexpB,IAgDpB0pB,GA9Cc,SAAU9qB,EAAO6a,EAAOhf,EAAOinB,GAC/C,IAAIzL,EAAYsT,GAAuB3qB,GACnCib,EAAO5D,EAAU0S,aAAalP,GAC9B5Z,EAAY4pB,GAAkB7qB,GAC9B4pB,EAASvS,EAAU2S,UAAU/oB,EAAW6hB,EAAWzL,GACnD0T,EAASxD,GAAiBqC,EAAQ/tB,EAAOof,EAAM5D,GAC/C8S,EAAY5hC,EAAIwiC,EAAQ,SAAUC,EAAIv/B,GACxC,OAAOu/B,EAAKpB,EAAOn+B,KAEjBw/B,EAAWtB,GAAgC1oB,EAAWkpB,GAC1D3hC,EAAKyiC,EAAU,SAAUprB,GACvBwX,EAAU4S,gBAAgBpqB,EAAKnQ,UAAWmQ,EAAKqX,WAE7Crb,IAAUoF,EAAU7D,OAAO8F,UAAY,GACzCmU,EAAU6S,cAAclqB,EAAOmqB,EAAWlP,IAgC1C6P,GA7Be,SAAU9qB,EAAO6a,EAAOhf,EAAOinB,GAChD,IAAI7hB,EAAY4pB,GAAkB7qB,GAC9B6pB,EAAUT,GAAYI,gBAAgBvoB,EAAW6hB,GACjDoI,EAAa3iC,EAAIshC,EAAS,SAAUsB,EAAI1/B,GAC1C,OAAOoQ,IAAUpQ,EAAIoW,KAAKC,IAAI+Y,EAAQsQ,EAAI9C,GAAUI,aAAe0C,IAEjEC,EAAezB,GAAiC1oB,EAAWiqB,GAC3DG,EAAc1B,GAA8B1oB,EAAWiqB,GAC3D1iC,EAAK6iC,EAAa,SAAUprB,GAC1BsX,GAAMpB,UAAUlW,EAAIvQ,UAAWuQ,EAAI6U,YAErCtsB,EAAK4iC,EAAc,SAAUvrB,GAC3B0X,GAAMpB,UAAUtW,EAAKnQ,UAAWmQ,EAAKiV,YAEvC,IAAI6B,EAvCG/qB,EAuCWs/B,EAvCI,SAAU1hC,EAAGJ,GACjC,OAAOI,EAAIJ,GACV,GAsCHmuB,GAAMpB,UAAUnW,EAAO2W,IAcrBmU,GAZgB,SAAU9qB,EAAOoB,EAAM0hB,GACzC,IAAIzL,EAAYsT,GAAuB3qB,GACnCiB,EAAY2pB,GAAexpB,GAC3BwoB,EAASvS,EAAU2S,UAAU/oB,EAAW6hB,EAAWzL,GACnD4T,EAAWtB,GAAgC1oB,EAAW2oB,GAC1DphC,EAAKyiC,EAAU,SAAUprB,GACvBwX,EAAU4S,gBAAgBpqB,EAAKnQ,UAAWmQ,EAAKqX,WAE7C+T,EAASjlC,OAAS,GACpBqxB,EAAU6S,cAAclqB,EAAO4pB,EAAQvS,EAAU0S,aAAa,KAe9DuB,GAAW,SAAUC,EAAmBh+B,EAAU/B,GACpD,GAAwB,IAApB+B,EAASvH,OACX,MAAM,IAAIiC,MAAM,iDAIlB,OAFA0F,EAAe,WAAYJ,GAC3BO,EAAWP,GACJ,SAAUf,GACf,IAAI4B,EAAS/B,EAAKG,GACJ7D,EAAO4E,EAAU,SAAUc,GACvC,OAAOhD,EAAS+C,EAAQC,MAGxBf,EAAWC,EAAUa,GAEvBm9B,EAAkBh+B,EAAUa,GAC5B,IAAIo9B,EAAc5iC,EAAO2E,EAAU,SAAUT,GAC3C,OAAQtB,EAAKigC,SAASj/B,EAAIM,GAAMA,KAKlC,OAHI0+B,EAAYxlC,OAAS,GAp0HJ,SAAU0lC,EAAWzhC,GAC5C,MAAM,IAAIhC,MAAM,kCAAoCgC,EAAO,WAAamD,EAAKs+B,GAAWl+B,KAAK,MAAQ,eAo0HjGm+B,CAAmBH,EAAahgC,EAAKoC,OAEhCpB,IAGPo/B,GAAc,SAAUr+B,EAAUlB,GACpC,IAAIqB,EAAc9E,EAAOyD,EAAM,SAAUS,GACvC,OAAQzB,EAASkC,EAAUT,KAEzBY,EAAY1H,OAAS,GACvByH,EAAcC,IAGdm+B,GAAU,SAAUt+B,GACtB,OAvCS,SAAUg+B,EAAmBh+B,GACtC,OAAO+9B,GAASC,EAAmBh+B,EAAU,CAC3Ck+B,SAAU5gC,EACV+C,MAAO,aAoCF0Q,CAAKstB,GAAar+B,IAGvBu+B,GAAmBD,GAAQ,CAC7B,OACA,MACA,UACA,QAEEE,GAAgB,SAAUr8B,GAC5B,IAAIkR,EAAUjQ,GAAMjB,EAAS,WAAaiQ,SAASlP,GAAMf,EAAS,WAAY,IAAM,EAChFiR,EAAUhQ,GAAMjB,EAAS,WAAaiQ,SAASlP,GAAMf,EAAS,WAAY,IAAM,EACpF,MAAO,CACLA,QAASxJ,EAASwJ,GAClBkR,QAAS1a,EAAS0a,GAClBD,QAASza,EAASya,KAkGlBqrB,GA/Fe,SAAUxZ,EAAYyZ,QACxB,IAAXA,IACFA,EAASF,IAEXD,GAAiBtZ,GACjB,IAAIsM,EAAW55B,EAAKuE,EAAO1C,QAIvBmlC,EAAS,SAAUx8B,GAErB,OALO,SAAUy8B,GACjB,OAAO3Z,EAAW3S,KAAKssB,GAIhBp3B,CADIk3B,EAAOv8B,KAGhB0tB,EAAM,SAAU1tB,GAClB,IAAIk2B,EAAcsG,EAAOx8B,GAQzB,OAPIovB,EAASz5B,MAAM8B,UACjB23B,EAASx5B,IAAImE,EAAON,KAAKy8B,IAE3BwG,EAAS3iC,EAAON,KAAK,CACnB+Y,KAAMxS,EACNk2B,YAAaA,IAERA,GAELwG,EAAS3iC,EAAO1C,OAQpB,MAAO,CACLslC,UARc,SAAU38B,EAASyS,GACjC,OAAOiqB,EAAO3kC,KAAK,WACjB,OAAO21B,EAAI1tB,IACV,SAAUkF,GACX,OAAOuN,EAAWzS,EAASkF,EAAEsN,MAAQtN,EAAEgxB,YAAcxI,EAAI1tB,MAK3DuzB,OAAQnE,EAASz5B,MA6DjB2mC,GA1DY,SAAU95B,EAAOQ,GAC/B,OAAO,SAAU8f,GACf,IAAIsM,EAAW55B,EAAKuE,EAAO1C,QAC3B+kC,GAAiBtZ,GACjB,IAAIpR,EAAO,GAMPkrB,EAAU,SAAU58B,GACtB,IAAIc,EAAQ,CAAE0B,MAAOA,GACjB2N,EAAO2S,EAAWle,QAAQ5E,EAASgD,EAAKlC,GAQ5C,OAPA4Q,EAAKhW,KAAK,CACR8W,KAAMxS,EACNq2B,IAAKlmB,IAEHif,EAASz5B,MAAM8B,UACjB23B,EAASx5B,IAAImE,EAAON,KAAK0W,IAEpBA,GAST,MAAO,CACL0sB,cARkB,SAAU78B,EAASyS,GACrC,OAlBW,SAAUzS,EAASyS,GAC9B,OAAOnW,EAAKoV,EAAM,SAAUhb,GAC1B,OAAO+b,EAAW/b,EAAE8b,KAAMxS,KAgBrBkG,CAAOlG,EAASyS,GAAY1a,KAAK,WACtC,OAAO6kC,EAAQ58B,IACd,SAAUkF,GACX,OAAOuN,EAAWzS,EAASkF,EAAEsN,MAAQtN,EAAEmxB,IAAMuG,EAAQ58B,MAKvDuzB,OAAQnE,EAASz5B,OA2BnB2mC,GAvBU,SAAUxZ,GACtBsZ,GAAiBtZ,GACjB,IAAIsM,EAAW55B,EAAKuE,EAAO1C,QAgB3B,MAAO,CACLylC,QAhBY,SAAU3sB,GAItB,OAHIif,EAASz5B,MAAM8B,UACjB23B,EAASx5B,IAAImE,EAAON,KAAK0W,IAEpB,WACL,IAAI3L,EAAMse,EAAW3S,KAAK,CACxBnQ,QAASxJ,EAAS2Z,GAClBe,QAAS1a,EAAS,GAClBya,QAASza,EAAS,KAIpB,OAFAiO,GAASD,EAAK,SACdC,GAAS0L,EAAM,SACR3L,IAKT+uB,OAAQnE,EAASz5B,MASjBonC,GAAY,CACd,OACA,IACA,MACA,UACA,QACA,aACA,SACA,SACA,SACA,MACA,UACA,KACA,KACA,QACA,QACA,QACA,QACA,UACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,aACA,MACA,WASEC,GAAU,SAAU7hB,EAAU3I,GAChC,IAAIyqB,EAAU9hB,EAASpX,WAAWlJ,KAAK2X,GACvC,OAAO7W,EAASohC,GAAWE,IAsCzBliB,GAAa,SAAUI,EAAU3I,GACnC,OAAO7W,EAAS,CACd,KACA,MACA,KACA,SACCwf,EAASpX,WAAWlJ,KAAK2X,KAQ1B0qB,GACOF,GADPE,GA7DS,SAAU/hB,EAAU3I,GAC/B,IAAIyqB,EAAU9hB,EAASpX,WAAWlJ,KAAK2X,GACvC,OAAO7W,EAAS,CACd,KACA,MACCshC,IAwDDC,GAMUniB,GAKVoiB,GAAarjB,KAyBbsjB,GAxBY,SAAUp9B,GACxB,OAAOk9B,GAAkBC,GAAYn9B,IAuBnCo9B,GArBW,SAAUp9B,GACvB,OAAOk9B,GAAiBC,GAAYn9B,IAoBlCo9B,GATe,SAAUp9B,GAC3B,OAAOk9B,GAAqBC,GAAYn9B,IA6DtCq9B,GA1CU,SAAUhtB,GACtB,IA+BMkT,EA/BF+Z,EAAO,SAAUtuB,GACnB,MAAoB,OAAbnU,GAAKmU,IAqBVuuB,EAAW,SAAUptB,GACvB,OAAOkF,GAAOlF,GAAMpX,KAAK,SAAU+e,GACjC,IAAI0lB,EAZCxxB,GAYoC8L,GAZpBjf,IAAI,SAAU4kC,GACnC,QAAIL,GAAqBK,MAGrBL,GAAwBK,IACI,QAAvB5iC,GAAK4iC,KAGbtlC,OAAM,GAKP,OAAOqT,GAAOsM,GAAWjf,IAAI,SAAU2S,GACrC,OAA+B,IAAxBgyB,GAjBS,OAAb3iC,GADkBmU,EAkB6BxD,IAjB1BuD,GAASC,EAAIouB,IAAqBllC,UAiBGolC,EAAKxlB,IAAcslB,GAAqB5xB,KAAYjU,GAAG4Y,EAAM3E,GAAU,GAAK,CAACnJ,GAAQU,QAAQ,OAlB/I,IAAUiM,MAoBtB7W,MAAM,KASPulC,EAFwB,KAJtBna,EAAUxqB,EAAKsX,EAAO,SAAUF,GAClC,IAAI1C,EAAaxB,GAASkE,GAC1B,OA9Ba,SAAUlE,GACzB,OAAOhT,EAAOgT,EAAU,SAAUsS,GAChC,OAAO+e,EAAK/e,IAAM/d,GAAO+d,IAAiC,IAA3B5J,GAAM4J,GAAGvJ,OAAO1e,SA4BxCqnC,CAAWlwB,GAAc,GAAKA,EAAWzW,OAAOumC,EAASptB,OAEnD7Z,OAAe,CAAC+L,GAAQU,QAAQ,OAASwgB,EAG1DpW,GAAMkD,EAAM,IACZnD,GAASmD,EAAM,GAAIqtB,IAIjB3hB,GAAQ,SAAUzL,GAEC,IADTJ,GAAYG,MAAMC,GACpBha,QACRgX,GAASgD,IAGTstB,GAAUtgC,EAAU,OAAQ,UAC5BugC,GAAkB,SAAUnwB,EAAM6C,EAAKc,GACzC,OAAOysB,GAAOpwB,EAAM6C,EAAKc,GAAQzY,QAAQ,WACvC,OAAOklC,GAAOpwB,EAAM,EAAG,MAGvBowB,GAAS,SAAUpwB,EAAM6C,EAAKc,GAChC,OAAOtX,EAAOC,KAAK0T,EAAK6C,IAAMxX,KAAK,SAAUkD,GAC3C,OAAOlC,EAAOC,KAAKiC,EAAEoU,QAAQgB,IAAStY,KAAK,SAAUwlB,GACnD,OAAOxkB,EAAOC,KAAKukB,EAAEve,gBAIvB+9B,GAAS,SAAUrwB,EAAM6C,EAAKc,GAChC,OAAOusB,GAAQlwB,EAAMowB,GAAOpwB,EAAM6C,EAAKc,KAErC2sB,GAAa,SAAUlsB,GACzB,OAAOzV,EAAMyV,EAAS,SAAUqc,EAAMvgB,GACpC,OAAO5U,EAAOm1B,EAAM,SAAU8P,GAC5B,OAAOA,EAAc1tB,QAAU3C,EAAO2C,QACnC4d,EAAOA,EAAKn3B,OAAO,CAAC4W,KACxB,IAAIlQ,KAAK,SAAUgb,EAASC,GAC7B,OAAOD,EAAQnI,MAAQoI,EAAQpI,SAG/B2tB,GAAgB,SAAUpsB,GAC5B,OAAOzV,EAAMyV,EAAS,SAAUqc,EAAMvgB,GACpC,OAAO5U,EAAOm1B,EAAM,SAAU8P,GAC5B,OAAOA,EAAc5sB,WAAazD,EAAOyD,WACtC8c,EAAOA,EAAKn3B,OAAO,CAAC4W,KACxB,IAAIlQ,KAAK,SAAUgb,EAASC,GAC7B,OAAOD,EAAQrH,SAAWsH,EAAQtH,YA+HlC8sB,GAAc,SAAU3tB,EAAMsS,EAAY3R,GAC5C,IAAIitB,EAAettB,GAA2BN,EAAMW,GAChDktB,EAAK7sB,GAAUC,SAAS2sB,GAC5B,OAAOjM,GAAmBkM,EAAIvb,GAAY,IAkBxCwb,GAASlD,GACTmD,GAAkB,CACpBC,gBAAiB1L,GAnJG,SAAUplB,EAAME,EAAQ6E,EAAY0gB,GACxD,IAAIhiB,EAAUvD,EAAO2C,MACjBkuB,EAAc7wB,EAAO2C,MACrBmuB,EAAU5H,GAAmCppB,EAAM+wB,EAAattB,EAASsB,EAAY0gB,EAAYwJ,WACrG,OAAOoB,GAAOW,EAASD,EAAa7wB,EAAOyD,WA+ILqiB,GAAQ39B,EAAMA,EAAMumC,IAC1DqC,iBAAkB7L,GA9IG,SAAUplB,EAAMoE,EAASW,EAAY0gB,GAC1D,IAAIhiB,EAAUW,EAAQ,GAAGvB,MACrBkuB,EAAc3sB,EAAQ,GAAGvB,MACzBC,EAAOwtB,GAAWlsB,GAClB4sB,EAAUriC,EAAMmU,EAAM,SAAUouB,EAAM9J,GACxC,OAAOgC,GAAmC8H,EAAMH,EAAattB,EAASsB,EAAY0gB,EAAYwJ,YAC7FjvB,GACH,OAAOqwB,GAAOW,EAASD,EAAa3sB,EAAQ,GAAGT,WAuIPwiB,GAAS99B,EAAMA,EAAMumC,IAC7DuC,eAAgB/L,GAtIG,SAAUplB,EAAME,EAAQ6E,EAAY0gB,GACvD,IAAIhiB,EAAUvD,EAAO2C,MACjBkuB,EAAc7wB,EAAO2C,MAAQ3C,EAAOqD,UACpCytB,EAAU5H,GAAmCppB,EAAM+wB,EAAattB,EAASsB,EAAY0gB,EAAYwJ,WACrG,OAAOoB,GAAOW,EAASD,EAAa7wB,EAAOyD,WAkIPqiB,GAAQ39B,EAAMA,EAAMumC,IACxDwC,gBAAiBhM,GAjIG,SAAUplB,EAAMoE,EAASW,EAAY0gB,GACzD,IAAI3iB,EAAOwtB,GAAWlsB,GAClBX,EAAUX,EAAKA,EAAKla,OAAS,GAAGia,MAChCkuB,EAAcjuB,EAAKA,EAAKla,OAAS,GAAGia,MAAQC,EAAKA,EAAKla,OAAS,GAAG2a,UAClEytB,EAAUriC,EAAMmU,EAAM,SAAUouB,EAAM9J,GACxC,OAAOgC,GAAmC8H,EAAMH,EAAattB,EAASsB,EAAY0gB,EAAYwJ,YAC7FjvB,GACH,OAAOqwB,GAAOW,EAASD,EAAa3sB,EAAQ,GAAGT,WA0HTwiB,GAAS99B,EAAMA,EAAMumC,IAC3DyC,mBAAoBjM,GAzHG,SAAUplB,EAAME,EAAQ6E,EAAY0gB,GAC3D,IAAIhiB,EAAUvD,EAAOyD,SACjBotB,EAAc7wB,EAAOyD,SACrBqtB,EAAU5H,GAAsCppB,EAAM+wB,EAAattB,EAASsB,EAAY0gB,EAAYwJ,WACxG,OAAOoB,GAAOW,EAAS9wB,EAAO2C,MAAOkuB,IAqHO/K,GAAQ4K,GAAQvoC,EAAMumC,IAClE0C,oBAAqBlM,GApHG,SAAUplB,EAAMoE,EAASW,EAAY0gB,GAC7D,IAAI3f,EAAU0qB,GAAcpsB,GACxBX,EAAUqC,EAAQ,GAAGnC,SACrBotB,EAAcjrB,EAAQ,GAAGnC,SACzBqtB,EAAUriC,EAAMmX,EAAS,SAAUorB,EAAM9J,GAC3C,OAAOgC,GAAsC8H,EAAMH,EAAattB,EAASsB,EAAY0gB,EAAYwJ,YAChGjvB,GACH,OAAOqwB,GAAOW,EAAS5sB,EAAQ,GAAGvB,MAAOkuB,IA6GK5K,GAASyK,GAAQvoC,EAAMumC,IACrE2C,kBAAmBnM,GA5GG,SAAUplB,EAAME,EAAQ6E,EAAY0gB,GAC1D,IAAIhiB,EAAUvD,EAAOyD,SACjBotB,EAAc7wB,EAAOyD,SAAWzD,EAAOsD,UACvCwtB,EAAU5H,GAAsCppB,EAAM+wB,EAAattB,EAASsB,EAAY0gB,EAAYwJ,WACxG,OAAOoB,GAAOW,EAAS9wB,EAAO2C,MAAOkuB,IAwGK/K,GAAQ4K,GAAQvoC,EAAMumC,IAChE4C,mBAAoBpM,GAvGG,SAAUplB,EAAMoE,EAASW,EAAY0gB,GAC5D,IAAIhiB,EAAUW,EAAQA,EAAQxb,OAAS,GAAG+a,SACtCotB,EAAc3sB,EAAQA,EAAQxb,OAAS,GAAG+a,SAAWS,EAAQA,EAAQxb,OAAS,GAAG4a,UACjFsC,EAAU0qB,GAAcpsB,GACxB4sB,EAAUriC,EAAMmX,EAAS,SAAUorB,EAAM9J,GAC3C,OAAOgC,GAAsC8H,EAAMH,EAAattB,EAASsB,EAAY0gB,EAAYwJ,YAChGjvB,GACH,OAAOqwB,GAAOW,EAAS5sB,EAAQ,GAAGvB,MAAOkuB,IAgGG5K,GAASyK,GAAQvoC,EAAMumC,IACnE6C,qBAAsBrM,GA/EK,SAAUplB,EAAME,EAAQ6E,EAAY0gB,GAC/D,IAAIuL,EAAU5H,GAA4CppB,EAAME,EAAO2C,MAAO3C,EAAOyD,SAAUoB,EAAY0gB,EAAYwJ,WACvH,OAAOoB,GAAOW,EAAS9wB,EAAO2C,MAAO3C,EAAOyD,WA6EMqiB,GAAQ4K,GAAQvoC,EAAMumC,IACxE8C,kBAAmBtM,GA5EK,SAAUplB,EAAME,EAAQ6E,EAAY0gB,GAC5D,IAAIuL,EAAU5H,GAAyCppB,EAAME,EAAO2C,MAAO3C,EAAOyD,SAAUoB,EAAY0gB,EAAYwJ,WACpH,OAAOoB,GAAOW,EAAS9wB,EAAO2C,MAAO3C,EAAOyD,WA0EAqiB,GAAQ39B,EAAMA,EAAMumC,IAChE+C,aAAcvM,GAzEG,SAAUplB,EAAMoE,EAASwtB,EAAaC,GACvD,IAAI/rB,EAAU0qB,GAAcpsB,GACxB4sB,EAAU5H,GAAuCppB,EAAM8F,EAAQ,GAAGnC,SAAUmC,EAAQA,EAAQld,OAAS,GAAG+a,UACxGkiB,EAASsK,GAAgBa,EAAS5sB,EAAQ,GAAGvB,MAAOuB,EAAQ,GAAGT,UACnE,OAAOusB,GAAQc,EAASnL,IAqEQM,GAASyK,GAAQviB,GAAOugB,IACxDkD,UAAW1M,GApEG,SAAUplB,EAAMoE,EAASwtB,EAAaC,GACpD,IAAI/uB,EAAOwtB,GAAWlsB,GAClB4sB,EAAU5H,GAAoCppB,EAAM8C,EAAK,GAAGD,MAAOC,EAAKA,EAAKla,OAAS,GAAGia,OACzFgjB,EAASsK,GAAgBa,EAAS5sB,EAAQ,GAAGvB,MAAOuB,EAAQ,GAAGT,UACnE,OAAOusB,GAAQc,EAASnL,IAgEEM,GAAS99B,EAAMgmB,GAAOugB,IAChDmD,iBAAkB3M,GA/FG,SAAUplB,EAAME,EAAQ6E,EAAY0gB,GACzD,IAAIuL,EAAUlH,GAAkC9pB,EAAME,EAAOyD,SAAUoB,EAAY0gB,EAAY0J,eAC/F,OAAOkB,GAAOW,EAAS9wB,EAAO2C,MAAO3C,EAAOyD,WA6FJqiB,GAAQ39B,EAAMA,EAAMumC,GAAqB,MAAO,OACxFoD,mBAAoB5M,GAxFG,SAAUplB,EAAME,EAAQ6E,EAAY0gB,GAC3D,IAAIuL,EAAUlH,GAAkC9pB,EAAME,EAAOyD,SAAUoB,EAAY0gB,EAAY0J,eAC/F,OAAOkB,GAAOW,EAAS9wB,EAAO2C,MAAO3C,EAAOyD,WAsFAqiB,GAAQ39B,EAAMA,EAAMumC,GAAqB,KAAM,OAC3FqD,cAAe7M,GArGG,SAAUplB,EAAME,EAAQ6E,EAAY0gB,GACtD,IAAIuL,EAAUlH,GAA+B9pB,EAAME,EAAO2C,MAAOkC,EAAY0gB,EAAY0J,eACzF,OAAOkB,GAAOW,EAAS9wB,EAAO2C,MAAO3C,EAAOyD,WAmGVqiB,GAAQ39B,EAAMA,EAAMumC,GAAqB,MAAO,OAClFsD,gBAAiB9M,GA9FG,SAAUplB,EAAME,EAAQ6E,EAAY0gB,GACxD,IAAIuL,EAAUlH,GAA+B9pB,EAAME,EAAO2C,MAAOkC,EAAY0gB,EAAY0J,eACzF,OAAOkB,GAAOW,EAAS9wB,EAAO2C,MAAO3C,EAAOyD,WA4FNqiB,GAAQ39B,EAAMA,EAAMumC,GAAqB,KAAM,OACrFuD,WAAY/M,GAnEG,SAAUplB,EAAM6U,EAAU9P,EAAY8sB,GACrD,IAAIlvB,EAAQkS,EAASlS,QACrBgtB,GAAmBhtB,GACnB,IAAIquB,EAAU7I,GAAwBnoB,EAAM6U,EAASnU,SAAUqE,EAAYjc,EAAS6Z,EAAM,KAC1F,OAAOutB,GAAQc,EAAS3kC,EAAOC,KAAKqW,EAAM,MAjtC3B,SAAUyvB,EAAY52B,GACrC,OAAOA,EAAOqZ,YA+wC0BxsB,EAAMA,EAAMumC,IACpDyD,aAAcjN,GA9DG,SAAUplB,EAAM8U,EAAY/P,EAAY0gB,GACzD,IAAIuL,EAAUxiC,EAAMsmB,EAAY,SAAU1oB,EAAGqW,GAC3C,OAAO0lB,GAA0B/7B,EAAGqW,EAAMsC,EAAY0gB,EAAY2J,QAAQ3sB,KACzEzC,GACH,OAAOkwB,GAAQc,EAAS3kC,EAAOC,KAAKwoB,EAAW,MAptC9B,SAAUsd,EAAY52B,GACvC,OAAOA,EAAOsZ,cA6wCgC8b,GAAQvoC,EAAMumC,IAC5DnY,WAAY2O,GAzDG,SAAUplB,EAAM0wB,EAAc3rB,EAAY8sB,GACzD,IAAwBjvB,EAAOwS,EACzBpR,EACA2sB,EAGFlJ,GALoB7kB,EAKJ8tB,EAAavb,YALFC,EAKesb,EAAatb,aAJrDpR,EAAOZ,GAAsBR,GAC7B+tB,EAAK7sB,GAAUC,SAASC,GACrBygB,GAAmBkM,EAAIvb,GAAY,IAGxCmS,EAAetnB,GAAQywB,EAAa7tB,MAAO6tB,EAAa/sB,UAE5D,OADiBmlB,GAAiBvB,EAAcvnB,EAAMynB,EAAOiJ,EAAatb,aAAcrQ,GACtE1a,KAAK,WACrB,OAAO6lC,GAAQlwB,EAAM3T,EAAON,KAAK2kC,EAAap+B,aAC7C,SAAUggC,GACX,IAAIzM,EAASsK,GAAgBmC,EAAQ5B,EAAa7tB,MAAO6tB,EAAa/sB,UACtE,OAAOusB,GAAQoC,EAAQzM,MA9vCb,SAAUhiB,EAAWrI,GACjC,OAAOgH,GAAYC,KAAKjH,EAAOlJ,WAAWjH,KAAK,SAAUoX,GACvD,OAAO0iB,GAAgBthB,EAAWpB,GAAMtX,IAAI,SAAUiZ,GAKpD,OAJY9M,GAASA,GAAS,GAAI8M,GAAU,CAC1CgR,WAAY5Z,EAAO4Z,WACnBD,UAAW3Z,EAAO2Z,iBAqyCayb,GAAQvoC,EAAMumC,IACnD2D,gBAAiBnN,GArCG,SAAUplB,EAAM0wB,EAAc3rB,EAAY8sB,GAC9D,IAAIpuB,EAAUzD,EAAK0wB,EAAa/tB,MAAM,GAAGE,OACrCpE,EAAQiyB,EAAa/tB,MAAM,GAAGE,MAC9B4kB,EAAQgJ,GAAYC,EAAavb,YAAaub,EAAatb,aAAc3R,GACzE+uB,EAAa1J,GAAkBrqB,EAAOuB,EAAMynB,EAAOiJ,EAAatb,aAAcrQ,GAC9E8gB,EAASsK,GAAgBqC,EAAY9B,EAAa/tB,MAAM,GAAGE,MAAO6tB,EAAa/tB,MAAM,GAAGgB,UAC5F,OAAOusB,GAAQsC,EAAY3M,IA+BWI,GAAa59B,EAAMA,EAAMumC,IAC/D6D,eAAgBrN,GA9BG,SAAUplB,EAAM0wB,EAAc3rB,EAAY8sB,GAC7D,IAAIpuB,EAAUzD,EAAK0wB,EAAa/tB,MAAM,GAAGE,OACrCpE,EAAQiyB,EAAa/tB,MAAM+tB,EAAa/tB,MAAM/Z,OAAS,GAAGia,MAAQ6tB,EAAa/tB,MAAM+tB,EAAa/tB,MAAM/Z,OAAS,GAAG2a,UACpHkkB,EAAQgJ,GAAYC,EAAavb,YAAaub,EAAatb,aAAc3R,GACzE+uB,EAAa1J,GAAkBrqB,EAAOuB,EAAMynB,EAAOiJ,EAAatb,aAAcrQ,GAC9E8gB,EAASsK,GAAgBqC,EAAY9B,EAAa/tB,MAAM,GAAGE,MAAO6tB,EAAa/tB,MAAM,GAAGgB,UAC5F,OAAOusB,GAAQsC,EAAY3M,IAwBSI,GAAa59B,EAAMA,EAAMumC,KAG3D8D,GAAY,SAAUnd,GACxB,OAAO5gB,GAAQF,QAAQ8gB,EAAOpf,YAE5Bw8B,GAAkB,SAAUxwB,GAC9B,OAAOA,EAAIsV,wBAAwBqC,OAEjC8Y,GAAiB,SAAUzwB,GAC7B,OAAOA,EAAIsV,wBAAwBC,QAEjCxG,GAAY,SAAUqE,GACxB,OAAO,SAAUjjB,GACf,OAAOzI,GAAGyI,EAASogC,GAAUnd,MAM7Bsd,GAAgB,SAAU9H,GAI5B,MAHI,WAAW3yB,KAAK2yB,KAClBA,GAAQ,MAEHA,GAEL+H,GAAkB,SAAUlwB,GAC9B,IAAImwB,EAAiB9xB,GAAc2B,EAAO,yCAC1CnP,GAAOmP,EAAO,kBACdxX,EAAK2nC,EAAgB,SAAUtwB,GAC7BhP,GAAOgP,EAAM,qBAQbuwB,GAAQ,CAAE7U,MAAOr1B,GAAS,IAC1BmqC,GAAQ,CAAE9U,MAAOr1B,GAAS,IAK1BoqC,GAAY,CAAEjV,YAJA,SAAU3rB,GAE1B,MAAe,QARE,SAAUA,GAC3B,MAAuC,QAAhCoE,GAAMpE,EAAS,aAAyB,MAAQ,MAM7C6gC,CAAa7gC,GACA2gC,GAAQD,KAK7BI,GAAgB,CAClBC,kBAAmB,WACnBvZ,MAAS,QAEPwZ,GAAoB,CAAEC,OAAQ,KAC9BC,GAAuB,SAAUje,GACnC,OAAOA,EAAOke,SAAS,2BAA4BH,GAAmB,WAEpEI,GAAmB,SAAUne,GAC/B,OAAOA,EAAOke,SAAS,uBAAwBL,GAAe,WAK5DO,GAAmB,SAAUpe,GAC/B,OAAOA,EAAOke,SAAS,wBAAwB,EAAM,YAEnDG,GAAqB,SAAUre,GACjC,OAAOA,EAAOke,SAAS,qBAAqB,EAAM,YAEhDI,GAAoB,SAAUte,GAChC,OAAOA,EAAOke,SAAS,oBAAoB,EAAM,YAE/CK,GAAsB,SAAUve,GAClC,OAAOA,EAAOke,SAAS,gBAAgB,EAAM,YAQ3CM,GAAqB,SAAUxe,GACjC,OAAOA,EAAOke,SAAS,sBAAsB,EAAO,YAQlDO,GAAoB,SAAUze,GAChC,OAAOA,EAAOke,SAAS,mBAAoB,GAAI,UAK7CQ,GAAiB,SAAU1e,GAC7B,OAAqD,IAA9CA,EAAOke,SAAS,2BAKrBS,GAAmB,SAAU3e,GAC/B,IAAI4e,EAAgB5e,EAAOke,SAAS,wBACpC,OAAInmC,EAAS6mC,GACJ9nC,EAAON,KAAKooC,EAAcxU,MAAM,SAC9B5yB,MAAMQ,QAAQ4mC,GAChB9nC,EAAON,KAAKooC,GAEZ9nC,EAAO1C,QAQdyqC,GAAa,SAAU7e,EAAQ1S,GACjC,OAAO0S,EAAO8e,KAAK,SAAU,CAAE3/B,KAAMmO,KAEnCyxB,GAAc,SAAU/e,EAAQ9S,GAClC,OAAO8S,EAAO8e,KAAK,UAAW,CAAE3/B,KAAM+N,KAEpC8xB,GAAwB,SAAUhf,EAAQ/Z,EAAQse,EAAOpC,GAC3DnC,EAAO8e,KAAK,oBAAqB,CAC/B74B,OAAQA,EACRse,MAAOA,EACPpC,OAAQA,KAGR8c,GAAoB,SAAUjf,EAAQ/Z,EAAQse,EAAOpC,GACvDnC,EAAO8e,KAAK,gBAAiB,CAC3B74B,OAAQA,EACRse,MAAOA,EACPpC,OAAQA,KAGR+c,GAA2B,SAAUlf,EAAQ5S,EAAO3O,EAAOqX,EAAQqpB,GACrEnf,EAAO8e,KAAK,uBAAwB,CAClC1xB,MAAOA,EACP3O,MAAOA,EACPqX,OAAQA,EACRqpB,WAAYA,KAGZC,GAA0B,SAAUpf,GACtCA,EAAO8e,KAAK,wBAGVO,GAAe,SAAUrf,EAAQsf,GACnC,IAAIC,EAAc,SAAUvf,GAC1B,MAAmC,UAA5BpoB,GAAKulC,GAAUnd,KAUpB5L,EAAeuqB,GAAiB3e,GAChCwf,EAAU,SAAU1P,EAAW2P,EAAOpsB,EAAQisB,GAChD,OAAO,SAAUjyB,EAAOpH,GACtBs3B,GAAgBlwB,GAChB,IAAIsf,EAAO2S,IACPh/B,EAAMlB,GAAQF,QAAQ8gB,EAAOgB,UAC7BmP,EAAY1H,GAAekV,GAAUjV,aACrC7I,EAAa1M,GAAUC,eAAeC,EAAQ/S,EAAK8T,GACvD,OAAOqrB,EAAMpyB,GAASyiB,EAAUnD,EAAMtf,EAAOpH,EAAQ4Z,EAAYsQ,GAAWr6B,KAAK,SAAUwV,GAOzF,OANAzV,EAAKyV,EAAO+d,UAAW,SAAU/b,GAC/BuxB,GAAW7e,EAAQ1S,EAAItQ,SAEzBnH,EAAKyV,EAAOge,WAAY,SAAUpc,GAChC6xB,GAAY/e,EAAQ9S,EAAKlQ,SAEpBsO,EAAOglB,SAAS16B,IAAI,SAAUsX,GACnC,IAAIiU,EAAMnB,EAAOhjB,IAAI0iC,YAGrB,OAFAve,EAAIwe,SAASzyB,EAAKlQ,MAAO,GACzBmkB,EAAIye,OAAO1yB,EAAKlQ,MAAO,GAChBmkB,MAENrqB,EAAO1C,SAchB,MAAO,CACLyrC,UAZcL,EAAQlE,GAAgBiB,UAhCrB,SAAUlvB,GAC3B,IAAImoB,EAAO1M,GAA0Bzb,GACrC,OAA+B,IAAxBkyB,EAAYvf,IAAqBwV,EAAKjoB,OAAS,GA8BSza,EAAMwsC,GAarEQ,aAZiBN,EAAQlE,GAAgBc,aA7BrB,SAAU/uB,GAC9B,IAAImoB,EAAO1M,GAA0Bzb,GACrC,OAA+B,IAAxBkyB,EAAYvf,IAAqBwV,EAAKjlB,UAAY,GA2Bezd,EAAMwsC,GAa9E5D,iBAZqB8D,EAAQlE,GAAgBI,iBAAkBvnC,EAAQrB,EAAMwsC,GAa7EzD,gBAZoB2D,EAAQlE,GAAgBO,gBAAiB1nC,EAAQrB,EAAMwsC,GAa3EvD,oBAZwByD,EAAQlE,GAAgBS,oBAAqB5nC,EAAQ0xB,GAAqByZ,GAalGrD,mBAZuBuD,EAAQlE,GAAgBW,mBAAoB9nC,EAAQ0xB,GAAqByZ,GAahG1C,WAZe4C,EAAQlE,GAAgBsB,WAAYzoC,EAAQrB,EAAMwsC,GAajExC,aAZiB0C,EAAQlE,GAAgBwB,aAAc3oC,EAAQrB,EAAMwsC,GAarEtC,gBAZoBwC,EAAQlE,GAAgB0B,gBAAiB7oC,EAAQrB,EAAMwsC,GAa3EpC,eAZmBsC,EAAQlE,GAAgB4B,eAAgB/oC,EAAQrB,EAAMwsC,GAazEpe,WAZese,EAAQlE,GAAgBpa,WAAY/sB,EAAQrB,EAAMwsC,KA2BjES,GAXW,SAAU1yB,EAAOpH,EAAQ4Z,GACtC,IAAIpR,EAAOZ,GAAsBR,GAC7B+C,EAAQ7B,GAAUC,SAASC,GAE/B,OADcmiB,GAAQxgB,EAAOnK,GACdrQ,IAAI,SAAUoqC,GAC3B,IACIC,EADO/Q,GAAmB9e,EAAOyP,GAAY,GAC3BxnB,MAAM2nC,EAAc,GAAG1yB,MAAO0yB,EAAcA,EAAc3sC,OAAS,GAAGia,MAAQ0yB,EAAcA,EAAc3sC,OAAS,GAAG2a,WACxIkyB,EAAgBvQ,GAAasQ,EAAYpgB,GAC7C,OAAOuJ,GAAY8W,MAKnBC,GAAWlpC,QAAQC,KAAKC,MAAMC,QAAQ,sBAwCtCgpC,GApBa,SAAUpgB,EAAQpT,EAAKhV,GAClCA,GACFooB,EAAOqgB,UAAU/sC,MAAM,QAAUsE,EAAM,GAAIgV,IAkB3CwzB,GAfc,SAAUpgB,EAAQpT,EAAKhV,GACnCA,GACFooB,EAAOqgB,UAAU/sC,MAAM,SAAWsE,EAAM,GAAIgV,IAa5CwzB,GAVe,SAAUpgB,EAAQpT,GACnCuzB,GAAStqC,KAAK,oBAAoBu0B,MAAM,KAAM,SAAUxyB,GACtDooB,EAAOqgB,UAAUniC,OAAO,QAAUtG,EAAM,GAAIgV,MAQ5CwzB,GALgB,SAAUpgB,EAAQpT,GACpCuzB,GAAStqC,KAAK,oBAAoBu0B,MAAM,KAAM,SAAUxyB,GACtDooB,EAAOqgB,UAAUniC,OAAO,SAAWtG,EAAM,GAAIgV,MAG7CwzB,GAtCsB,SAAUpjC,EAAK4P,EAAKhV,GAC5C,IACI0oC,EAcJ,OADAA,EAZoB,SAAUA,EAAiBC,GAC7C,IAAK,IAAIznC,EAAI,EAAGA,EAAIynC,EAAKltC,OAAQyF,IAAK,CACpC,IAAI0nC,EAAexjC,EAAIyjC,SAASF,EAAKznC,GAAIlB,GAIzC,QAH+B,IAApB0oC,IACTA,EAAkBE,GAEhBF,IAAoBE,EACtB,MAAO,GAGX,OAAOF,EAESI,CAAcJ,EAdpBtjC,EAAI2jC,OAAO,QAAS/zB,KAgE9Bg0B,GAAwB,SAAU5jC,EAAK4P,GACzC,IAAIi0B,EAAW,SAAUpuC,GACvB,OAAOkM,GAAWlM,EAAO,OAASuK,EAAI8jC,MAAMruC,GAASA,GAMvD,MAAO,CACLsuC,YALgBz/B,GAAOlC,GAAQF,QAAQ0N,GAAM,gBAAgB1X,MAAM,IAMnE8rC,YALgB1/B,GAAOlC,GAAQF,QAAQ0N,GAAM,gBAAgB1X,MAAM,IAMnE+rC,YALgB3/B,GAAOlC,GAAQF,QAAQ0N,GAAM,gBAAgBhX,IAAIirC,GAAU3rC,MAAM,IAMjFgsC,gBALY5/B,GAAOlC,GAAQF,QAAQ0N,GAAM,oBAAoBhX,IAAIirC,GAAU3rC,MAAM,MAsGjFisC,GAAe,SAAUC,EAAYC,EAAYC,EAAUthB,EAAQpT,GACrE,IAAI20B,EAAgB,GASpB,OARApB,GAAStqC,KAAKurC,EAAWhX,MAAM,KAAM,SAAUxyB,GACzCooB,EAAOqgB,UAAUmB,UAAU50B,EAAKy0B,EAAazpC,KAC/C2pC,EAAcD,GAAY1pC,KAGzB2pC,EAAcD,KACjBC,EAAcD,GAAY,IAErBC,GAELE,GAAgB/tC,EAAMytC,GAAc,qBACpCO,GAAgBhuC,EAAMytC,GAAc,qBAkGpCQ,GA/OiB,SAAUC,EAAWC,EAAcC,GACtD,IAAIC,EAAc,SAAUxnC,EAAQf,GAclC,OAbAA,EAASA,GAAU,GACnB2mC,GAAStqC,KAAK0E,EAAQ,SAAUgV,GAC9B,IAAIyyB,EAAW,CAAE/hC,KAAMsP,EAAKtP,MAAQsP,EAAK0yB,OACrC1yB,EAAK2yB,KACPF,EAASE,KAAOH,EAAYxyB,EAAK2yB,OAEjCF,EAASvvC,MAAQ8c,EAAK9c,MAClBovC,GACFA,EAAaG,IAGjBxoC,EAAOf,KAAKupC,KAEPxoC,GAET,OAAOuoC,EAAYH,EAAWE,GAAc,KA8N1CH,GA7MkB,SAAUnI,GAC9B,IAAI2I,EAAW3I,EAAK,GAChB4I,EAAiB5I,EAAKnhC,MAAM,GAC5BoD,EAAS/B,EAAKyoC,GAalB,OAZAtsC,EAAKusC,EAAgB,SAAUC,GAC7BxsC,EAAK4F,EAAQ,SAAUtB,GACrBP,EAAOyoC,EAAO,SAAUC,EAAWC,GACjC,IAAIC,EAAkBL,EAAShoC,GACP,KAApBqoC,GAA0BroC,IAAQooC,GAChCC,IAAoBF,IACtBH,EAAShoC,GAAO,UAMnBgoC,GA6LLR,GA3LiB,SAAUc,GAC7B,IAAIC,EAAc,CAChB,CACE9qC,KAAM,cACNN,KAAM,YACN2D,MAAO,eACPonC,MAAO,CACL,CACEpiC,KAAM,YACNxN,MAAO,IAET,CACEwN,KAAM,QACNxN,MAAO,SAET,CACEwN,KAAM,SACNxN,MAAO,UAET,CACEwN,KAAM,SACNxN,MAAO,UAET,CACEwN,KAAM,SACNxN,MAAO,UAET,CACEwN,KAAM,SACNxN,MAAO,UAET,CACEwN,KAAM,QACNxN,MAAO,SAET,CACEwN,KAAM,QACNxN,MAAO,SAET,CACEwN,KAAM,SACNxN,MAAO,UAET,CACEwN,KAAM,OACNxN,MAAO,QAET,CACEwN,KAAM,SACNxN,MAAO,YAIb,CACEmF,KAAM,cACNN,KAAM,aACN2D,MAAO,gBAET,CACErD,KAAM,kBACNN,KAAM,aACN2D,MAAO,qBASX,MAAO,CACLgnC,MAAO,WACPrqC,KAAM,WACNyqC,MAJyB,SAAfI,EAAwB,CALlB,CAChB7qC,KAAM,cACNN,KAAM,QACN2D,MAAO,iBAEyClH,OAAO2uC,GAAeA,IAsHtEf,GA1C8B,SAAU3hB,EAAQpT,EAAK+1B,GACvD,IAOI3lC,EAAMgjB,EAAOhjB,IAUjB,OATW+E,GAASA,GAAS,CAC3BwiB,MAAOvnB,EAAIyjC,SAAS7zB,EAAK,UAAY5P,EAAI4lC,UAAUh2B,EAAK,SACxDuV,OAAQnlB,EAAIyjC,SAAS7zB,EAAK,WAAa5P,EAAI4lC,UAAUh2B,EAAK,UAC1Di2B,YAAa7lC,EAAIyjC,SAAS7zB,EAAK,mBAAqB5P,EAAI4lC,UAAUh2B,EAAK,eACvEk2B,YAAa9lC,EAAI4lC,UAAUh2B,EAAK,gBAAkBwzB,GAA6BpgB,EAAOhjB,IAAK4P,EAAK,WAChGoxB,OAbc,SAAUhhC,EAAK4P,GAC7B,IAAIm2B,EAAiBzhC,GAAOlC,GAAQF,QAAQ0N,GAAM,gBAClD,OAAI4xB,GAAmBxe,IAAW+iB,EAAe9tC,SACxC8tC,EAAe7tC,MAAM,IAEvB8H,EAAI4lC,UAAUh2B,EAAK,WAAawzB,GAA6BpgB,EAAOhjB,IAAK4P,EAAK,iBAAmBwzB,GAA6BpgB,EAAOhjB,IAAK4P,EAAK,UAQ9Io2B,CAAUhmC,EAAK4P,GACvBq2B,UAAWjmC,EAAI2jC,OAAO,UAAW/zB,GAAK,GACtCs2B,MAAOlmC,EAAI4lC,UAAUh2B,EAAK,QAAS,KAClC60B,GAAc,QAAS,QAASzhB,EAAQpT,IAAO+1B,EAAiB/B,GAAsB5jC,EAAK4P,GAAO,KAyBnG+0B,GAtB4B,SAAU3hB,EAAQpT,EAAK0xB,GACrD,IAAIthC,EAAMgjB,EAAOhjB,IAQjB,OAPW+E,GAASA,GAAS,CAC3BogB,OAAQnlB,EAAIyjC,SAAS7zB,EAAK,WAAa5P,EAAI4lC,UAAUh2B,EAAK,UAC1DrN,MAAOvC,EAAI4lC,UAAUh2B,EAAK,SAC1Bs2B,MAAOlmC,EAAI4lC,UAAUh2B,EAAK,QAAS,IACnCu2B,MAAO,GACP7rC,KAAMsV,EAAInM,WAAWxD,SAASC,eAC7BukC,GAAc,QAAS,QAASzhB,EAAQpT,IAAO0xB,EAAoBsC,GAAsB5jC,EAAK4P,GAAO,KActG+0B,GAX6B,SAAU3hB,EAAQpT,EAAKyxB,GACtD,IAAIrhC,EAAMgjB,EAAOhjB,IAQjB,OAPW+E,GAASA,GAASA,GAAS,CACpCwiB,MAAOvnB,EAAIyjC,SAAS7zB,EAAK,UAAY5P,EAAI4lC,UAAUh2B,EAAK,SACxDuV,OAAQnlB,EAAIyjC,SAAS7zB,EAAK,WAAa5P,EAAI4lC,UAAUh2B,EAAK,UAC1DrN,MAAOvC,EAAI4lC,UAAUh2B,EAAK,SAC1Bw2B,SAAUx2B,EAAI3P,SAASC,cACvBgmC,MAAOlmC,EAAI4lC,UAAUh2B,EAAK,QAAS,KAClC60B,GAAc,QAAS,SAAUzhB,EAAQpT,IAAO80B,GAAc,SAAU,SAAU1hB,EAAQpT,IAAOyxB,EAAqBuC,GAAsB5jC,EAAK4P,GAAO,KAGzJ+0B,GAjG0B,SAAU3hB,EAAQ2iB,GAC9C,IAuCMU,EAKAC,EAlBAC,EA1BFzkC,EAAQq/B,GAAiBne,GACzBniB,EAAQogC,GAAqBje,GAmC7BhjB,EAAMgjB,EAAOhjB,IACbwmC,EAAWb,EAnCgB,SAAU3lC,GACvC,IAAI6jC,EAAW,SAAUpuC,GACvB,OAAOkM,GAAWlM,EAAO,OAASuK,EAAI8jC,MAAMruC,GAASA,GAEnDgxC,EAAc/wC,EAAIoM,EAAO,gBAAgB5J,MAAM,IAC/CwuC,EAAchxC,EAAIoM,EAAO,gBAAgB5J,MAAM,IAC/CyuC,EAAUjxC,EAAIoM,EAAO,oBAAoB5J,MAAM,IACnD,MAAO,CACL8rC,YAAayC,EACbxC,YAAaJ,EAAS6C,GACtBxC,gBAAiBL,EAAS8C,IAyBEC,CAAyB5mC,GAAO,GAehE,OADW+E,GAASA,GAASA,GAASA,GAASA,GAASA,GAAS,GApC/C,CAChBogB,OAAQ,GACRoC,MAAO,OACPse,YAAa,GACbC,YAAa,GACbG,SAAS,EACTC,MAAO,GACPC,MAAO,GACPnF,OAAQ,KA4ByEl/B,GAAQjB,GAAQ2lC,IAzB7FD,EAAczkC,EAAM,gBACpB0/B,GAAmBxe,IAAWujB,EACzB,CAAEvF,OAAQuF,GAEZ7wC,EAAImL,EAAO,UAAU/I,KAAK,WAC/B,MAAO,IACN,SAAUkpC,GACX,MAAO,CAAEA,OAAQA,QAMfqF,EAAU3wC,EAAIoM,EAAO,kBAAkBpJ,GAAGhD,EAAImL,EAAO,gBAAgB/I,KAAK,WAC5E,MAAO,IACN,SAAU+tC,GACX,MAAO,CAAEA,YAAaA,KAEpBS,EAAU5wC,EAAIoM,EAAO,kBAAkBpJ,GAAGhD,EAAImL,EAAO,gBAAgB/I,KAAK,WAC5E,MAAO,IACN,SAAUguC,GACX,MAAO,CAAEA,YAAaA,KAEjB/gC,GAASA,GAAS,GAAIshC,GAAUC,MAgFvCO,GAAa,CACf,CACEjsC,KAAM,QACNN,KAAM,QACN2D,MAAO,SAET,CACErD,KAAM,SACNN,KAAM,QACN2D,MAAO,UAET,CACErD,KAAM,WACNN,KAAM,YACN2D,MAAO,YACPonC,MAAO,CACL,CACEpiC,KAAM,OACNxN,MAAO,MAET,CACEwN,KAAM,cACNxN,MAAO,QAIb,CACEmF,KAAM,QACNN,KAAM,YACN2D,MAAO,QACPonC,MAAO,CACL,CACEpiC,KAAM,OACNxN,MAAO,IAET,CACEwN,KAAM,MACNxN,MAAO,OAET,CACEwN,KAAM,SACNxN,MAAO,OAET,CACEwN,KAAM,YACNxN,MAAO,YAET,CACEwN,KAAM,eACNxN,MAAO,cAIb,CACEmF,KAAM,SACNN,KAAM,YACN2D,MAAO,UACPonC,MAAO,CACL,CACEpiC,KAAM,OACNxN,MAAO,IAET,CACEwN,KAAM,OACNxN,MAAO,QAET,CACEwN,KAAM,SACNxN,MAAO,UAET,CACEwN,KAAM,QACNxN,MAAO,WAIb,CACEmF,KAAM,SACNN,KAAM,YACN2D,MAAO,UACPonC,MAAO,CACL,CACEpiC,KAAM,OACNxN,MAAO,IAET,CACEwN,KAAM,MACNxN,MAAO,OAET,CACEwN,KAAM,SACNxN,MAAO,UAET,CACEwN,KAAM,SACNxN,MAAO,aAYXqxC,GAPW,SAAU9jB,GACvB,OA3HiB,SAAUA,GAC3B,IAAI+jB,EAvbiB,SAAU/jB,GAC/B,OAAOA,EAAOke,SAAS,wBAAyB,GAAI,SAsbjC8F,CAAiBhkB,GAChCikB,EAAUtC,GAAuBoC,EAAc,SAAUx0B,GACvDA,EAAK9c,QACP8c,EAAK20B,UAAY,WACf,OAAOlkB,EAAOqgB,UAAU8D,WAAW,CACjCC,MAAO,KACPH,QAAS,CAAC10B,EAAK9c,aAKvB,OAAIsxC,EAAa1wC,OAAS,EACjByD,EAAON,KAAK,CACjBoB,KAAM,QACNN,KAAM,YACN2D,MAAO,QACPonC,MAAO4B,IAGJntC,EAAO1C,OAuGPiwC,CAAarkB,GAAQlrB,KAAK,WAC/B,OAAO+uC,IACN,SAAUS,GACX,OAAOT,GAAW9vC,OAAOuwC,MAiCzBC,GAAc,CAChBC,OA7BW,SAAUxnC,EAAKmC,GAO1B,MAAO,CACLslC,UAPc,SAAUpmC,EAAM5L,GAC9BuK,EAAIynC,UAAUtlC,EAAMd,EAAM5L,IAO1BiyC,SALa,SAAUC,EAAMlyC,GAC7BuK,EAAI0nC,SAASvlC,EAAMwlC,EAAMlyC,MAyB3BmyC,SAlBa,SAAU5nC,EAAKmC,GAW5B,MAAO,CACLslC,UAXc,SAAUpmC,EAAM5L,GAC1BA,GACFuK,EAAIynC,UAAUtlC,EAAMd,EAAM5L,IAU5BiyC,SAPa,SAAUC,EAAMlyC,GACzBA,GACFuK,EAAI0nC,SAASvlC,EAAMwlC,EAAMlyC,OAa3BoyC,GAAoB,SAAUC,EAAWtL,GAC3CsL,EAAUL,UAAU,QAASjL,EAAKj6B,OAClCulC,EAAUL,UAAU,QAASjL,EAAK0J,OAClC4B,EAAUJ,SAAS,QAASpH,GAAc9D,EAAKjV,QAC/CugB,EAAUJ,SAAS,SAAUpH,GAAc9D,EAAKrX,UAE9C4iB,GAAsB,SAAUD,EAAWtL,GAC7CsL,EAAUJ,SAAS,mBAAoBlL,EAAK0H,iBAC5C4D,EAAUJ,SAAS,eAAgBlL,EAAKyH,aACxC6D,EAAUJ,SAAS,eAAgBlL,EAAKwH,aACxC8D,EAAUJ,SAAS,eAAgBpH,GAAc9D,EAAKuH,eAEpDiE,GAAgB,SAAUhlB,EAAQ5S,EAAOosB,GAC3C,IAAIx8B,EAAMgjB,EAAOhjB,IACbioC,EAAUzL,EAAK4J,UAAYh2B,EAAM,GAAGnQ,SAASC,gBAAkBs8B,EAAK4J,SAAWpmC,EAAIkoC,OAAO93B,EAAM,GAAIosB,EAAK4J,UAAYh2B,EAAM,GAC3H03B,EAAYP,GAAYC,OAAOxnC,EAAKioC,GACxCJ,GAAkBC,EAAWtL,GACzB6E,GAAmBre,IACrB+kB,GAAoBD,EAAWtL,GAEjC4G,GAAsBpgB,EAAQilB,GAC9B7E,GAAuBpgB,EAAQilB,GAC3BzL,EAAK2L,QACP/E,GAAoBpgB,EAAQilB,EAASzL,EAAK2L,QAExC3L,EAAK4L,QACPhF,GAAqBpgB,EAAQilB,EAASzL,EAAK4L,SAG3CC,GAAkB,SAAUrlB,EAAQ5S,EAAOosB,GAC7C,IAAIx8B,EAAMgjB,EAAOhjB,IACjBmjC,GAAStqC,KAAKuX,EAAO,SAAU63B,GACzBzL,EAAK4J,UAAY6B,EAAQhoC,SAASC,gBAAkBs8B,EAAK4J,WAC3D6B,EAAUjoC,EAAIkoC,OAAOD,EAASzL,EAAK4J,WAErC,IAAI0B,EAAYP,GAAYK,SAAS5nC,EAAKioC,GAC1CJ,GAAkBC,EAAWtL,GACzB6E,GAAmBre,IACrB+kB,GAAoBD,EAAWtL,GAE7BA,EAAK2L,QACP/E,GAAoBpgB,EAAQilB,EAASzL,EAAK2L,QAExC3L,EAAK4L,QACPhF,GAAqBpgB,EAAQilB,EAASzL,EAAK4L,WAI7CE,GAAmB,SAAUtlB,EAAQ5S,EAAOkE,GAC9C,IAAIkoB,EAAOloB,EAAIi0B,UACfj0B,EAAIk0B,QACJxlB,EAAOylB,YAAYC,SAAS,YACQ,IAAjBt4B,EAAM/Z,OAAe2xC,GAAgBK,IAC3CrlB,EAAQ5S,EAAOosB,GAC1BxZ,EAAOqB,WA0DPskB,GAvDO,SAAU3lB,GACnB,IAAIilB,EAAS73B,EAAQ,GAOrB,GANAA,EAAQ4S,EAAOhjB,IAAI2jC,OAAO,+CAC1BsE,EAAUjlB,EAAOhjB,IAAI6jB,UAAUb,EAAOf,UAAU6B,WAAY,UACvD1T,EAAM/Z,QAAU4xC,GACnB73B,EAAM3U,KAAKwsC,GAEbA,EAAUA,GAAW73B,EAAM,GAC3B,CAGA,IAAIw4B,EAAYzF,GAASvqC,IAAIwX,EAAO,SAAU63B,GAC5C,OAAOtD,GAAmC3hB,EAAQilB,EAAS5G,GAAmBre,MAE5EwZ,EAAOmI,GAAwBiE,GAC/BC,EAAiB,CACnBvuC,KAAM,WACNwuC,KAAM,CACJ,CACE7D,MAAO,UACPrqC,KAAM,UACNyqC,MAAOyB,GAA8B9jB,IAEvC2hB,GAAuB,UAGvBoE,EAAc,CAChBzuC,KAAM,QACN+qC,MAAO,CAAC,CACJ/qC,KAAM,OACNiZ,QAAS,EACT8xB,MAAOyB,GAA8B9jB,MAG3CA,EAAOgmB,cAAcC,KAAK,CACxBhE,MAAO,kBACPzM,KAAM,SACN70B,KAAM09B,GAAmBre,GAAU6lB,EAAiBE,EACpDG,QAAS,CACP,CACE5uC,KAAM,SACNM,KAAM,SACNqI,KAAM,UAER,CACE3I,KAAM,SACNM,KAAM,OACNqI,KAAM,OACNkmC,SAAS,IAGbC,YAAa5M,EACb6M,SAAU3yC,EAAM4xC,GAAkBtlB,EAAQ5S,OA2B1Ck5B,GAAe,CACjB,CACEhvC,KAAM,YACNM,KAAM,OACNqD,MAAO,WACPonC,MAAO,CACL,CACEpiC,KAAM,SACNxN,MAAO,SAET,CACEwN,KAAM,OACNxN,MAAO,SAET,CACEwN,KAAM,SACNxN,MAAO,WAIb,CACE6E,KAAM,YACNM,KAAM,QACNqD,MAAO,YACPonC,MAAO,CACL,CACEpiC,KAAM,OACNxN,MAAO,IAET,CACEwN,KAAM,OACNxN,MAAO,QAET,CACEwN,KAAM,SACNxN,MAAO,UAET,CACEwN,KAAM,QACNxN,MAAO,WAIb,CACEwI,MAAO,SACPrD,KAAM,SACNN,KAAM,UAUNivC,GAPa,SAAUvmB,GACzB,OAxEmB,SAAUA,GAC7B,IAAI+jB,EA1sBgB,SAAU/jB,GAC9B,OAAOA,EAAOke,SAAS,uBAAwB,GAAI,SAysBhCsI,CAAgBxmB,GAC/BikB,EAAUtC,GAAuBoC,EAAc,SAAUx0B,GACvDA,EAAK9c,QACP8c,EAAK20B,UAAY,WACf,OAAOlkB,EAAOqgB,UAAU8D,WAAW,CACjCC,MAAO,KACPH,QAAS,CAAC10B,EAAK9c,aAKvB,OAAIsxC,EAAa1wC,OAAS,EACjByD,EAAON,KAAK,CACjBoB,KAAM,QACNN,KAAM,YACN2D,MAAO,QACPonC,MAAO4B,IAGJntC,EAAO1C,OAoDPqyC,CAAezmB,GAAQlrB,KAAK,WACjC,OAAOwxC,IACN,SAAUrC,GACX,OAAOqC,GAAavyC,OAAOkwC,MA+B3ByC,GAAkB,SAAU1mB,EAAQzS,EAAMo5B,EAASr1B,GACrD,IAAItU,EAAMgjB,EAAOhjB,IACbw8B,EAAOloB,EAAIi0B,UACfj0B,EAAIk0B,QACJ,IAAIoB,EAAiC,IAAhBr5B,EAAKla,OAAekxC,GAAYC,OAASD,GAAYK,SAC1E5kB,EAAOylB,YAAYC,SAAS,WAC1BvF,GAAStqC,KAAK0X,EAAM,SAAUs5B,GACxBrN,EAAKliC,OAASuvC,EAAOpmC,WAAWxD,SAASC,eAjC/B,SAAUF,EAAK6pC,EAAQC,GACzC,IAAIC,EAAW/pC,EAAI6jB,UAAUgmB,EAAQ,SACjCG,EAAeH,EAAOpmC,WACtBwmC,EAAYjqC,EAAI2jC,OAAOmG,EAAQC,GAAU,GACxCE,IACHA,EAAYjqC,EAAIwa,OAAOsvB,GACnBC,EAASr9B,WAC0B,YAAjCq9B,EAASr9B,WAAWzM,SACtBD,EAAIkqC,YAAYD,EAAWF,EAASr9B,YAEpCq9B,EAASz9B,aAAa29B,EAAWF,EAASr9B,YAG5Cq9B,EAASp9B,YAAYs9B,IAGzBA,EAAUt9B,YAAYk9B,GACjBG,EAAapnC,iBAChB5C,EAAIkB,OAAO8oC,GAgBPG,CAAcnnB,EAAOhjB,IAAK6pC,EAAQrN,EAAKliC,MAEzC,IAAI8vC,EAAWR,EAAe5pC,EAAK6pC,GACnCO,EAAS3C,UAAU,QAASjL,EAAKj6B,OACjC6nC,EAAS3C,UAAU,QAASjL,EAAK0J,OACjCkE,EAAS1C,SAAS,SAAUpH,GAAc9D,EAAKrX,SAC3Cmc,GAAkBte,IAnBA,SAAUonB,EAAU5N,GAC9C4N,EAAS1C,SAAS,mBAAoBlL,EAAK0H,iBAC3CkG,EAAS1C,SAAS,eAAgBlL,EAAKyH,aACvCmG,EAAS1C,SAAS,eAAgBlL,EAAKwH,aAiBjCqG,CAAsBD,EAAU5N,GAE9BA,EAAK2J,QAAUwD,EAAQxD,QACzB/C,GAAsBpgB,EAAQ6mB,GAC9BzG,GAAoBpgB,EAAQ6mB,EAAQrN,EAAK2J,UAG7CnjB,EAAOqB,WAoEPimB,GAjES,SAAUtnB,GACrB,IACI+mB,EAAU9B,EADVjoC,EAAMgjB,EAAOhjB,IAEbuQ,EAAO,GAEX,IADAw5B,EAAW/pC,EAAI6jB,UAAUb,EAAOf,UAAU6B,WAAY,YAItDmkB,EAAUjoC,EAAI6jB,UAAUb,EAAOf,UAAU6B,WAAY,SACrDqf,GAAStqC,KAAKkxC,EAASx5B,KAAM,SAAUD,GACrC6yB,GAAStqC,KAAKyX,EAAIF,MAAO,SAAUF,GACjC,IAAKlQ,EAAI4lC,UAAU11B,EAAM,sBAAwBA,IAAS+3B,IAAY13B,EAAKhV,QAAQ+U,GAAO,EAExF,OADAC,EAAK9U,KAAK6U,IACH,MAIJC,EAAK,IACd,CAGA,IAAIg6B,EAAWpH,GAASvqC,IAAI2X,EAAM,SAAUs5B,GAC1C,OAAOlF,GAAkC3hB,EAAQ6mB,EAAQvI,GAAkBte,MAEzEwZ,EAAOmI,GAAwB4F,GAC/B1B,EAAiB,CACnBvuC,KAAM,WACNwuC,KAAM,CACJ,CACE7D,MAAO,UACPrqC,KAAM,UACNyqC,MAAOkE,GAA6BvmB,IAEtC2hB,GAAuB,SAGvBoE,EAAc,CAChBzuC,KAAM,QACN+qC,MAAO,CAAC,CACJ/qC,KAAM,OACNiZ,QAAS,EACT8xB,MAAOkE,GAA6BvmB,MAG1CA,EAAOgmB,cAAcC,KAAK,CACxBhE,MAAO,iBACPzM,KAAM,SACN70B,KAAM29B,GAAkBte,GAAU6lB,EAAiBE,EACnDG,QAAS,CACP,CACE5uC,KAAM,SACNM,KAAM,SACNqI,KAAM,UAER,CACE3I,KAAM,SACNM,KAAM,OACNqI,KAAM,OACNkmC,SAAS,IAGbC,YAAa5M,EACb6M,SAAU3yC,EAAMgzC,GAAiB1mB,EAAQzS,EAAMisB,OAK/CgO,GAAmBlxC,OAAOmB,UAAUkC,eAyBpC8tC,IArBsB5e,GAHV,SAAU6e,EAAKtlC,GAC7B,OAAOA,GAGA,WAEL,IADA,IAAIulC,EAAU,IAAInwC,MAAMpE,UAAUC,QACzByF,EAAI,EAAGA,EAAI6uC,EAAQt0C,OAAQyF,IAClC6uC,EAAQ7uC,GAAK1F,UAAU0F,GAEzB,GAAuB,IAAnB6uC,EAAQt0C,OACV,MAAM,IAAIiC,MAAM,4BAGlB,IADA,IAAIqT,EAAM,GACDoG,EAAI,EAAGA,EAAI44B,EAAQt0C,OAAQ0b,IAAK,CACvC,IAAI64B,EAAYD,EAAQ54B,GACxB,IAAK,IAAI5U,KAAOytC,EACVJ,GAAiB/yC,KAAKmzC,EAAWztC,KACnCwO,EAAIxO,GAAO0uB,GAAOlgB,EAAIxO,GAAMytC,EAAUztC,KAI5C,OAAOwO,IAKPk/B,GAAW5wC,QAAQC,KAAKC,MAAMC,QAAQ,eAEtC0wC,GAAuB,CACzB7wB,OAAQ,CACN6mB,kBAAmB,WACnBvZ,MAAS,QAEXnmB,WAAY,CAAE4/B,OAAQ,KACtB+J,aAAa,GAiBXC,GAAW,SAAUz6B,EAAMgD,EAAS03B,EAAYC,EAAeC,QAC9C,IAAfA,IACFA,EAAaL,IAEf,IAAIz6B,EAlBGjO,GAAQU,QAAQ,SAmBvBmB,GAASoM,EAAO86B,EAAWlxB,QAC3BrZ,GAAOyP,EAAO86B,EAAW/pC,YACzB,IAAIgqC,EAlBGhpC,GAAQU,QAAQ,SAmBvB0J,GAAO6D,EAAO+6B,GAEd,IADA,IAAIC,EAAM,GACDvvC,EAAI,EAAGA,EAAIyU,EAAMzU,IAAK,CAE7B,IADA,IAAI8wB,EAnBCxqB,GAAQU,QAAQ,MAoBZiP,EAAI,EAAGA,EAAIwB,EAASxB,IAAK,CAChC,IAAIiB,EAAKlX,EAAImvC,GAAcl5B,EAAIm5B,EAlB5B9oC,GAAQU,QAAQ,MAGhBV,GAAQU,QAAQ,MAgBfiP,EAAIm5B,GACNv1C,GAAIqd,EAAI,QAAS,OAEflX,EAAImvC,GACNt1C,GAAIqd,EAAI,QAAS,OAEnBxG,GAAOwG,EAAI5Q,GAAQU,QAAQ,OACvBqoC,EAAWJ,aACb/mC,GAAMgP,EAAI,QAAS,IAAMO,EAAU,KAErC/G,GAAOogB,EAAI5Z,GAEbq4B,EAAI5vC,KAAKmxB,GAGX,OADA3f,GAASm+B,EAAOC,GACTh7B,GAaLi7B,GAAmB,SAAUtoB,EAAQ9S,GACvC8S,EAAOf,UAAU0hB,OAAOzzB,EAAKlQ,OAAO,GACpCgjB,EAAOf,UAAUspB,UAAS,IAqCxBC,GArBW,SAAUxoB,EAAQzP,EAAShD,GACxC,IAJ2BgX,EAIvBsZ,EAAgBM,GAAiBne,GACjCyoB,EAAU,CACZxxB,OAAQ4mB,EACRz/B,WAAY6/B,GAAqBje,GACjC+nB,aARyBxjB,EAQCsZ,EAActZ,MAPnCxsB,EAASwsB,KAAkC,IAAxBA,EAAMhsB,QAAQ,OAOammC,GAAe1e,KAEhE3S,EAAQ26B,GAASz6B,EAAMgD,EAAS,EAAG,EAAGk4B,GAC1C91C,GAAI0a,EAAO,cAAe,SAC1B,IAlCyBtQ,EACrB0e,EACA5oB,EAgCAyM,GAlCqBvC,EAkCHsQ,EAjClBoO,EAAYrc,GAAQU,QAAQ,OAC5BjN,EAAQuM,GAAQF,QAAQnC,EAAQC,MAAMyV,WAAU,IACpDjJ,GAAOiS,EAAW5oB,GANR,SAAUkK,GACpB,OAAOA,EAAQC,MAAM2C,UAMd+oC,CAAMjtB,IAgCb,OADAuE,EAAO2oB,cAAcrpC,GACd6M,GAAagxB,GAAUnd,GAAS,8BAA8BpqB,IAAI,SAAUyX,GAOjF,OANIqxB,GAAe1e,IACjBhf,GAAMqM,EAAO,QAASlM,GAAMkM,EAAO,UAErCnP,GAAOmP,EAAO,eA1BD,SAAU2S,EAAQ3S,GACjCxX,EAAK6V,GAAc2B,EAAO,MAAO,SAAUC,GACzCuxB,GAAW7e,EAAQ1S,EAAItQ,OACvBnH,EAAK6V,GAAc4B,EAAK,SAAU,SAAUJ,GAC1C6xB,GAAY/e,EAAQ9S,EAAKlQ,WAuB3B4rC,CAAW5oB,EAAQ3S,GA9BM,SAAU2S,EAAQ+mB,GAC7C56B,GAAa46B,EAAU,SAASlxC,KAAKnC,EAAM40C,GAAkBtoB,IA8B3D6oB,CAAuB7oB,EAAQ3S,GACxBA,EAAMrQ,QACZ9H,MAAM,OAmGP4zC,GA/Fa,SAAU9oB,EAAQ+oB,EAAYC,GAC7C,IAAIC,EAAoBD,EAAsB,CAC5C,CACE1xC,KAAM,QACNM,KAAM,OACNqD,MAAO,OACPiuC,UAAW,WAEb,CACE5xC,KAAM,QACNM,KAAM,OACNqD,MAAO,OACPiuC,UAAW,YAX0B,GA0BrCC,EA7jCqB,SAAUnpB,GACnC,OAAOA,EAAOke,SAAS,4BAA4B,EAAM,WA4jCnCkL,CAAqBppB,GAAU,CACnD,CACE1oB,KAAM,QACNM,KAAM,cACNqD,MAAO,eACPiuC,UAAW,WAEb,CACE5xC,KAAM,QACNM,KAAM,cACNqD,MAAO,eACPiuC,UAAW,WAEb,CACE5xC,KAAM,QACNM,KAAM,SACNqD,MAAO,gBAET,CACE3D,KAAM,QACN2D,MAAO,UACPonC,MAAO,CAAC,CACJ/qC,KAAM,WACNM,KAAM,UACNqD,MAAO,mBAGX,GAwBAouC,EAAgBN,EAAa,CAAC,CAC9BzxC,KAAM,YACNM,KAAM,QACNqD,MAAO,QACPonC,MAAOV,GAAuBlD,GAAkBze,GAAS,SAAUzQ,GAC7DA,EAAK9c,QACP8c,EAAK20B,UAAY,WACf,OAAOlkB,EAAOqgB,UAAU8D,WAAW,CACjCC,MAAO,QACPH,QAAS,CAAC10B,EAAK9c,eAKpB,GACP,OAAOw2C,EAAiBl1C,OA9EN,CAChB,CACEuD,KAAM,QACNM,KAAM,QACNqD,MAAO,SAET,CACE3D,KAAM,QACNM,KAAM,SACNqD,MAAO,YAqEiClH,OAAOo1C,GAAiBp1C,OAtChD,CAAC,CACjBuD,KAAM,YACNM,KAAM,QACNqD,MAAO,YACPonC,MAAO,CACL,CACEpiC,KAAM,OACNxN,MAAO,IAET,CACEwN,KAAM,OACNxN,MAAO,QAET,CACEwN,KAAM,SACNxN,MAAO,UAET,CACEwN,KAAM,QACNxN,MAAO,aAmB2EsB,OAAOs1C,IAI/FC,GAAY,SAAUtsC,EAAK4P,EAAKhV,EAAMnF,GACxC,GAAoB,OAAhBma,EAAIotB,SAAoC,OAAhBptB,EAAIotB,QAC1BjiC,EAASH,GACXoF,EAAI0nC,SAAS93B,EAAKhV,EAAMnF,GAExBuK,EAAI0nC,SAAS93B,EAAKhV,QAGpB,GAAIgV,EAAI5D,SACN,IAAK,IAAIlQ,EAAI,EAAGA,EAAI8T,EAAI5D,SAAS3V,OAAQyF,IACvCwwC,GAAUtsC,EAAK4P,EAAI5D,SAASlQ,GAAIlB,EAAMnF,IA2C1C82C,GAAoB,SAAUvpB,EAAQ+mB,EAAUz1B,GAClD,IACIk4B,EADAxsC,EAAMgjB,EAAOhjB,IAEbw8B,EAAOloB,EAAIi0B,UACfj0B,EAAIk0B,QACe,KAAfhM,EAAK0J,cACA1J,EAAK0J,MAEdljB,EAAOylB,YAAYC,SAAS,WAC1B,IAAKqB,EAAU,CACb,IAAIn5B,EAAOZ,SAASwsB,EAAK5rB,KAAM,KAAO,EAClCL,EAAOP,SAASwsB,EAAKjsB,KAAM,KAAO,EACtCw5B,EAAWyB,GAAmBxoB,EAAQpS,EAAML,IAlDzB,SAAUyS,EAAQ+mB,EAAUvN,GACnD,IA3sC6BhE,EA2sCzBx4B,EAAMgjB,EAAOhjB,IACba,EAAQ,GACRoZ,EAAS,GAgBb,GAfApZ,EAAMqlC,MAAQ1J,EAAK0J,MACnBjsB,EAAOkL,OAASmb,GAAc9D,EAAKrX,QAC/BnlB,EAAI4lC,UAAUmE,EAAU,WAAavI,GAAmBxe,GAC1DniB,EAAM0mB,OAjtCqBiR,EAitCEgE,EAAKjV,OAhtCtBiR,EAAK7zB,QAAQ,MAAO,IAAM,GAktCtCsV,EAAOsN,MAAQ+Y,GAAc9D,EAAKjV,OAEhCia,GAAmBxe,IACrB/I,EAAO,gBAAkBqmB,GAAc9D,EAAKwE,QAC5C/mB,EAAO,kBAAoBqmB,GAAc9D,EAAKqJ,eAE9ChlC,EAAMmgC,OAASxE,EAAKwE,OACpBngC,EAAMilC,YAActJ,EAAKsJ,YACzBjlC,EAAMglC,YAAcrJ,EAAKqJ,aAEvBrE,GAAmBxe,IAAW+mB,EAAS/9B,SACzC,IAAK,IAAIlQ,EAAI,EAAGA,EAAIiuC,EAAS/9B,SAAS3V,OAAQyF,IAC5CwwC,GAAUtsC,EAAK+pC,EAAS/9B,SAASlQ,GAAI,CACnC2wC,eAAgBnM,GAAc9D,EAAKwE,QACnCsF,QAAWhG,GAAc9D,EAAKsJ,eAE5BvE,GAAoBve,IACtBspB,GAAUtsC,EAAK+pC,EAAS/9B,SAASlQ,GAAI,CAAE4wC,eAAgBlQ,EAAKyH,cAI9D1C,GAAoBve,KACtB/I,EAAO,oBAAsBuiB,EAAK0H,gBAClCjqB,EAAO,gBAAkBuiB,EAAKyH,YAC9BhqB,EAAO,gBAAkBuiB,EAAKwH,aAEhCnjC,EAAMiB,MAAQ9B,EAAI2sC,eAAelC,GAAQtJ,GAAiBne,GAAS/I,IACnEja,EAAI4sC,WAAW7C,EAAUU,GAAQxJ,GAAqBje,GAASniB,IAgB7DgsC,CAAmB7pB,EAAQ+mB,EAAUvN,IACrCgQ,EAAaxsC,EAAI2jC,OAAO,UAAWoG,GAAU,MAC1BvN,EAAKyJ,SACtBjmC,EAAIkB,OAAOsrC,IAERA,GAAchQ,EAAKyJ,WACtBuG,EAAaxsC,EAAIwa,OAAO,YACb7X,UAAakoC,GAAS7jC,GAAkC,IAA7B,2BACtC+iC,EAASz9B,aAAakgC,EAAYzC,EAASr9B,aAE1B,KAAf8vB,EAAK2J,MACP/C,GAAsBpgB,EAAQ+mB,GAE9B3G,GAAoBpgB,EAAQ+mB,EAAUvN,EAAK2J,OAE7CnjB,EAAOqB,QACPrB,EAAO8pB,eA+EPC,GA5ES,SAAU/pB,EAAQgpB,GAC7B,IACIjC,EADA/pC,EAAMgjB,EAAOhjB,IAEbw8B,EAAOmI,GAAgC3hB,EAAQue,GAAoBve,KAChD,IAAnBgpB,GACFjC,EAAW/pC,EAAI6jB,UAAUb,EAAOf,UAAU6B,WAAY,UAEpD0Y,EAAOmI,GAAoC3hB,EAAQ+mB,EAAUxI,GAAoBve,IAE7Eue,GAAoBve,KACtBwZ,EAAKwH,YAAc,GACnBxH,EAAKyH,YAAc,GACnBzH,EAAK0H,gBAAkB,KAI3B1H,EAAK5rB,KAAO,IACZ4rB,EAAKjsB,KAAO,IACRgxB,GAAoBve,KACtBwZ,EAAKwH,YAAc,GACnBxH,EAAKyH,YAAc,GACnBzH,EAAK0H,gBAAkB,KAG3B,IAAI6H,EAAatK,GAAkBze,GAAQ3sB,OAAS,EAChD01C,GACEvP,EAAK0J,QACP1J,EAAK0J,MAAQ1J,EAAK0J,MAAMvhC,QAAQ,0BAA2B,KAG/D,IAAIqoC,EAAe,CACjB1yC,KAAM,OACNiZ,QAAS,EACT8xB,MAAOyG,GAA+B9oB,EAAQ+oB,EAAYC,IAqBxDiB,EAAa1L,GAAoBve,GAZ5B,CACL1oB,KAAM,WACNwuC,KAAM,CACJ,CACE7D,MAAO,UACPrqC,KAAM,UACNyqC,MAAO,CAAC2H,IAEVrI,GAAuB,WAdpB,CACLrqC,KAAM,QACN+qC,MAAO,CAAC2H,IAiBZhqB,EAAOgmB,cAAcC,KAAK,CACxBhE,MAAO,mBACPzM,KAAM,SACN70B,KAAMspC,EACN5D,SAAU3yC,EAAM61C,GAAmBvpB,EAAQ+mB,GAC3Cb,QAAS,CACP,CACE5uC,KAAM,SACNM,KAAM,SACNqI,KAAM,UAER,CACE3I,KAAM,SACNM,KAAM,OACNqI,KAAM,OACNkmC,SAAS,IAGbC,YAAa5M,KAKb0Q,GAAgC,SAAUziC,GAC5C,OAAO,SAAUuY,GACf,OAAOlpB,EAAOC,KAAKipB,EAAOhjB,IAAI6jB,UAAUb,EAAOf,UAAU6B,WAAYrZ,IAAW7R,IAAIwJ,GAAQF,WAG5FirC,GAAwBD,GAA8B,SACtDE,GAAiCF,GAA8B,iBAE/DG,GAASlK,GAAStqC,KA4IlBy0C,GAAW,CAAEC,iBA3IM,SAAUvqB,EAAQC,EAASC,EAAehB,EAAYsrB,GAC3E,IAAI/hC,EAASkT,GAAUqE,GAqBnByqB,EAAmB,SAAUv9B,GAC/B,OAAOD,GAAYI,MAAMH,EAAMzE,IAE7BiiC,EAAU,SAAUr9B,GACtB,MAAO,CACLkX,MAAO6Y,GAAgB/vB,EAAMrQ,OAC7BmlB,OAAQib,GAAgB/vB,EAAMrQ,SAU9B2tC,EAAiB,SAAUnL,GAC7B2K,GAAsBnqB,GAAQnqB,KAAK,SAAUqX,GAC3Cu9B,EAAiBv9B,GAAMrX,KAAK,SAAUwX,GACpC,IAAI4T,EAAUxB,GAAaC,QAAQR,EAAY7R,EAAOH,GAClD09B,EAAaF,EAAQr9B,GACzBmyB,EAAQnyB,EAAO4T,GAASprB,KAAK,SAAUsrB,IAZ1B,SAAUnB,EAAQ6qB,EAASx9B,GAC5C,IAAI0W,EAAU2mB,EAAQr9B,GAClBw9B,EAAQtmB,QAAUR,EAAQQ,OAASsmB,EAAQ1oB,SAAW4B,EAAQ5B,SAChE6c,GAAsBhf,EAAQ3S,EAAMrQ,MAAO6tC,EAAQtmB,MAAOsmB,EAAQ1oB,QAClE8c,GAAkBjf,EAAQ3S,EAAMrQ,MAAO+mB,EAAQQ,MAAOR,EAAQ5B,SAS1D2oB,CAAa9qB,EAAQ4qB,EAAYv9B,GACjC2S,EAAOf,UAAUmC,OAAOD,GACxBnB,EAAOqB,QACPnB,EAAcoB,MAAMjU,GACpBkwB,GAAgBlwB,UAKpB09B,EAAmB,SAAUvL,GAC/B,OAAO2K,GAAsBnqB,GAAQpqB,IAAI,SAAUsX,GACjD,OAAOu9B,EAAiBv9B,GAAMpX,KAAK,SAAUuX,GAC3C,IAAI/M,EAAMlB,GAAQF,QAAQ8gB,EAAOgB,UAC7BC,EAAUxB,GAAaC,QAAQR,EAAY7R,EAAOH,GAClD2S,EAAa1M,GAAUC,eAAetgB,EAAMwN,EAAKxJ,EAAO1C,QAC5D,OAAO2rC,GAAkB1yB,EAAO4T,EAASpB,QAI3CmrB,EAAmB,SAAUxL,GAC/BgL,EAAc93C,MAAMmD,KAAK,SAAU0X,GACjC,IAAI09B,EAAar1C,EAAI2X,EAAM,SAAUD,GACnC,OAAOqF,GAAKrF,KAEd68B,GAAsBnqB,GAAQnqB,KAAK,SAAUqX,GAC3Cu9B,EAAiBv9B,GAAMrX,KAAK,SAAUwX,GACpC,IAAI/M,EAAMlB,GAAQF,QAAQ8gB,EAAOgB,UAC7BnB,EAAa1M,GAAUoB,MAAMjU,GAC7B2gB,EAAUxB,GAAaE,UAAUT,EAAY7R,EAAOH,EAAM+9B,EAAYprB,GAC1E2f,EAAQnyB,EAAO4T,GAASprB,KAAK,SAAUsrB,GACrCnB,EAAOf,UAAUmC,OAAOD,GACxBnB,EAAOqB,QACPnB,EAAcoB,MAAMjU,YAM9Bg9B,GAAO,CACLa,mBAAoB,WAClBP,EAAe1qB,EAAQ6c,eAEzBqO,mBAAoB,WAClBR,EAAe1qB,EAAQ2c,aAEzBwO,wBAAyB,WACvBT,EAAe1qB,EAAQyb,mBAEzB2P,uBAAwB,WACtBV,EAAe1qB,EAAQ4b,kBAEzByP,wBAAyB,WACvBX,EAAe1qB,EAAQ8b,sBAEzBwP,uBAAwB,WACtBZ,EAAe1qB,EAAQgc,qBAEzBuP,kBAAmB,WACjBb,EAAe1qB,EAAQ6f,eAEzB2L,kBAAmB,WACjBd,EAAe1qB,EAAQ4f,YAEzB6L,eAAgB,SAAUjhC,GACxBsgC,IAAmBl1C,KAAK,SAAUopB,GAChCurB,EAAc73C,IAAIssB,GAClB0rB,EAAe1qB,EAAQ4f,cAG3B8L,gBAAiB,SAAUlhC,GACzBsgC,IAAmBl1C,KAAK,SAAUopB,GAChCurB,EAAc73C,IAAIssB,MAGtB2sB,uBAAwB,SAAUnhC,GAChCugC,EAAiB/qB,EAAQ+c,kBAE3B6O,sBAAuB,SAAUphC,GAC/BugC,EAAiB/qB,EAAQid,iBAE3B4O,eA1He,WACf1B,GAA+BpqB,GAAQnqB,KAAK,SAAUk2C,GACrC9+B,GAAYI,MAAM0+B,EAAetjC,GACvCxS,OAAOjC,EAAIyU,IAAS5S,KAAK,SAAUwX,GAC1C,IAAIijB,EAASlxB,GAAQY,SAAS,IAG9B,GAFAuJ,GAAM8D,EAAOijB,GACbjmB,GAASgD,GACL2S,EAAOhjB,IAAIgvC,QAAQhsB,EAAOpf,WAC5Bof,EAAOisB,WAAW,IAClBjsB,EAAOf,UAAUitB,wBACZ,CACL,IAAI/qB,EAAMnB,EAAOhjB,IAAI0iC,YACrBve,EAAIwe,SAASrP,EAAOtzB,MAAO,GAC3BmkB,EAAIye,OAAOtP,EAAOtzB,MAAO,GACzBgjB,EAAOf,UAAUmC,OAAOD,GACxBnB,EAAOmsB,qBA4GZ,SAAUC,EAAMx0C,GACjBooB,EAAOqsB,WAAWz0C,EAAMw0C,KAE1B/B,GAAO,CACLiC,eAAgB54C,EAAMq2C,GAAkB/pB,GAAQ,GAChDusB,cAAe74C,EAAMq2C,GAAkB/pB,GAAQ,GAC/CwsB,iBAAkB94C,EAAM4zC,GAAgBtnB,GACxCysB,kBAAmB/4C,EAAMiyC,GAAiB3lB,IACzC,SAAUosB,EAAMx0C,GACjBooB,EAAOqsB,WAAWz0C,EAAM,WACtBw0C,UA+BFM,GAzBO,SAAU3vC,GACnB,IAAIwL,EAASzR,EAAOC,KAAKgG,EAAQC,MAAMupB,iBAAiB3wB,IAAIwJ,GAAQF,SAAShK,MAAM6H,GACnF,MAAO,CACLwL,OAAQhV,EAASgV,GACjBokC,KAAMp5C,EAASwJ,GACf+vB,OAAQv5B,EAAS2yB,GAAS,EAAG,MAoB7BwmB,GAPS,SAAUE,EAAU7oC,GAC/B,MAAO,CACLwE,OAAQhV,EAASwQ,GACjB4oC,KAAMp5C,EAASq5C,GACf9f,OAAQv5B,EAAS2yB,GAAS,EAAG,MAS7B2mB,GAAQ,SAAUvyC,GACpB,IAAIE,EAASH,EAAU/G,MAAM,KAAMgH,GAC/BwyC,EAAW,GAsBf,MAAO,CACLh3C,KAtBS,SAAUi3C,GACnB,QAAgBt3C,IAAZs3C,EACF,MAAM,IAAIz3C,MAAM,uCAElBw3C,EAASr0C,KAAKs0C,IAmBdC,OAjBW,SAAUD,GACrBD,EAAW72C,EAAO62C,EAAU,SAAUhrB,GACpC,OAAOA,IAAMirB,KAgBfE,QAbY,WAEZ,IADA,IAAI/5C,EAAO,GACFC,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCD,EAAKC,GAAMC,UAAUD,GAEvB,IAAI+5C,EAAQ1yC,EAAOlH,MAAM,KAAMJ,GAC/B2C,EAAKi3C,EAAU,SAAUC,GACvBA,EAAQG,QAyBVC,GAAS,CAAE31B,OAfA,SAAU41B,GAUvB,MAAO,CACLC,SAVarzC,EAAMozC,EAAU,SAAUF,GACvC,MAAO,CACLp3C,KAAMo3C,EAAMp3C,KACZk3C,OAAQE,EAAMF,UAQhBC,QALYjzC,EAAMozC,EAAU,SAAUF,GACtC,OAAOA,EAAMD,aAoBbK,GAAe,SAAUC,GAC3B,IAAItnC,EAAS7G,GAAQF,QAAQquC,EAAStnC,QAClCyC,EAAO,WACT6kC,EAASC,mBAEPC,EAAU,WACZF,EAASntB,kBAEPstB,EAAO36C,EAAQ06C,EAAS/kC,GAC5B,OApBY,SAAUzC,EAAQxS,EAAG4M,EAAGqI,EAAM+kC,EAASC,EAAMnsC,GACzD,MAAO,CACL0E,OAAQ1S,EAAS0S,GACjBxS,EAAGF,EAASE,GACZ4M,EAAG9M,EAAS8M,GACZqI,KAAMA,EACN+kC,QAASA,EACTC,KAAMA,EACNnsC,IAAKhO,EAASgO,IAYTosC,CAAQ1nC,EAAQsnC,EAASK,QAASL,EAASM,QAASnlC,EAAM+kC,EAASC,EAAMH,IAU9EO,GAAS,SAAU/wC,EAASmwC,EAAOj3C,EAAQ82C,EAASgB,GACtD,IAAIC,EATO,SAAU/3C,EAAQ82C,GAC7B,OAAO,SAAUQ,GACVt3C,EAAOs3C,IAGZR,EAAQO,GAAaC,KAITU,CAAOh4C,EAAQ82C,GAE7B,OADAhwC,EAAQC,MAAMkxC,iBAAiBhB,EAAOc,EAASD,GACxC,CAAEf,OAAQt5C,EAAMs5C,GAAQjwC,EAASmwC,EAAOc,EAASD,KAKtDf,GAAS,SAAUjwC,EAASmwC,EAAOH,EAASgB,GAC9ChxC,EAAQC,MAAMmxC,oBAAoBjB,EAAOH,EAASgB,IAGhDK,GAAW76C,GAAS,GACpB86C,GAAS,SAAUtxC,EAASmwC,EAAOH,GACrC,OATW,SAAUhwC,EAASmwC,EAAOj3C,EAAQ82C,GAC7C,OAAOe,GAAO/wC,EAASmwC,EAAOj3C,EAAQ82C,GAAS,GAQxCuB,CAAOvxC,EAASmwC,EAAOkB,GAAUrB,IAItCwB,GAAW,CAAEn3C,QADF8J,GAAI,kBACgB9J,SA2B/Bo3C,GAAWtV,GAAQ,CACrB,UACA,UACA,SACA,SAEEuV,GAAWvV,GAAQ,CACrB,UACA,QACA,OACA,YAEEwV,GAAUxV,GAAQ,CACpB,YACA,OACA,OACA,cAsCEyV,GAAYH,GAAS,CACvBI,QApCY,SAAUlH,EAAKtlC,GAC3B,OAAO8jB,GAAS9jB,EAAG4Y,OAAS0sB,EAAI1sB,OAAQ5Y,EAAG4jB,MAAQ0hB,EAAI1hB,QAoCvD+J,QAlCc,SAAUmd,GACxB,OAAOp2C,EAAON,KAAK0vB,GAASgnB,EAAMz5C,IAAKy5C,EAAM7sC,OAkC7CwuC,KA7BS,SAAUC,EAASC,GAC5B,IAAI7iB,EAtDQ,SAAUuc,GACtB,IAAIsG,EAAWtH,GAAQ,CAAEuH,WAAYT,GAASn3C,QAAQ,YAAcqxC,GAChEjpC,EAAMJ,GAAQU,QAAQ,OAiB1B,OAhBAnN,GAAI6M,EAAK,OAAQ,gBACjByB,GAASzB,EAAK,CACZ2sB,SAAU,QACVnR,KAAM,MACNgL,IAAK,MACLzB,MAAO,OACPpC,OAAQ,SAEVyI,GAAMprB,EAAK+uC,GAASn3C,QAAQ,YAC5BwzB,GAAMprB,EAAKuvC,EAASC,YAOb,CACLjyC,QAPY,WACZ,OAAOyC,GAOPktB,QALY,WACZriB,GAAS7K,KAqCGyvC,CAAQF,GAClBG,EAAQb,GAAOniB,EAAQnvB,UAAW,YAAa+xC,EAAQK,WACvDC,EAAMf,GAAOniB,EAAQnvB,UAAW,UAAW+xC,EAAQO,MACnDC,EAAQjB,GAAOniB,EAAQnvB,UAAW,YAAa+xC,EAAQS,MACvDC,EAAOnB,GAAOniB,EAAQnvB,UAAW,WAAY+xC,EAAQW,WAczD,OAAOhB,GAAS,CACd1xC,QAASmvB,EAAQnvB,QACjB0B,MARU,SAAU8J,GACpBiB,GAAOjB,EAAQ2jB,EAAQnvB,YAQvB2L,KANS,WACT2B,GAAS6hB,EAAQnvB,YAMjB2vB,QAjBY,WACZR,EAAQQ,UACR0iB,EAAIpC,SACJsC,EAAMtC,SACNwC,EAAKxC,SACLkC,EAAMlC,aAmBR35B,OAjCW,SAAUq8B,EAAUrsC,GAC/BqsC,EAASr8B,OAAOhQ,EAAK2X,OAAQ3X,EAAK2iB,UA8DpC,SAAS2pB,KACP,IAAI/iB,EAAW91B,EAAO1C,OAoBlBw7C,EAASzC,GAAO31B,OAAO,CAAE+3B,KAAM1C,GAAM,CAAC,WAC1C,MAAO,CACLgD,QAXY,SAAU3C,EAAO4C,GACZA,EAAK/f,QAAQmd,GACnBr3C,KAAK,SAAU2jC,IATf,SAAUsW,EAAM1tC,GAC3B,IAAIkJ,EAASshB,EAASh3B,IAAI,SAAU8xC,GAClC,OAAOoI,EAAKlB,QAAQlH,EAAKtlC,KAG3B,OADAwqB,EAAW91B,EAAON,KAAK4L,GAChBkJ,GAKQykC,CAAOD,EAAMtW,GACnB3jC,KAAK,SAAUyF,GACpBs0C,EAAO3C,QAAQsC,KAAKj0C,QAOxB00C,MAtBU,WACVpjB,EAAW91B,EAAO1C,QAsBlBw7C,OAAQA,EAAOvC,UAWnB,SAAS4C,KACP,IAAIC,EAPG,CACLL,QAAS/8C,EACTk9C,MAAOl9C,GAMLq9C,EAAcR,KACdS,EAAYF,EAehB,MAAO,CACL/vB,GAfO,WACPiwB,EAAUJ,QACVI,EAAYD,GAcZE,IAZQ,WACRD,EAAUJ,QACVI,EAAYF,GAWZI,KANS,WACT,OAAOF,IAAcD,GAMrBN,QAVY,SAAU3C,EAAO4C,GAC7BM,EAAUP,QAAQ3C,EAAO4C,IAUzBF,OAAQO,EAAYP,QAIxB,IA8DIW,GA9DQ,SAAUb,EAAUI,EAAMf,GACpC,IA3FqBp7C,EAAI68C,EACrBC,EA0FAC,GAAS,EACTd,EAASzC,GAAO31B,OAAO,CACzB/Y,MAAOouC,GAAM,IACbnkC,KAAMmkC,GAAM,MAEV8D,EAAWV,KACXZ,EAAO,WACTR,EAAKnmC,OACDioC,EAASL,SACXK,EAASN,MACTT,EAAO3C,QAAQvkC,SAGfkoC,GAxGiBj9C,EAwGM07C,EAxGFmB,EAwGQ,IAvG7BC,EAAQ,KAoBL,CACLI,OApBW,WACG,OAAVJ,IACFn+C,EAAWw+C,aAAaL,GACxBA,EAAQ,OAkBVM,SAfa,WAEb,IADA,IAAI79C,EAAO,GACFC,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCD,EAAKC,GAAMC,UAAUD,GAET,OAAVs9C,GACFn+C,EAAWw+C,aAAaL,GAE1BA,EAAQn+C,EAAW0+C,WAAW,WAC5Br9C,EAAGL,MAAM,KAAMJ,GACfu9C,EAAQ,MACPD,MA+FLG,EAASf,OAAOL,KAAKz5C,KAAK,SAAUo3C,GAClC4C,EAAKz8B,OAAOq8B,EAAUxC,EAAM7pC,UAE9B,IAMI4tC,EAAc,SAAUh9C,GAC1B,OAAO,WAEL,IADA,IAAIf,EAAO,GACFC,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCD,EAAKC,GAAMC,UAAUD,GAEnBu9C,GACFz8C,EAAEX,MAAM,KAAMJ,KAIhB27C,EAAOiB,EAAKjB,KAAKH,GAAQ,CAC3BS,UAAWE,EACXA,KAAM4B,EAAY5B,GAClBE,KAAM0B,EA3BQ,SAAU/D,GACxB0D,EAAcC,SACdF,EAASd,QAAQ3C,EAAO4C,KA0BxBL,UAAWwB,EAAYL,EAAcG,YACnChC,GAIJ,MAAO,CACLhyC,QAAS8xC,EAAK9xC,QACdm0C,GAxCO,SAAU3oC,GACjBsmC,EAAKpwC,MAAM8J,GACXooC,EAASxwB,KACTyvB,EAAO3C,QAAQxuC,SAsCf0hB,GA7BO,WACPuwB,GAAS,GA6BTL,IA3BQ,WACRK,GAAS,GA2BThkB,QARY,WACZmiB,EAAKniB,WAQLkjB,OAAQA,EAAOvC,WAYf8D,GAPc,SAAUzB,EAAUX,QACnB,IAAbA,IACFA,EAAW,IAEb,IAAIe,OAAyBr6C,IAAlBs5C,EAASe,KAAqBf,EAASe,KAAOnB,GACzD,OAAO4B,GAAeb,EAAUI,EAAMf,IAoBpCqC,GAAc,WAChB,IAAIxB,EAASzC,GAAO31B,OAAO,CACzB65B,KAAMxE,GAAM,CACV,SACA,SACA,aAGA5mC,EAASnP,EAAO1C,OAChBk9C,EAzBS,WACb,IAAI1B,EAASzC,GAAO31B,OAAO,CACzB65B,KAAMxE,GAAM,CACV,SACA,aAMJ,MAAO,CACLx5B,OAJW,SAAU5f,EAAG4M,GACxBuvC,EAAO3C,QAAQoE,KAAK59C,EAAG4M,IAIvBuvC,OAAQA,EAAOvC,UAaFkE,GACfD,EAAS1B,OAAOyB,KAAKv7C,KAAK,SAAUo3C,GAClCjnC,EAAOpQ,KAAK,SAAU0B,GACpBq4C,EAAO3C,QAAQoE,KAAKnE,EAAMsE,SAAUtE,EAAMuE,SAAUl6C,OASxD,MAAO,CACLyK,OAPW,SAAUzK,GACrB0O,EAASnP,EAAON,KAAKe,IAOrB7E,IALQ,WACR,OAAOuT,GAKPoN,OAAQi+B,EAASj+B,OACjBu8B,OAAQA,EAAOvC,WAIfqE,GAAwB,SAAU9kC,GACpC,MAAyC,SAAlC9O,GAAM8O,EAAK,oBAMhB+kC,GAAoB3lB,GAAO50B,QAAQ,wBACnCw6C,GAAa,SAAUjlB,EAAMwD,EAAWhD,GAC1C,IAAIuiB,EAAW0B,KACXS,EAAWV,GAAkBzB,EAAU,IACvCoC,EAAah7C,EAAO1C,OACpB29C,EAAa,SAAUh1C,EAASzF,GAClC,OAAOR,EAAOC,KAAK+G,GAAMf,EAASzF,KAEpCo4C,EAASE,OAAOyB,KAAKv7C,KAAK,SAAUo3C,GAClC6E,EAAW7E,EAAMjnC,SAAU,YAAYpQ,KAAK,SAAUm8C,GACpD,IAAIljC,EAAa4mB,GAAUK,OAAOmX,EAAMjnC,SAAU,OAClDjF,GAAMksC,EAAMjnC,SAAU,MAAO6I,EAAao+B,EAAMuE,SAAW,QAE7DM,EAAW7E,EAAMjnC,SAAU,eAAepQ,KAAK,SAAUo8C,GACvD,IAAIC,EAAaxc,GAAUK,OAAOmX,EAAMjnC,SAAU,QAClDjF,GAAMksC,EAAMjnC,SAAU,OAAQisC,EAAahF,EAAMsE,SAAW,UAGhE,IAAIW,EAAW,SAAUlsC,EAAQmsC,GAG/B,OAFW1c,GAAUK,OAAO9vB,EAAQmsC,GACzBplC,SAASlP,GAAMmI,EAAQ,gBAAkBmsC,GAAM,KAG5DP,EAASjC,OAAOlnC,KAAK5S,KAAK,WACxB45C,EAASh9C,MAAMmD,KAAK,SAAUoQ,GAC5B6rC,EAAWj8C,KAAK,SAAUwX,GACxB0kC,EAAW9rC,EAAQ,YAAYpQ,KAAK,SAAUyX,GAC5C,IAAI4a,EAAQiqB,EAASlsC,EAAQ,OAC7B/H,GAAO+H,EAAQ,oBACf2pC,EAAO3C,QAAQoF,aAAahlC,EAAO6a,EAAOlb,SAASM,EAAK,OAE1DykC,EAAW9rC,EAAQ,eAAepQ,KAAK,SAAUuY,GAC/C,IAAI8Z,EAAQiqB,EAASlsC,EAAQ,QAC7B/H,GAAO+H,EAAQ,qBACf2pC,EAAO3C,QAAQqF,YAAYjlC,EAAO6a,EAAOlb,SAASoB,EAAQ,OAE5D2f,GAAapB,EAAMtf,EAAO8f,EAAYgD,SAI5C,IAAI4c,EAAU,SAAU9mC,EAAQmsC,GAC9BxC,EAAO3C,QAAQsF,cACf7C,EAAS1tC,OAAOiE,GAChBtT,GAAIsT,EAAQ,gBAAkBmsC,EAAKplC,SAAS7L,GAAM8E,EAAQmsC,GAAM,KAChExnB,GAAM3kB,EAAQ0rC,IACd3wC,GAAMiF,EAAQ,UAAW,OACzB4rC,EAASX,GAAGvkB,EAAKpkB,WAEfiqC,EAAYnE,GAAO1hB,EAAKpkB,SAAU,YAAa,SAAU2kC,GACvDnf,GAAcmf,EAAMjnC,WACtB8mC,EAAQG,EAAMjnC,SAAU,OAEtB8nB,GAAcmf,EAAMjnC,WACtB8mC,EAAQG,EAAMjnC,SAAU,UAGxBwC,EAAS,SAAUuB,GACrB,OAAO1V,GAAG0V,EAAG2iB,EAAKggB,SAEhB8F,EAA2B,SAAUxsC,GACvC,OAAOqG,GAAUrG,EAAQ,QAASwC,GAAQxS,OAAO,SAAUoX,GACzD,OAjE2B,SAAUpH,EAAQwC,GACjD,OAAO6D,GAAUrG,EAAQ,oBAAqBwC,GAgEnCiqC,CAA2BrlC,EAAO5E,GAAQ1S,OAAO27C,OAGxDiB,EAAYtE,GAAO1hB,EAAKggB,OAAQ,YAAa,SAAUO,GACzDuF,EAAyBvF,EAAMjnC,UAAUnR,KAAK,WACxC0L,GAAO0sC,EAAMjnC,WACf8nB,GAAapB,IAEd,SAAUtf,GACXykC,EAAah7C,EAAON,KAAK6W,GACzB0gB,GAAapB,EAAMtf,EAAO8f,EAAYgD,OAYtCyf,EAASzC,GAAO31B,OAAO,CACzB66B,aAAcxF,GAAM,CAClB,QACA,QACA,QAEFyF,YAAazF,GAAM,CACjB,QACA,QACA,WAEF0F,YAAa1F,GAAM,MAErB,MAAO,CACLngB,QAvBY,WACZ8lB,EAAUxF,SACV2F,EAAU3F,SACV6E,EAASnlB,UACTqB,GAAapB,IAoBbimB,QAlBY,SAAU51B,GACtB+Q,GAAapB,EAAM3P,EAAKmQ,EAAYgD,IAkBpChQ,GAAI0xB,EAAS1xB,GACbkwB,IAAKwB,EAASxB,IACdwC,SAAUn/C,EAAMq6B,GAAWpB,GAC3BmmB,SAAUp/C,EAAMq6B,GAAWpB,GAC3BijB,OAAQA,EAAOvC,WAoCf0F,GAhCW,SAAUpmB,EAAMS,GAC7B,IAAID,EAAalF,GAAa9F,OAC1B6wB,EAAUpB,GAAWjlB,EAAMS,EAAYD,GACvCyiB,EAASzC,GAAO31B,OAAO,CACzBy7B,aAAcpG,GAAM,CAAC,UACrBqG,YAAarG,GAAM,CAAC,UACpBsG,UAAWtG,GAAM,MAiBnB,OAfAmG,EAAQpD,OAAOyC,aAAav8C,KAAK,SAAUo3C,GACzC0C,EAAO3C,QAAQgG,aAAa/F,EAAM7/B,SAClC,IAAI6a,EAAQiF,EAAWjF,MAAMglB,EAAMhlB,QAASglB,EAAM7/B,SAClD8qB,GAAyB+U,EAAM7/B,QAAS6a,EAAOglB,EAAM5/B,MAAO6f,GAC5DyiB,EAAO3C,QAAQiG,YAAYhG,EAAM7/B,WAEnC2lC,EAAQpD,OAAO2C,YAAYz8C,KAAK,SAAUo3C,GACxC0C,EAAO3C,QAAQkG,cAEjBH,EAAQpD,OAAO0C,YAAYx8C,KAAK,SAAUo3C,GACxC0C,EAAO3C,QAAQgG,aAAa/F,EAAM7/B,SAClC,IAAI6a,EAAQkF,EAAWlF,MAAMglB,EAAMhlB,QAASglB,EAAM7/B,SAClD8qB,GAAwB+U,EAAM7/B,QAAS6a,EAAOglB,EAAM9+B,SAAUgf,GAC9DwiB,EAAO3C,QAAQiG,YAAYhG,EAAM7/B,WAE5B,CACL8S,GAAI6yB,EAAQ7yB,GACZkwB,IAAK2C,EAAQ3C,IACbwC,SAAUG,EAAQH,SAClBC,SAAUE,EAAQF,SAClBpmB,QAASsmB,EAAQtmB,QACjBkjB,OAAQA,EAAOvC,WA0Bf+F,GARQ,SAAUpzB,EAAQvE,GAC5B,OAAOuE,EAAOqzB,OAAS3G,GAAgBvP,GAAUnd,GAd7B,WACpB,IAAIvE,EAAYrc,GAAQU,QAAQ,OAUhC,OATAmB,GAASwa,EAAW,CAClB0Q,SAAU,SACVhK,OAAQ,IACRoC,MAAO,IACP+e,QAAS,IACTgQ,OAAQ,IACRtV,OAAQ,MAEVx0B,GAAO7I,KAAQ8a,GACRA,EAGmD83B,IAAqB7G,GAAgBttC,GAAQF,QAAQ8gB,EAAOgB,YAOpHoyB,GALW,SAAUpzB,EAAQ2M,GAC3B3M,EAAOqzB,QACThpC,GAASsiB,EAAKpkB,WAQdirC,GAA2B,SAAUz2C,EAASwL,GAChD,OAAO60B,GAAgBrgC,EAAQC,OAASogC,GAAgB70B,EAAOvL,OAAS,IAAM,KAmB5Ey2C,GAAmB,SAAUzzB,GAC/B,IAII0zB,EACAC,EALAC,EAAe98C,EAAO1C,OACtBinC,EAASvkC,EAAO1C,OAChBu4B,EAAO71B,EAAO1C,OACdkvB,EAA2B,iBAG3BuwB,EAAU,SAAUjnC,GACtB,MAAwB,UAAjBA,EAAI3P,UAETqnB,EAAc,SAAU1X,GAC1B,IAAIrL,EAAMye,EAAOhjB,IAAIyjC,SAAS7zB,EAAK,UAAYoT,EAAOhjB,IAAI4lC,UAAUh2B,EAAK,SACzE,OAAO9V,EAAOC,KAAKwK,GAAKtL,OAAO,SAAUlB,GACvC,OAAOA,EAAE1B,OAAS,KAGlBygD,EAAa,WACf,OAAOzY,GA2FT,OA9EArb,EAAOG,GAAG,OAAQ,WAChB,IAAIgQ,EAAY1H,GAAekV,GAAUjV,aACrCqrB,EAAUX,GAAcpzB,GAE5B,GADA2M,EAAO71B,EAAON,KAAKu9C,GAliEC,SAAU/zB,GAChC,IAAIg0B,EAAiBh0B,EAAOke,SAAS,mBAAmB,GACxD,OAAOnmC,EAASi8C,GAAqC,UAAnBA,EAA6BA,EAiiEzDC,CAAkBj0B,IAvlED,SAAUA,GACjC,OAAOA,EAAOke,SAAS,qBAAqB,EAAM,WAslEfgW,CAAmBl0B,GAAS,CAC3D,IAAIm0B,EAAKpB,GAAmBgB,EAAS5jB,GACrCgkB,EAAGh0B,KACHg0B,EAAGvE,OAAOuD,UAAUr9C,KAAK,SAAUo3C,GACjC0G,EAAe98C,EAAON,KAAKwpB,EAAOf,UAAUm1B,YAE9CD,EAAGvE,OAAOqD,aAAan9C,KAAK,SAAUo3C,GACpC,IAAImH,EAAWnH,EAAM7/B,QAAQrQ,MAC7BgiC,GAAsBhf,EAAQq0B,EAAUjX,GAAgBiX,GAAWhX,GAAegX,MAEpFF,EAAGvE,OAAOsD,YAAYp9C,KAAK,SAAUo3C,GACnC,IAAI7/B,EAAQ6/B,EAAM7/B,QACdgnC,EAAWhnC,EAAMrQ,MACrBugC,GAAgBlwB,GAChBumC,EAAa/9C,KAAK,SAAUsrB,GAC1BnB,EAAOf,UAAUmC,OAAOD,GACxBnB,EAAOqB,UAET4d,GAAkBjf,EAAQq0B,EAAUjX,GAAgBiX,GAAWhX,GAAegX,IAC9Er0B,EAAOylB,YAAYhb,QAErB4Q,EAASvkC,EAAON,KAAK29C,MAGzBn0B,EAAOG,GAAG,oBAAqB,SAAUnW,GACvC,IA/D0BqD,EA+DtBinC,EAAYtqC,EAAE/D,OAClB,GAAI4tC,EAAQS,GAAY,CACtB,IAAIC,EAAqBjwB,EAAYgwB,GAAW1+C,IAAI,SAAU+Z,GAC5D,OAAO2T,EAAyBzgB,KAAK8M,KACpCza,OAAM,GACLq/C,GAAsB7V,GAAe1e,IApEjB3S,EAqERinC,EApEpBtzC,GAAM5B,GAAQF,QAAQmO,GAAQ,QAAS+vB,GAAgB/vB,GAAOhX,WAAa,QAqE3Dk+C,GAtlEQ,SAAUv0B,GAClC,OAAqD,IAA9CA,EAAOke,SAAS,0BAqlEesW,CAAoBx0B,IAnFpC,SAAUq0B,GAChC,IAAIhnC,EAAQjO,GAAQF,QAAQm1C,GAC5B9rC,GAAO8E,GAAOzX,IAAI,SAAU2S,GAC1B,OAAOirC,GAAyBnmC,EAAO9E,KACtC1S,KAAK,SAAU4+C,GAChBzzC,GAAMqM,EAAO,QAASonC,GACtB5+C,EAAK6V,GAAc2B,EAAO,MAAO,SAAUuc,GACzC/zB,EAAKmT,GAAS4gB,GAAK,SAAU5Z,GAC3BhP,GAAMgP,EAAI,QAASwjC,GAAyBxjC,EAAI4Z,UA4EhD8qB,CAAkBJ,GAEpBZ,EAAS1pC,EAAEua,MACXovB,EAAYrvB,EAAYgwB,GAAWp/C,MAAM,OAG7C8qB,EAAOG,GAAG,gBAAiB,SAAUnW,GACnC,IAAIsqC,EAAYtqC,EAAE/D,OAClB,GAAI4tC,EAAQS,GAAY,CACtB,IAAIjnC,EAAQinC,EACZ,GAAIhxB,EAAyBzgB,KAAK8wC,GAAY,CAC5C,IAAIgB,EAAWlzB,WAAW6B,EAAyB2B,KAAK0uB,GAAW,IAC/DiB,EAAiB5qC,EAAEua,MAAQowB,EAAWjB,EAC1C1zB,EAAOhjB,IAAI0nC,SAASr3B,EAAO,QAASunC,EAAiB,SAChD,CACL,IAAIC,EAAiB,GACrB1U,GAAStqC,KAAKwX,EAAME,KAAM,SAAUD,GAClC6yB,GAAStqC,KAAKyX,EAAIF,MAAO,SAAUF,GACjC,IAAIqX,EAAQvE,EAAOhjB,IAAIyjC,SAASvzB,EAAM,SAAS,GAC/C2nC,EAAep8C,KAAK,CAClByU,KAAMA,EACNqX,MAAOA,QAIb4b,GAAStqC,KAAKg/C,EAAgB,SAAUC,GACtC90B,EAAOhjB,IAAI0nC,SAASoQ,EAAY5nC,KAAM,QAAS4nC,EAAYvwB,OAC3DvE,EAAOhjB,IAAIynC,UAAUqQ,EAAY5nC,KAAM,QAAS,YAKxD8S,EAAOG,GAAG,aAAc,WACtB2zB,IAAaj+C,KAAK,SAAUwlC,GACtBrb,EAAO+0B,SACT1Z,EAAOwX,WAEPxX,EAAOyX,eAIN,CACLgB,WAAYA,EACZxU,SA3Fa,WACb,OAAO3S,EAAKz3B,MAAMw3C,GAAgBttC,GAAQF,QAAQ8gB,EAAOpf,cA2FzD8rB,QAzFY,WACZ2O,EAAOxlC,KAAK,SAAUs+C,GACpBA,EAAGznB,YAELC,EAAK92B,KAAK,SAAU8Z,GAClByjC,GAAiBpzB,EAAQrQ,QAwF3BqlC,GAAQp3B,GAAa,CACvB,CAAExpB,KAAM,CAAC,YACT,CAAE4d,MAAO,CAAC,YACV,CACE0iB,OAAQ,CACN,UACA,WAGJ,CAAExgB,KAAM,CAAC,cAQP+gC,GAAelzC,GAASA,GAAS,GAAIizC,IAAQ,CAAE5gD,KANtC,SAAU+O,GAIrB,YAHgB,IAAZA,IACFA,OAAU1N,GAELu/C,GAAM5gD,KAAK+O,MAIhB+xC,GAAW,SAAU/xC,EAASsF,GAChC,OAAOwE,GAAYI,MAAMlK,EAASsF,GAAQ3S,KAAK,SAAUuX,GACvD,IAAIvZ,EAAMmZ,GAAYG,MAAMC,GAI5B,OAHY/T,EAAUxF,EAAK,SAAUL,GACnC,OAAOa,GAAG6O,EAAS1P,KAERmC,IAAI,SAAUuiB,GACzB,MAAO,CACLjP,MAAO3V,EAAS4kB,GAChBrkB,IAAKP,EAASO,SAqBlBqhD,GAhBO,SAAUhyC,EAASsF,GAE5B,OADgBysC,GAAS/xC,EAASsF,GACjB3T,KAAK,WACpB,OAAOmgD,GAAa7gD,KAAK+O,IACxB,SAAUE,GACX,OAAOA,EAAK6F,QAAU,EAAI7F,EAAKvP,MAAMT,OAAS4hD,GAAavgB,OAAOvxB,EAASE,EAAKvP,MAAMuP,EAAK6F,QAAU,IAAM+rC,GAAa/gC,KAAK/Q,MAW7HgyC,GARO,SAAUhyC,EAASsF,GAE5B,OADgBysC,GAAS/xC,EAASsF,GACjB3T,KAAK,WACpB,OAAOmgD,GAAa7gD,QACnB,SAAUiP,GACX,OAAOA,EAAK6F,QAAU,GAAK,EAAI+rC,GAAavgB,OAAOvxB,EAASE,EAAKvP,MAAMuP,EAAK6F,QAAU,IAAM+rC,GAAajjC,MAAM7O,MAS/GiyC,GAAW,CAAE59B,OADFnd,EAAU,QAAS,UAAW,SAAU,YAGnDg7C,GAAQz3B,GAAa,CACvB,CAAExU,OAAQ,CAAC,YACX,CACE+W,GAAI,CACF,UACA,WAGJ,CAAE5W,MAAO,CAAC,cAWR+rC,GAAO,CACTlsC,OAJaisC,GAAMjsC,OAKnB+W,GAJOk1B,GAAMl1B,GAKb5W,MAJY8rC,GAAM9rC,MAKlBqV,KAbW,SAAUC,EAAS02B,EAAUC,EAAMC,GAC9C,OAAO52B,EAAQ/pB,KAAKygD,EAAUC,EAAMC,IAapC30B,SAXa,SAAU40B,GACvB,OAAOA,EAAK5gD,KAAKtB,EAAUA,EAAUA,KAanCmiD,GAAQ/3B,GAAa,CACvB,CAAEg4B,SAAU,CAAC,QACb,CACEC,SAAU,CACR,YACA,eAGJ,CACEC,MAAO,CACL,QACA,UACA,SACA,cA4BFC,GAAY,CACdH,SATaD,GAAMC,SAUnBC,SATaF,GAAME,SAUnBC,MATUH,GAAMG,MAUhBE,eA5BmB,SAAUC,GAC7B,OAAON,GAAMG,MAAMG,EAASx3C,QAASw3C,EAASC,UAAWD,EAASngC,SAAUmgC,EAASE,YA4BrFC,OAVW,SAAUn3B,GACrB,IA9hM0BliB,EA8hMtB0B,EAjBW,SAAUwgB,GACzB,OAAOA,EAAUpd,MAAM,CACrB+zC,SAAU,SAAUz0B,GAClB,OAAO/hB,GAAQF,QAAQiiB,EAAIk1B,iBAE7BR,SAAU,SAAUS,EAAWC,GAC7B,OAAOjB,GAAKx0B,SAASw1B,IAEvBR,MAAO,SAAUr3C,EAAOy3C,EAASpgC,EAAQqgC,GACvC,OAAO13C,KAQC+3C,CAAWv3B,GACvB,OA/hM0BliB,EA+hMP0B,EA9hMZW,GAAQF,QAAQnC,EAAQC,MAAM0D,cAAc4lB,cAuiMnD0E,MAPYoqB,GAAS59B,QAenBi/B,GAA0B,SAAUt1B,EAAKpkB,GAC3CokB,EAAIu1B,mBAAmB35C,EAAQC,QAoB7B25C,GAAmB,SAAUtwB,EAAKiwB,EAAWC,GAC/C,IAnBuBp1B,EAmBnB6J,EAAQ3E,EAAI5mB,SAASm3C,cAGzB,OAtBuBz1B,EAoBd6J,EAAOsrB,EAnBXxhD,KAAK,SAAUkV,GAClBmX,EAAI01B,eAAe7sC,EAAEhN,QACpB,SAAUgN,EAAGzV,GACd4sB,EAAIwe,SAAS31B,EAAEhN,MAAOzI,IACrB,SAAUyV,GACXmX,EAAI21B,cAAc9sC,EAAEhN,SAGR,SAAUmkB,EAAKu0B,GAC7BA,EAAK5gD,KAAK,SAAUkV,GAClBmX,EAAI41B,aAAa/sC,EAAEhN,QAClB,SAAUgN,EAAGzV,GACd4sB,EAAIye,OAAO51B,EAAEhN,MAAOzI,IACnB,SAAUyV,GACXmX,EAAI61B,YAAYhtC,EAAEhN,SAMpBi6C,CAAUjsB,EAAOurB,GACVvrB,GAELksB,GAAgB,SAAU7wB,EAAK5nB,EAAOy3C,EAASpgC,EAAQqgC,GACzD,IAAIh1B,EAAMkF,EAAI5mB,SAASm3C,cAGvB,OAFAz1B,EAAIwe,SAASlhC,EAAMzB,MAAOk5C,GAC1B/0B,EAAIye,OAAO9pB,EAAO9Y,MAAOm5C,GAClBh1B,GAELg2B,GAAS,SAAUC,GACrB,MAAO,CACLp8B,KAAMznB,EAAS6jD,EAAKp8B,MACpBgL,IAAKzyB,EAAS6jD,EAAKpxB,KACnB/K,MAAO1nB,EAAS6jD,EAAKn8B,OACrBo8B,OAAQ9jD,EAAS6jD,EAAKC,QACtB9yB,MAAOhxB,EAAS6jD,EAAK7yB,OACrBpC,OAAQ5uB,EAAS6jD,EAAKj1B,UAStBm1B,GAAQ15B,GAAa,CACvB,CACE2K,IAAK,CACH,QACA,UACA,SACA,YAGJ,CACEF,IAAK,CACH,QACA,UACA,SACA,cAIFkvB,GAAY,SAAUlxB,EAAK/uB,EAAM0zB,GACnC,OAAO1zB,EAAK8H,GAAQF,QAAQ8rB,EAAMqrB,gBAAiBrrB,EAAMwsB,YAAap4C,GAAQF,QAAQ8rB,EAAMysB,cAAezsB,EAAM0sB,YA+C/GC,GAAW,SAAUtxB,EAAKpH,GAE5B,OAjBe,SAAUoH,EAAKuxB,GAC9B,IAAIz2B,EAAMy2B,EAAOrvB,MACjB,OAAIpH,EAAI02B,UACSD,EAAOvvB,MAAMpyB,OAAO,SAAU6hD,GAC3C,OAAyB,IAAlBA,EAAID,YAEGjiD,IAAI,SAAUkiD,GAC5B,OAAOR,GAAMjvB,IAAIjpB,GAAQF,QAAQ44C,EAAIL,cAAeK,EAAIJ,UAAWt4C,GAAQF,QAAQ44C,EAAIzB,gBAAiByB,EAAIN,eAC3GriD,WAAW,WACZ,OAAOoiD,GAAUlxB,EAAKixB,GAAM/uB,IAAKpH,KAG5Bo2B,GAAUlxB,EAAKixB,GAAM/uB,IAAKpH,GAK5B42B,CAAW1xB,EA/CJ,SAAUA,EAAKpH,GAC7B,OAAOA,EAAUpd,MAAM,CACrB+zC,SAAU,SAAUz0B,GAClB,MAAO,CACLoH,IAAKh1B,EAAS4tB,GACdkH,IAAKvxB,EAAO1C,OAGhByhD,SAAU,SAAUS,EAAWC,GAC7B,MAAO,CACLhuB,IAAKvpB,GAAO,WACV,OAAO23C,GAAiBtwB,EAAKiwB,EAAWC,KAE1CluB,IAAKrpB,GAAO,WACV,OAAOlI,EAAON,KAAKmgD,GAAiBtwB,EAAKkwB,EAAYD,QAI3DR,MAAO,SAAUr3C,EAAOy3C,EAASpgC,EAAQqgC,GACvC,MAAO,CACL5tB,IAAKvpB,GAAO,WACV,OAAOk4C,GAAc7wB,EAAK5nB,EAAOy3C,EAASpgC,EAAQqgC,KAEpD9tB,IAAKrpB,GAAO,WACV,OAAOlI,EAAON,KAAK0gD,GAAc7wB,EAAKvQ,EAAQqgC,EAAS13C,EAAOy3C,UAsBzD8B,CAAU3xB,EAAKpH,KAG1Bg5B,GAAa,SAAU5xB,EAAKpH,GAE9B,OADgB04B,GAAStxB,EAAKpH,GACbpd,MAAM,CACrB0mB,IAAK,SAAU9pB,EAAOy3C,EAASpgC,EAAQqgC,GACrC,IAAIh1B,EAAMkF,EAAI5mB,SAASm3C,cAGvB,OAFAz1B,EAAIwe,SAASlhC,EAAMzB,MAAOk5C,GAC1B/0B,EAAIye,OAAO9pB,EAAO9Y,MAAOm5C,GAClBh1B,GAETkH,IAAK,SAAU5pB,EAAOy3C,EAASpgC,EAAQqgC,GACrC,IAAIh1B,EAAMkF,EAAI5mB,SAASm3C,cAGvB,OAFAz1B,EAAIwe,SAAS7pB,EAAO9Y,MAAOm5C,GAC3Bh1B,EAAIye,OAAOnhC,EAAMzB,MAAOk5C,GACjB/0B,MAyBT+2B,GAAS,SAAUd,EAAM3jD,EAAG4M,GAC9B,OAAO5M,GAAK2jD,EAAKp8B,MAAQvnB,GAAK2jD,EAAKn8B,OAAS5a,GAAK+2C,EAAKpxB,KAAO3lB,GAAK+2C,EAAKC,QAGrEc,GAAe,SAAU73C,EAAK83C,EAAU3kD,EAAG4M,EAAG+2C,GAChD,IAAIiB,EAAiB,SAAU9jD,GAC7B,IAAIyE,EAAIsH,EAAItD,MAAM45C,cAGlB,OAFA59C,EAAE2mC,SAASyY,EAASp7C,MAAOzI,GAC3ByE,EAAEuvC,UAAS,GACJvvC,GAML3F,EAASqe,GAAM0mC,GAAU/kD,OACzBilD,EApCe,SAAUC,EAAe9kD,EAAG4M,EAAGm4C,EAAMnlD,GACxD,GAAe,IAAXA,EACF,OAAO,EACF,GAAII,IAAM+kD,EACf,OAAOnlD,EAAS,EAGlB,IADA,IAAIm+C,EAASgH,EACJ1/C,EAAI,EAAGA,EAAIzF,EAAQyF,IAAK,CAC/B,IAAIs+C,EAAOmB,EAAcz/C,GACrB2/C,EAAYvpC,KAAKmc,IAAI53B,EAAI2jD,EAAKp8B,MAClC,GAAI3a,GAAK+2C,EAAKC,OAAQ,CACpB,GAAIh3C,EAAI+2C,EAAKpxB,KAAOyyB,EAAYjH,EAC9B,OAAO14C,EAAI,EAEX04C,EAASiH,GAIf,OAAO,EAkBMC,CALO,SAAUnkD,GAE5B,OADQ8jD,EAAe9jD,GACd2tB,yBAGgCzuB,EAAG4M,EAAG+2C,EAAKn8B,MAAO5nB,GAC7D,OAAOglD,EAAeC,IAsBpBK,GAAa,SAAUr4C,EAAKnB,EAAM1L,EAAG4M,GACvC,OAAO9C,GAAO4B,GArBH,SAAUmB,EAAKnB,EAAM1L,EAAG4M,GACnC,IAAIrH,EAAIsH,EAAItD,MAAM45C,cAClB59C,EAAE4/C,WAAWz5C,EAAKnC,OAClB,IAAI67C,EAAQ7/C,EAAE8/C,iBAId,OAHgB7vB,GAAQ4vB,EAAO,SAAUzB,GACvC,OAAOc,GAAOd,EAAM3jD,EAAG4M,GAAKvJ,EAAON,KAAK4gD,GAAQtgD,EAAO1C,SAExCwB,IAAI,SAAUwhD,GAC7B,OAAOe,GAAa73C,EAAKnB,EAAM1L,EAAG4M,EAAG+2C,KAajB2B,CAAOz4C,EAAKnB,EAAM1L,EAAG4M,GATtB,SAAUC,EAAKnB,EAAM1L,EAAG4M,GAC7C,IAAIrH,EAAIsH,EAAItD,MAAM45C,cACdoC,EAAQhwC,GAAS7J,GACrB,OAAO8pB,GAAQ+vB,EAAO,SAAUpkD,GAE9B,OADAoE,EAAE4/C,WAAWhkD,EAAEoI,OACRk7C,GAAOl/C,EAAEkpB,wBAAyBzuB,EAAG4M,GAAKs4C,GAAWr4C,EAAK1L,EAAGnB,EAAG4M,GAAKvJ,EAAO1C,SAIrC6kD,CAAiB34C,EAAKnB,EAAM1L,EAAG4M,IAa7E64C,GAAuB,SAAU9B,EAAM3jD,GACzC,OAAOA,EAAI2jD,EAAKp8B,KAAOo8B,EAAKn8B,MAAQxnB,GAElC0lD,GAAsB,SAAU74C,EAAK2F,EAAQmzC,GAC/C,IAAIpgD,EAAIsH,EAAItD,MAAM45C,cAGlB,OAFA59C,EAAE4/C,WAAW3yC,EAAOjJ,OACpBhE,EAAEuvC,SAAS6Q,GACJpgD,GAELqgD,GAAkB,SAAU/4C,EAAKnB,EAAM1L,GACzC,IAAI6lD,EAAch5C,EAAItD,MAAM45C,cAC5B0C,EAAYV,WAAWz5C,EAAKnC,OAC5B,IAAIo6C,EAAOkC,EAAYp3B,wBACnBk3B,EAAoBF,GAAqB9B,EAAM3jD,GAEnD,QAjBqB,IAgBb2lD,EAAyCpnC,GAAQI,IAChDjT,GAAMvJ,IAAI,SAAUqQ,GAC3B,OAAOkzC,GAAoB74C,EAAK2F,EAAQmzC,MAGxCG,GAAgB,SAAUj5C,EAAKnB,EAAM1L,GACvC,IAAI2jD,EAAOj4C,EAAKnC,MAAMklB,wBAClBk3B,EAAoBF,GAAqB9B,EAAM3jD,GACnD,OAAOqD,EAAON,KAAK2iD,GAAoB74C,EAAKnB,EAAMi6C,KAqBhDI,GAAkB,SAAUl5C,EAAKnB,EAAM1L,EAAG4M,GAC5C,IAAIrH,EAAIsH,EAAItD,MAAM45C,cAClB59C,EAAE4/C,WAAWz5C,EAAKnC,OAClB,IAAIo6C,EAAOp+C,EAAEkpB,wBAGb,OA5Da,SAAU5hB,EAAKnB,EAAM1L,EAAG4M,GACrC,IAAIrH,EAAIsH,EAAItD,MAAM45C,cAClB59C,EAAE4/C,WAAWz5C,EAAKnC,OAClB,IAAIo6C,EAAOp+C,EAAEkpB,wBACTu3B,EAAWvqC,KAAKC,IAAIioC,EAAKp8B,KAAM9L,KAAKyG,IAAIyhC,EAAKn8B,MAAOxnB,IACpDimD,EAAWxqC,KAAKC,IAAIioC,EAAKpxB,IAAK9W,KAAKyG,IAAIyhC,EAAKC,OAAQh3C,IACxD,OAAOs4C,GAAWr4C,EAAKnB,EAAMs6C,EAAUC,GAsDhCC,CAASr5C,EAAKnB,EAFN+P,KAAKC,IAAIioC,EAAKp8B,KAAM9L,KAAKyG,IAAIyhC,EAAKn8B,MAAOxnB,IACzCyb,KAAKC,IAAIioC,EAAKpxB,IAAK9W,KAAKyG,IAAIyhC,EAAKC,OAAQh3C,MAWtDu5C,GAAkBn6C,SAASo6C,uBA9BF,SAAUv5C,EAAK7M,EAAG4M,GAC7C,OAAOvJ,EAAOC,KAAKuJ,EAAItD,MAAM68C,uBAAuBpmD,EAAG4M,IAAIvK,KAAK,SAAUgkD,GACxE,GAAuB,OAAnBA,EAAIC,WACN,OAAOjjD,EAAO1C,OAEhB,IAAI4E,EAAIsH,EAAItD,MAAM45C,cAGlB,OAFA59C,EAAE2mC,SAASma,EAAIC,WAAYD,EAAIxB,QAC/Bt/C,EAAEuvC,WACKzxC,EAAON,KAAKwC,MAsB0DyG,SAASu6C,oBAnBhE,SAAU15C,EAAK7M,EAAG4M,GAC1C,OAAOvJ,EAAOC,KAAKuJ,EAAItD,MAAMg9C,oBAAoBvmD,EAAG4M,KAUhC,SAAUC,EAAK7M,EAAG4M,GACtC,OAAOjB,GAAQe,UAAUG,EAAK7M,EAAG4M,GAAGvK,KAAK,SAAU4R,GACjD,IAAImT,EAAW,WACb,OA9BO,SAAUva,EAAKnB,EAAM1L,GAEhC,OADkC,IAA1BuV,GAAS7J,GAAM9L,OAAekmD,GAAgBF,IAC7C/4C,EAAKnB,EAAM1L,GA4BTgS,CAAOnF,EAAKoH,EAAMjU,IAE3B,OAAiC,IAA1BuV,GAAStB,GAAMrU,OAAewnB,IAAa2+B,GAAgBl5C,EAAKoH,EAAMjU,EAAG4M,GAAG1K,QAAQklB,MAW3Fo/B,GAAgB,SAAUl9C,EAASu7C,GACrC,IAAI4B,EAAStiD,GAAKmF,GAClB,MAAI,UAAYm9C,EACP5E,GAAK/rC,MAAMxM,GACRrE,EAAS,CACjB,KACA,OACCwhD,GAGe,IAAX5B,EAAehD,GAAKlsC,OAAOrM,GAAWu4C,GAAK/rC,MAAMxM,GAFjDu4C,GAAKn1B,GAAGpjB,EAASu7C,IAKxB6B,GAAqB,SAAU7D,EAAWC,GAC5C,IAAI93C,EAAQ63C,EAAUxhD,KAAKwgD,GAAKlsC,OAAQ6wC,GAAe3E,GAAK/rC,OACxDuM,EAASygC,EAAWzhD,KAAKwgD,GAAKlsC,OAAQ6wC,GAAe3E,GAAK/rC,OAC9D,OAAOwsC,GAAUF,SAASp3C,EAAOqX,IAE/BskC,GAAkB,SAAU37C,EAAOy3C,EAASpgC,EAAQqgC,GACtD,IAAIG,EAAY2D,GAAcx7C,EAAOy3C,GACjCK,EAAa0D,GAAcnkC,EAAQqgC,GACvC,OAAOJ,GAAUF,SAASS,EAAWC,IAqBnC8D,GAAU,SAAU57C,EAAOy3C,EAASpgC,EAAQqgC,GAC9C,IAAIn9C,EARU,SAAUyF,EAAOy3C,EAASpgC,EAAQqgC,GAChD,IACIh1B,EADM7Y,GAAM7J,GACFzB,MAAM45C,cAGpB,OAFAz1B,EAAIwe,SAASlhC,EAAMzB,MAAOk5C,GAC1B/0B,EAAIye,OAAO9pB,EAAO9Y,MAAOm5C,GAClBh1B,EAGCm5B,CAAU77C,EAAOy3C,EAASpgC,EAAQqgC,GACtCoE,EAAOjmD,GAAGmK,EAAOqX,IAAWogC,IAAYC,EAC5C,OAAOn9C,EAAE6+C,YAAc0C,GAGrBC,GAAmB,SAAUn0B,EAAKlF,GACpCrqB,EAAOC,KAAKsvB,EAAIo0B,gBAAgB5kD,KAAK,SAAUopB,GAC7CA,EAAUy7B,kBACVz7B,EAAU07B,SAASx5B,MAGnBy5B,GAAa,SAAUv0B,EAAK5nB,EAAOy3C,EAASpgC,EAAQqgC,GACtD,IAAIh1B,EAAM+1B,GAAc7wB,EAAK5nB,EAAOy3C,EAASpgC,EAAQqgC,GACrDqE,GAAiBn0B,EAAKlF,IAMpB05B,GAAuB,SAAUx0B,EAAKwvB,GACxC,OAAO8B,GAAStxB,EAAKwvB,GAAUh0C,MAAM,CACnC0mB,IAAK,SAAU9pB,EAAOy3C,EAASpgC,EAAQqgC,GACrCyE,GAAWv0B,EAAK5nB,EAAOy3C,EAASpgC,EAAQqgC,IAE1C9tB,IAAK,SAAU5pB,EAAOy3C,EAASpgC,EAAQqgC,GACrC,IAAIl3B,EAAYoH,EAAIo0B,eACpB,GAAIx7B,EAAU67B,iBACZ77B,EAAU67B,iBAAiBr8C,EAAMzB,MAAOk5C,EAASpgC,EAAO9Y,MAAOm5C,QAC1D,GAAIl3B,EAAU87B,OACnB,KAdgB,SAAU10B,EAAKpH,EAAWxgB,EAAOy3C,EAASpgC,EAAQqgC,GACxEl3B,EAAUspB,SAAS9pC,EAAMzB,MAAOk5C,GAChCj3B,EAAU87B,OAAOjlC,EAAO9Y,MAAOm5C,GAavB6E,CAAkB30B,EAAKpH,EAAWxgB,EAAOy3C,EAASpgC,EAAQqgC,GAC1D,MAAOnsC,GACP4wC,GAAWv0B,EAAKvQ,EAAQqgC,EAAS13C,EAAOy3C,QAG1C0E,GAAWv0B,EAAKvQ,EAAQqgC,EAAS13C,EAAOy3C,OAa5C+E,GAAW,SAAUh8B,GACvB,IAAIoH,EAAM0vB,GAAUK,OAAOn3B,GAAWjiB,MAClCk+C,EAAc,SAAUz8C,EAAOy3C,EAASpgC,EAAQqgC,GAClD,OAAOe,GAAc7wB,EAAK5nB,EAAOy3C,EAASpgC,EAAQqgC,IAEhD1mC,EAzEW,SAAUwP,GACzB,OAAOA,EAAUpd,MAAM,CACrB+zC,SAAU,SAAUz0B,GAClB,IAAI1iB,EAAQW,GAAQF,QAAQiiB,EAAIk1B,gBAC5BvgC,EAAS1W,GAAQF,QAAQiiB,EAAIs2B,cACjC,OAAO2C,GAAgB37C,EAAO0iB,EAAIq2B,YAAa1hC,EAAQqL,EAAIu2B,YAE7D7B,SAAUsE,GACVrE,MAAOsE,KAiEMe,CAAWl8B,GAC1B,OAAO04B,GAAStxB,EAAK5W,GAAU5N,MAAM,CACnC0mB,IAAK2yB,EACL7yB,IAAK6yB,KAYLE,GAAa,SAAUn8B,GACzB,IAAIo8B,EAASj8C,GAAQF,QAAQ+f,EAAUq8B,YACnCj6B,EAAQjiB,GAAQF,QAAQ+f,EAAUs8B,WACtC,OAAOlB,GAAQgB,EAAQp8B,EAAUu8B,aAAcn6B,EAAOpC,EAAUw8B,aAAe3kD,EAAON,KAAK4+C,GAAS59B,OAAO6jC,EAAQp8B,EAAUu8B,aAAcn6B,EAAOpC,EAAUw8B,cAZ9I,SAAUx8B,GACxB,GAAIA,EAAUy8B,WAAa,EAAG,CAC5B,IAAIC,EAAW18B,EAAU28B,WAAW,GAChCC,EAAU58B,EAAU28B,WAAW38B,EAAUy8B,WAAa,GAC1D,OAAO5kD,EAAON,KAAK4+C,GAAS59B,OAAOpY,GAAQF,QAAQy8C,EAAStF,gBAAiBsF,EAASnE,YAAap4C,GAAQF,QAAQ28C,EAAQpE,cAAeoE,EAAQnE,YAElJ,OAAO5gD,EAAO1C,OAM4J0nD,CAAU78B,IAEpL88B,GAAe,SAAU11B,EAAKtpB,GAChC,IAAIokB,EA/YmB,SAAUkF,EAAKtpB,GACtC,IAAIokB,EAAMkF,EAAI5mB,SAASm3C,cAEvB,OADAH,GAAwBt1B,EAAKpkB,GACtBokB,EA4YGu1B,CAAmBrwB,EAAKtpB,GAClCy9C,GAAiBn0B,EAAKlF,IAOpB66B,GAAQ,SAAU31B,GACpB,OANa,SAAUA,GACvB,OAAOvvB,EAAOC,KAAKsvB,EAAIo0B,gBAAgBxkD,OAAO,SAAUgmD,GACtD,OAAOA,EAAIP,WAAa,IACvB5lD,KAAKslD,IAGDc,CAAS71B,GAAKzwB,IAAI,SAAUo1B,GACjC,OAAO+qB,GAAUD,MAAM9qB,EAAMvsB,QAASusB,EAAMkrB,UAAWlrB,EAAMlV,SAAUkV,EAAMmrB,cAG7EgG,GAAiB,SAAU91B,EAAKpH,GAElC,OA9WiB,SAAUkC,GAC3B,IAAI03B,EAAQ13B,EAAI23B,iBACZ1B,EAAOyB,EAAMxlD,OAAS,EAAIwlD,EAAM,GAAK13B,EAAIe,wBAC7C,OAAOk1B,EAAK7yB,MAAQ,GAAK6yB,EAAKj1B,OAAS,EAAIrrB,EAAON,KAAK4gD,GAAMxhD,IAAIuhD,IAAUrgD,EAAO1C,OA2W3EgoD,CADGnE,GAAW5xB,EAAKpH,KAGxBo9B,GAAa,SAAUh2B,EAAK5yB,EAAG4M,GACjC,OA9IgB,SAAUgmB,EAAK5yB,EAAG4M,GAClC,IAAIC,EAAMlB,GAAQF,QAAQmnB,EAAI5mB,UAC9B,OAAOm6C,GAAgBt5C,EAAK7M,EAAG4M,GAAGzK,IAAI,SAAUurB,GAC9C,OAAOi0B,GAAS59B,OAAOpY,GAAQF,QAAQiiB,EAAIk1B,gBAAiBl1B,EAAIq2B,YAAap4C,GAAQF,QAAQiiB,EAAIs2B,cAAet2B,EAAIu2B,aA2I/G4E,CAAYj2B,EAAK5yB,EAAG4M,IAOzBk8C,GAAWtlD,QAAQC,KAAKC,MAAMC,QAAQ,mBAEtColD,GAAU,SAAUx8B,EAAQvX,EAAQyE,EAAMoyB,GAC5C,OAAO4R,GAAGlxB,EAAQvX,EAAQ0sC,GAAoBjoC,GAAOoyB,IAEnDmd,GAAW,SAAUz8B,EAAQvX,EAAQyE,EAAMoyB,GAC7C,OAAO4R,GAAGlxB,EAAQvX,EAAQ0sC,GAAoBjoC,GAAOoyB,IAEnDod,GAA6B,SAAU18B,EAAQ9S,GACjD,IAAI+R,EAAY82B,GAAUD,MAAM5oC,EAAM,EAAGA,EAAM,GAC/C,OAAO+tC,GAASh8B,IAEd09B,GAA0B,SAAU38B,EAAQ3S,GAC9C,IA9rOmB1U,EA8rOf4U,EAAO7B,GAAc2B,EAAO,MAChC,OA/rOmB1U,EA+rOP4U,EA9rOS,IAAd5U,EAAGtF,OAAeyD,EAAO1C,OAAS0C,EAAON,KAAKmC,EAAGA,EAAGtF,OAAS,KA8rOlDyC,KAAK,SAAUoe,GAC/B,OAAO/H,GAAa+H,EAAM,SAASte,IAAI,SAAUoc,GAC/C,OAAO0qC,GAA2B18B,EAAQhO,QAI5Ck/B,GAAK,SAAUlxB,EAAQvX,EAAQyE,EAAM+S,EAASqf,GAChD,OAAOpyB,EAAKpY,KAAKgC,EAAO1C,KAAM0C,EAAO1C,KAAM,SAAU+O,EAASwX,GAC5D,OAAO3I,GAAM2I,GAAM/kB,IAAI,SAAUsX,GAC/B,OAAOwvC,GAA2B18B,EAAQ9S,MAE3C,SAAU/J,GACX,OAAO8J,GAAYI,MAAMlK,EAASsF,GAAQ3S,KAAK,SAAUuX,GACvD,IAAI4T,EAAUxB,GAAaJ,OAAOlc,GAIlC,OAHA6c,EAAOylB,YAAYC,SAAS,WAC1BzlB,EAAQ4b,gBAAgBxuB,EAAO4T,KAE1B07B,GAAwB38B,EAAQ3S,QAIzCuvC,GAAe,CACjB,QACA,KACA,MAuBEC,GAAa,CAAE5O,OArBJ,SAAUf,EAAOltB,EAAQC,EAASqf,GAC/C,GAAI4N,EAAM4P,UAAYP,GAASQ,IAAK,CAClC,IAAIC,EAAS7f,GAAUnd,GACnBi9B,EAAW,SAAUlgD,GACvB,IAAIm9C,EAAStiD,GAAKmF,GAClB,OAAOzI,GAAGyI,EAASigD,IAAWtkD,EAASkkD,GAAc1C,IAEnD/4B,EAAMnB,EAAOf,UAAUm1B,SAC3B,GAAIjzB,EAAI02B,UAAW,CACjB,IAAIp5C,EAAQW,GAAQF,QAAQiiB,EAAIk1B,gBAChCppC,GAAYC,KAAKzO,EAAOw+C,GAAUpnD,KAAK,SAAUqX,GAC/CggC,EAAM9sB,kBACW8sB,EAAMgQ,SAAWT,GAAWD,IACxBx8B,EAAQi9B,EAAU/vC,EAAM+S,EAASqf,GAClDzpC,KAAK,SAAUm1B,GACjBhL,EAAOf,UAAUmC,OAAO4J,WAS9BmyB,GAAW,CAAE3lC,OADFnd,EAAU,YAAa,SASlC+iD,GANW,SAAU3+C,EAAOy3C,EAASpgC,EAAQqgC,GAC/C,MAAO,CACL13C,MAAOlL,EAAS+hD,GAAKn1B,GAAG1hB,EAAOy3C,IAC/BpgC,OAAQviB,EAAS+hD,GAAKn1B,GAAGrK,EAAQqgC,MAUjCkH,GAAO,CACTC,eANmB,SAAUj3B,EAAKpH,GAClC,IAAIkC,EAAM82B,GAAW5xB,EAAKpH,GAC1B,OAAOm2B,GAAS59B,OAAOpY,GAAQF,QAAQiiB,EAAIk1B,gBAAiBl1B,EAAIq2B,YAAap4C,GAAQF,QAAQiiB,EAAIs2B,cAAet2B,EAAIu2B,YAKpH6F,UAHcH,IAiBZI,GAAW,SAAU/hC,EAAWhT,EAAQhK,EAAOqX,EAAQ2nC,GACzD,OAAKnpD,GAAGmK,EAAOqX,GAWNhf,EAAO1C,OAVPioB,GAAcX,SAASjd,EAAOqX,EAAQrN,GAAQ3S,KAAK,SAAU4nD,GAClE,IAAI7hC,EAAQ6hC,EAAQ7hC,QAAQ3mB,MAAM,IAClC,OAAI2mB,EAAMxoB,OAAS,GACjBoqD,EAAYhiC,EAAWI,EAAO6hC,EAAQj/C,QAASi/C,EAAQ5nC,UAChDhf,EAAON,KAAK2mD,GAAS3lC,OAAO1gB,EAAON,KAAK6mD,GAAKE,UAAU9+C,EAAO,EAAGA,EAAOmT,GAAOnT,MAAU,KAEzF3H,EAAO1C,UAelBupD,GAAe,CACjBC,KAnCS,SAAUniC,EAAWhT,EAAQhK,EAAOy3C,EAASpgC,EAAQqgC,EAASsH,GACvE,OAAMnpD,GAAGmK,EAAOqX,IAAWogC,IAAYC,EAO9Br/C,EAAO1C,OANPkY,GAAU7N,EAAO,QAASgK,GAAQ3S,KAAK,SAAUf,GACtD,OAAOuX,GAAUwJ,EAAQ,QAASrN,GAAQ3S,KAAK,SAAU7B,GACvD,OAAOupD,GAAS/hC,EAAWhT,EAAQ1T,EAAGd,EAAGwpD,QAgC/Cj7C,OAAQg7C,GACRzN,OAXW,SAAUxiC,EAAMgD,EAASkL,EAAW8B,EAAUsgC,GAMzD,OAAOxhC,GAAcG,eAAee,EAAUhQ,EAAMgD,EAASstC,EAAYphC,wBAAyBohC,EAAYnhC,wBAAwB9mB,IALhH,SAAUkoD,GAG9B,OAFAD,EAAYE,kBAAkBtiC,GAC9BoiC,EAAYJ,YAAYhiC,EAAWqiC,EAAQjiC,QAASiiC,EAAQr/C,QAASq/C,EAAQhoC,UACtEgoC,EAAQjiC,YAUfmiC,GAAW3jD,EAAU,OAAQ,QAC7B4jD,GAAY,SAAU/lC,EAAU3I,EAAM2uC,EAAYC,GAIpD,YAHmB,IAAfA,IACFA,EAAaC,IAERlmC,EAASpX,WAAWyH,OAAOgH,GAAM3Z,IAAI,SAAUqM,GACpD,OAAO+7C,GAAS/7C,EAAGk8C,MAGnBC,GAAW,SAAUlmC,EAAU3I,EAAM4gB,EAAWguB,GAIlD,YAHmB,IAAfA,IACFA,EAAaE,IAERluB,EAAUmuB,QAAQpmC,EAAU3I,GAAM3Z,IAAI,SAAUqM,GACrD,OAAO+7C,GAAS/7C,EAAGk8C,MAGnBE,GAAU,SAAUnmC,EAAU3I,EAAM4gB,EAAWguB,QAC9B,IAAfA,IACFA,EAAaE,IAEf,IAAIr1C,EAAWkP,EAASpX,WAAWkI,SAASuG,GAE5C,OADa4gB,EAAUne,MAAMhJ,GACfpT,IAAI,SAAUoD,GAC1B,OAAOglD,GAAShlD,EAAGmlD,MAGnBI,GAAa,CACf,CACEp7C,QAAS86C,GACTtjC,KAAMyjC,GACNvjC,SAAU/jB,EAAO1C,QAEnB,CACE+O,QAASi7C,GACTzjC,KAAM0jC,GACNxjC,SAAU/jB,EAAON,KAAKynD,KAExB,CACE96C,QAASk7C,GACT1jC,KAAM0jC,GACNxjC,SAAU/jB,EAAON,KAAK4nD,MAGtBI,GAAO,SAAUtmC,EAAU3I,EAAMugC,EAAM3f,EAAWsuB,GAOpD,YANc,IAAVA,IACFA,EAAQF,IAEIllD,EAAKolD,EAAO,SAAUC,GAClC,OAAOA,EAAKv7C,UAAY2sC,IAEXh6C,KAAK,SAAU6oD,GAC5B,OAAOA,EAAKx7C,QAAQ+U,EAAU3I,EAAM4gB,EAAWwuB,EAAKhkC,MAAMhlB,QAAQ,WAChE,OAAOgpD,EAAK9jC,SAAS/kB,KAAK,SAAU7C,GAClC,OAAOurD,GAAKtmC,EAAU3I,EAAMtc,EAAIk9B,UA8BpCyuB,GAxBO,WAOT,MAAO,CACLN,QAPY,SAAUpmC,EAAU3I,GAChC,OAAO2I,EAAS/Q,QAAQ0B,YAAY0G,IAOpCyC,MALU,SAAUhJ,GACpB,OAAOA,EAAS3V,OAAS,EAAIyD,EAAON,KAAKwS,EAASA,EAAS3V,OAAS,IAAMyD,EAAO1C,UAmBjFwqD,GAZQ,WAOV,MAAO,CACLN,QAPY,SAAUpmC,EAAU3I,GAChC,OAAO2I,EAAS/Q,QAAQ4B,YAAYwG,IAOpCyC,MALU,SAAUhJ,GACpB,OAAOA,EAAS3V,OAAS,EAAIyD,EAAON,KAAKwS,EAAS,IAAMlS,EAAO1C,UAY/DyqD,GAAO,SAAU3mC,EAAU3I,EAAMlE,EAAWykC,EAAM3f,EAAW1nB,GAE/D,OADW+1C,GAAKtmC,EAAU3I,EAAMugC,EAAM3f,GAC1Br6B,KAAK,SAAUlB,GACzB,OAAI6T,EAAO7T,EAAE2a,QACJzY,EAAO1C,OAEPiX,EAAUzW,EAAE2a,QAAUzY,EAAON,KAAK5B,EAAE2a,QAAUsvC,GAAK3mC,EAAUtjB,EAAE2a,OAAQlE,EAAWzW,EAAEk7C,OAAQ3f,EAAW1nB,MAWhHq2C,GAAS,SAAU5mC,GACrB,OAAO,SAAUnb,GACf,OAAwD,IAAjDmb,EAASpX,WAAWkI,SAASjM,GAAS1J,SAS7C0rD,GAlBS,SAAU7mC,EAAU3I,EAAMlE,EAAW5C,GAChD,OAAOo2C,GAAK3mC,EAAU3I,EAAMlE,EAAW+yC,GAAUQ,KAAgBn2C,IAkB/Du2C,GAhBU,SAAU9mC,EAAU3I,EAAMlE,EAAW5C,GACjD,OAAOo2C,GAAK3mC,EAAU3I,EAAMlE,EAAW+yC,GAAUQ,KAAiBn2C,IAiBhEw2C,GAAapoC,KACbqoC,GAAW,SAAUniD,EAAS0L,GAChC,OAXa,SAAUyP,EAAU3I,EAAM9G,GACvC,OAAOs2C,GAAS7mC,EAAU3I,EAAMuvC,GAAO5mC,GAAWzP,GAU3C02C,CAASF,GAAYliD,EAAS0L,IAEnC22C,GAAU,SAAUriD,EAAS0L,GAC/B,OAXY,SAAUyP,EAAU3I,EAAM9G,GACtC,OAAOu2C,GAAU9mC,EAAU3I,EAAMuvC,GAAO5mC,GAAWzP,GAU5C42C,CAAQJ,GAAYliD,EAAS0L,IAalC62C,GAAQjlD,EAAU,UAAW,UAM7BklD,IALQllD,EAAU,UAAW,eACnBA,EAAU,UAAW,QAAS,UAC/BA,EAAU,QAAS,OACrBA,EAAU,UAAW,QAEpBujB,GAAa,CACvB,CAAExpB,KAAM,CAAC,YACT,CAAEorD,QAAS,IACX,CAAEC,SAAU,CAAC,SACb,CAAEC,WAAY,CAAC,YAObC,GAAQ,SAAUj4C,GACpB,OAAO4E,GAAU5E,EAAM,OAuBrBk4C,GAAc79C,GAASA,GAAS,GAAIw9C,IAAQ,CAC9CM,OAtBW,SAAUC,EAAQ12C,EAAQ22C,EAAcx2C,EAAOy2C,EAAaC,EAASx3C,GAChF,OAAO6D,GAAU/C,EAAO,QAASd,GAAQ3S,KAAK,SAAUoqD,GACtD,OAAO5zC,GAAUlD,EAAQ,QAASX,GAAQ7S,IAAI,SAAUuqD,GACtD,OAAK7rD,GAAG4rD,EAAWC,GAUV7rD,GAAGiV,EAAO22C,IAActuC,GAAOsuC,KAAeF,EAAcC,EAAQE,GAAcZ,GAAMnrD,KAAK,gBAT7F+mB,GAAU7B,UAAUqmC,GAAO,CAChCO,EACAC,IACCrrD,KAAK,WACN,OAhBU,SAAUgrD,EAAQ12C,EAAQG,GAC5C,IAAI62C,EAAeN,EAAOO,QAAQj3C,GAC9Bk3C,EAAcR,EAAOO,QAAQ92C,GACjC,OAAO+2C,EAAYrlC,MAAQmlC,EAAaplC,MAAQslC,EAAYtlC,KAAOolC,EAAanlC,MAajEslC,CAAcT,EAAQK,EAAYD,GAAaX,GAAMC,UAAYS,EAAQE,IAC/E,SAAUK,GACX,OAAOP,EAAQE,SAMpBjrD,MAAMqqD,GAAMnrD,KAAK,aAOpBwqB,KALW,SAAUC,EAASC,EAAQ2hC,EAAWC,EAAYC,GAC7D,OAAO9hC,EAAQ/pB,KAAKgqB,EAAQ2hC,EAAWC,EAAYC,MAQjDC,IADavmD,EAAU,WAAY,cAAe,UAAW,SAClDA,EAAU,SAAU,WAAY,UAAW,UAStD9B,GAAU,SAAUwR,EAAUhN,GAChC,OAAOzD,EAAUyQ,EAAUrW,EAAMY,GAAIyI,KAGnCs9B,GAAO,SAAU3yB,GACnB,MAAsB,OAAf9P,GAAK8P,IAEVm5C,GAAW,SAAUC,EAAMC,EAAQt4C,GACrC,OAAOs4C,EAAOD,EAAMr4C,GAAQ3S,KAAK,SAAUmQ,GACzC,OAAO1I,GAAO0I,IAA2C,IAAhCyL,GAAMzL,GAAQ8L,OAAO1e,OAAewtD,GAAS56C,EAAQ86C,EAAQt4C,GAAU3R,EAAON,KAAKyP,MAa5G+6C,GAAe,SAAUv4C,EAAQ1L,EAASu7C,EAAQnoB,GACpD,OANW,SAAUpzB,EAASu7C,GAC9B,OAAOrvC,GAAMlM,EAASu7C,GAAQriD,OAAOokC,IAAM1kC,QAAQ,WACjD,OAAOsT,GAAMlM,EAASu7C,EAAS,GAAGriD,OAAOokC,MAIpC4mB,CAAOlkD,EAASu7C,GAAQxiD,KAAK,SAAUorD,GAC5C,OAAO/wB,EAAU6tB,SAASkD,GAAIpsD,KAAK,WACjC,OAAO+rD,GAASK,EAAI/wB,EAAU4wB,OAAQt4C,GAAQ7S,IAAIu6B,EAAU0lB,WAC3D,SAAUsL,GACX,OAnCwBpkD,EAmCHokD,EAlClB54C,GAAOxL,GAASjH,KAAK,SAAUyS,GACpC,IAAIiC,EAAaxB,GAAST,GAC1B,OAAOhQ,GAAQiS,EAAYzN,GAASnH,IAAI,SAAUsT,GAChD,OAAO03C,GAASr4C,EAAQiC,EAAYzN,EAASmM,QA+BdtT,IAAI,SAAUyN,GAC3C,OAAOiyC,GAAKn1B,GAAG9c,EAAKkF,SAAUlF,EAAK6F,WApCvB,IAAUnM,OA6D1BqkD,GApBQ,SAAU34C,EAAQ1L,EAASu7C,EAAQnoB,GAE7C,OADakK,GAAKt9B,GAtBL,SAAU0L,EAAQ1L,EAASozB,GACxC,OAAOA,EAAU6tB,SAASjhD,GAASpH,QAAQ,WACzC,OAAOkrD,GAAS9jD,EAASozB,EAAU4wB,OAAQt4C,KAC1C7S,IAAIu6B,EAAU0lB,UAmBYwL,CAAS54C,EAAQ1L,EAASozB,GAAa6wB,GAAav4C,EAAQ1L,EAASu7C,EAAQnoB,IAC5Fv6B,IAAI,SAAU0rD,GAC1B,MAAO,CACL7iD,MAAOlL,EAAS+tD,GAChBxrC,OAAQviB,EAAS+tD,OAenBF,GAXU,SAAUG,GACtB,OAAO3B,GAAYhhC,KAAK2iC,EAAU,SAAUpwB,GAC1C,OAAOr6B,EAAO1C,QACb,WACD,OAAO0C,EAAO1C,QACb,SAAU8Y,GACX,OAAOpW,EAAON,KAAK8oD,GAAMpyC,EAAM,KAC9B,SAAUA,GACX,OAAOpW,EAAON,KAAK8oD,GAAMpyC,EAAM0E,GAAO1E,QAQtCs0C,GAAOjmD,EAAS,CAClB,OACA,MACA,QACA,UACC,IAoDCkmD,GAAS,CACXr/C,GAAIo/C,GACJE,OA7CW,SAAUC,EAAOl+B,GAC5B,OAAO+9B,GAAK,CACVxmC,KAAM2mC,EAAM3mC,OACZgL,IAAK27B,EAAM37B,MAAQvC,EACnBxI,MAAO0mC,EAAM1mC,QACbo8B,OAAQsK,EAAMtK,SAAW5zB,KAyC3Bm+B,SAtDa,SAAUD,EAAOl+B,GAC9B,OAAO+9B,GAAK,CACVxmC,KAAM2mC,EAAM3mC,OACZgL,IAAK27B,EAAM37B,MAAQvC,EACnBxI,MAAO0mC,EAAM1mC,QACbo8B,OAAQsK,EAAMtK,SAAW5zB,KAkD3Bo+B,aAvCiB,SAAUF,EAAOtK,GAClC,IAAIl1B,EAASw/B,EAAMtK,SAAWsK,EAAM37B,MACpC,OAAOw7B,GAAK,CACVxmC,KAAM2mC,EAAM3mC,OACZgL,IAAKqxB,EAASl1B,EACdlH,MAAO0mC,EAAM1mC,QACbo8B,OAAQA,KAkCVyK,UA/Bc,SAAUH,EAAO37B,GAC/B,IAAI7D,EAASw/B,EAAMtK,SAAWsK,EAAM37B,MACpC,OAAOw7B,GAAK,CACVxmC,KAAM2mC,EAAM3mC,OACZgL,IAAKA,EACL/K,MAAO0mC,EAAM1mC,QACbo8B,OAAQrxB,EAAM7D,KA0BhBqF,OAfa,SAAUm6B,GACvB,OAAOA,EAAM37B,OAeb+7B,UAbc,SAAUJ,GACxB,OAAOA,EAAMtK,UAabpxB,UAzBc,SAAU07B,EAAOnQ,EAAQC,GACvC,OAAO+P,GAAK,CACVxmC,KAAM2mC,EAAM3mC,OAASw2B,EACrBxrB,IAAK27B,EAAM37B,MAAQyrB,EACnBx2B,MAAO0mC,EAAM1mC,QAAUu2B,EACvB6F,OAAQsK,EAAMtK,SAAW5F,KAqB3Bp7C,SAZa,SAAUsrD,GACvB,MAAO,IAAMA,EAAM3mC,OAAS,KAAO2mC,EAAM37B,MAAQ,SAAW27B,EAAM1mC,QAAU,KAAO0mC,EAAMtK,SAAW,MAsBlG2K,GAAU,SAAU5K,GACtB,OAAOqK,GAAOr/C,GAAG,CACf4Y,KAAMo8B,EAAKp8B,KACXgL,IAAKoxB,EAAKpxB,IACV/K,MAAOm8B,EAAKn8B,MACZo8B,OAAQD,EAAKC,UAGb4K,GAAa,SAAUnC,EAAQ/iD,GACjC,OAAOjG,EAAON,KAAKspD,EAAOO,QAAQtjD,KAoBhCmlD,GAlBW,SAAUpC,EAAQ/iD,EAASu7C,GACxC,OAAIh7C,GAAUP,GACLklD,GAAWnC,EAAQ/iD,GAASnH,IAAIosD,IAC9BzkD,GAAOR,GAtBA,SAAU+iD,EAAQ/iD,EAASu7C,GAC7C,OAAIA,GAAU,GAAKA,EAAS1mC,GAAO7U,GAC1B+iD,EAAOqC,cAAcplD,EAASu7C,EAAQv7C,EAASu7C,EAAS,GACtDA,EAAS,EACXwH,EAAOqC,cAAcplD,EAASu7C,EAAS,EAAGv7C,EAASu7C,GAErDxhD,EAAO1C,OAiBLguD,CAActC,EAAQ/iD,EAASu7C,GAAQ1iD,IAAIosD,IAE3ClrD,EAAO1C,QAYd8tD,GATe,SAAUpC,EAAQ/iD,GACnC,OAAIO,GAAUP,GACLklD,GAAWnC,EAAQ/iD,GAASnH,IAAIosD,IAC9BzkD,GAAOR,GACT+iD,EAAOqC,cAAcplD,EAAS,EAAGA,EAAS6U,GAAO7U,IAAUnH,IAAIosD,IAE/DlrD,EAAO1C,QAUdiuD,GAAQzkC,GAAa,CACvB,CAAExpB,KAAM,IACR,CAAEkuD,MAAO,CAAC,YAKRC,GAAiB,SAAUzC,EAAQ/iD,EAAS4kD,GAC9C,OAtxNsBpiD,EAsxNPxC,EAtxNcsO,EAsxNL8uB,GAlxNjBtuB,GAHE,SAAU9W,EAAG8N,GACpB,OAAOA,EAAK9N,IAEe+W,GAAUvM,EAAO8L,EAAW5C,IAkxNX3T,KAAKvB,GAAS,GAAQ,SAAU2Z,GAC5E,OAAOg1C,GAAwBpC,EAAQ5yC,GAAMnX,OAAO,SAAU4mB,GAC5D,OANU,SAAUglC,EAAOhlC,GAC/B,OAAOglC,EAAM3mC,OAAS2B,EAAI3B,QAAU9L,KAAKmc,IAAI1O,EAAI1B,QAAU0mC,EAAM3mC,QAAU,GAAK2mC,EAAM3mC,OAAS2B,EAAI1B,QAKxFunC,CAAUb,EAAOhlC,OAxxNhB,IAAUpd,EAAO8L,EAAW5C,GAozNtCg6C,GAAa,CACfnD,MAAOmC,GAAOj6B,OACdk7B,SAda,SAAU5C,EAAQ/iD,EAAS4lD,EAAUpwC,EAAUovC,GAC5D,IAAIiB,EAAcnB,GAAOC,OAAOC,EA7BlB,GA8Bd,OAAIzyC,KAAKmc,IAAIs3B,EAAS38B,MAAQzT,EAASyT,OAAS,EACvCq8B,GAAMC,MAAMM,GACVD,EAAStL,SAAWsK,EAAM37B,MAC5Bq8B,GAAMC,MAAMM,GACVD,EAAStL,WAAasK,EAAM37B,MAC9Bq8B,GAAMC,MAAMb,GAAOC,OAAOC,EAAO,IAEjCY,GAAezC,EAAQ/iD,EAAS4kD,GAASU,GAAMC,MAAMb,GAAOx7B,UAAU28B,EArCjE,EAqCyF,IAAMP,GAAMjuD,QAMnHm7C,KAAMkS,GAAOC,OACbX,OAAQ7B,IAEN2D,GAAe,CACjBvD,MAAOmC,GAAOM,UACdW,SAhCe,SAAU5C,EAAQ/iD,EAAS4lD,EAAUpwC,EAAUovC,GAC9D,IAAImB,EAAarB,GAAOG,SAASD,EAjBnB,GAkBd,OAAIzyC,KAAKmc,IAAIs3B,EAAStL,SAAW9kC,EAAS8kC,UAAY,EAC7CgL,GAAMC,MAAMQ,GACVH,EAAS38B,MAAQ27B,EAAMtK,SACzBgL,GAAMC,MAAMQ,GACVH,EAAS38B,QAAU27B,EAAMtK,SAC3BgL,GAAMC,MAAMb,GAAOG,SAASD,EAAO,IAEnCY,GAAezC,EAAQ/iD,EAAS4kD,GAASU,GAAMC,MAAMb,GAAOx7B,UAAU68B,EAzBjE,EAyBwF,IAAMT,GAAMjuD,QAwBlHm7C,KAAMkS,GAAOG,SACbb,OAAQ3B,IAUN2D,GAAY,SAAUjD,EAAQnP,EAAUp+B,EAAUovC,EAAOqB,GAC3D,OAAmB,IAAfA,EACKlsD,EAAON,KAAKmrD,GAVP,SAAU7B,EAAQrsD,EAAG4M,GACnC,OAAOy/C,EAAOv/C,iBAAiB9M,EAAG4M,GAAGpK,OAAO,SAAU2W,GACpD,MAAqB,UAAdhV,GAAKgV,KACX3X,SASCguD,CAAUnD,EAAQ6B,EAAM3mC,OAAQ21B,EAAS2O,MAAMqC,IAPhC,SAAU7B,EAAQnP,EAAUp+B,EAAUovC,EAAOqB,GAChE,OAAOD,GAAUjD,EAAQnP,EAAUp+B,EAAUo+B,EAASpB,KAAKoS,EA1D7C,GA0DgEqB,GAOrEE,CAAepD,EAAQnP,EAAUp+B,EAAUovC,EAAOqB,EAAa,GAEjElD,EAAOqD,eAAexB,EAAM3mC,OAAQ21B,EAAS2O,MAAMqC,IAAQ7rD,KAAK,SAAUstD,GAC/E,OAAOA,EAAM3kD,QAAQ3J,KAAKgC,EAAO1C,KAAM,SAAU2I,GAC/C,OAAOmlD,GAAwBpC,EAAQ/iD,GAASjH,KAAK,SAAU6sD,GAC7D,OAAOhS,EAAS+R,SAAS5C,EAAQ/iD,EAAS4lD,EAAUpwC,EAAUovC,GAAO7sD,KAAKgC,EAAO1C,KAAM,SAAUivD,GAC/F,OAAON,GAAUjD,EAAQnP,EAAUp+B,EAAU8wC,EAAUL,EAAa,OAErErtD,QAAQ,WACT,OAAOmB,EAAON,KAAKmrD,MAEpB7qD,EAAO1C,SAkBVkuD,GAAQ,SAAU3R,EAAUmP,EAAQ6B,GACtC,IAAI2B,EAAQ3S,EAASpB,KAAKoS,EA/FZ,GAgGV4B,EAAWR,GAAUjD,EAAQnP,EAAUgR,EAAO2B,EA/FlC,KA+FsDpuD,MAAMouD,GAC5E,OAZgB,SAAU3S,EAAU4S,EAAUzD,GAC9C,OAAInP,EAAS2O,MAAMiE,GAAYzD,EAAO0D,iBAC7B1sD,EAAON,KAAKm6C,EAAS2O,MAAMiE,GAAYzD,EAAO0D,kBAC5C7S,EAAS2O,MAAMiE,GAAY,EAC7BzsD,EAAON,MAAMm6C,EAAS2O,MAAMiE,IAE5BzsD,EAAO1C,OAMTqvD,CAAY9S,EAAU4S,EAAUzD,GAAQhrD,KAAK,WAClD,OAAOgrD,EAAOqD,eAAeI,EAASvoC,OAAQ21B,EAAS2O,MAAMiE,KAC5D,SAAUr7B,GAEX,OADA43B,EAAO4D,SAAS,EAAGx7B,GACZ43B,EAAOqD,eAAeI,EAASvoC,OAAQ21B,EAAS2O,MAAMiE,GAAYr7B,MAGzEy7B,GAAU,CACZC,MAAOlwD,EAAM4uD,GAAOG,IACpBoB,QAASnwD,EAAM4uD,GAAOO,IACtBiB,QAzBY,SAAUhE,EAAQ6B,GAC9B,OAAO7B,EAAOqD,eAAexB,EAAM3mC,OAAQ2mC,EAAM37B,MAnFnC,IA4Gd+9B,UA7Bc,SAAUjE,EAAQ6B,GAChC,OAAO7B,EAAOqD,eAAexB,EAAM3mC,OAAQ2mC,EAAMtK,SAhFnC,IA6Gd2M,YAAazwD,EA7GC,IAiHZ0wD,GAAa38C,KAYb48C,GAAO,SAAUpE,EAAQr3C,EAAQ1L,EAASu7C,EAAQnoB,EAAW6yB,GAC/D,OAAmB,IAAfA,EACKlsD,EAAO1C,OAET+vD,GAAUrE,EAAQr3C,EAAQ1L,EAASu7C,EAAQnoB,GAAWr6B,KAAK,SAAUsuD,GAC1E,IAAIp5B,EAAQ80B,EAAOuE,UAAUD,GACzB7C,EAAW3B,GAAYC,OAAOC,EAAQ/iD,EAASu7C,EAAQttB,EAAMlV,SAAUkV,EAAMmrB,UAAWhmB,EAAU8vB,QAASx3C,GAC/G,OAAOm3C,GAAYhhC,KAAK2iC,EAAU,WAChC,OAAOzqD,EAAO1C,QACb,WACD,OAAO0C,EAAON,KAAK4tD,IAClB,SAAUl3C,GACX,OAAI5Y,GAAGyI,EAASmQ,IAAoB,IAAXorC,EAChBgM,GAASxE,EAAQ/iD,EAASu7C,EAAQmJ,GAAOC,OAAQvxB,GAEjD+zB,GAAKpE,EAAQr3C,EAAQyE,EAAM,EAAGijB,EAAW6yB,EAAa,IAE9D,SAAU91C,GACX,OAAI5Y,GAAGyI,EAASmQ,IAASorC,IAAW1mC,GAAO1E,GAClCo3C,GAASxE,EAAQ/iD,EAASu7C,EAAQmJ,GAAOG,SAAUzxB,GAEnD+zB,GAAKpE,EAAQr3C,EAAQyE,EAAM0E,GAAO1E,GAAOijB,EAAW6yB,EAAa,QAK5EsB,GAAW,SAAUxE,EAAQ/iD,EAASu7C,EAAQ/I,EAAMpf,GACtD,OAAO+xB,GAAoBpC,EAAQ/iD,EAASu7C,GAAQxiD,KAAK,SAAU6mB,GACjE,OAAO4nC,GAAMzE,EAAQ3vB,EAAWof,EAAK5yB,EAAKgnC,GAAQK,mBAGlDO,GAAQ,SAAUzE,EAAQ3vB,EAAWxT,GACvC,OAAIsnC,GAAWr+C,QAAQpC,YAAcygD,GAAWr+C,QAAQhC,YAAcqgD,GAAWr+C,QAAQjC,aAAesgD,GAAWr+C,QAAQrC,SAClH4sB,EAAUq0B,WAAW1E,EAAQnjC,GAC3BsnC,GAAWr+C,QAAQnC,OACrB0sB,EAAUs0B,QAAQ3E,EAAQnjC,GAE1B7lB,EAAO1C,QAGd+vD,GAAY,SAAUrE,EAAQr3C,EAAQ1L,EAASu7C,EAAQnoB,GACzD,OAAO+xB,GAAoBpC,EAAQ/iD,EAASu7C,GAAQxiD,KAAK,SAAU6mB,GACjE,OAAO4nC,GAAMzE,EAAQ3vB,EAAWxT,MAQhC+nC,GALW,SAAU5E,EAAQr3C,EAAQ0nB,GACvC,OAzDa,SAAU2vB,EAAQr3C,EAAQ0nB,GACvC,OAAO2vB,EAAOrF,eAAe3kD,KAAK,SAAUmmD,GAC1C,OAAOmF,GAAa34C,EAAQwzC,EAAInmC,SAAUmmC,EAAI9F,UAAWhmB,GAAWr7B,KAAK,WACvE,OAAOgC,EAAON,KAAK8oD,GAAMrD,EAAInmC,SAAUmmC,EAAI9F,aAC1C,SAAUwO,GACX,IAAI35B,EAAQ80B,EAAOuE,UAAUM,GACzBpD,EAAW3B,GAAYC,OAAOC,EAAQ7D,EAAInmC,SAAUmmC,EAAI9F,UAAWnrB,EAAMlV,SAAUkV,EAAMmrB,UAAWhmB,EAAU8vB,QAASx3C,GAC3H,OAAO24C,GAAeG,OAkDnBqD,CAAS9E,EAAQr3C,EAAQ0nB,GAAWr6B,KAAK,SAAU+uD,GACxD,OAAOX,GAAKpE,EAAQr3C,EAAQo8C,EAAK9nD,UAAW8nD,EAAKvM,SAAUnoB,EA5D7C,IA4DqEv6B,IAAIkqD,EAAOuE,cAK9FS,GAAYx9C,KACZy9C,GAAc,SAAUr9C,EAAM2F,GAChC,OAvZOvB,GAuZWpE,EAAM,SAAUsC,GAChC,OAAOzB,GAAOyB,GAAGjU,OAAO,SAAUkM,GAChC,OAAO3N,GAAG2N,EAAGoL,MAzZiB5E,GAAQxT,SAD3B,IAA4BwT,GA8ZzCu8C,GAAW,SAAUlF,EAAQr3C,EAAQ0nB,EAAW39B,EAAS6oD,GAC3D,OAAO/uC,GAAU9Z,EAAS,QAASiW,GAAQ3S,KAAK,SAAU2I,GACxD,OAAO6N,GAAU7N,EAAO,QAASgK,GAAQ3S,KAAK,SAAUuX,GACtD,OAAK03C,GAAY1J,EAAQhuC,GAGlBq3C,GAAiB5E,EAAQr3C,EAAQ0nB,GAAWr6B,KAAK,SAAUk1B,GAChE,OAAO1e,GAAU0e,EAAMlV,SAAU,QAASrN,GAAQ7S,IAAI,SAAUkgB,GAC9D,MAAO,CACLrX,MAAOlL,EAASkL,GAChBqX,OAAQviB,EAASuiB,GACjBkV,MAAOz3B,EAASy3B,QAPbl0B,EAAO1C,YAgElB6wD,GAlDW,SAAUnF,EAAQr3C,EAAQ0nB,EAAW39B,EAAS6oD,EAAQ6J,GACnE,OAAIJ,GAAUl/C,QAAQnC,OACb3M,EAAO1C,OAEP8wD,EAAS1yD,EAASiW,GAAQ9S,QAAQ,WACvC,OAAOqvD,GAASlF,EAAQr3C,EAAQ0nB,EAAW39B,EAAS6oD,GAAQzlD,IAAI,SAAUyN,GACxE,IAAI2nB,EAAQ3nB,EAAK2nB,QACjB,OAAOmyB,GAAS3lC,OAAO1gB,EAAON,KAAK6mD,GAAKE,UAAUvyB,EAAMvsB,QAASusB,EAAMkrB,UAAWlrB,EAAMlV,SAAUkV,EAAMmrB,aAAa,QA2CzH8O,GALS,SAAUnF,EAAQrkC,EAAWhT,EAAQ0nB,EAAW39B,EAAS6oD,EAAQoC,GAC5E,OAAOuH,GAASlF,EAAQr3C,EAAQ0nB,EAAW39B,EAAS6oD,GAAQvlD,KAAK,SAAUuN,GACzE,OAAOs6C,GAAan7C,OAAOiZ,EAAWhT,EAAQpF,EAAK5E,QAAS4E,EAAKyS,SAAU2nC,MAG3EwH,GAtCe,SAAUzyD,EAASiW,GACpC,OAAO6D,GAAU9Z,EAAS,KAAMiW,GAAQ3S,KAAK,SAAU8a,GACrD,OAAOtE,GAAUsE,EAAU,QAASnI,GAAQ3S,KAAK,SAAUuX,GACzD,IAAIE,EAAO7B,GAAc2B,EAAO,MAChC,OAAI/Y,GAAGsc,EAAUrD,EAAK,IAvcX,SAAUxQ,EAASsO,EAAW5C,GAC7C,OAAOs2C,GAASE,GAAYliD,EAASsO,EAAW5C,GAucnC08C,CAAW93C,EAAO,SAAUtQ,GACjC,OAAOqV,GAAOrV,GAAS9H,UACtBwT,GAAQ7S,IAAI,SAAUse,GACvB,IAAIkxC,EAAaxzC,GAAOsC,GACxB,OAAOipC,GAAS3lC,OAAO1gB,EAAON,KAAK6mD,GAAKE,UAAUrpC,EAAMkxC,EAAYlxC,EAAMkxC,KAAc,KAGnFtuD,EAAO1C,YA0BlB6wD,GArBgB,SAAUzyD,EAASiW,GACrC,OAAO6D,GAAU9Z,EAAS,KAAMiW,GAAQ3S,KAAK,SAAU8a,GACrD,OAAOtE,GAAUsE,EAAU,QAASnI,GAAQ3S,KAAK,SAAUuX,GACzD,IAAIE,EAAO7B,GAAc2B,EAAO,MAChC,OAAI/Y,GAAGsc,EAAUrD,EAAKA,EAAKla,OAAS,IArdxB,SAAU0J,EAASsO,EAAW5C,GAC9C,OAAOu2C,GAAUC,GAAYliD,EAASsO,EAAW5C,GAqdpC48C,CAAYh4C,EAAO,SAAUtQ,GAClC,OAAOiV,GAAMjV,GAAS9H,UACrBwT,GAAQ7S,IAAI,SAAUoc,GACvB,OAAOmrC,GAAS3lC,OAAO1gB,EAAON,KAAK6mD,GAAKE,UAAUvrC,EAAO,EAAGA,EAAO,KAAK,KAGnElb,EAAO1C,YAiBlBkxD,GAAW,SAAUr/C,EAAQwC,GAC/B,OAAO6D,GAAUrG,EAAQ,QAASwC,IAmCpC,IAgBI88C,GAAe,CACjBvuC,KAjBS,CACTgnC,SAAUj1C,GACVg4C,OAAQ3B,GACRvJ,SAAUP,GAAKlsC,OACfo7C,WAAYb,GAAQE,QACpBY,QAASd,GAAQI,UACjB9D,QAASL,GAAYF,YAYrB5oC,GAVO,CACPknC,SAAUn1C,GACVk4C,OAAQ7B,GACRrJ,SAAUP,GAAKlsC,OACfo7C,WAAYb,GAAQC,MACpBa,QAASd,GAAQG,QACjB7D,QAASL,GAAYH,WAOnB+F,GAAQ,SAAUrrD,GACpB,OAAO,SAAUsrD,GACf,OAAOA,IAAYtrD,IAGnBurD,GAAOF,GAAM,IACbG,GAASH,GAAM,IAIfI,GAAgB,CAClBr9B,IAAK,CACHs9B,WAAYL,GAAM,IAClBM,UAAWN,GAAM,KAEnBn9B,IAAK,CACHw9B,WAAYL,GAAM,IAClBM,UAAWN,GAAM,KAEnBE,KAAMA,GACNC,OAAQA,GACRI,aAdiB,SAAUN,GAC3B,OAAOA,GAAW,IAAMA,GAAW,KA0BjCO,GAVQ,SAAUC,GACpB,MAAO,CACLjrC,KAAMirC,EAAGjrC,OACTgL,IAAKigC,EAAGjgC,MACR/K,MAAOgrC,EAAGhrC,QACVo8B,OAAQ4O,EAAG5O,SACX9yB,MAAO0hC,EAAG1hC,QACVpC,OAAQ8jC,EAAG9jC,WAkBX+jC,IAbW5+C,KAAW1B,QAAQhC,WAaf,SAAUyiB,GA+C3B,MAAO,CACL9lB,iBA/CqB,SAAU9M,EAAG4M,GAClC,OAAOjB,GAAQe,UAAUf,GAAQF,QAAQmnB,EAAI5mB,UAAWhM,EAAG4M,IA+C3DggD,QA7CY,SAAUtjD,GACtB,OAAOA,EAAQC,MAAMklB,yBA6CrBigC,cA3CkB,SAAU1jD,EAAOy3C,EAASpgC,EAAQqgC,GACpD,IAAI8F,EAAMlG,GAAUD,MAAMr3C,EAAOy3C,EAASpgC,EAAQqgC,GAClD,OAAOgG,GAAe91B,EAAK41B,GAAKrmD,IAAIowD,KA0CpCvL,aAxCiB,WACjB,OAAOuB,GAAM31B,GAAKzwB,IAAI,SAAUuwD,GAC9B,OAAO9I,GAAKC,eAAej3B,EAAK8/B,MAuClC9B,UApCc,SAAUD,GACxB,IAAIvO,EAAWE,GAAUF,SAASuO,EAAM3lD,QAAS2lD,EAAMtuC,UACvD,OAAOunC,GAAKC,eAAej3B,EAAKwvB,IAmChCsN,eAjCmB,SAAU1vD,EAAG4M,GAChC,OAAOg8C,GAAWh2B,EAAK5yB,EAAG4M,GAAGzK,IAAI,SAAUkgD,GACzC,OAAOsH,GAAatH,EAAMr3C,QAASq3C,EAAMI,UAAWJ,EAAMhgC,SAAUggC,EAAMK,cAgC5EiQ,eA7BmB,YAn3BX,SAAU//B,GACJA,EAAIo0B,eACVC,kBAk3BRp5B,CAAM+E,IA6BNggC,aAxBiB,SAAUpK,IA/6BhB,SAAU51B,EAAK5nB,EAAOy3C,EAASpgC,EAAQqgC,GACpD,IAAIN,EAAWuE,GAAgB37C,EAAOy3C,EAASpgC,EAAQqgC,GACvD0E,GAAqBx0B,EAAKwvB,GA86BxByQ,CAASjgC,EAAK41B,EAAIx9C,QAASw9C,EAAI/F,UAAW+F,EAAInmC,SAAUmmC,EAAI9F,YAwB5DoQ,qBAtByB,SAAU9nD,EAAOqX,IA96B5B,SAAUuQ,EAAKiwB,EAAWC,GAC1C,IAAIV,EAAWsE,GAAmB7D,EAAWC,GAC7CsE,GAAqBx0B,EAAKwvB,GA66BxB2Q,CAAYngC,EAAK5nB,EAAOqX,IAsBxB2wC,eA7BmB,SAAU1pD,GAC7Bg/C,GAAa11B,EAAKtpB,IA6BlBymD,eArBmB,WACnB,OAAOn9B,EAAIqgC,aAqBXC,WAnBe,WACf,IArDkBC,EAChBtmD,EACA7M,EACA4M,EAmDF,OAtDkBumD,EAqDFxnD,GAAQF,QAAQmnB,EAAI5mB,UApDlCa,OAAe7K,IAATmxD,EAAqBA,EAAK5pD,MAAQ1K,EAAWmN,SACnDhM,EAAI6M,EAAIK,KAAKimB,YAActmB,EAAIimB,gBAAgBK,WAC/CvmB,EAAIC,EAAIK,KAAK+lB,WAAapmB,EAAIimB,gBAAgBG,UAC3CR,GAASzyB,EAAG4M,IAkDN2lB,OAkBX09B,SAhBa,SAAUjwD,EAAG4M,IAlDrB,SAAU5M,EAAG4M,EAAGumD,SACJnxD,IAATmxD,EAAqBA,EAAK5pD,MAAQ1K,EAAWmN,UACzC6mB,YACVo9B,SAASjwD,EAAG4M,GAgDdwmD,CAAGpzD,EAAG4M,EAAGjB,GAAQF,QAAQmnB,EAAI5mB,eAmB7BqnD,GAAKzsD,EAAU,OAAQ,QA4FvB0sD,GAAaz/C,KAgBb0/C,GAAgB,CAClBC,MA5GU,SAAU5gC,EAAK5K,EAAWhT,EAAQo1C,GAC5C,IACI/Q,EA1KN,SAAyBgT,EAAQrkC,EAAWhT,EAAQo1C,GAClD,IAAIvtB,EAASx5B,EAAO1C,OAChB8yD,EAAa,WACf52B,EAASx5B,EAAO1C,QAuBlB,MAAO,CACLo+C,UAtBc,SAAUtF,GACxB2Q,EAAYv8B,MAAM7F,GAClB6U,EAASg1B,GAASpY,EAAMjnC,SAAUwC,IAqBlCkqC,UAnBc,SAAUzF,GACxB5c,EAAOz6B,KAAK,SAAU4I,GACpBo/C,EAAYE,kBAAkBtiC,GAC9B6pC,GAASpY,EAAMjnC,SAAUwC,GAAQ5S,KAAK,SAAUigB,GAC9CuG,GAAcX,SAASjd,EAAOqX,EAAQrN,GAAQ5S,KAAK,SAAU6nD,GAC3D,IAAI7hC,EAAQ6hC,EAAQ7hC,QAAQ3mB,MAAM,KAC9B2mB,EAAMxoB,OAAS,GAAsB,IAAjBwoB,EAAMxoB,SAAiBiB,GAAGmK,EAAOqX,MACvD+nC,EAAYJ,YAAYhiC,EAAWI,EAAO6hC,EAAQj/C,QAASi/C,EAAQ5nC,UACnEgqC,EAAO2G,eAAe3wC,WAY9BqxC,QANY,SAAUC,GACtB92B,EAAOz6B,KAAKqxD,KAkJCG,CADFnB,GAAa7/B,GACY5K,EAAWhT,EAAQo1C,GACzD,MAAO,CACLrL,UAAW1F,EAAS0F,UACpBG,UAAW7F,EAAS6F,UACpBwU,QAASra,EAASqa,UAuGpBG,SApGa,SAAUjhC,EAAK5K,EAAWhT,EAAQo1C,GAC/C,IAAIiC,EAASoG,GAAa7/B,GACtBkhC,EAAkB,WAEpB,OADA1J,EAAYv8B,MAAM7F,GACX3kB,EAAO1C,QAyEhB,MAAO,CACLozD,QAxEY,SAAUta,EAAOzuC,EAAOy3C,EAASpgC,EAAQqgC,EAAShmB,GAC9D,IAAIs3B,EAAYva,EAAM3rC,MAClBkkD,EAAUgC,EAAUC,MACpBxK,GAAkC,IAAvBuK,EAAUvK,SAmDzB,OAlDc7gC,GAAcC,SAASb,EAAWoiC,EAAY3tC,oBAAoBpb,KAAK,WACnF,OAAI8wD,GAAcD,OAAOF,IAAYvI,EAC5BxpD,EAAMuxD,GAAyBnF,EAAQrkC,EAAWhT,EAAQ88C,GAAavuC,KAAMlB,EAAQrX,EAAOo/C,EAAYJ,aACtGmI,GAAcF,KAAKD,IAAYvI,EACjCxpD,EAAMuxD,GAAyBnF,EAAQrkC,EAAWhT,EAAQ88C,GAAazuC,GAAIhB,EAAQrX,EAAOo/C,EAAYJ,aACpGmI,GAAcD,OAAOF,GACvB/xD,EAAMuxD,GAA2BnF,EAAQr3C,EAAQ88C,GAAavuC,KAAMlB,EAAQrX,EAAOwmD,IACjFW,GAAcF,KAAKD,GACrB/xD,EAAMuxD,GAA2BnF,EAAQr3C,EAAQ88C,GAAazuC,GAAIhB,EAAQrX,EAAOwmD,IAEjFnuD,EAAO1C,MAEf,SAAUmpB,GACX,IAAIwyB,EAAS,SAAU4X,GACrB,OAAO,WAIL,OAHiB1+B,GAAQ0+B,EAAU,SAAUz/B,GAC3C,OAAOy1B,GAAa5N,OAAO7nB,EAAM3a,OAAQ2a,EAAMta,OAAQ6N,EAAW8B,EAAUsgC,KAE5D/oD,KAAK,WACrB,OAAOunB,GAAcU,SAAStB,EAAWoiC,EAAYphC,wBAAyBohC,EAAYnhC,wBAAwB9mB,IAAI,SAAUsnB,GAC9H,IAAI24B,EAAW+P,GAAcD,OAAOF,IAAYt1B,EAAU21B,UAAUL,GAAWnQ,GAAK/rC,MAAQ+rC,GAAKlsC,OAGjG,OAFA02C,EAAOyG,qBAAqBjR,GAAKn1B,GAAGjD,EAAMlL,QAAS,GAAI6jC,EAAS34B,EAAM7P,UACtEwwC,EAAYv8B,MAAM7F,GACX0hC,GAAS3lC,OAAO1gB,EAAO1C,QAAQ,MAEvC,SAAU28B,GACX,OAAOj6B,EAAON,KAAK2mD,GAAS3lC,OAAO1gB,EAAO1C,QAAQ,QAIxD,OAAIwxD,GAAcD,OAAOF,IAAYvI,EAC5BnN,EAAO,CAAC+W,GAAG,EAAI,KACblB,GAAcF,KAAKD,IAAYvI,EACjCnN,EAAO,CAAC+W,IAAI,EAAG,KACb32B,EAAU01B,WAAWJ,IAAYvI,EACnCnN,EAAO,CACZ+W,GAAG,GAAI,GACPA,IAAI,EAAG,KAEA32B,EAAU21B,UAAUL,IAAYvI,EAClCnN,EAAO,CACZ+W,GAAG,EAAG,GACNA,GAAG,EAAI,KAEAlB,GAAcG,aAAaN,KAAyB,IAAbvI,EACzCqK,EAEAzwD,EAAO1C,MAGX24C,IAmBP6a,MAjBU,SAAU1a,EAAOzuC,EAAOy3C,EAASpgC,EAAQqgC,GACnD,OAAO95B,GAAcC,SAASb,EAAWoiC,EAAY3tC,oBAAoBpb,KAAK,WAC5E,IAAI2yD,EAAYva,EAAM3rC,MAClBkkD,EAAUgC,EAAUC,MAExB,OAAiB,KADqB,IAAvBD,EAAUvK,UAEhBpmD,EAAO1C,OAEZwxD,GAAcG,aAAaN,GACtB9H,GAAaC,KAAKniC,EAAWhT,EAAQhK,EAAOy3C,EAASpgC,EAAQqgC,EAAS0H,EAAYJ,aAElF3mD,EAAO1C,QAEf0C,EAAO1C,SA0BZyzD,SAlBa,SAAUxhC,EAAK5K,EAAWhT,EAAQo1C,GAC/C,IAAIiC,EAASoG,GAAa7/B,GAC1B,OAAO,SAAU5nB,EAAOqX,GACtB+nC,EAAYE,kBAAkBtiC,GAC9BY,GAAcX,SAASjd,EAAOqX,EAAQrN,GAAQ5S,KAAK,SAAU6nD,GAC3D,IAAI7hC,EAAQ6hC,EAAQ7hC,QAAQ3mB,MAAM,IAClC2oD,EAAYJ,YAAYhiC,EAAWI,EAAO6hC,EAAQj/C,QAASi/C,EAAQ5nC,UAC/DixC,GAAWzgD,WAAWI,UACxBo5C,EAAOsG,iBAEPtG,EAAO2G,eAAe3wC,QAW1BgyC,GAAW,SAAU/qD,EAASknC,GAChCpuC,EAAKouC,EAAS,SAAUxwC,IA3/KX,SAAUsJ,EAASytB,GAC5BH,GAASttB,GACKA,EAAQC,MAAMstB,UACpBpsB,OAAOssB,GAEjBE,GAAS3tB,EAASytB,GAEpBK,GAAW9tB,GAq/KTgrD,CAAShrD,EAAStJ,MA0ElBu0D,GAAsB,CACxBC,QA5DY,SAAUC,GACtB,IAZuB19B,EAKKyZ,EAOxBkkB,GAZmB39B,EAYU09B,EAAS3qC,WAXnC,SAAUxgB,GACf6tB,GAAM7tB,EAASytB,KAWb49B,GARwBnkB,EAQe,CACzCikB,EAAS3qC,WACT2qC,EAASvqC,eACTuqC,EAASxqC,iBAVJ,SAAU3gB,GACf+qD,GAAS/qD,EAASknC,KAWhB3iB,EAAQ,SAAU7F,GACpB,IAAIc,EAAO7Q,GAAc+P,EAAWysC,EAASh4C,oBAC7Cra,EAAK0mB,EAAM6rC,IAQb,MAAO,CACLrK,kBAAmBz8B,EACnBA,MAAOA,EACPm8B,YATgB,SAAUhiC,EAAWrO,EAAO3O,EAAOqX,GACnDwL,EAAM7F,GACN5lB,EAAKuX,EAAO+6C,GACZv9B,GAAMnsB,EAAOypD,EAASxqC,iBACtBkN,GAAM9U,EAAQoyC,EAASvqC,iBAMvBzN,iBAAkBg4C,EAASh4C,iBAC3BuM,sBAAuByrC,EAASzrC,sBAChCC,qBAAsBwrC,EAASxrC,uBAsCjC2rC,OAnCW,SAAUH,EAAUI,EAAaC,GAC5C,IAAIC,EAA4B,SAAUzrD,GACxCmB,GAAOnB,EAASmrD,EAAS3qC,YACzBrf,GAAOnB,EAASmrD,EAASxqC,iBACzBxf,GAAOnB,EAASmrD,EAASvqC,iBAEvB8qC,EAAwB,SAAU1rD,GACpCpK,GAAIoK,EAASmrD,EAAS3qC,WAAY,MAEhC+D,EAAQ,SAAU7F,GACpBsiC,EAAkBtiC,GAClB8sC,KAEExK,EAAoB,SAAUtiC,GAChC,IAAIc,EAAO7Q,GAAc+P,EAAWysC,EAASh4C,oBAC7Cra,EAAK0mB,EAAMisC,IASb,MAAO,CACLzK,kBAAmBA,EACnBz8B,MAAOA,EACPm8B,YAVgB,SAAUhiC,EAAWrO,EAAO3O,EAAOqX,GACnDwL,EAAM7F,GACN5lB,EAAKuX,EAAOq7C,GACZ91D,GAAI8L,EAAOypD,EAASxqC,gBAAiB,KACrC/qB,GAAImjB,EAAQoyC,EAASvqC,eAAgB,KACrC2qC,EAAYl7C,EAAO3O,EAAOqX,IAM1B5F,iBAAkBg4C,EAASh4C,iBAC3BuM,sBAAuByrC,EAASzrC,sBAChCC,qBAAsBwrC,EAASxrC,wBA0C/BgsC,GAAa,CAAEC,cAdC,SAAUt7C,EAAOpH,EAAQ4Z,GAC3C,IAAIpR,EAAOZ,GAAsBR,GAC7B+C,EAAQ7B,GAAUC,SAASC,GAE/B,OADcmiB,GAAQxgB,EAAOnK,GACdrQ,IAAI,SAAUoqC,GAC3B,IAAIv1B,EAAOykB,GAAmB9e,EAAOyP,GAAY,GAGjD,MAAO,CACL+oC,cA7BiB,SAAUn+C,EAAMu1B,EAAengB,GACpD,IAAIgpC,EAASp+C,EAAKpS,MAAM,EAAG2nC,EAAcA,EAAc3sC,OAAS,GAAGia,MAAQ,GACvEw7C,EAAYn5B,GAAak5B,EAAQhpC,GACrC,OAAO/pB,EAAKgzD,EAAW,SAAUn+C,GAC/B,IAAIo+C,EAAcp+C,EAAOyC,QAAQ/U,MAAM,EAAG2nC,EAAcA,EAAc3sC,OAAS,GAAG+a,SAAW,GAC7F,OAAOxY,EAAImzD,EAAa,SAAU77C,GAChC,OAAOA,EAAKnQ,cAoBMisD,CAAiBv+C,EAAMu1B,EAAengB,GAIxDopC,iBApBoB,SAAUx+C,EAAMu1B,EAAengB,GACvD,IAAIqpC,EAAWz+C,EAAKpS,MAAM2nC,EAAc,GAAG1yB,MAAQ0yB,EAAc,GAAGhyB,UAAY,EAAGvD,EAAKpX,QACpF81D,EAAcx5B,GAAau5B,EAAUrpC,GACzC,OAAO/pB,EAAKqzD,EAAa,SAAUx+C,GACjC,IAAIo+C,EAAcp+C,EAAOyC,QAAQ/U,MAAM2nC,EAAc,GAAG5xB,SAAW4xB,EAAc,GAAG/xB,UAAY,GAAItD,EAAOyC,QAAQ/Z,QACnH,OAAOuC,EAAImzD,EAAa,SAAU77C,GAChC,OAAOA,EAAKnQ,cAWSqsD,CAAoB3+C,EAAMu1B,EAAengB,QAShEwpC,GAAoB,SAAUr/C,GAChC,OAAyE,IAAlE+gB,GAAM3rB,GAAQF,QAAQ8K,EAAE/D,QAAS,8BAuL1C,IAAIqjD,GAAa,SAAUtpC,GAazB,MAAO,CAAEttB,IAZC,WACR,IAAIiO,EAAOw8B,GAAUnd,GACrB,OAAO/C,GAAwBtc,EAAM6c,GAAStN,oBAAoBpb,KAAK,WACrE,YAAoCW,IAAhCuqB,EAAOf,UAAU6B,WACZnC,GAAevqB,OAEfuqB,GAAeD,OAAOsB,EAAOf,YAErC,SAAU7R,GACX,OAAOuR,GAAeF,SAASrR,QAMjCm8C,GAAsB,SAAUvpC,EAAQd,GAC1C,IAAI+B,EAAU1uB,EAAKuE,EAAO1C,QACtBo1D,EAAiBj3D,EAAK,IACtBk3D,EAAc,WAChB,OAAOrf,GAA+BpqB,GAAQlqB,KAAK,SAAUi2C,GAE3D,OADY9+B,GAAYI,MAAM0+B,GACjBn2C,IAAI,SAAUyX,GACzB,MAA4B,YAAxBzV,GAAKm0C,GACAtsB,GAAajS,QAAQu+B,GAErBtsB,GAAaC,QAAQR,EAAY7R,EAAO0+B,QAKnD2d,EAAe,WACjBzoC,EAAQtuB,IAAIqM,GAAOyqD,EAAPzqD,IACZnJ,EAAK2zD,EAAe92D,MAAO,SAAUq6C,GACnC,OAAOA,OAGP4c,EAAU,SAAUr4C,EAAKs4C,GAC3B,IAAI7c,EAAU,WACZ,OAAO9rB,EAAQvuB,MAAMoC,KAAK,WACxBwc,EAAIu4C,aAAY,IACf,SAAU5oC,GACX3P,EAAIu4C,YAAYD,EAAW3oC,OAK/B,OAFA8rB,IACAyc,EAAe72D,IAAI62D,EAAe92D,MAAMqB,OAAO,CAACg5C,KACzC,WACLyc,EAAe72D,IAAIsD,EAAOuzD,EAAe92D,MAAO,SAAUovB,GACxD,OAAOA,IAAMirB,OAyBnB,OADA/sB,EAAOG,GAAG,aAAcupC,GACjB,CACLI,aAtBiB,SAAUx4C,GAC3B,OAAOq4C,EAAQr4C,EAAK,SAAUyf,GAC5B,OAAO,KAqBTg5B,iBAlBqB,SAAUz4C,GAC/B,OAAOq4C,EAAQr4C,EAAK,SAAU2P,GAC5B,MAAmC,YAA5BrpB,GAAKqpB,EAAQlkB,cAiBtBitD,iBAdqB,SAAU14C,GAC/B,OAAOq4C,EAAQr4C,EAAK,SAAU2P,GAC5B,OAAOA,EAAQ3B,WAAW9qB,YAa5By1D,mBAVuB,SAAU34C,GACjC,OAAOq4C,EAAQr4C,EAAK,SAAU2P,GAC5B,OAAOA,EAAQ1B,aAAa/qB,YAS9Bk1D,aAAcA,EACdzoC,QAAS,WACP,OAAOA,EAAQvuB,SAsIjBw3D,GAAU,CACZC,WAlIe,SAAUnqC,EAAQoqC,GACjCpqC,EAAOqqC,GAAGhd,SAASid,cAAc,QAAS,CACxCC,QAAS,QACTC,KAAM,QACNC,MAAO,SAAUC,GACf,OAAOA,EAAS,2DAGpB,IAAIC,EAAM,SAAUC,GAClB,OAAO,WACL,OAAO5qC,EAAO6qC,YAAYD,KAG9B5qC,EAAOqqC,GAAGhd,SAASyd,UAAU,aAAc,CACzCP,QAAS,mBACTQ,SAAUJ,EAAI,iBACdH,KAAM,QACNb,QAASS,EAAiBN,eAE5B9pC,EAAOqqC,GAAGhd,SAASyd,UAAU,cAAe,CAC1CP,QAAS,eACTQ,SAAUJ,EAAI,kBACdH,KAAM,qBACNb,QAASS,EAAiBN,eAE5B9pC,EAAOqqC,GAAGhd,SAASyd,UAAU,iBAAkB,CAC7CP,QAAS,kBACTQ,SAAUJ,EAAI,qBACdH,KAAM,wBACNb,QAASS,EAAiBL,mBAE5B/pC,EAAOqqC,GAAGhd,SAASyd,UAAU,kBAAmB,CAC9CP,QAAS,cACTQ,SAAUJ,EAAI,sBACdH,KAAM,oBACNb,QAASS,EAAiBJ,mBAE5BhqC,EAAOqqC,GAAGhd,SAASyd,UAAU,kBAAmB,CAC9CP,QAAS,aACTQ,SAAUJ,EAAI,sBACdH,KAAM,oBACNb,QAASS,EAAiBH,qBAE5BjqC,EAAOqqC,GAAGhd,SAASyd,UAAU,uBAAwB,CACnDP,QAAS,oBACTQ,SAAUJ,EAAI,2BACdH,KAAM,yBACNb,QAASS,EAAiBL,mBAE5B/pC,EAAOqqC,GAAGhd,SAASyd,UAAU,sBAAuB,CAClDP,QAAS,mBACTQ,SAAUJ,EAAI,0BACdH,KAAM,yBACNb,QAASS,EAAiBL,mBAE5B/pC,EAAOqqC,GAAGhd,SAASyd,UAAU,iBAAkB,CAC7CP,QAAS,aACTQ,SAAUJ,EAAI,qBACdH,KAAM,mBACNb,QAASS,EAAiBL,mBAE5B/pC,EAAOqqC,GAAGhd,SAASyd,UAAU,gBAAiB,CAC5CP,QAAS,iBACTQ,SAAUJ,EAAI,oBACdH,KAAM,uBACNb,QAASS,EAAiBL,mBAE5B/pC,EAAOqqC,GAAGhd,SAASyd,UAAU,uBAAwB,CACnDP,QAAS,uBACTQ,SAAUJ,EAAI,2BACdH,KAAM,6BACNb,QAASS,EAAiBL,mBAE5B/pC,EAAOqqC,GAAGhd,SAASyd,UAAU,sBAAuB,CAClDP,QAAS,sBACTQ,SAAUJ,EAAI,0BACdH,KAAM,4BACNb,QAASS,EAAiBL,mBAE5B/pC,EAAOqqC,GAAGhd,SAASyd,UAAU,iBAAkB,CAC7CP,QAAS,gBACTQ,SAAUJ,EAAI,qBACdH,KAAM,sBACNb,QAASS,EAAiBL,mBAE5B/pC,EAAOqqC,GAAGhd,SAASyd,UAAU,cAAe,CAC1CP,QAAS,UACTQ,SAAUJ,EAAI,kBACdH,KAAM,wBACNb,QAASS,EAAiBL,mBAE5B/pC,EAAOqqC,GAAGhd,SAASyd,UAAU,eAAgB,CAC3CP,QAAS,WACTQ,SAAUJ,EAAI,mBACdH,KAAM,wBACNb,QAASS,EAAiBL,mBAE5B/pC,EAAOqqC,GAAGhd,SAASyd,UAAU,sBAAuB,CAClDP,QAAS,mBACTQ,SAAUJ,EAAI,0BACdH,KAAM,wBACNb,QAASS,EAAiBL,mBAE5B/pC,EAAOqqC,GAAGhd,SAASyd,UAAU,qBAAsB,CACjDP,QAAS,kBACTQ,SAAUJ,EAAI,yBACdH,KAAM,wBACNb,QAASS,EAAiBL,mBAE5B/pC,EAAOqqC,GAAGhd,SAASyd,UAAU,oBAAqB,CAChDP,QAAS,eACTQ,SAAUJ,EAAI,kBACdH,KAAM,WAmBRQ,YAhBgB,SAAUhrC,GAC1B,IAGIirC,EAhrIW,SAAUjrC,GACzB,OAAOA,EAAOke,SAAS,gBApDC,8IAmuIVgtB,CAAWlrC,GACrBirC,EAAQ53D,OAAS,GACnB2sB,EAAOqqC,GAAGhd,SAAS8d,kBAAkB,QAAS,CAC5C9/C,UANU,SAAUgC,GACtB,OAAO2S,EAAOhjB,IAAIhI,GAAGqY,EAAO,UAAY2S,EAAOpf,UAAUlI,SAAS2U,IAMhEg1B,MAAO4oB,EACP1rD,MAAO,OACP4sB,SAAU,WA4MZi/B,GAAY,CAAEC,aAnMC,SAAUrrC,EAAQoqC,GACnC,IAAIO,EAAM,SAAUC,GAClB,OAAO,WACL,OAAO5qC,EAAO6qC,YAAYD,KAG1BU,EAAoB,SAAUC,GAChC,IAAIC,EAAUD,EAAGC,QAASC,EAAaF,EAAGE,WAC1CzrC,EAAOylB,YAAYC,SAAS,WAC1B8C,GAAmBxoB,EAAQyrC,EAAYD,KAEzCxrC,EAAO8pB,aAEL4hB,EAAkB,CACpBzrD,KAAM,mBACN0pD,QAASS,EAAiBN,aAC1BiB,SAAUJ,EAAI,kBAEZgB,EAAc,CAChB1rD,KAAM,eACNuqD,KAAM,qBACNb,QAASS,EAAiBN,aAC1BiB,SAAUJ,EAAI,mBAEZiB,EAAW,CACb,CACEt0D,KAAM,WACN2I,KAAM,oBACNuqD,KAAM,yBACNO,SAAUJ,EAAI,2BACdhB,QAASS,EAAiBL,kBAE5B,CACEzyD,KAAM,WACN2I,KAAM,mBACNuqD,KAAM,yBACNO,SAAUJ,EAAI,0BACdhB,QAASS,EAAiBL,kBAE5B,CACEzyD,KAAM,WACN2I,KAAM,aACNuqD,KAAM,mBACNO,SAAUJ,EAAI,qBACdhB,QAASS,EAAiBL,kBAE5B,CACEzyD,KAAM,WACN2I,KAAM,iBACNuqD,KAAM,uBACNO,SAAUJ,EAAI,oBACdhB,QAASS,EAAiBL,kBAE5B,CAAEzyD,KAAM,aACR,CACEA,KAAM,WACN2I,KAAM,UACN8qD,SAAUJ,EAAI,kBACdhB,QAASS,EAAiBL,kBAE5B,CACEzyD,KAAM,WACN2I,KAAM,WACN8qD,SAAUJ,EAAI,mBACdhB,QAASS,EAAiBL,kBAE5B,CACEzyD,KAAM,WACN2I,KAAM,mBACN8qD,SAAUJ,EAAI,0BACdhB,QAASS,EAAiBL,kBAE5B,CACEzyD,KAAM,WACN2I,KAAM,kBACN8qD,SAAUJ,EAAI,yBACdhB,QAASS,EAAiBL,mBAG1Bz8C,EAAM,CACRhW,KAAM,iBACN2I,KAAM,MACN4rD,gBAAiB,WACf,OAAOD,IAGPE,EAAc,CAChB,CACEx0D,KAAM,WACN2I,KAAM,uBACNuqD,KAAM,6BACNO,SAAUJ,EAAI,2BACdhB,QAASS,EAAiBL,kBAE5B,CACEzyD,KAAM,WACN2I,KAAM,sBACNuqD,KAAM,4BACNO,SAAUJ,EAAI,0BACdhB,QAASS,EAAiBL,kBAE5B,CACEzyD,KAAM,WACN2I,KAAM,gBACNuqD,KAAM,sBACNO,SAAUJ,EAAI,qBACdhB,QAASS,EAAiBL,mBAG1B37C,EAAS,CACX9W,KAAM,iBACN2I,KAAM,SACN4rD,gBAAiB,WACf,OAAOC,IAGPC,EAAY,CACd,CACEz0D,KAAM,WACN2I,KAAM,kBACNuqD,KAAM,wBACNO,SAAUJ,EAAI,qBACdhB,QAASS,EAAiBL,kBAE5B,CACEzyD,KAAM,WACN2I,KAAM,cACNuqD,KAAM,oBACNO,SAAUJ,EAAI,sBACdhB,QAASS,EAAiBJ,kBAE5B,CACE1yD,KAAM,WACN2I,KAAM,aACNuqD,KAAM,oBACNO,SAAUJ,EAAI,sBACdhB,QAASS,EAAiBH,qBAG1B/8C,EAAO,CACT5V,KAAM,iBACN2I,KAAM,OACN4rD,gBAAiB,WACf,OAAOE,IA8CX,OA3C6B,IAt2IZ,SAAU/rC,GAC3B,OAAOA,EAAOke,SAAS,cAAc,EAAM,WAq2IvC8tB,CAAahsC,GACfA,EAAOqqC,GAAGhd,SAAS4e,YAAY,cAAe,CAC5ChsD,KAAM,QACNuqD,KAAM,QACNO,SAAUJ,EAAI,oBAGhB3qC,EAAOqqC,GAAGhd,SAAS6e,kBAAkB,cAAe,CAClDjsD,KAAM,QACNuqD,KAAM,QACNqB,gBAAiB,WACf,MAAO,CAAC,CACJv0D,KAAM,gBACN60D,UAAW,cACXpB,SAAUO,OAKpBtrC,EAAOqqC,GAAGhd,SAAS4e,YAAY,oBAAqB,CAClDhsD,KAAM,eACNuqD,KAAM,QACNO,SAAUJ,EAAI,oBAEhB3qC,EAAOqqC,GAAGhd,SAAS4e,YAAY,aAAcP,GAC7C1rC,EAAOqqC,GAAGhd,SAAS4e,YAAY,cAAeN,GAC9C3rC,EAAOqqC,GAAGhd,SAAS6e,kBAAkB,MAAO5+C,GAC5C0S,EAAOqqC,GAAGhd,SAAS6e,kBAAkB,SAAU99C,GAC/C4R,EAAOqqC,GAAGhd,SAAS6e,kBAAkB,OAAQh/C,GAC7C8S,EAAOqqC,GAAGhd,SAAS+e,eAAe,QAAS,CACzCrc,OAAQ,WAEN,OADAqa,EAAiBV,eACVU,EAAiBnpC,UAAUnsB,KAAK,WACrC,MAAO,IACN,SAAUmsB,GACX,MAAgC,YAA5BrpB,GAAKqpB,EAAQlkB,WACR,yBAEA,gDAKR,CACL6uD,SAAUA,EACVE,YAAaA,EACbC,UAAWA,KAkBXM,GAAS,SAAUrsC,EAAQwqB,EAAe8hB,EAAelC,EAAkBmC,GAC7E,MAAO,CACLC,YAAa,SAAUj8C,EAAShD,GAC9B,OAAOi7B,GAAmBxoB,EAAQzP,EAAShD,IAE7Ck/C,iBAAkB,SAAUl/C,GAC1B,OAViB,SAAUA,EAAMi9B,GACrC,IAAIkiB,EAAY92D,EAAI2X,EAAMnO,GAAQF,SAClCsrC,EAAc73C,IAAImE,EAAOC,KAAK21D,IAQnBD,CAAiBl/C,EAAMi9B,IAEhCmiB,iBAAkB,WAChB,OAtBiB,SAAUniB,GAC/B,OAAOA,EAAc93C,MAAMoC,KAAK,aAE7B,SAAUyY,GACX,OAAO3X,EAAI2X,EAAM,SAAUD,GACzB,OAAOA,EAAItQ,UAiBJ2vD,CAAiBniB,IAE1B8hB,cAAeA,EACfC,UAAWA,EACXnC,iBAAkBA,IAItB,SAASwC,GAAO5sC,GACd,IAAId,EAAaoqC,GAAWtpC,GACxBoqC,EAAmBb,GAAoBvpC,EAAQd,GAC/CotC,EAAgB7Y,GAAiBzzB,GACjCE,EAxnBN,SAA0BF,EAAQ8zB,EAAYsW,GAC5C,IAAIyC,EAAgBtxD,EAAS,CAC3B,YACA,YACA,UACA,QACA,WACC,IACCuxC,EAAWh2C,EAAO1C,OAClBggB,EAAeuqB,GAAiB3e,GAehC69B,EAAcmK,GAAoBK,OAAO7qC,GAd3B,SAAUpQ,EAAO3O,EAAOqX,GACxCs0C,EAAiBnpC,UAAUprB,KAAK,SAAUorB,GACzBhU,GAAYI,MAAM5O,GACxB5I,KAAK,SAAUwX,GACtB,IAAI/M,EAAMlB,GAAQF,QAAQ8gB,EAAOgB,UAC7BnB,EAAa1M,GAAUC,eAAetgB,EAAMwN,EAAK8T,GACjD+qB,EAAaupB,GAAWC,cAAct7C,EAAO4T,EAASpB,GAC1Dqf,GAAyBlf,EAAQ5S,EAAO3O,EAAOqX,EAAQqpB,QAI/C,WACZC,GAAwBpf,KAyJ1B,OAtJAA,EAAOG,GAAG,OAAQ,SAAUnW,GAC1B,IAAIqc,EAAMrG,EAAOo2B,SACbz1C,EAAOw8B,GAAUnd,GACjBvX,EAASkT,GAAUqE,GAanB8sC,EAAgB9F,GAAcC,MAAM5gC,EAAK1lB,EAAM8H,EAAQo1C,GACvDkP,EAAc/F,GAAcM,SAASjhC,EAAK1lB,EAAM8H,EAAQo1C,GACxDgK,EAAWb,GAAca,SAASxhC,EAAK1lB,EAAM8H,EAAQo1C,GAIzD79B,EAAOG,GAAG,sBAAuB,SAAUnW,GACzC69C,EAAS79C,EAAEvL,MAAOuL,EAAE8L,UAEtB,IAwFMk3C,EACAC,EAzFFC,EAAiB,SAAUhgB,EAAOigB,IANpB,SAAUjgB,GAC1B,OAAgC,IAAzBA,EAAM3rC,MAAM27C,UAMdkQ,CAAYlgB,KAGbigB,EAASzf,QACXR,EAAMQ,OAERyf,EAASluC,YAAYppB,KAAK,SAAUw3D,GAClC,IAAIxX,EAAWE,GAAUF,SAASwX,EAAG5uD,QAAS4uD,EAAGv3C,UAC7CqL,EAAM82B,GAAW5xB,EAAKwvB,GAC1B71B,EAAOf,UAAUmC,OAAOD,OAGxBymC,EAAQ,SAAU1a,GACpB,IAAIogB,EAAeC,EAAUrgB,GAC7B,GAAIogB,EAAa/rD,MAAM27C,UAAY0I,GAAcG,aAAauH,EAAa/rD,MAAMmmD,OAAQ,CACvF,IAAIvmC,EAAMnB,EAAOf,UAAUm1B,SACvB31C,EAAQW,GAAQF,QAAQiiB,EAAIk1B,gBAC5B59B,EAAMrZ,GAAQF,QAAQiiB,EAAIs2B,cAC9BsV,EAAYnF,MAAM0F,EAAc7uD,EAAO0iB,EAAIq2B,YAAa/+B,EAAK0I,EAAIu2B,WAAW7hD,KAAK,SAAUs3D,GACzFD,EAAeI,EAAcH,OAI/B3F,EAAU,SAAUta,GACtB,IAAIogB,EAAeC,EAAUrgB,GAC7B4G,IAAaj+C,KAAK,SAAUwlC,GAC1BA,EAAOwX,aAET,IAAI1xB,EAAMnB,EAAOf,UAAUm1B,SACvBiC,EAAiBj3C,GAAQF,QAAQ8gB,EAAOf,UAAU6B,YAClDriB,EAAQW,GAAQF,QAAQiiB,EAAIk1B,gBAC5B59B,EAAMrZ,GAAQF,QAAQiiB,EAAIs2B,cAC1BtnB,EAAYwN,GAAUjV,YAAY2tB,GAAgBztB,QAAUg9B,GAAcv9B,IAAMu9B,GAAcr9B,IAClGwkC,EAAYvF,QAAQ8F,EAAc7uD,EAAO0iB,EAAIq2B,YAAa/+B,EAAK0I,EAAIu2B,UAAWvnB,GAAWt6B,KAAK,SAAUs3D,GACtGD,EAAeI,EAAcH,KAE/BrZ,IAAaj+C,KAAK,SAAUwlC,GAC1BA,EAAOyX,cAGP0a,EAAe,SAAUtgB,GAC3B,OAAOA,EAAMvzC,eAAe,MAAQuzC,EAAMvzC,eAAe,MAEvD4zD,EAAY,SAAUrgB,GACxB,IAAIjnC,EAAS7G,GAAQF,QAAQguC,EAAMjnC,QAC/ByC,EAAO,WACTwkC,EAAMM,mBAEJC,EAAU,WACZP,EAAM9sB,kBAEJstB,EAAO36C,EAAQ06C,EAAS/kC,GAC5B,MAAO,CACLzC,OAAQ1S,EAAS0S,GACjBxS,EAAGF,EAASi6D,EAAatgB,GAASA,EAAMz5C,EAAI,MAC5C4M,EAAG9M,EAASi6D,EAAatgB,GAASA,EAAM7sC,EAAI,MAC5CqI,KAAMA,EACN+kC,QAASA,EACTC,KAAMA,EACNnsC,IAAKhO,EAAS25C,KAGdugB,EAAc,SAAUlsD,GAC1B,OAAsB,IAAfA,EAAImsD,QAQTC,EAAY,SAAU3jD,GACpByjD,EAAYzjD,IAAMq/C,GAAkBr/C,IACtC8iD,EAActa,UAAU+a,EAAUvjD,KAGlC4jD,EAAY,SAAU5jD,GAXA,IAAUzI,OACd9L,KADc8L,EAYVyI,GAXhBk8B,SAGqB,IAAP,EAAd3kC,EAAI2kC,WAQkBmjB,GAAkBr/C,IAC9C8iD,EAAcna,UAAU4a,EAAUvjD,KAGlC6jD,EAAU,SAAU7jD,GAClByjD,EAAYzjD,IAAMq/C,GAAkBr/C,IACtC8iD,EAAc3F,QAAQoG,EAAUvjD,KAqBhC8jD,GAjBEd,EAAaz6D,EAAK6M,GAAQF,QAAQyB,IAClCssD,EAAgB16D,EAAK,GAclB,CAAEw7D,SAbM,SAAUx2D,GACvB,IAAI0O,EAAS7G,GAAQF,QAAQ3H,EAAE0O,QAC/B,GAAqB,OAAjBrO,GAAKqO,IAAqC,OAAjBrO,GAAKqO,GAAkB,CAClD,IAAI+nD,EAAKhB,EAAWt6D,MAChBu7D,EAAMhB,EAAcv6D,MACpB4B,GAAG05D,EAAI/nD,IAAW1O,EAAE22D,UAAYD,EAAM,MACxC12D,EAAE6oB,iBACFynC,EAAS5hD,EAAQA,IAGrB+mD,EAAWr6D,IAAIsT,GACfgnD,EAAct6D,IAAI4E,EAAE22D,cAKxBluC,EAAOG,GAAG,YAAawtC,GACvB3tC,EAAOG,GAAG,YAAaytC,GACvB5tC,EAAOG,GAAG,UAAW0tC,GACrB7tC,EAAOG,GAAG,WAAY2tC,EAAUC,UAChC/tC,EAAOG,GAAG,QAASynC,GACnB5nC,EAAOG,GAAG,UAAWqnC,GACrBxnC,EAAOG,GAAG,aArIU,WAClB,IAAI87B,EAAMj8B,EAAOf,UACbxgB,EAAQW,GAAQF,QAAQ+8C,EAAIn7B,YAC5BrI,EAAMrZ,GAAQF,QAAQ+8C,EAAIrqC,UACjBuJ,GAAU7B,UAAUrM,GAAYI,MAAO,CAClD5O,EACAga,IAEK3jB,KAAK,WACV+oD,EAAYv8B,MAAM3gB,IACjB7N,KA4HLg6C,EAAWh2C,EAAON,KAAKq2D,EAAc,CACnCra,UAAWmb,EACXhb,UAAWib,EACXzG,QAAS0G,EACTjG,MAAOA,EACPJ,QAASA,OAON,CACLlmC,MAAOu8B,EAAYv8B,MACnBoL,QANY,WACZogB,EAASj3C,KAAK,SAAUi3C,QA4cNqhB,CAAgBnuC,EAAQssC,EAAcxY,WAAYsW,GAClEnqC,EAAUof,GAAarf,EAAQssC,EAAchtB,UAC7CkL,EAAgBj4C,EAAKuE,EAAO1C,QAChCk2C,GAASC,iBAAiBvqB,EAAQC,EAASC,EAAehB,EAAYsrB,GACtE1qB,GAAUC,eAAeC,EAAQd,EAAYe,EAASC,GACtD,IAAIqsC,EAAYnB,GAAUC,aAAarrC,EAAQoqC,GAgB/C,OAfAF,GAAQC,WAAWnqC,EAAQoqC,GAC3BF,GAAQc,YAAYhrC,GACpBA,EAAOG,GAAG,UAAW,WACnBH,EAAOU,WAAW0tC,YAAY5wC,GAASE,iBACvCsC,EAAOU,WAAW0tC,YAAY5wC,GAASG,kBAErCygB,GAAiBpe,IACnBA,EAAOG,GAAG,UAAW,SAAUnW,GAC7B6yC,GAAW5O,OAAOjkC,EAAGgW,EAAQC,EAASqsC,EAAchtB,YAGxDtf,EAAOG,GAAG,SAAU,WAClBmsC,EAAc5/B,UACdxM,EAAcwM,YAET2/B,GAAOrsC,EAAQwqB,EAAe8hB,EAAelC,EAAkBmC,GAGtEv1D,EAAOyzB,IAAI,QAASmiC,IAzvS1B,CA8vSE/vD","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      var clone = function () {\n        return Cell(get());\n      };\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var noop = function () {\n    };\n    var compose = function (fa, fb) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return fa(fb.apply(null, args));\n      };\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    function curry(fn) {\n      var initialArgs = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        initialArgs[_i - 1] = arguments[_i];\n      }\n      return function () {\n        var restArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          restArgs[_i] = arguments[_i];\n        }\n        var all = initialArgs.concat(restArgs);\n        return fn.apply(null, all);\n      };\n    }\n    var not = function (f) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return !f.apply(null, args);\n      };\n    };\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isString = isType('string');\n    var isArray = isType('array');\n    var isBoolean = isType('boolean');\n    var isFunction = isType('function');\n    var isNumber = isType('number');\n\n    var nativeSlice = Array.prototype.slice;\n    var nativeIndexOf = Array.prototype.indexOf;\n    var nativePush = Array.prototype.push;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var contains = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var exists = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var eachr = function (xs, f) {\n      for (var i = xs.length - 1; i >= 0; i--) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var foldr = function (xs, f, acc) {\n      eachr(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var find = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Option.some(x);\n        }\n      }\n      return Option.none();\n    };\n    var findIndex = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Option.some(i);\n        }\n      }\n      return Option.none();\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      var output = map(xs, f);\n      return flatten(output);\n    };\n    var forall = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        var x = xs[i];\n        if (pred(x, i) !== true) {\n          return false;\n        }\n      }\n      return true;\n    };\n    var reverse = function (xs) {\n      var r = nativeSlice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n    var last = function (xs) {\n      return xs.length === 0 ? Option.none() : Option.some(xs[xs.length - 1]);\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var keys = Object.keys;\n    var hasOwnProperty = Object.hasOwnProperty;\n    var each$1 = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var map$1 = function (obj, f) {\n      return tupleMap(obj, function (x, i) {\n        return {\n          k: i,\n          v: f(x, i)\n        };\n      });\n    };\n    var tupleMap = function (obj, f) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        var tuple = f(x, i);\n        r[tuple.k] = tuple.v;\n      });\n      return r;\n    };\n    var get = function (obj, key) {\n      return has(obj, key) ? Option.from(obj[key]) : Option.none();\n    };\n    var has = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n\n    var Immutable = function () {\n      var fields = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        fields[_i] = arguments[_i];\n      }\n      return function () {\n        var values = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n        if (fields.length !== values.length) {\n          throw new Error('Wrong number of arguments to struct. Expected \"[' + fields.length + ']\", got ' + values.length + ' arguments');\n        }\n        var struct = {};\n        each(fields, function (name, i) {\n          struct[name] = constant(values[i]);\n        });\n        return struct;\n      };\n    };\n\n    var sort = function (arr) {\n      return arr.slice(0).sort();\n    };\n    var reqMessage = function (required, keys) {\n      throw new Error('All required keys (' + sort(required).join(', ') + ') were not specified. Specified keys were: ' + sort(keys).join(', ') + '.');\n    };\n    var unsuppMessage = function (unsupported) {\n      throw new Error('Unsupported keys for object: ' + sort(unsupported).join(', '));\n    };\n    var validateStrArr = function (label, array) {\n      if (!isArray(array)) {\n        throw new Error('The ' + label + ' fields must be an array. Was: ' + array + '.');\n      }\n      each(array, function (a) {\n        if (!isString(a)) {\n          throw new Error('The value ' + a + ' in the ' + label + ' fields was not a string.');\n        }\n      });\n    };\n    var invalidTypeMessage = function (incorrect, type) {\n      throw new Error('All values need to be of type: ' + type + '. Keys (' + sort(incorrect).join(', ') + ') were not.');\n    };\n    var checkDupes = function (everything) {\n      var sorted = sort(everything);\n      var dupe = find(sorted, function (s, i) {\n        return i < sorted.length - 1 && s === sorted[i + 1];\n      });\n      dupe.each(function (d) {\n        throw new Error('The field: ' + d + ' occurs more than once in the combined fields: [' + sorted.join(', ') + '].');\n      });\n    };\n\n    var MixedBag = function (required, optional) {\n      var everything = required.concat(optional);\n      if (everything.length === 0) {\n        throw new Error('You must specify at least one required or optional field.');\n      }\n      validateStrArr('required', required);\n      validateStrArr('optional', optional);\n      checkDupes(everything);\n      return function (obj) {\n        var keys$1 = keys(obj);\n        var allReqd = forall(required, function (req) {\n          return contains(keys$1, req);\n        });\n        if (!allReqd) {\n          reqMessage(required, keys$1);\n        }\n        var unsupported = filter(keys$1, function (key) {\n          return !contains(everything, key);\n        });\n        if (unsupported.length > 0) {\n          unsuppMessage(unsupported);\n        }\n        var r = {};\n        each(required, function (req) {\n          r[req] = constant(obj[req]);\n        });\n        each(optional, function (opt) {\n          r[opt] = constant(Object.prototype.hasOwnProperty.call(obj, opt) ? Option.some(obj[opt]) : Option.none());\n        });\n        return r;\n      };\n    };\n\n    var ATTRIBUTE = domGlobals.Node.ATTRIBUTE_NODE;\n    var CDATA_SECTION = domGlobals.Node.CDATA_SECTION_NODE;\n    var COMMENT = domGlobals.Node.COMMENT_NODE;\n    var DOCUMENT = domGlobals.Node.DOCUMENT_NODE;\n    var DOCUMENT_TYPE = domGlobals.Node.DOCUMENT_TYPE_NODE;\n    var DOCUMENT_FRAGMENT = domGlobals.Node.DOCUMENT_FRAGMENT_NODE;\n    var ELEMENT = domGlobals.Node.ELEMENT_NODE;\n    var TEXT = domGlobals.Node.TEXT_NODE;\n    var PROCESSING_INSTRUCTION = domGlobals.Node.PROCESSING_INSTRUCTION_NODE;\n    var ENTITY_REFERENCE = domGlobals.Node.ENTITY_REFERENCE_NODE;\n    var ENTITY = domGlobals.Node.ENTITY_NODE;\n    var NOTATION = domGlobals.Node.NOTATION_NODE;\n\n    var Global = typeof domGlobals.window !== 'undefined' ? domGlobals.window : Function('return this;')();\n\n    var name = function (element) {\n      var r = element.dom().nodeName;\n      return r.toLowerCase();\n    };\n    var type = function (element) {\n      return element.dom().nodeType;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isComment = function (element) {\n      return type(element) === COMMENT || name(element) === '#comment';\n    };\n    var isElement = isType$1(ELEMENT);\n    var isText = isType$1(TEXT);\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        domGlobals.console.error('Invalid call to Attr.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set = function (element, key, value) {\n      rawSet(element.dom(), key, value);\n    };\n    var setAll = function (element, attrs) {\n      var dom = element.dom();\n      each$1(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n    var get$1 = function (element, key) {\n      var v = element.dom().getAttribute(key);\n      return v === null ? undefined : v;\n    };\n    var has$1 = function (element, key) {\n      var dom = element.dom();\n      return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n    };\n    var remove = function (element, key) {\n      element.dom().removeAttribute(key);\n    };\n    var clone = function (element) {\n      return foldl(element.dom().attributes, function (acc, attr) {\n        acc[attr.name] = attr.value;\n        return acc;\n      }, {});\n    };\n\n    var checkRange = function (str, substr, start) {\n      if (substr === '') {\n        return true;\n      }\n      if (str.length < substr.length) {\n        return false;\n      }\n      var x = str.substr(start, start + substr.length);\n      return x === substr;\n    };\n    var contains$1 = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n    var startsWith = function (str, prefix) {\n      return checkRange(str, prefix, 0);\n    };\n    var endsWith = function (str, suffix) {\n      return checkRange(str, suffix, str.length - suffix.length);\n    };\n    var trim = function (str) {\n      return str.replace(/^\\s+|\\s+$/g, '');\n    };\n\n    var isSupported = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var cached = function (f) {\n      var called = false;\n      var r;\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!called) {\n          called = true;\n          r = f.apply(null, args);\n        }\n        return r;\n      };\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        domGlobals.console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: constant(node) };\n    };\n    var fromPoint = function (docElm, x, y) {\n      var doc = docElm.dom();\n      return Option.from(doc.elementFromPoint(x, y)).map(fromDom);\n    };\n    var Element = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var inBody = function (element) {\n      var dom = isText(element) ? element.dom().parentNode : element.dom();\n      return dom !== undefined && dom !== null && dom.ownerDocument.body.contains(dom);\n    };\n    var body = cached(function () {\n      return getBody(Element.fromDom(domGlobals.document));\n    });\n    var getBody = function (doc) {\n      var b = doc.dom().body;\n      if (b === null || b === undefined) {\n        throw new Error('Body is not available yet');\n      }\n      return Element.fromDom(b);\n    };\n\n    var internalSet = function (dom, property, value) {\n      if (!isString(value)) {\n        domGlobals.console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n        throw new Error('CSS value must be a string: ' + value);\n      }\n      if (isSupported(dom)) {\n        dom.style.setProperty(property, value);\n      }\n    };\n    var internalRemove = function (dom, property) {\n      if (isSupported(dom)) {\n        dom.style.removeProperty(property);\n      }\n    };\n    var set$1 = function (element, property, value) {\n      var dom = element.dom();\n      internalSet(dom, property, value);\n    };\n    var setAll$1 = function (element, css) {\n      var dom = element.dom();\n      each$1(css, function (v, k) {\n        internalSet(dom, k, v);\n      });\n    };\n    var get$2 = function (element, property) {\n      var dom = element.dom();\n      var styles = domGlobals.window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      var v = r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n      return v === null ? undefined : v;\n    };\n    var getUnsafeProperty = function (dom, property) {\n      return isSupported(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n    var getRaw = function (element, property) {\n      var dom = element.dom();\n      var raw = getUnsafeProperty(dom, property);\n      return Option.from(raw).filter(function (r) {\n        return r.length > 0;\n      });\n    };\n    var remove$1 = function (element, property) {\n      var dom = element.dom();\n      internalRemove(dom, property);\n      if (has$1(element, 'style') && trim(get$1(element, 'style')) === '') {\n        remove(element, 'style');\n      }\n    };\n    var copy = function (source, target) {\n      var sourceDom = source.dom();\n      var targetDom = target.dom();\n      if (isSupported(sourceDom) && isSupported(targetDom)) {\n        targetDom.style.cssText = sourceDom.style.cssText;\n      }\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionPreceding = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_PRECEDING);\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n    var Node = {\n      documentPositionPreceding: documentPositionPreceding,\n      documentPositionContainedBy: documentPositionContainedBy\n    };\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$1 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu(group(1), group(2));\n    };\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown();\n      }\n      return find$1(versionRegexes, cleanedAgent);\n    };\n    var unknown = function () {\n      return nu(0, 0);\n    };\n    var nu = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu,\n      detect: detect,\n      unknown: unknown\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var isBrowser = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$1 = function () {\n      return nu$1({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$1 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge, current),\n        isChrome: isBrowser(chrome, current),\n        isIE: isBrowser(ie, current),\n        isOpera: isBrowser(opera, current),\n        isFirefox: isBrowser(firefox, current),\n        isSafari: isBrowser(safari, current)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$1,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var isOS = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$2 = function () {\n      return nu$2({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows, current),\n        isiOS: isOS(ios, current),\n        isAndroid: isOS(android, current),\n        isOSX: isOS(osx, current),\n        isLinux: isOS(linux, current),\n        isSolaris: isOS(solaris, current),\n        isFreeBSD: isOS(freebsd, current)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$2,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd)\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains$1(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('os x'),\n        versionRegexes: [/.*?os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var detect$2 = function (userAgent, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var mediaMatch = function (query) {\n      return domGlobals.window.matchMedia(query).matches;\n    };\n    var platform = Cell(PlatformDetection.detect(domGlobals.navigator.userAgent, mediaMatch));\n    var detect$3 = function () {\n      return platform.get();\n    };\n\n    var ELEMENT$1 = ELEMENT;\n    var DOCUMENT$1 = DOCUMENT;\n    var is = function (element, selector) {\n      var dom = element.dom();\n      if (dom.nodeType !== ELEMENT$1) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT$1 && dom.nodeType !== DOCUMENT$1 || dom.childElementCount === 0;\n    };\n    var all = function (selector, scope) {\n      var base = scope === undefined ? domGlobals.document : scope.dom();\n      return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), Element.fromDom);\n    };\n    var one = function (selector, scope) {\n      var base = scope === undefined ? domGlobals.document : scope.dom();\n      return bypassSelector(base) ? Option.none() : Option.from(base.querySelector(selector)).map(Element.fromDom);\n    };\n\n    var eq = function (e1, e2) {\n      return e1.dom() === e2.dom();\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom();\n      var d2 = e2.dom();\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return Node.documentPositionContainedBy(e1.dom(), e2.dom());\n    };\n    var browser = detect$3().browser;\n    var contains$2 = browser.isIE() ? ieContains : regularContains;\n    var is$1 = is;\n\n    var owner = function (element) {\n      return Element.fromDom(element.dom().ownerDocument);\n    };\n    var defaultView = function (element) {\n      return Element.fromDom(element.dom().ownerDocument.defaultView);\n    };\n    var parent = function (element) {\n      return Option.from(element.dom().parentNode).map(Element.fromDom);\n    };\n    var parents = function (element, isRoot) {\n      var stop = isFunction(isRoot) ? isRoot : never;\n      var dom = element.dom();\n      var ret = [];\n      while (dom.parentNode !== null && dom.parentNode !== undefined) {\n        var rawParent = dom.parentNode;\n        var p = Element.fromDom(rawParent);\n        ret.push(p);\n        if (stop(p) === true) {\n          break;\n        } else {\n          dom = rawParent;\n        }\n      }\n      return ret;\n    };\n    var prevSibling = function (element) {\n      return Option.from(element.dom().previousSibling).map(Element.fromDom);\n    };\n    var nextSibling = function (element) {\n      return Option.from(element.dom().nextSibling).map(Element.fromDom);\n    };\n    var children = function (element) {\n      return map(element.dom().childNodes, Element.fromDom);\n    };\n    var child = function (element, index) {\n      var cs = element.dom().childNodes;\n      return Option.from(cs[index]).map(Element.fromDom);\n    };\n    var firstChild = function (element) {\n      return child(element, 0);\n    };\n    var spot = Immutable('element', 'offset');\n\n    var before = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom().insertBefore(element.dom(), marker.dom());\n      });\n    };\n    var after = function (marker, element) {\n      var sibling = nextSibling(marker);\n      sibling.fold(function () {\n        var parent$1 = parent(marker);\n        parent$1.each(function (v) {\n          append(v, element);\n        });\n      }, function (v) {\n        before(v, element);\n      });\n    };\n    var prepend = function (parent, element) {\n      var firstChild$1 = firstChild(parent);\n      firstChild$1.fold(function () {\n        append(parent, element);\n      }, function (v) {\n        parent.dom().insertBefore(element.dom(), v.dom());\n      });\n    };\n    var append = function (parent, element) {\n      parent.dom().appendChild(element.dom());\n    };\n    var wrap = function (element, wrapper) {\n      before(element, wrapper);\n      append(wrapper, element);\n    };\n\n    var before$1 = function (marker, elements) {\n      each(elements, function (x) {\n        before(marker, x);\n      });\n    };\n    var after$1 = function (marker, elements) {\n      each(elements, function (x, i) {\n        var e = i === 0 ? marker : elements[i - 1];\n        after(e, x);\n      });\n    };\n    var append$1 = function (parent, elements) {\n      each(elements, function (x) {\n        append(parent, x);\n      });\n    };\n\n    var empty = function (element) {\n      element.dom().textContent = '';\n      each(children(element), function (rogue) {\n        remove$2(rogue);\n      });\n    };\n    var remove$2 = function (element) {\n      var dom = element.dom();\n      if (dom.parentNode !== null) {\n        dom.parentNode.removeChild(dom);\n      }\n    };\n    var unwrap = function (wrapper) {\n      var children$1 = children(wrapper);\n      if (children$1.length > 0) {\n        before$1(wrapper, children$1);\n      }\n      remove$2(wrapper);\n    };\n\n    var dimension = Immutable('width', 'height');\n    var dimensions = Immutable('width', 'height');\n    var grid = Immutable('rows', 'columns');\n    var address = Immutable('row', 'column');\n    var coords = Immutable('x', 'y');\n    var detail = Immutable('element', 'rowspan', 'colspan');\n    var detailnew = Immutable('element', 'rowspan', 'colspan', 'isNew');\n    var extended = Immutable('element', 'rowspan', 'colspan', 'row', 'column');\n    var rowdata = Immutable('element', 'cells', 'section');\n    var elementnew = Immutable('element', 'isNew');\n    var rowdatanew = Immutable('element', 'cells', 'section', 'isNew');\n    var rowcells = Immutable('cells', 'section');\n    var rowdetails = Immutable('details', 'section');\n    var bounds = Immutable('startRow', 'startCol', 'finishRow', 'finishCol');\n\n    var ancestors = function (scope, predicate, isRoot) {\n      return filter(parents(scope, isRoot), predicate);\n    };\n    var children$1 = function (scope, predicate) {\n      return filter(children(scope), predicate);\n    };\n    var descendants = function (scope, predicate) {\n      var result = [];\n      each(children(scope), function (x) {\n        if (predicate(x)) {\n          result = result.concat([x]);\n        }\n        result = result.concat(descendants(x, predicate));\n      });\n      return result;\n    };\n\n    var ancestors$1 = function (scope, selector, isRoot) {\n      return ancestors(scope, function (e) {\n        return is(e, selector);\n      }, isRoot);\n    };\n    var children$2 = function (scope, selector) {\n      return children$1(scope, function (e) {\n        return is(e, selector);\n      });\n    };\n    var descendants$1 = function (scope, selector) {\n      return all(selector, scope);\n    };\n\n    function ClosestOrAncestor (is, ancestor, scope, a, isRoot) {\n      return is(scope, a) ? Option.some(scope) : isFunction(isRoot) && isRoot(scope) ? Option.none() : ancestor(scope, a, isRoot);\n    }\n\n    var ancestor = function (scope, predicate, isRoot) {\n      var element = scope.dom();\n      var stop = isFunction(isRoot) ? isRoot : constant(false);\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = Element.fromDom(element);\n        if (predicate(el)) {\n          return Option.some(el);\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Option.none();\n    };\n    var closest = function (scope, predicate, isRoot) {\n      var is = function (s, test) {\n        return test(s);\n      };\n      return ClosestOrAncestor(is, ancestor, scope, predicate, isRoot);\n    };\n    var child$1 = function (scope, predicate) {\n      var pred = function (node) {\n        return predicate(Element.fromDom(node));\n      };\n      var result = find(scope.dom().childNodes, pred);\n      return result.map(Element.fromDom);\n    };\n    var descendant = function (scope, predicate) {\n      var descend = function (node) {\n        for (var i = 0; i < node.childNodes.length; i++) {\n          var child_1 = Element.fromDom(node.childNodes[i]);\n          if (predicate(child_1)) {\n            return Option.some(child_1);\n          }\n          var res = descend(node.childNodes[i]);\n          if (res.isSome()) {\n            return res;\n          }\n        }\n        return Option.none();\n      };\n      return descend(scope.dom());\n    };\n\n    var ancestor$1 = function (scope, selector, isRoot) {\n      return ancestor(scope, function (e) {\n        return is(e, selector);\n      }, isRoot);\n    };\n    var child$2 = function (scope, selector) {\n      return child$1(scope, function (e) {\n        return is(e, selector);\n      });\n    };\n    var descendant$1 = function (scope, selector) {\n      return one(selector, scope);\n    };\n    var closest$1 = function (scope, selector, isRoot) {\n      return ClosestOrAncestor(is, ancestor$1, scope, selector, isRoot);\n    };\n\n    var firstLayer = function (scope, selector) {\n      return filterFirstLayer(scope, selector, constant(true));\n    };\n    var filterFirstLayer = function (scope, selector, predicate) {\n      return bind(children(scope), function (x) {\n        return is(x, selector) ? predicate(x) ? [x] : [] : filterFirstLayer(x, selector, predicate);\n      });\n    };\n    var LayerSelector = {\n      firstLayer: firstLayer,\n      filterFirstLayer: filterFirstLayer\n    };\n\n    var lookup = function (tags, element, isRoot) {\n      if (isRoot === void 0) {\n        isRoot = never;\n      }\n      if (isRoot(element)) {\n        return Option.none();\n      }\n      if (contains(tags, name(element))) {\n        return Option.some(element);\n      }\n      var isRootOrUpperTable = function (elm) {\n        return is(elm, 'table') || isRoot(elm);\n      };\n      return ancestor$1(element, tags.join(','), isRootOrUpperTable);\n    };\n    var cell = function (element, isRoot) {\n      return lookup([\n        'td',\n        'th'\n      ], element, isRoot);\n    };\n    var cells = function (ancestor) {\n      return LayerSelector.firstLayer(ancestor, 'th,td');\n    };\n    var notCell = function (element, isRoot) {\n      return lookup([\n        'caption',\n        'tr',\n        'tbody',\n        'tfoot',\n        'thead'\n      ], element, isRoot);\n    };\n    var neighbours = function (selector, element) {\n      return parent(element).map(function (parent) {\n        return children$2(parent, selector);\n      });\n    };\n    var neighbourCells = curry(neighbours, 'th,td');\n    var neighbourRows = curry(neighbours, 'tr');\n    var firstCell = function (ancestor) {\n      return descendant$1(ancestor, 'th,td');\n    };\n    var table = function (element, isRoot) {\n      return closest$1(element, 'table', isRoot);\n    };\n    var row = function (element, isRoot) {\n      return lookup(['tr'], element, isRoot);\n    };\n    var rows = function (ancestor) {\n      return LayerSelector.firstLayer(ancestor, 'tr');\n    };\n    var attr = function (element, property) {\n      return parseInt(get$1(element, property), 10);\n    };\n    var grid$1 = function (element, rowProp, colProp) {\n      var rowsCount = attr(element, rowProp);\n      var cols = attr(element, colProp);\n      return grid(rowsCount, cols);\n    };\n    var TableLookup = {\n      cell: cell,\n      firstCell: firstCell,\n      cells: cells,\n      neighbourCells: neighbourCells,\n      table: table,\n      row: row,\n      rows: rows,\n      notCell: notCell,\n      neighbourRows: neighbourRows,\n      attr: attr,\n      grid: grid$1\n    };\n\n    var fromTable = function (table) {\n      var rows = TableLookup.rows(table);\n      return map(rows, function (row) {\n        var element = row;\n        var parent$1 = parent(element);\n        var parentSection = parent$1.map(function (p) {\n          var parentName = name(p);\n          return parentName === 'tfoot' || parentName === 'thead' || parentName === 'tbody' ? parentName : 'tbody';\n        }).getOr('tbody');\n        var cells = map(TableLookup.cells(row), function (cell) {\n          var rowspan = has$1(cell, 'rowspan') ? parseInt(get$1(cell, 'rowspan'), 10) : 1;\n          var colspan = has$1(cell, 'colspan') ? parseInt(get$1(cell, 'colspan'), 10) : 1;\n          return detail(cell, rowspan, colspan);\n        });\n        return rowdata(element, cells, parentSection);\n      });\n    };\n    var fromPastedRows = function (rows, example) {\n      return map(rows, function (row) {\n        var cells = map(TableLookup.cells(row), function (cell) {\n          var rowspan = has$1(cell, 'rowspan') ? parseInt(get$1(cell, 'rowspan'), 10) : 1;\n          var colspan = has$1(cell, 'colspan') ? parseInt(get$1(cell, 'colspan'), 10) : 1;\n          return detail(cell, rowspan, colspan);\n        });\n        return rowdata(row, cells, example.section());\n      });\n    };\n    var DetailsList = {\n      fromTable: fromTable,\n      fromPastedRows: fromPastedRows\n    };\n\n    var key = function (row, column) {\n      return row + ',' + column;\n    };\n    var getAt = function (warehouse, row, column) {\n      var raw = warehouse.access()[key(row, column)];\n      return raw !== undefined ? Option.some(raw) : Option.none();\n    };\n    var findItem = function (warehouse, item, comparator) {\n      var filtered = filterItems(warehouse, function (detail) {\n        return comparator(item, detail.element());\n      });\n      return filtered.length > 0 ? Option.some(filtered[0]) : Option.none();\n    };\n    var filterItems = function (warehouse, predicate) {\n      var all = bind(warehouse.all(), function (r) {\n        return r.cells();\n      });\n      return filter(all, predicate);\n    };\n    var generate = function (list) {\n      var access = {};\n      var cells = [];\n      var maxRows = list.length;\n      var maxColumns = 0;\n      each(list, function (details, r) {\n        var currentRow = [];\n        each(details.cells(), function (detail) {\n          var start = 0;\n          while (access[key(r, start)] !== undefined) {\n            start++;\n          }\n          var current = extended(detail.element(), detail.rowspan(), detail.colspan(), r, start);\n          for (var i = 0; i < detail.colspan(); i++) {\n            for (var j = 0; j < detail.rowspan(); j++) {\n              var cr = r + j;\n              var cc = start + i;\n              var newpos = key(cr, cc);\n              access[newpos] = current;\n              maxColumns = Math.max(maxColumns, cc + 1);\n            }\n          }\n          currentRow.push(current);\n        });\n        cells.push(rowdata(details.element(), currentRow, details.section()));\n      });\n      var grid$1 = grid(maxRows, maxColumns);\n      return {\n        grid: constant(grid$1),\n        access: constant(access),\n        all: constant(cells)\n      };\n    };\n    var justCells = function (warehouse) {\n      var rows = map(warehouse.all(), function (w) {\n        return w.cells();\n      });\n      return flatten(rows);\n    };\n    var Warehouse = {\n      generate: generate,\n      getAt: getAt,\n      findItem: findItem,\n      filterItems: filterItems,\n      justCells: justCells\n    };\n\n    var statsStruct = Immutable('minRow', 'minCol', 'maxRow', 'maxCol');\n    var findSelectedStats = function (house, isSelected) {\n      var totalColumns = house.grid().columns();\n      var totalRows = house.grid().rows();\n      var minRow = totalRows;\n      var minCol = totalColumns;\n      var maxRow = 0;\n      var maxCol = 0;\n      each$1(house.access(), function (detail) {\n        if (isSelected(detail)) {\n          var startRow = detail.row();\n          var endRow = startRow + detail.rowspan() - 1;\n          var startCol = detail.column();\n          var endCol = startCol + detail.colspan() - 1;\n          if (startRow < minRow) {\n            minRow = startRow;\n          } else if (endRow > maxRow) {\n            maxRow = endRow;\n          }\n          if (startCol < minCol) {\n            minCol = startCol;\n          } else if (endCol > maxCol) {\n            maxCol = endCol;\n          }\n        }\n      });\n      return statsStruct(minRow, minCol, maxRow, maxCol);\n    };\n    var makeCell = function (list, seenSelected, rowIndex) {\n      var row = list[rowIndex].element();\n      var td = Element.fromTag('td');\n      append(td, Element.fromTag('br'));\n      var f = seenSelected ? append : prepend;\n      f(row, td);\n    };\n    var fillInGaps = function (list, house, stats, isSelected) {\n      var totalColumns = house.grid().columns();\n      var totalRows = house.grid().rows();\n      for (var i = 0; i < totalRows; i++) {\n        var seenSelected = false;\n        for (var j = 0; j < totalColumns; j++) {\n          if (!(i < stats.minRow() || i > stats.maxRow() || j < stats.minCol() || j > stats.maxCol())) {\n            var needCell = Warehouse.getAt(house, i, j).filter(isSelected).isNone();\n            if (needCell) {\n              makeCell(list, seenSelected, i);\n            } else {\n              seenSelected = true;\n            }\n          }\n        }\n      }\n    };\n    var clean = function (table, stats) {\n      var emptyRows = filter(LayerSelector.firstLayer(table, 'tr'), function (row) {\n        return row.dom().childElementCount === 0;\n      });\n      each(emptyRows, remove$2);\n      if (stats.minCol() === stats.maxCol() || stats.minRow() === stats.maxRow()) {\n        each(LayerSelector.firstLayer(table, 'th,td'), function (cell) {\n          remove(cell, 'rowspan');\n          remove(cell, 'colspan');\n        });\n      }\n      remove(table, 'width');\n      remove(table, 'height');\n      remove$1(table, 'width');\n      remove$1(table, 'height');\n    };\n    var extract = function (table, selectedSelector) {\n      var isSelected = function (detail) {\n        return is(detail.element(), selectedSelector);\n      };\n      var list = DetailsList.fromTable(table);\n      var house = Warehouse.generate(list);\n      var stats = findSelectedStats(house, isSelected);\n      var selector = 'th:not(' + selectedSelector + ')' + ',td:not(' + selectedSelector + ')';\n      var unselectedCells = LayerSelector.filterFirstLayer(table, 'th,td', function (cell) {\n        return is(cell, selector);\n      });\n      each(unselectedCells, remove$2);\n      fillInGaps(list, house, stats, isSelected);\n      clean(table, stats);\n      return table;\n    };\n    var CopySelected = { extract: extract };\n\n    function NodeValue (is, name) {\n      var get = function (element) {\n        if (!is(element)) {\n          throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n        }\n        return getOption(element).getOr('');\n      };\n      var getOption = function (element) {\n        return is(element) ? Option.from(element.dom().nodeValue) : Option.none();\n      };\n      var set = function (element, value) {\n        if (!is(element)) {\n          throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n        }\n        element.dom().nodeValue = value;\n      };\n      return {\n        get: get,\n        getOption: getOption,\n        set: set\n      };\n    }\n\n    var api = NodeValue(isText, 'text');\n    var get$3 = function (element) {\n      return api.get(element);\n    };\n    var getOption = function (element) {\n      return api.getOption(element);\n    };\n    var set$2 = function (element, value) {\n      api.set(element, value);\n    };\n\n    var getEnd = function (element) {\n      return name(element) === 'img' ? 1 : getOption(element).fold(function () {\n        return children(element).length;\n      }, function (v) {\n        return v.length;\n      });\n    };\n    var NBSP = '\\xA0';\n    var isTextNodeWithCursorPosition = function (el) {\n      return getOption(el).filter(function (text) {\n        return text.trim().length !== 0 || text.indexOf(NBSP) > -1;\n      }).isSome();\n    };\n    var elementsWithCursorPosition = [\n      'img',\n      'br'\n    ];\n    var isCursorPosition = function (elem) {\n      var hasCursorPosition = isTextNodeWithCursorPosition(elem);\n      return hasCursorPosition || contains(elementsWithCursorPosition, name(elem));\n    };\n\n    var first = function (element) {\n      return descendant(element, isCursorPosition);\n    };\n    var last$1 = function (element) {\n      return descendantRtl(element, isCursorPosition);\n    };\n    var descendantRtl = function (scope, predicate) {\n      var descend = function (element) {\n        var children$1 = children(element);\n        for (var i = children$1.length - 1; i >= 0; i--) {\n          var child = children$1[i];\n          if (predicate(child)) {\n            return Option.some(child);\n          }\n          var res = descend(child);\n          if (res.isSome()) {\n            return res;\n          }\n        }\n        return Option.none();\n      };\n      return descend(scope);\n    };\n\n    var clone$1 = function (original, isDeep) {\n      return Element.fromDom(original.dom().cloneNode(isDeep));\n    };\n    var shallow = function (original) {\n      return clone$1(original, false);\n    };\n    var deep = function (original) {\n      return clone$1(original, true);\n    };\n    var shallowAs = function (original, tag) {\n      var nu = Element.fromTag(tag);\n      var attributes = clone(original);\n      setAll(nu, attributes);\n      return nu;\n    };\n    var copy$1 = function (original, tag) {\n      var nu = shallowAs(original, tag);\n      var cloneChildren = children(deep(original));\n      append$1(nu, cloneChildren);\n      return nu;\n    };\n\n    var createCell = function () {\n      var td = Element.fromTag('td');\n      append(td, Element.fromTag('br'));\n      return td;\n    };\n    var replace = function (cell, tag, attrs) {\n      var replica = copy$1(cell, tag);\n      each$1(attrs, function (v, k) {\n        if (v === null) {\n          remove(replica, k);\n        } else {\n          set(replica, k, v);\n        }\n      });\n      return replica;\n    };\n    var pasteReplace = function (cell) {\n      return cell;\n    };\n    var newRow = function (doc) {\n      return function () {\n        return Element.fromTag('tr', doc.dom());\n      };\n    };\n    var cloneFormats = function (oldCell, newCell, formats) {\n      var first$1 = first(oldCell);\n      return first$1.map(function (firstText) {\n        var formatSelector = formats.join(',');\n        var parents = ancestors$1(firstText, formatSelector, function (element) {\n          return eq(element, oldCell);\n        });\n        return foldr(parents, function (last, parent) {\n          var clonedFormat = shallow(parent);\n          remove(clonedFormat, 'contenteditable');\n          append(last, clonedFormat);\n          return clonedFormat;\n        }, newCell);\n      }).getOr(newCell);\n    };\n    var cellOperations = function (mutate, doc, formatsToClone) {\n      var newCell = function (prev) {\n        var docu = owner(prev.element());\n        var td = Element.fromTag(name(prev.element()), docu.dom());\n        var formats = formatsToClone.getOr([\n          'strong',\n          'em',\n          'b',\n          'i',\n          'span',\n          'font',\n          'h1',\n          'h2',\n          'h3',\n          'h4',\n          'h5',\n          'h6',\n          'p',\n          'div'\n        ]);\n        var lastNode = formats.length > 0 ? cloneFormats(prev.element(), td, formats) : td;\n        append(lastNode, Element.fromTag('br'));\n        copy(prev.element(), td);\n        remove$1(td, 'height');\n        if (prev.colspan() !== 1) {\n          remove$1(prev.element(), 'width');\n        }\n        mutate(prev.element(), td);\n        return td;\n      };\n      return {\n        row: newRow(doc),\n        cell: newCell,\n        replace: replace,\n        gap: createCell\n      };\n    };\n    var paste = function (doc) {\n      return {\n        row: newRow(doc),\n        cell: createCell,\n        replace: pasteReplace,\n        gap: createCell\n      };\n    };\n    var TableFill = {\n      cellOperations: cellOperations,\n      paste: paste\n    };\n\n    var fromHtml$1 = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      return children(Element.fromDom(div));\n    };\n\n    var inSelection = function (bounds, detail) {\n      var leftEdge = detail.column();\n      var rightEdge = detail.column() + detail.colspan() - 1;\n      var topEdge = detail.row();\n      var bottomEdge = detail.row() + detail.rowspan() - 1;\n      return leftEdge <= bounds.finishCol() && rightEdge >= bounds.startCol() && (topEdge <= bounds.finishRow() && bottomEdge >= bounds.startRow());\n    };\n    var isWithin = function (bounds, detail) {\n      return detail.column() >= bounds.startCol() && detail.column() + detail.colspan() - 1 <= bounds.finishCol() && detail.row() >= bounds.startRow() && detail.row() + detail.rowspan() - 1 <= bounds.finishRow();\n    };\n    var isRectangular = function (warehouse, bounds) {\n      var isRect = true;\n      var detailIsWithin = curry(isWithin, bounds);\n      for (var i = bounds.startRow(); i <= bounds.finishRow(); i++) {\n        for (var j = bounds.startCol(); j <= bounds.finishCol(); j++) {\n          isRect = isRect && Warehouse.getAt(warehouse, i, j).exists(detailIsWithin);\n        }\n      }\n      return isRect ? Option.some(bounds) : Option.none();\n    };\n    var CellBounds = {\n      inSelection: inSelection,\n      isWithin: isWithin,\n      isRectangular: isRectangular\n    };\n\n    var getBounds = function (detailA, detailB) {\n      return bounds(Math.min(detailA.row(), detailB.row()), Math.min(detailA.column(), detailB.column()), Math.max(detailA.row() + detailA.rowspan() - 1, detailB.row() + detailB.rowspan() - 1), Math.max(detailA.column() + detailA.colspan() - 1, detailB.column() + detailB.colspan() - 1));\n    };\n    var getAnyBox = function (warehouse, startCell, finishCell) {\n      var startCoords = Warehouse.findItem(warehouse, startCell, eq);\n      var finishCoords = Warehouse.findItem(warehouse, finishCell, eq);\n      return startCoords.bind(function (sc) {\n        return finishCoords.map(function (fc) {\n          return getBounds(sc, fc);\n        });\n      });\n    };\n    var getBox = function (warehouse, startCell, finishCell) {\n      return getAnyBox(warehouse, startCell, finishCell).bind(function (bounds) {\n        return CellBounds.isRectangular(warehouse, bounds);\n      });\n    };\n    var CellGroup = {\n      getAnyBox: getAnyBox,\n      getBox: getBox\n    };\n\n    var moveBy = function (warehouse, cell, row, column) {\n      return Warehouse.findItem(warehouse, cell, eq).bind(function (detail) {\n        var startRow = row > 0 ? detail.row() + detail.rowspan() - 1 : detail.row();\n        var startCol = column > 0 ? detail.column() + detail.colspan() - 1 : detail.column();\n        var dest = Warehouse.getAt(warehouse, startRow + row, startCol + column);\n        return dest.map(function (d) {\n          return d.element();\n        });\n      });\n    };\n    var intercepts = function (warehouse, start, finish) {\n      return CellGroup.getAnyBox(warehouse, start, finish).map(function (bounds) {\n        var inside = Warehouse.filterItems(warehouse, curry(CellBounds.inSelection, bounds));\n        return map(inside, function (detail) {\n          return detail.element();\n        });\n      });\n    };\n    var parentCell = function (warehouse, innerCell) {\n      var isContainedBy = function (c1, c2) {\n        return contains$2(c2, c1);\n      };\n      return Warehouse.findItem(warehouse, innerCell, isContainedBy).map(function (detail) {\n        return detail.element();\n      });\n    };\n    var CellFinder = {\n      moveBy: moveBy,\n      intercepts: intercepts,\n      parentCell: parentCell\n    };\n\n    var moveBy$1 = function (cell, deltaRow, deltaColumn) {\n      return TableLookup.table(cell).bind(function (table) {\n        var warehouse = getWarehouse(table);\n        return CellFinder.moveBy(warehouse, cell, deltaRow, deltaColumn);\n      });\n    };\n    var intercepts$1 = function (table, first, last) {\n      var warehouse = getWarehouse(table);\n      return CellFinder.intercepts(warehouse, first, last);\n    };\n    var nestedIntercepts = function (table, first, firstTable, last, lastTable) {\n      var warehouse = getWarehouse(table);\n      var optStartCell = eq(table, firstTable) ? Option.some(first) : CellFinder.parentCell(warehouse, first);\n      var optLastCell = eq(table, lastTable) ? Option.some(last) : CellFinder.parentCell(warehouse, last);\n      return optStartCell.bind(function (startCell) {\n        return optLastCell.bind(function (lastCell) {\n          return CellFinder.intercepts(warehouse, startCell, lastCell);\n        });\n      });\n    };\n    var getBox$1 = function (table, first, last) {\n      var warehouse = getWarehouse(table);\n      return CellGroup.getBox(warehouse, first, last);\n    };\n    var getWarehouse = function (table) {\n      var list = DetailsList.fromTable(table);\n      return Warehouse.generate(list);\n    };\n    var TablePositions = {\n      moveBy: moveBy$1,\n      intercepts: intercepts$1,\n      nestedIntercepts: nestedIntercepts,\n      getBox: getBox$1\n    };\n\n    var TagBoundaries = [\n      'body',\n      'p',\n      'div',\n      'article',\n      'aside',\n      'figcaption',\n      'figure',\n      'footer',\n      'header',\n      'nav',\n      'section',\n      'ol',\n      'ul',\n      'li',\n      'table',\n      'thead',\n      'tbody',\n      'tfoot',\n      'caption',\n      'tr',\n      'td',\n      'th',\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'blockquote',\n      'pre',\n      'address'\n    ];\n\n    function DomUniverse () {\n      var clone$1 = function (element) {\n        return Element.fromDom(element.dom().cloneNode(false));\n      };\n      var document = function (element) {\n        return element.dom().ownerDocument;\n      };\n      var isBoundary = function (element) {\n        if (!isElement(element)) {\n          return false;\n        }\n        if (name(element) === 'body') {\n          return true;\n        }\n        return contains(TagBoundaries, name(element));\n      };\n      var isEmptyTag = function (element) {\n        if (!isElement(element)) {\n          return false;\n        }\n        return contains([\n          'br',\n          'img',\n          'hr',\n          'input'\n        ], name(element));\n      };\n      var comparePosition = function (element, other) {\n        return element.dom().compareDocumentPosition(other.dom());\n      };\n      var copyAttributesTo = function (source, destination) {\n        var as = clone(source);\n        setAll(destination, as);\n      };\n      return {\n        up: constant({\n          selector: ancestor$1,\n          closest: closest$1,\n          predicate: ancestor,\n          all: parents\n        }),\n        down: constant({\n          selector: descendants$1,\n          predicate: descendants\n        }),\n        styles: constant({\n          get: get$2,\n          getRaw: getRaw,\n          set: set$1,\n          remove: remove$1\n        }),\n        attrs: constant({\n          get: get$1,\n          set: set,\n          remove: remove,\n          copyTo: copyAttributesTo\n        }),\n        insert: constant({\n          before: before,\n          after: after,\n          afterAll: after$1,\n          append: append,\n          appendAll: append$1,\n          prepend: prepend,\n          wrap: wrap\n        }),\n        remove: constant({\n          unwrap: unwrap,\n          remove: remove$2\n        }),\n        create: constant({\n          nu: Element.fromTag,\n          clone: clone$1,\n          text: Element.fromText\n        }),\n        query: constant({\n          comparePosition: comparePosition,\n          prevSibling: prevSibling,\n          nextSibling: nextSibling\n        }),\n        property: constant({\n          children: children,\n          name: name,\n          parent: parent,\n          document: document,\n          isText: isText,\n          isComment: isComment,\n          isElement: isElement,\n          getText: get$3,\n          setText: set$2,\n          isBoundary: isBoundary,\n          isEmptyTag: isEmptyTag\n        }),\n        eq: eq,\n        is: is$1\n      };\n    }\n\n    var leftRight = Immutable('left', 'right');\n    var brokenPath = Immutable('first', 'second', 'splits');\n    var bisect = function (universe, parent, child) {\n      var children = universe.property().children(parent);\n      var index = findIndex(children, curry(universe.eq, child));\n      return index.map(function (ind) {\n        return {\n          before: constant(children.slice(0, ind)),\n          after: constant(children.slice(ind + 1))\n        };\n      });\n    };\n    var breakToRight = function (universe, parent, child) {\n      return bisect(universe, parent, child).map(function (parts) {\n        var second = universe.create().clone(parent);\n        universe.insert().appendAll(second, parts.after());\n        universe.insert().after(parent, second);\n        return leftRight(parent, second);\n      });\n    };\n    var breakToLeft = function (universe, parent, child) {\n      return bisect(universe, parent, child).map(function (parts) {\n        var prior = universe.create().clone(parent);\n        universe.insert().appendAll(prior, parts.before().concat([child]));\n        universe.insert().appendAll(parent, parts.after());\n        universe.insert().before(parent, prior);\n        return leftRight(prior, parent);\n      });\n    };\n    var breakPath = function (universe, item, isTop, breaker) {\n      var next = function (child, group, splits) {\n        var fallback = brokenPath(child, Option.none(), splits);\n        if (isTop(child)) {\n          return brokenPath(child, group, splits);\n        } else {\n          return universe.property().parent(child).bind(function (parent) {\n            return breaker(universe, parent, child).map(function (breakage) {\n              var extra = [{\n                  first: breakage.left,\n                  second: breakage.right\n                }];\n              var nextChild = isTop(parent) ? parent : breakage.left();\n              return next(nextChild, Option.some(breakage.right()), splits.concat(extra));\n            });\n          }).getOr(fallback);\n        }\n      };\n      return next(item, Option.none(), []);\n    };\n\n    var all$1 = function (universe, look, elements, f) {\n      var head = elements[0];\n      var tail = elements.slice(1);\n      return f(universe, look, head, tail);\n    };\n    var oneAll = function (universe, look, elements) {\n      return elements.length > 0 ? all$1(universe, look, elements, unsafeOne) : Option.none();\n    };\n    var unsafeOne = function (universe, look, head, tail) {\n      var start = look(universe, head);\n      return foldr(tail, function (b, a) {\n        var current = look(universe, a);\n        return commonElement(universe, b, current);\n      }, start);\n    };\n    var commonElement = function (universe, start, end) {\n      return start.bind(function (s) {\n        return end.filter(curry(universe.eq, s));\n      });\n    };\n\n    var eq$1 = function (universe, item) {\n      return curry(universe.eq, item);\n    };\n    var unsafeSubset = function (universe, common, ps1, ps2) {\n      var children = universe.property().children(common);\n      if (universe.eq(common, ps1[0])) {\n        return Option.some([ps1[0]]);\n      }\n      if (universe.eq(common, ps2[0])) {\n        return Option.some([ps2[0]]);\n      }\n      var finder = function (ps) {\n        var topDown = reverse(ps);\n        var index = findIndex(topDown, eq$1(universe, common)).getOr(-1);\n        var item = index < topDown.length - 1 ? topDown[index + 1] : topDown[index];\n        return findIndex(children, eq$1(universe, item));\n      };\n      var startIndex = finder(ps1);\n      var endIndex = finder(ps2);\n      return startIndex.bind(function (sIndex) {\n        return endIndex.map(function (eIndex) {\n          var first = Math.min(sIndex, eIndex);\n          var last = Math.max(sIndex, eIndex);\n          return children.slice(first, last + 1);\n        });\n      });\n    };\n    var ancestors$2 = function (universe, start, end, isRoot) {\n      if (isRoot === void 0) {\n        isRoot = never;\n      }\n      var ps1 = [start].concat(universe.up().all(start));\n      var ps2 = [end].concat(universe.up().all(end));\n      var prune = function (path) {\n        var index = findIndex(path, isRoot);\n        return index.fold(function () {\n          return path;\n        }, function (ind) {\n          return path.slice(0, ind + 1);\n        });\n      };\n      var pruned1 = prune(ps1);\n      var pruned2 = prune(ps2);\n      var shared = find(pruned1, function (x) {\n        return exists(pruned2, eq$1(universe, x));\n      });\n      return {\n        firstpath: constant(pruned1),\n        secondpath: constant(pruned2),\n        shared: constant(shared)\n      };\n    };\n    var subset = function (universe, start, end) {\n      var ancs = ancestors$2(universe, start, end);\n      return ancs.shared().bind(function (shared) {\n        return unsafeSubset(universe, shared, ancs.firstpath(), ancs.secondpath());\n      });\n    };\n    var SubsetFn = {\n      subset: subset,\n      ancestors: ancestors$2\n    };\n\n    var sharedOne = oneAll;\n    var subset$1 = SubsetFn.subset;\n    var ancestors$3 = SubsetFn.ancestors;\n    var breakToLeft$1 = breakToLeft;\n    var breakToRight$1 = breakToRight;\n    var breakPath$1 = breakPath;\n    var Parent = {\n      sharedOne: sharedOne,\n      subset: subset$1,\n      ancestors: ancestors$3,\n      breakToLeft: breakToLeft$1,\n      breakToRight: breakToRight$1,\n      breakPath: breakPath$1\n    };\n\n    var universe = DomUniverse();\n    var sharedOne$1 = function (look, elements) {\n      return Parent.sharedOne(universe, function (_universe, element) {\n        return look(element);\n      }, elements);\n    };\n    var subset$2 = function (start, finish) {\n      return Parent.subset(universe, start, finish);\n    };\n    var ancestors$4 = function (start, finish, isRoot) {\n      return Parent.ancestors(universe, start, finish, isRoot);\n    };\n    var breakToLeft$2 = function (parent, child) {\n      return Parent.breakToLeft(universe, parent, child);\n    };\n    var breakToRight$2 = function (parent, child) {\n      return Parent.breakToRight(universe, parent, child);\n    };\n    var breakPath$2 = function (child, isTop, breaker) {\n      return Parent.breakPath(universe, child, isTop, function (u, p, c) {\n        return breaker(p, c);\n      });\n    };\n    var DomParent = {\n      sharedOne: sharedOne$1,\n      subset: subset$2,\n      ancestors: ancestors$4,\n      breakToLeft: breakToLeft$2,\n      breakToRight: breakToRight$2,\n      breakPath: breakPath$2\n    };\n\n    var create = MixedBag([\n      'boxes',\n      'start',\n      'finish'\n    ], []);\n    var Identified = { create: create };\n\n    var lookupTable = function (container) {\n      return ancestor$1(container, 'table');\n    };\n    var identify = function (start, finish, isRoot) {\n      var getIsRoot = function (rootTable) {\n        return function (element) {\n          return isRoot !== undefined && isRoot(element) || eq(element, rootTable);\n        };\n      };\n      if (eq(start, finish)) {\n        return Option.some(Identified.create({\n          boxes: Option.some([start]),\n          start: start,\n          finish: finish\n        }));\n      } else {\n        return lookupTable(start).bind(function (startTable) {\n          return lookupTable(finish).bind(function (finishTable) {\n            if (eq(startTable, finishTable)) {\n              return Option.some(Identified.create({\n                boxes: TablePositions.intercepts(startTable, start, finish),\n                start: start,\n                finish: finish\n              }));\n            } else if (contains$2(startTable, finishTable)) {\n              var ancestorCells = ancestors$1(finish, 'td,th', getIsRoot(startTable));\n              var finishCell = ancestorCells.length > 0 ? ancestorCells[ancestorCells.length - 1] : finish;\n              return Option.some(Identified.create({\n                boxes: TablePositions.nestedIntercepts(startTable, start, startTable, finish, finishTable),\n                start: start,\n                finish: finishCell\n              }));\n            } else if (contains$2(finishTable, startTable)) {\n              var ancestorCells = ancestors$1(start, 'td,th', getIsRoot(finishTable));\n              var startCell = ancestorCells.length > 0 ? ancestorCells[ancestorCells.length - 1] : start;\n              return Option.some(Identified.create({\n                boxes: TablePositions.nestedIntercepts(finishTable, start, startTable, finish, finishTable),\n                start: start,\n                finish: startCell\n              }));\n            } else {\n              return DomParent.ancestors(start, finish).shared().bind(function (lca) {\n                return closest$1(lca, 'table', isRoot).bind(function (lcaTable) {\n                  var finishAncestorCells = ancestors$1(finish, 'td,th', getIsRoot(lcaTable));\n                  var finishCell = finishAncestorCells.length > 0 ? finishAncestorCells[finishAncestorCells.length - 1] : finish;\n                  var startAncestorCells = ancestors$1(start, 'td,th', getIsRoot(lcaTable));\n                  var startCell = startAncestorCells.length > 0 ? startAncestorCells[startAncestorCells.length - 1] : start;\n                  return Option.some(Identified.create({\n                    boxes: TablePositions.nestedIntercepts(lcaTable, start, startTable, finish, finishTable),\n                    start: startCell,\n                    finish: finishCell\n                  }));\n                });\n              });\n            }\n          });\n        });\n      }\n    };\n    var retrieve = function (container, selector) {\n      var sels = descendants$1(container, selector);\n      return sels.length > 0 ? Option.some(sels) : Option.none();\n    };\n    var getLast = function (boxes, lastSelectedSelector) {\n      return find(boxes, function (box) {\n        return is(box, lastSelectedSelector);\n      });\n    };\n    var getEdges = function (container, firstSelectedSelector, lastSelectedSelector) {\n      return descendant$1(container, firstSelectedSelector).bind(function (first) {\n        return descendant$1(container, lastSelectedSelector).bind(function (last) {\n          return DomParent.sharedOne(lookupTable, [\n            first,\n            last\n          ]).map(function (tbl) {\n            return {\n              first: constant(first),\n              last: constant(last),\n              table: constant(tbl)\n            };\n          });\n        });\n      });\n    };\n    var expandTo = function (finish, firstSelectedSelector) {\n      return ancestor$1(finish, 'table').bind(function (table) {\n        return descendant$1(table, firstSelectedSelector).bind(function (start) {\n          return identify(start, finish).bind(function (identified) {\n            return identified.boxes().map(function (boxes) {\n              return {\n                boxes: constant(boxes),\n                start: constant(identified.start()),\n                finish: constant(identified.finish())\n              };\n            });\n          });\n        });\n      });\n    };\n    var shiftSelection = function (boxes, deltaRow, deltaColumn, firstSelectedSelector, lastSelectedSelector) {\n      return getLast(boxes, lastSelectedSelector).bind(function (last) {\n        return TablePositions.moveBy(last, deltaRow, deltaColumn).bind(function (finish) {\n          return expandTo(finish, firstSelectedSelector);\n        });\n      });\n    };\n    var CellSelection = {\n      identify: identify,\n      retrieve: retrieve,\n      shiftSelection: shiftSelection,\n      getEdges: getEdges\n    };\n\n    var retrieve$1 = function (container, selector) {\n      return CellSelection.retrieve(container, selector);\n    };\n    var retrieveBox = function (container, firstSelectedSelector, lastSelectedSelector) {\n      return CellSelection.getEdges(container, firstSelectedSelector, lastSelectedSelector).bind(function (edges) {\n        var isRoot = function (ancestor) {\n          return eq(container, ancestor);\n        };\n        var firstAncestor = ancestor$1(edges.first(), 'thead,tfoot,tbody,table', isRoot);\n        var lastAncestor = ancestor$1(edges.last(), 'thead,tfoot,tbody,table', isRoot);\n        return firstAncestor.bind(function (fA) {\n          return lastAncestor.bind(function (lA) {\n            return eq(fA, lA) ? TablePositions.getBox(edges.table(), edges.first(), edges.last()) : Option.none();\n          });\n        });\n      });\n    };\n    var TableSelection = {\n      retrieve: retrieve$1,\n      retrieveBox: retrieveBox\n    };\n\n    var selected = 'data-mce-selected';\n    var selectedSelector = 'td[' + selected + '],th[' + selected + ']';\n    var attributeSelector = '[' + selected + ']';\n    var firstSelected = 'data-mce-first-selected';\n    var firstSelectedSelector = 'td[' + firstSelected + '],th[' + firstSelected + ']';\n    var lastSelected = 'data-mce-last-selected';\n    var lastSelectedSelector = 'td[' + lastSelected + '],th[' + lastSelected + ']';\n    var Ephemera = {\n      selected: constant(selected),\n      selectedSelector: constant(selectedSelector),\n      attributeSelector: constant(attributeSelector),\n      firstSelected: constant(firstSelected),\n      firstSelectedSelector: constant(firstSelectedSelector),\n      lastSelected: constant(lastSelected),\n      lastSelectedSelector: constant(lastSelectedSelector)\n    };\n\n    var generate$1 = function (cases) {\n      if (!isArray(cases)) {\n        throw new Error('cases must be an array');\n      }\n      if (cases.length === 0) {\n        throw new Error('there must be at least one case');\n      }\n      var constructors = [];\n      var adt = {};\n      each(cases, function (acase, count) {\n        var keys$1 = keys(acase);\n        if (keys$1.length !== 1) {\n          throw new Error('one and only one name per case');\n        }\n        var key = keys$1[0];\n        var value = acase[key];\n        if (adt[key] !== undefined) {\n          throw new Error('duplicate key detected:' + key);\n        } else if (key === 'cata') {\n          throw new Error('cannot have a case named cata (sorry)');\n        } else if (!isArray(value)) {\n          throw new Error('case arguments must be an array');\n        }\n        constructors.push(key);\n        adt[key] = function () {\n          var argLength = arguments.length;\n          if (argLength !== value.length) {\n            throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n          }\n          var args = new Array(argLength);\n          for (var i = 0; i < args.length; i++) {\n            args[i] = arguments[i];\n          }\n          var match = function (branches) {\n            var branchKeys = keys(branches);\n            if (constructors.length !== branchKeys.length) {\n              throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n            }\n            var allReqd = forall(constructors, function (reqKey) {\n              return contains(branchKeys, reqKey);\n            });\n            if (!allReqd) {\n              throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n            }\n            return branches[key].apply(null, args);\n          };\n          return {\n            fold: function () {\n              if (arguments.length !== cases.length) {\n                throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + arguments.length);\n              }\n              var target = arguments[count];\n              return target.apply(null, args);\n            },\n            match: match,\n            log: function (label) {\n              domGlobals.console.log(label, {\n                constructors: constructors,\n                constructor: key,\n                params: args\n              });\n            }\n          };\n        };\n      });\n      return adt;\n    };\n    var Adt = { generate: generate$1 };\n\n    var type$1 = Adt.generate([\n      { none: [] },\n      { multiple: ['elements'] },\n      { single: ['selection'] }\n    ]);\n    var cata = function (subject, onNone, onMultiple, onSingle) {\n      return subject.fold(onNone, onMultiple, onSingle);\n    };\n    var SelectionTypes = {\n      cata: cata,\n      none: type$1.none,\n      multiple: type$1.multiple,\n      single: type$1.single\n    };\n\n    var selection = function (cell, selections) {\n      return SelectionTypes.cata(selections.get(), constant([]), identity, constant([cell]));\n    };\n    var unmergable = function (cell, selections) {\n      var hasSpan = function (elem) {\n        return has$1(elem, 'rowspan') && parseInt(get$1(elem, 'rowspan'), 10) > 1 || has$1(elem, 'colspan') && parseInt(get$1(elem, 'colspan'), 10) > 1;\n      };\n      var candidates = selection(cell, selections);\n      return candidates.length > 0 && forall(candidates, hasSpan) ? Option.some(candidates) : Option.none();\n    };\n    var mergable = function (table, selections) {\n      return SelectionTypes.cata(selections.get(), Option.none, function (cells, _env) {\n        if (cells.length === 0) {\n          return Option.none();\n        }\n        return TableSelection.retrieveBox(table, Ephemera.firstSelectedSelector(), Ephemera.lastSelectedSelector()).bind(function (bounds) {\n          return cells.length > 1 ? Option.some({\n            bounds: constant(bounds),\n            cells: constant(cells)\n          }) : Option.none();\n        });\n      }, Option.none);\n    };\n    var CellOperations = {\n      mergable: mergable,\n      unmergable: unmergable,\n      selection: selection\n    };\n\n    var noMenu = function (cell) {\n      return {\n        element: constant(cell),\n        mergable: Option.none,\n        unmergable: Option.none,\n        selection: constant([cell])\n      };\n    };\n    var forMenu = function (selections, table, cell) {\n      return {\n        element: constant(cell),\n        mergable: constant(CellOperations.mergable(table, selections)),\n        unmergable: constant(CellOperations.unmergable(cell, selections)),\n        selection: constant(CellOperations.selection(cell, selections))\n      };\n    };\n    var notCell$1 = function (element) {\n      return noMenu(element);\n    };\n    var paste$1 = Immutable('element', 'clipboard', 'generators');\n    var pasteRows = function (selections, table, cell, clipboard, generators) {\n      return {\n        element: constant(cell),\n        mergable: Option.none,\n        unmergable: Option.none,\n        selection: constant(CellOperations.selection(cell, selections)),\n        clipboard: constant(clipboard),\n        generators: constant(generators)\n      };\n    };\n    var TableTargets = {\n      noMenu: noMenu,\n      forMenu: forMenu,\n      notCell: notCell$1,\n      paste: paste$1,\n      pasteRows: pasteRows\n    };\n\n    var extractSelected = function (cells) {\n      return TableLookup.table(cells[0]).map(deep).map(function (replica) {\n        return [CopySelected.extract(replica, Ephemera.attributeSelector())];\n      });\n    };\n    var serializeElements = function (editor, elements) {\n      return map(elements, function (elm) {\n        return editor.selection.serializer.serialize(elm.dom(), {});\n      }).join('');\n    };\n    var getTextContent = function (elements) {\n      return map(elements, function (element) {\n        return element.dom().innerText;\n      }).join('');\n    };\n    var registerEvents = function (editor, selections, actions, cellSelection) {\n      editor.on('BeforeGetContent', function (e) {\n        var multiCellContext = function (cells) {\n          e.preventDefault();\n          extractSelected(cells).each(function (elements) {\n            e.content = e.format === 'text' ? getTextContent(elements) : serializeElements(editor, elements);\n          });\n        };\n        if (e.selection === true) {\n          SelectionTypes.cata(selections.get(), noop, multiCellContext, noop);\n        }\n      });\n      editor.on('BeforeSetContent', function (e) {\n        if (e.selection === true && e.paste === true) {\n          var cellOpt = Option.from(editor.dom.getParent(editor.selection.getStart(), 'th,td'));\n          cellOpt.each(function (domCell) {\n            var cell = Element.fromDom(domCell);\n            TableLookup.table(cell).each(function (table) {\n              var elements = filter(fromHtml$1(e.content), function (content) {\n                return name(content) !== 'meta';\n              });\n              if (elements.length === 1 && name(elements[0]) === 'table') {\n                e.preventDefault();\n                var doc = Element.fromDom(editor.getDoc());\n                var generators = TableFill.paste(doc);\n                var targets = TableTargets.paste(cell, elements[0], generators);\n                actions.pasteCells(table, targets).each(function (rng) {\n                  editor.selection.setRng(rng);\n                  editor.focus();\n                  cellSelection.clear(table);\n                });\n              }\n            });\n          });\n        }\n      });\n    };\n    var Clipboard = { registerEvents: registerEvents };\n\n    function Dimension (name, getOffset) {\n      var set = function (element, h) {\n        if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n          throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n        }\n        var dom = element.dom();\n        if (isSupported(dom)) {\n          dom.style[name] = h + 'px';\n        }\n      };\n      var get = function (element) {\n        var r = getOffset(element);\n        if (r <= 0 || r === null) {\n          var css = get$2(element, name);\n          return parseFloat(css) || 0;\n        }\n        return r;\n      };\n      var getOuter = get;\n      var aggregate = function (element, properties) {\n        return foldl(properties, function (acc, property) {\n          var val = get$2(element, property);\n          var value = val === undefined ? 0 : parseInt(val, 10);\n          return isNaN(value) ? acc : acc + value;\n        }, 0);\n      };\n      var max = function (element, value, properties) {\n        var cumulativeInclusions = aggregate(element, properties);\n        var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n        return absoluteMax;\n      };\n      return {\n        set: set,\n        get: get,\n        getOuter: getOuter,\n        aggregate: aggregate,\n        max: max\n      };\n    }\n\n    var api$1 = Dimension('height', function (element) {\n      var dom = element.dom();\n      return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n    });\n    var get$4 = function (element) {\n      return api$1.get(element);\n    };\n    var getOuter = function (element) {\n      return api$1.getOuter(element);\n    };\n\n    var api$2 = Dimension('width', function (element) {\n      return element.dom().offsetWidth;\n    });\n    var get$5 = function (element) {\n      return api$2.get(element);\n    };\n    var getOuter$1 = function (element) {\n      return api$2.getOuter(element);\n    };\n\n    var platform$1 = detect$3();\n    var needManualCalc = function () {\n      return platform$1.browser.isIE() || platform$1.browser.isEdge();\n    };\n    var toNumber = function (px, fallback) {\n      var num = parseFloat(px);\n      return isNaN(num) ? fallback : num;\n    };\n    var getProp = function (elm, name, fallback) {\n      return toNumber(get$2(elm, name), fallback);\n    };\n    var getCalculatedHeight = function (cell) {\n      var paddingTop = getProp(cell, 'padding-top', 0);\n      var paddingBottom = getProp(cell, 'padding-bottom', 0);\n      var borderTop = getProp(cell, 'border-top-width', 0);\n      var borderBottom = getProp(cell, 'border-bottom-width', 0);\n      var height = cell.dom().getBoundingClientRect().height;\n      var boxSizing = get$2(cell, 'box-sizing');\n      var borders = borderTop + borderBottom;\n      return boxSizing === 'border-box' ? height : height - paddingTop - paddingBottom - borders;\n    };\n    var getWidth = function (cell) {\n      return getProp(cell, 'width', get$5(cell));\n    };\n    var getHeight = function (cell) {\n      return needManualCalc() ? getCalculatedHeight(cell) : getProp(cell, 'height', get$4(cell));\n    };\n    var RuntimeSize = {\n      getWidth: getWidth,\n      getHeight: getHeight\n    };\n\n    var genericSizeRegex = /(\\d+(\\.\\d+)?)(\\w|%)*/;\n    var percentageBasedSizeRegex = /(\\d+(\\.\\d+)?)%/;\n    var pixelBasedSizeRegex = /(\\d+(\\.\\d+)?)px|em/;\n    var setPixelWidth = function (cell, amount) {\n      set$1(cell, 'width', amount + 'px');\n    };\n    var setPercentageWidth = function (cell, amount) {\n      set$1(cell, 'width', amount + '%');\n    };\n    var setHeight = function (cell, amount) {\n      set$1(cell, 'height', amount + 'px');\n    };\n    var getHeightValue = function (cell) {\n      return getRaw(cell, 'height').getOrThunk(function () {\n        return RuntimeSize.getHeight(cell) + 'px';\n      });\n    };\n    var convert = function (cell, number, getter, setter) {\n      var newSize = TableLookup.table(cell).map(function (table) {\n        var total = getter(table);\n        return Math.floor(number / 100 * total);\n      }).getOr(number);\n      setter(cell, newSize);\n      return newSize;\n    };\n    var normalizePixelSize = function (value, cell, getter, setter) {\n      var number = parseInt(value, 10);\n      return endsWith(value, '%') && name(cell) !== 'table' ? convert(cell, number, getter, setter) : number;\n    };\n    var getTotalHeight = function (cell) {\n      var value = getHeightValue(cell);\n      if (!value) {\n        return get$4(cell);\n      }\n      return normalizePixelSize(value, cell, get$4, setHeight);\n    };\n    var get$6 = function (cell, type, f) {\n      var v = f(cell);\n      var span = getSpan(cell, type);\n      return v / span;\n    };\n    var getSpan = function (cell, type) {\n      return has$1(cell, type) ? parseInt(get$1(cell, type), 10) : 1;\n    };\n    var getRawWidth = function (element) {\n      var cssWidth = getRaw(element, 'width');\n      return cssWidth.fold(function () {\n        return Option.from(get$1(element, 'width'));\n      }, function (width) {\n        return Option.some(width);\n      });\n    };\n    var normalizePercentageWidth = function (cellWidth, tableSize) {\n      return cellWidth / tableSize.pixelWidth() * 100;\n    };\n    var choosePercentageSize = function (element, width, tableSize) {\n      var percentMatch = percentageBasedSizeRegex.exec(width);\n      if (percentMatch !== null) {\n        return parseFloat(percentMatch[1]);\n      } else {\n        var intWidth = get$5(element);\n        return normalizePercentageWidth(intWidth, tableSize);\n      }\n    };\n    var getPercentageWidth = function (cell, tableSize) {\n      var width = getRawWidth(cell);\n      return width.fold(function () {\n        var intWidth = get$5(cell);\n        return normalizePercentageWidth(intWidth, tableSize);\n      }, function (w) {\n        return choosePercentageSize(cell, w, tableSize);\n      });\n    };\n    var normalizePixelWidth = function (cellWidth, tableSize) {\n      return cellWidth / 100 * tableSize.pixelWidth();\n    };\n    var choosePixelSize = function (element, width, tableSize) {\n      var pixelMatch = pixelBasedSizeRegex.exec(width);\n      if (pixelMatch !== null) {\n        return parseInt(pixelMatch[1], 10);\n      }\n      var percentMatch = percentageBasedSizeRegex.exec(width);\n      if (percentMatch !== null) {\n        var floatWidth = parseFloat(percentMatch[1]);\n        return normalizePixelWidth(floatWidth, tableSize);\n      }\n      return get$5(element);\n    };\n    var getPixelWidth = function (cell, tableSize) {\n      var width = getRawWidth(cell);\n      return width.fold(function () {\n        return get$5(cell);\n      }, function (w) {\n        return choosePixelSize(cell, w, tableSize);\n      });\n    };\n    var getHeight$1 = function (cell) {\n      return get$6(cell, 'rowspan', getTotalHeight);\n    };\n    var getGenericWidth = function (cell) {\n      var width = getRawWidth(cell);\n      return width.bind(function (w) {\n        var match = genericSizeRegex.exec(w);\n        if (match !== null) {\n          return Option.some({\n            width: constant(parseFloat(match[1])),\n            unit: constant(match[3])\n          });\n        } else {\n          return Option.none();\n        }\n      });\n    };\n    var setGenericWidth = function (cell, amount, unit) {\n      set$1(cell, 'width', amount + unit);\n    };\n    var Sizes = {\n      percentageBasedSizeRegex: constant(percentageBasedSizeRegex),\n      pixelBasedSizeRegex: constant(pixelBasedSizeRegex),\n      setPixelWidth: setPixelWidth,\n      setPercentageWidth: setPercentageWidth,\n      setHeight: setHeight,\n      getPixelWidth: getPixelWidth,\n      getPercentageWidth: getPercentageWidth,\n      getGenericWidth: getGenericWidth,\n      setGenericWidth: setGenericWidth,\n      getHeight: getHeight$1,\n      getRawWidth: getRawWidth\n    };\n\n    var halve = function (main, other) {\n      var width = Sizes.getGenericWidth(main);\n      width.each(function (w) {\n        var newWidth = w.width() / 2;\n        Sizes.setGenericWidth(main, newWidth, w.unit());\n        Sizes.setGenericWidth(other, newWidth, w.unit());\n      });\n    };\n    var CellMutations = { halve: halve };\n\n    var r = function (left, top) {\n      var translate = function (x, y) {\n        return r(left + x, top + y);\n      };\n      return {\n        left: constant(left),\n        top: constant(top),\n        translate: translate\n      };\n    };\n    var Position = r;\n\n    var boxPosition = function (dom) {\n      var box = dom.getBoundingClientRect();\n      return Position(box.left, box.top);\n    };\n    var firstDefinedOrZero = function (a, b) {\n      return a !== undefined ? a : b !== undefined ? b : 0;\n    };\n    var absolute = function (element) {\n      var doc = element.dom().ownerDocument;\n      var body = doc.body;\n      var win = doc.defaultView;\n      var html = doc.documentElement;\n      if (body === element.dom()) {\n        return Position(body.offsetLeft, body.offsetTop);\n      }\n      var scrollTop = firstDefinedOrZero(win.pageYOffset, html.scrollTop);\n      var scrollLeft = firstDefinedOrZero(win.pageXOffset, html.scrollLeft);\n      var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n      var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n      return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n    };\n    var viewport = function (element) {\n      var dom = element.dom();\n      var doc = dom.ownerDocument;\n      var body = doc.body;\n      if (body === dom) {\n        return Position(body.offsetLeft, body.offsetTop);\n      }\n      if (!inBody(element)) {\n        return Position(0, 0);\n      }\n      return boxPosition(dom);\n    };\n\n    var rowInfo = Immutable('row', 'y');\n    var colInfo = Immutable('col', 'x');\n    var rtlEdge = function (cell) {\n      var pos = absolute(cell);\n      return pos.left() + getOuter$1(cell);\n    };\n    var ltrEdge = function (cell) {\n      return absolute(cell).left();\n    };\n    var getLeftEdge = function (index, cell) {\n      return colInfo(index, ltrEdge(cell));\n    };\n    var getRightEdge = function (index, cell) {\n      return colInfo(index, rtlEdge(cell));\n    };\n    var getTop = function (cell) {\n      return absolute(cell).top();\n    };\n    var getTopEdge = function (index, cell) {\n      return rowInfo(index, getTop(cell));\n    };\n    var getBottomEdge = function (index, cell) {\n      return rowInfo(index, getTop(cell) + getOuter(cell));\n    };\n    var findPositions = function (getInnerEdge, getOuterEdge, array) {\n      if (array.length === 0) {\n        return [];\n      }\n      var lines = map(array.slice(1), function (cellOption, index) {\n        return cellOption.map(function (cell) {\n          return getInnerEdge(index, cell);\n        });\n      });\n      var lastLine = array[array.length - 1].map(function (cell) {\n        return getOuterEdge(array.length - 1, cell);\n      });\n      return lines.concat([lastLine]);\n    };\n    var negate = function (step) {\n      return -step;\n    };\n    var height = {\n      delta: identity,\n      positions: function (optElements) {\n        return findPositions(getTopEdge, getBottomEdge, optElements);\n      },\n      edge: getTop\n    };\n    var ltr = {\n      delta: identity,\n      edge: ltrEdge,\n      positions: function (optElements) {\n        return findPositions(getLeftEdge, getRightEdge, optElements);\n      }\n    };\n    var rtl = {\n      delta: negate,\n      edge: rtlEdge,\n      positions: function (optElements) {\n        return findPositions(getRightEdge, getLeftEdge, optElements);\n      }\n    };\n    var BarPositions = {\n      height: height,\n      rtl: rtl,\n      ltr: ltr\n    };\n\n    var ResizeDirection = {\n      ltr: BarPositions.ltr,\n      rtl: BarPositions.rtl\n    };\n\n    function TableDirection (directionAt) {\n      var auto = function (table) {\n        return directionAt(table).isRtl() ? ResizeDirection.rtl : ResizeDirection.ltr;\n      };\n      var delta = function (amount, table) {\n        return auto(table).delta(amount, table);\n      };\n      var positions = function (cols, table) {\n        return auto(table).positions(cols, table);\n      };\n      var edge = function (cell) {\n        return auto(cell).edge(cell);\n      };\n      return {\n        delta: delta,\n        edge: edge,\n        positions: positions\n      };\n    }\n\n    var getGridSize = function (table) {\n      var input = DetailsList.fromTable(table);\n      var warehouse = Warehouse.generate(input);\n      return warehouse.grid();\n    };\n    var TableGridSize = { getGridSize: getGridSize };\n\n    var cat = function (arr) {\n      var r = [];\n      var push = function (x) {\n        r.push(x);\n      };\n      for (var i = 0; i < arr.length; i++) {\n        arr[i].each(push);\n      }\n      return r;\n    };\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Option.none();\n    };\n\n    var setIfNot = function (element, property, value, ignore) {\n      if (value === ignore) {\n        remove(element, property);\n      } else {\n        set(element, property, value);\n      }\n    };\n    var render = function (table, grid) {\n      var newRows = [];\n      var newCells = [];\n      var renderSection = function (gridSection, sectionName) {\n        var section = child$2(table, sectionName).getOrThunk(function () {\n          var tb = Element.fromTag(sectionName, owner(table).dom());\n          append(table, tb);\n          return tb;\n        });\n        empty(section);\n        var rows = map(gridSection, function (row) {\n          if (row.isNew()) {\n            newRows.push(row.element());\n          }\n          var tr = row.element();\n          empty(tr);\n          each(row.cells(), function (cell) {\n            if (cell.isNew()) {\n              newCells.push(cell.element());\n            }\n            setIfNot(cell.element(), 'colspan', cell.colspan(), 1);\n            setIfNot(cell.element(), 'rowspan', cell.rowspan(), 1);\n            append(tr, cell.element());\n          });\n          return tr;\n        });\n        append$1(section, rows);\n      };\n      var removeSection = function (sectionName) {\n        child$2(table, sectionName).each(remove$2);\n      };\n      var renderOrRemoveSection = function (gridSection, sectionName) {\n        if (gridSection.length > 0) {\n          renderSection(gridSection, sectionName);\n        } else {\n          removeSection(sectionName);\n        }\n      };\n      var headSection = [];\n      var bodySection = [];\n      var footSection = [];\n      each(grid, function (row) {\n        switch (row.section()) {\n        case 'thead':\n          headSection.push(row);\n          break;\n        case 'tbody':\n          bodySection.push(row);\n          break;\n        case 'tfoot':\n          footSection.push(row);\n          break;\n        }\n      });\n      renderOrRemoveSection(headSection, 'thead');\n      renderOrRemoveSection(bodySection, 'tbody');\n      renderOrRemoveSection(footSection, 'tfoot');\n      return {\n        newRows: constant(newRows),\n        newCells: constant(newCells)\n      };\n    };\n    var copy$2 = function (grid) {\n      var rows = map(grid, function (row) {\n        var tr = shallow(row.element());\n        each(row.cells(), function (cell) {\n          var clonedCell = deep(cell.element());\n          setIfNot(clonedCell, 'colspan', cell.colspan(), 1);\n          setIfNot(clonedCell, 'rowspan', cell.rowspan(), 1);\n          append(tr, clonedCell);\n        });\n        return tr;\n      });\n      return rows;\n    };\n    var Redraw = {\n      render: render,\n      copy: copy$2\n    };\n\n    var read = function (element, attr) {\n      var value = get$1(element, attr);\n      return value === undefined || value === '' ? [] : value.split(' ');\n    };\n    var add = function (element, attr, id) {\n      var old = read(element, attr);\n      var nu = old.concat([id]);\n      set(element, attr, nu.join(' '));\n      return true;\n    };\n    var remove$3 = function (element, attr, id) {\n      var nu = filter(read(element, attr), function (v) {\n        return v !== id;\n      });\n      if (nu.length > 0) {\n        set(element, attr, nu.join(' '));\n      } else {\n        remove(element, attr);\n      }\n      return false;\n    };\n\n    var supports = function (element) {\n      return element.dom().classList !== undefined;\n    };\n    var get$7 = function (element) {\n      return read(element, 'class');\n    };\n    var add$1 = function (element, clazz) {\n      return add(element, 'class', clazz);\n    };\n    var remove$4 = function (element, clazz) {\n      return remove$3(element, 'class', clazz);\n    };\n\n    var add$2 = function (element, clazz) {\n      if (supports(element)) {\n        element.dom().classList.add(clazz);\n      } else {\n        add$1(element, clazz);\n      }\n    };\n    var cleanClass = function (element) {\n      var classList = supports(element) ? element.dom().classList : get$7(element);\n      if (classList.length === 0) {\n        remove(element, 'class');\n      }\n    };\n    var remove$5 = function (element, clazz) {\n      if (supports(element)) {\n        var classList = element.dom().classList;\n        classList.remove(clazz);\n      } else {\n        remove$4(element, clazz);\n      }\n      cleanClass(element);\n    };\n    var has$2 = function (element, clazz) {\n      return supports(element) && element.dom().classList.contains(clazz);\n    };\n\n    var repeat = function (repititions, f) {\n      var r = [];\n      for (var i = 0; i < repititions; i++) {\n        r.push(f(i));\n      }\n      return r;\n    };\n    var range = function (start, end) {\n      var r = [];\n      for (var i = start; i < end; i++) {\n        r.push(i);\n      }\n      return r;\n    };\n    var deduce = function (xs, index) {\n      if (index < 0 || index >= xs.length - 1) {\n        return Option.none();\n      }\n      var current = xs[index].fold(function () {\n        var rest = reverse(xs.slice(0, index));\n        return findMap(rest, function (a, i) {\n          return a.map(function (aa) {\n            return {\n              value: aa,\n              delta: i + 1\n            };\n          });\n        });\n      }, function (c) {\n        return Option.some({\n          value: c,\n          delta: 0\n        });\n      });\n      var next = xs[index + 1].fold(function () {\n        var rest = xs.slice(index + 1);\n        return findMap(rest, function (a, i) {\n          return a.map(function (aa) {\n            return {\n              value: aa,\n              delta: i + 1\n            };\n          });\n        });\n      }, function (n) {\n        return Option.some({\n          value: n,\n          delta: 1\n        });\n      });\n      return current.bind(function (c) {\n        return next.map(function (n) {\n          var extras = n.delta + c.delta;\n          return Math.abs(n.value - c.value) / extras;\n        });\n      });\n    };\n\n    var columns = function (warehouse) {\n      var grid = warehouse.grid();\n      var cols = range(0, grid.columns());\n      var rowsArr = range(0, grid.rows());\n      return map(cols, function (col) {\n        var getBlock = function () {\n          return bind(rowsArr, function (r) {\n            return Warehouse.getAt(warehouse, r, col).filter(function (detail) {\n              return detail.column() === col;\n            }).fold(constant([]), function (detail) {\n              return [detail];\n            });\n          });\n        };\n        var isSingle = function (detail) {\n          return detail.colspan() === 1;\n        };\n        var getFallback = function () {\n          return Warehouse.getAt(warehouse, 0, col);\n        };\n        return decide(getBlock, isSingle, getFallback);\n      });\n    };\n    var decide = function (getBlock, isSingle, getFallback) {\n      var inBlock = getBlock();\n      var singleInBlock = find(inBlock, isSingle);\n      var detailOption = singleInBlock.orThunk(function () {\n        return Option.from(inBlock[0]).orThunk(getFallback);\n      });\n      return detailOption.map(function (detail) {\n        return detail.element();\n      });\n    };\n    var rows$1 = function (warehouse) {\n      var grid = warehouse.grid();\n      var rowsArr = range(0, grid.rows());\n      var cols = range(0, grid.columns());\n      return map(rowsArr, function (row) {\n        var getBlock = function () {\n          return bind(cols, function (c) {\n            return Warehouse.getAt(warehouse, row, c).filter(function (detail) {\n              return detail.row() === row;\n            }).fold(constant([]), function (detail) {\n              return [detail];\n            });\n          });\n        };\n        var isSingle = function (detail) {\n          return detail.rowspan() === 1;\n        };\n        var getFallback = function () {\n          return Warehouse.getAt(warehouse, row, 0);\n        };\n        return decide(getBlock, isSingle, getFallback);\n      });\n    };\n    var Blocks = {\n      columns: columns,\n      rows: rows$1\n    };\n\n    var css = function (namespace) {\n      var dashNamespace = namespace.replace(/\\./g, '-');\n      var resolve = function (str) {\n        return dashNamespace + '-' + str;\n      };\n      return { resolve: resolve };\n    };\n\n    var styles = css('ephox-snooker');\n    var Styles = { resolve: styles.resolve };\n\n    var col = function (column, x, y, w, h) {\n      var blocker = Element.fromTag('div');\n      setAll$1(blocker, {\n        position: 'absolute',\n        left: x - w / 2 + 'px',\n        top: y + 'px',\n        height: h + 'px',\n        width: w + 'px'\n      });\n      setAll(blocker, {\n        'data-column': column,\n        'role': 'presentation'\n      });\n      return blocker;\n    };\n    var row$1 = function (r, x, y, w, h) {\n      var blocker = Element.fromTag('div');\n      setAll$1(blocker, {\n        position: 'absolute',\n        left: x + 'px',\n        top: y - h / 2 + 'px',\n        height: h + 'px',\n        width: w + 'px'\n      });\n      setAll(blocker, {\n        'data-row': r,\n        'role': 'presentation'\n      });\n      return blocker;\n    };\n    var Bar = {\n      col: col,\n      row: row$1\n    };\n\n    var resizeBar = Styles.resolve('resizer-bar');\n    var resizeRowBar = Styles.resolve('resizer-rows');\n    var resizeColBar = Styles.resolve('resizer-cols');\n    var BAR_THICKNESS = 7;\n    var destroy = function (wire) {\n      var previous = descendants$1(wire.parent(), '.' + resizeBar);\n      each(previous, remove$2);\n    };\n    var drawBar = function (wire, positions, create) {\n      var origin = wire.origin();\n      each(positions, function (cpOption, i) {\n        cpOption.each(function (cp) {\n          var bar = create(origin, cp);\n          add$2(bar, resizeBar);\n          append(wire.parent(), bar);\n        });\n      });\n    };\n    var refreshCol = function (wire, colPositions, position, tableHeight) {\n      drawBar(wire, colPositions, function (origin, cp) {\n        var colBar = Bar.col(cp.col(), cp.x() - origin.left(), position.top() - origin.top(), BAR_THICKNESS, tableHeight);\n        add$2(colBar, resizeColBar);\n        return colBar;\n      });\n    };\n    var refreshRow = function (wire, rowPositions, position, tableWidth) {\n      drawBar(wire, rowPositions, function (origin, cp) {\n        var rowBar = Bar.row(cp.row(), position.left() - origin.left(), cp.y() - origin.top(), tableWidth, BAR_THICKNESS);\n        add$2(rowBar, resizeRowBar);\n        return rowBar;\n      });\n    };\n    var refreshGrid = function (wire, table, rows, cols, hdirection, vdirection) {\n      var position = absolute(table);\n      var rowPositions = rows.length > 0 ? hdirection.positions(rows, table) : [];\n      refreshRow(wire, rowPositions, position, getOuter$1(table));\n      var colPositions = cols.length > 0 ? vdirection.positions(cols, table) : [];\n      refreshCol(wire, colPositions, position, getOuter(table));\n    };\n    var refresh = function (wire, table, hdirection, vdirection) {\n      destroy(wire);\n      var list = DetailsList.fromTable(table);\n      var warehouse = Warehouse.generate(list);\n      var rows = Blocks.rows(warehouse);\n      var cols = Blocks.columns(warehouse);\n      refreshGrid(wire, table, rows, cols, hdirection, vdirection);\n    };\n    var each$2 = function (wire, f) {\n      var bars = descendants$1(wire.parent(), '.' + resizeBar);\n      each(bars, f);\n    };\n    var hide = function (wire) {\n      each$2(wire, function (bar) {\n        set$1(bar, 'display', 'none');\n      });\n    };\n    var show = function (wire) {\n      each$2(wire, function (bar) {\n        set$1(bar, 'display', 'block');\n      });\n    };\n    var isRowBar = function (element) {\n      return has$2(element, resizeRowBar);\n    };\n    var isColBar = function (element) {\n      return has$2(element, resizeColBar);\n    };\n    var Bars = {\n      refresh: refresh,\n      hide: hide,\n      show: show,\n      destroy: destroy,\n      isRowBar: isRowBar,\n      isColBar: isColBar\n    };\n\n    var addCell = function (gridRow, index, cell) {\n      var cells = gridRow.cells();\n      var before = cells.slice(0, index);\n      var after = cells.slice(index);\n      var newCells = before.concat([cell]).concat(after);\n      return setCells(gridRow, newCells);\n    };\n    var mutateCell = function (gridRow, index, cell) {\n      var cells = gridRow.cells();\n      cells[index] = cell;\n    };\n    var setCells = function (gridRow, cells) {\n      return rowcells(cells, gridRow.section());\n    };\n    var mapCells = function (gridRow, f) {\n      var cells = gridRow.cells();\n      var r = map(cells, f);\n      return rowcells(r, gridRow.section());\n    };\n    var getCell = function (gridRow, index) {\n      return gridRow.cells()[index];\n    };\n    var getCellElement = function (gridRow, index) {\n      return getCell(gridRow, index).element();\n    };\n    var cellLength = function (gridRow) {\n      return gridRow.cells().length;\n    };\n    var GridRow = {\n      addCell: addCell,\n      setCells: setCells,\n      mutateCell: mutateCell,\n      getCell: getCell,\n      getCellElement: getCellElement,\n      mapCells: mapCells,\n      cellLength: cellLength\n    };\n\n    var getColumn = function (grid, index) {\n      return map(grid, function (row) {\n        return GridRow.getCell(row, index);\n      });\n    };\n    var getRow = function (grid, index) {\n      return grid[index];\n    };\n    var findDiff = function (xs, comp) {\n      if (xs.length === 0) {\n        return 0;\n      }\n      var first = xs[0];\n      var index = findIndex(xs, function (x) {\n        return !comp(first.element(), x.element());\n      });\n      return index.fold(function () {\n        return xs.length;\n      }, function (ind) {\n        return ind;\n      });\n    };\n    var subgrid = function (grid, row, column, comparator) {\n      var restOfRow = getRow(grid, row).cells().slice(column);\n      var endColIndex = findDiff(restOfRow, comparator);\n      var restOfColumn = getColumn(grid, column).slice(row);\n      var endRowIndex = findDiff(restOfColumn, comparator);\n      return {\n        colspan: constant(endColIndex),\n        rowspan: constant(endRowIndex)\n      };\n    };\n    var TableGrid = { subgrid: subgrid };\n\n    var toDetails = function (grid, comparator) {\n      var seen = map(grid, function (row, ri) {\n        return map(row.cells(), function (col, ci) {\n          return false;\n        });\n      });\n      var updateSeen = function (ri, ci, rowspan, colspan) {\n        for (var r = ri; r < ri + rowspan; r++) {\n          for (var c = ci; c < ci + colspan; c++) {\n            seen[r][c] = true;\n          }\n        }\n      };\n      return map(grid, function (row, ri) {\n        var details = bind(row.cells(), function (cell, ci) {\n          if (seen[ri][ci] === false) {\n            var result = TableGrid.subgrid(grid, ri, ci, comparator);\n            updateSeen(ri, ci, result.rowspan(), result.colspan());\n            return [detailnew(cell.element(), result.rowspan(), result.colspan(), cell.isNew())];\n          } else {\n            return [];\n          }\n        });\n        return rowdetails(details, row.section());\n      });\n    };\n    var toGrid = function (warehouse, generators, isNew) {\n      var grid = [];\n      for (var i = 0; i < warehouse.grid().rows(); i++) {\n        var rowCells = [];\n        for (var j = 0; j < warehouse.grid().columns(); j++) {\n          var element = Warehouse.getAt(warehouse, i, j).map(function (item) {\n            return elementnew(item.element(), isNew);\n          }).getOrThunk(function () {\n            return elementnew(generators.gap(), true);\n          });\n          rowCells.push(element);\n        }\n        var row = rowcells(rowCells, warehouse.all()[i].section());\n        grid.push(row);\n      }\n      return grid;\n    };\n    var Transitions = {\n      toDetails: toDetails,\n      toGrid: toGrid\n    };\n\n    var fromWarehouse = function (warehouse, generators) {\n      return Transitions.toGrid(warehouse, generators, false);\n    };\n    var deriveRows = function (rendered, generators) {\n      var findRow = function (details) {\n        var rowOfCells = findMap(details, function (detail) {\n          return parent(detail.element()).map(function (row) {\n            var isNew = parent(row).isNone();\n            return elementnew(row, isNew);\n          });\n        });\n        return rowOfCells.getOrThunk(function () {\n          return elementnew(generators.row(), true);\n        });\n      };\n      return map(rendered, function (details) {\n        var row = findRow(details.details());\n        return rowdatanew(row.element(), details.details(), details.section(), row.isNew());\n      });\n    };\n    var toDetailList = function (grid, generators) {\n      var rendered = Transitions.toDetails(grid, eq);\n      return deriveRows(rendered, generators);\n    };\n    var findInWarehouse = function (warehouse, element) {\n      var all = flatten(map(warehouse.all(), function (r) {\n        return r.cells();\n      }));\n      return find(all, function (e) {\n        return eq(element, e.element());\n      });\n    };\n    var run = function (operation, extract, adjustment, postAction, genWrappers) {\n      return function (wire, table, target, generators, direction) {\n        var input = DetailsList.fromTable(table);\n        var warehouse = Warehouse.generate(input);\n        var output = extract(warehouse, target).map(function (info) {\n          var model = fromWarehouse(warehouse, generators);\n          var result = operation(model, info, eq, genWrappers(generators));\n          var grid = toDetailList(result.grid(), generators);\n          return {\n            grid: constant(grid),\n            cursor: result.cursor\n          };\n        });\n        return output.fold(function () {\n          return Option.none();\n        }, function (out) {\n          var newElements = Redraw.render(table, out.grid());\n          adjustment(table, out.grid(), direction);\n          postAction(table);\n          Bars.refresh(wire, table, BarPositions.height, direction);\n          return Option.some({\n            cursor: out.cursor,\n            newRows: newElements.newRows,\n            newCells: newElements.newCells\n          });\n        });\n      };\n    };\n    var onCell = function (warehouse, target) {\n      return TableLookup.cell(target.element()).bind(function (cell) {\n        return findInWarehouse(warehouse, cell);\n      });\n    };\n    var onPaste = function (warehouse, target) {\n      return TableLookup.cell(target.element()).bind(function (cell) {\n        return findInWarehouse(warehouse, cell).map(function (details) {\n          var value = __assign(__assign({}, details), {\n            generators: target.generators,\n            clipboard: target.clipboard\n          });\n          return value;\n        });\n      });\n    };\n    var onPasteRows = function (warehouse, target) {\n      var details = map(target.selection(), function (cell) {\n        return TableLookup.cell(cell).bind(function (lc) {\n          return findInWarehouse(warehouse, lc);\n        });\n      });\n      var cells = cat(details);\n      return cells.length > 0 ? Option.some({\n        cells: cells,\n        generators: target.generators,\n        clipboard: target.clipboard\n      }) : Option.none();\n    };\n    var onMergable = function (_warehouse, target) {\n      return target.mergable();\n    };\n    var onUnmergable = function (_warehouse, target) {\n      return target.unmergable();\n    };\n    var onCells = function (warehouse, target) {\n      var details = map(target.selection(), function (cell) {\n        return TableLookup.cell(cell).bind(function (lc) {\n          return findInWarehouse(warehouse, lc);\n        });\n      });\n      var cells = cat(details);\n      return cells.length > 0 ? Option.some(cells) : Option.none();\n    };\n\n    var value = function (o) {\n      var is = function (v) {\n        return o === v;\n      };\n      var or = function (opt) {\n        return value(o);\n      };\n      var orThunk = function (f) {\n        return value(o);\n      };\n      var map = function (f) {\n        return value(f(o));\n      };\n      var mapError = function (f) {\n        return value(o);\n      };\n      var each = function (f) {\n        f(o);\n      };\n      var bind = function (f) {\n        return f(o);\n      };\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n      var exists = function (f) {\n        return f(o);\n      };\n      var forall = function (f) {\n        return f(o);\n      };\n      var toOption = function () {\n        return Option.some(o);\n      };\n      return {\n        is: is,\n        isValue: always,\n        isError: never,\n        getOr: constant(o),\n        getOrThunk: constant(o),\n        getOrDie: constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOption: toOption\n      };\n    };\n    var error = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n      var getOrDie = function () {\n        return die(String(message))();\n      };\n      var or = function (opt) {\n        return opt;\n      };\n      var orThunk = function (f) {\n        return f();\n      };\n      var map = function (f) {\n        return error(message);\n      };\n      var mapError = function (f) {\n        return error(f(message));\n      };\n      var bind = function (f) {\n        return error(message);\n      };\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n      return {\n        is: never,\n        isValue: never,\n        isError: always,\n        getOr: identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOption: Option.none\n      };\n    };\n    var fromOption = function (opt, err) {\n      return opt.fold(function () {\n        return error(err);\n      }, value);\n    };\n    var Result = {\n      value: value,\n      error: error,\n      fromOption: fromOption\n    };\n\n    var measure = function (startAddress, gridA, gridB) {\n      if (startAddress.row() >= gridA.length || startAddress.column() > GridRow.cellLength(gridA[0])) {\n        return Result.error('invalid start address out of table bounds, row: ' + startAddress.row() + ', column: ' + startAddress.column());\n      }\n      var rowRemainder = gridA.slice(startAddress.row());\n      var colRemainder = rowRemainder[0].cells().slice(startAddress.column());\n      var colRequired = GridRow.cellLength(gridB[0]);\n      var rowRequired = gridB.length;\n      return Result.value({\n        rowDelta: constant(rowRemainder.length - rowRequired),\n        colDelta: constant(colRemainder.length - colRequired)\n      });\n    };\n    var measureWidth = function (gridA, gridB) {\n      var colLengthA = GridRow.cellLength(gridA[0]);\n      var colLengthB = GridRow.cellLength(gridB[0]);\n      return {\n        rowDelta: constant(0),\n        colDelta: constant(colLengthA - colLengthB)\n      };\n    };\n    var fill = function (cells, generator) {\n      return map(cells, function () {\n        return elementnew(generator.cell(), true);\n      });\n    };\n    var rowFill = function (grid, amount, generator) {\n      return grid.concat(repeat(amount, function (_row) {\n        return GridRow.setCells(grid[grid.length - 1], fill(grid[grid.length - 1].cells(), generator));\n      }));\n    };\n    var colFill = function (grid, amount, generator) {\n      return map(grid, function (row) {\n        return GridRow.setCells(row, row.cells().concat(fill(range(0, amount), generator)));\n      });\n    };\n    var tailor = function (gridA, delta, generator) {\n      var fillCols = delta.colDelta() < 0 ? colFill : identity;\n      var fillRows = delta.rowDelta() < 0 ? rowFill : identity;\n      var modifiedCols = fillCols(gridA, Math.abs(delta.colDelta()), generator);\n      var tailoredGrid = fillRows(modifiedCols, Math.abs(delta.rowDelta()), generator);\n      return tailoredGrid;\n    };\n    var Fitment = {\n      measure: measure,\n      measureWidth: measureWidth,\n      tailor: tailor\n    };\n\n    var merge = function (grid, bounds, comparator, substitution) {\n      if (grid.length === 0) {\n        return grid;\n      }\n      for (var i = bounds.startRow(); i <= bounds.finishRow(); i++) {\n        for (var j = bounds.startCol(); j <= bounds.finishCol(); j++) {\n          GridRow.mutateCell(grid[i], j, elementnew(substitution(), false));\n        }\n      }\n      return grid;\n    };\n    var unmerge = function (grid, target, comparator, substitution) {\n      var first = true;\n      for (var i = 0; i < grid.length; i++) {\n        for (var j = 0; j < GridRow.cellLength(grid[0]); j++) {\n          var current = GridRow.getCellElement(grid[i], j);\n          var isToReplace = comparator(current, target);\n          if (isToReplace === true && first === false) {\n            GridRow.mutateCell(grid[i], j, elementnew(substitution(), true));\n          } else if (isToReplace === true) {\n            first = false;\n          }\n        }\n      }\n      return grid;\n    };\n    var uniqueCells = function (row, comparator) {\n      return foldl(row, function (rest, cell) {\n        return exists(rest, function (currentCell) {\n          return comparator(currentCell.element(), cell.element());\n        }) ? rest : rest.concat([cell]);\n      }, []);\n    };\n    var splitRows = function (grid, index, comparator, substitution) {\n      if (index > 0 && index < grid.length) {\n        var rowPrevCells = grid[index - 1].cells();\n        var cells = uniqueCells(rowPrevCells, comparator);\n        each(cells, function (cell) {\n          var replacement = Option.none();\n          var _loop_1 = function (i) {\n            var _loop_2 = function (j) {\n              var current = grid[i].cells()[j];\n              var isToReplace = comparator(current.element(), cell.element());\n              if (isToReplace) {\n                if (replacement.isNone()) {\n                  replacement = Option.some(substitution());\n                }\n                replacement.each(function (sub) {\n                  GridRow.mutateCell(grid[i], j, elementnew(sub, true));\n                });\n              }\n            };\n            for (var j = 0; j < GridRow.cellLength(grid[0]); j++) {\n              _loop_2(j);\n            }\n          };\n          for (var i = index; i < grid.length; i++) {\n            _loop_1(i);\n          }\n        });\n      }\n      return grid;\n    };\n    var MergingOperations = {\n      merge: merge,\n      unmerge: unmerge,\n      splitRows: splitRows\n    };\n\n    var isSpanning = function (grid, row, col, comparator) {\n      var candidate = GridRow.getCell(grid[row], col);\n      var matching = curry(comparator, candidate.element());\n      var currentRow = grid[row];\n      return grid.length > 1 && GridRow.cellLength(currentRow) > 1 && (col > 0 && matching(GridRow.getCellElement(currentRow, col - 1)) || col < currentRow.cells().length - 1 && matching(GridRow.getCellElement(currentRow, col + 1)) || row > 0 && matching(GridRow.getCellElement(grid[row - 1], col)) || row < grid.length - 1 && matching(GridRow.getCellElement(grid[row + 1], col)));\n    };\n    var mergeTables = function (startAddress, gridA, gridB, generator, comparator) {\n      var startRow = startAddress.row();\n      var startCol = startAddress.column();\n      var mergeHeight = gridB.length;\n      var mergeWidth = GridRow.cellLength(gridB[0]);\n      var endRow = startRow + mergeHeight;\n      var endCol = startCol + mergeWidth;\n      for (var r = startRow; r < endRow; r++) {\n        for (var c = startCol; c < endCol; c++) {\n          if (isSpanning(gridA, r, c, comparator)) {\n            MergingOperations.unmerge(gridA, GridRow.getCellElement(gridA[r], c), comparator, generator.cell);\n          }\n          var newCell = GridRow.getCellElement(gridB[r - startRow], c - startCol);\n          var replacement = generator.replace(newCell);\n          GridRow.mutateCell(gridA[r], c, elementnew(replacement, true));\n        }\n      }\n      return gridA;\n    };\n    var merge$1 = function (startAddress, gridA, gridB, generator, comparator) {\n      var result = Fitment.measure(startAddress, gridA, gridB);\n      return result.map(function (delta) {\n        var fittedGrid = Fitment.tailor(gridA, delta, generator);\n        return mergeTables(startAddress, fittedGrid, gridB, generator, comparator);\n      });\n    };\n    var insert = function (index, gridA, gridB, generator, comparator) {\n      MergingOperations.splitRows(gridA, index, comparator, generator.cell);\n      var delta = Fitment.measureWidth(gridB, gridA);\n      var fittedNewGrid = Fitment.tailor(gridB, delta, generator);\n      var secondDelta = Fitment.measureWidth(gridA, fittedNewGrid);\n      var fittedOldGrid = Fitment.tailor(gridA, secondDelta, generator);\n      return fittedOldGrid.slice(0, index).concat(fittedNewGrid).concat(fittedOldGrid.slice(index, fittedOldGrid.length));\n    };\n    var TableMerge = {\n      merge: merge$1,\n      insert: insert\n    };\n\n    var insertRowAt = function (grid, index, example, comparator, substitution) {\n      var before = grid.slice(0, index);\n      var after = grid.slice(index);\n      var between = GridRow.mapCells(grid[example], function (ex, c) {\n        var withinSpan = index > 0 && index < grid.length && comparator(GridRow.getCellElement(grid[index - 1], c), GridRow.getCellElement(grid[index], c));\n        var ret = withinSpan ? GridRow.getCell(grid[index], c) : elementnew(substitution(ex.element(), comparator), true);\n        return ret;\n      });\n      return before.concat([between]).concat(after);\n    };\n    var insertColumnAt = function (grid, index, example, comparator, substitution) {\n      return map(grid, function (row) {\n        var withinSpan = index > 0 && index < GridRow.cellLength(row) && comparator(GridRow.getCellElement(row, index - 1), GridRow.getCellElement(row, index));\n        var sub = withinSpan ? GridRow.getCell(row, index) : elementnew(substitution(GridRow.getCellElement(row, example), comparator), true);\n        return GridRow.addCell(row, index, sub);\n      });\n    };\n    var splitCellIntoColumns = function (grid, exampleRow, exampleCol, comparator, substitution) {\n      var index = exampleCol + 1;\n      return map(grid, function (row, i) {\n        var isTargetCell = i === exampleRow;\n        var sub = isTargetCell ? elementnew(substitution(GridRow.getCellElement(row, exampleCol), comparator), true) : GridRow.getCell(row, exampleCol);\n        return GridRow.addCell(row, index, sub);\n      });\n    };\n    var splitCellIntoRows = function (grid, exampleRow, exampleCol, comparator, substitution) {\n      var index = exampleRow + 1;\n      var before = grid.slice(0, index);\n      var after = grid.slice(index);\n      var between = GridRow.mapCells(grid[exampleRow], function (ex, i) {\n        var isTargetCell = i === exampleCol;\n        return isTargetCell ? elementnew(substitution(ex.element(), comparator), true) : ex;\n      });\n      return before.concat([between]).concat(after);\n    };\n    var deleteColumnsAt = function (grid, start, finish) {\n      var rows = map(grid, function (row) {\n        var cells = row.cells().slice(0, start).concat(row.cells().slice(finish + 1));\n        return rowcells(cells, row.section());\n      });\n      return filter(rows, function (row) {\n        return row.cells().length > 0;\n      });\n    };\n    var deleteRowsAt = function (grid, start, finish) {\n      return grid.slice(0, start).concat(grid.slice(finish + 1));\n    };\n    var ModificationOperations = {\n      insertRowAt: insertRowAt,\n      insertColumnAt: insertColumnAt,\n      splitCellIntoColumns: splitCellIntoColumns,\n      splitCellIntoRows: splitCellIntoRows,\n      deleteRowsAt: deleteRowsAt,\n      deleteColumnsAt: deleteColumnsAt\n    };\n\n    var replaceIn = function (grid, targets, comparator, substitution) {\n      var isTarget = function (cell) {\n        return exists(targets, function (target) {\n          return comparator(cell.element(), target.element());\n        });\n      };\n      return map(grid, function (row) {\n        return GridRow.mapCells(row, function (cell) {\n          return isTarget(cell) ? elementnew(substitution(cell.element(), comparator), true) : cell;\n        });\n      });\n    };\n    var notStartRow = function (grid, rowIndex, colIndex, comparator) {\n      return GridRow.getCellElement(grid[rowIndex], colIndex) !== undefined && (rowIndex > 0 && comparator(GridRow.getCellElement(grid[rowIndex - 1], colIndex), GridRow.getCellElement(grid[rowIndex], colIndex)));\n    };\n    var notStartColumn = function (row, index, comparator) {\n      return index > 0 && comparator(GridRow.getCellElement(row, index - 1), GridRow.getCellElement(row, index));\n    };\n    var replaceColumn = function (grid, index, comparator, substitution) {\n      var targets = bind(grid, function (row, i) {\n        var alreadyAdded = notStartRow(grid, i, index, comparator) || notStartColumn(row, index, comparator);\n        return alreadyAdded ? [] : [GridRow.getCell(row, index)];\n      });\n      return replaceIn(grid, targets, comparator, substitution);\n    };\n    var replaceRow = function (grid, index, comparator, substitution) {\n      var targetRow = grid[index];\n      var targets = bind(targetRow.cells(), function (item, i) {\n        var alreadyAdded = notStartRow(grid, index, i, comparator) || notStartColumn(targetRow, i, comparator);\n        return alreadyAdded ? [] : [item];\n      });\n      return replaceIn(grid, targets, comparator, substitution);\n    };\n    var TransformOperations = {\n      replaceColumn: replaceColumn,\n      replaceRow: replaceRow\n    };\n\n    var adt = Adt.generate([\n      { none: [] },\n      { only: ['index'] },\n      {\n        left: [\n          'index',\n          'next'\n        ]\n      },\n      {\n        middle: [\n          'prev',\n          'index',\n          'next'\n        ]\n      },\n      {\n        right: [\n          'prev',\n          'index'\n        ]\n      }\n    ]);\n    var ColumnContext = __assign({}, adt);\n\n    var neighbours$1 = function (input, index) {\n      if (input.length === 0) {\n        return ColumnContext.none();\n      }\n      if (input.length === 1) {\n        return ColumnContext.only(0);\n      }\n      if (index === 0) {\n        return ColumnContext.left(0, 1);\n      }\n      if (index === input.length - 1) {\n        return ColumnContext.right(index - 1, index);\n      }\n      if (index > 0 && index < input.length - 1) {\n        return ColumnContext.middle(index - 1, index, index + 1);\n      }\n      return ColumnContext.none();\n    };\n    var determine = function (input, column, step, tableSize) {\n      var result = input.slice(0);\n      var context = neighbours$1(input, column);\n      var zero = function (array) {\n        return map(array, constant(0));\n      };\n      var onNone = constant(zero(result));\n      var onOnly = function (index) {\n        return tableSize.singleColumnWidth(result[index], step);\n      };\n      var onChange = function (index, next) {\n        if (step >= 0) {\n          var newNext = Math.max(tableSize.minCellWidth(), result[next] - step);\n          return zero(result.slice(0, index)).concat([\n            step,\n            newNext - result[next]\n          ]).concat(zero(result.slice(next + 1)));\n        } else {\n          var newThis = Math.max(tableSize.minCellWidth(), result[index] + step);\n          var diffx = result[index] - newThis;\n          return zero(result.slice(0, index)).concat([\n            newThis - result[index],\n            diffx\n          ]).concat(zero(result.slice(next + 1)));\n        }\n      };\n      var onLeft = onChange;\n      var onMiddle = function (_prev, index, next) {\n        return onChange(index, next);\n      };\n      var onRight = function (_prev, index) {\n        if (step >= 0) {\n          return zero(result.slice(0, index)).concat([step]);\n        } else {\n          var size = Math.max(tableSize.minCellWidth(), result[index] + step);\n          return zero(result.slice(0, index)).concat([size - result[index]]);\n        }\n      };\n      return context.fold(onNone, onOnly, onLeft, onMiddle, onRight);\n    };\n    var Deltas = { determine: determine };\n\n    var getSpan$1 = function (cell, type) {\n      return has$1(cell, type) && parseInt(get$1(cell, type), 10) > 1;\n    };\n    var hasColspan = function (cell) {\n      return getSpan$1(cell, 'colspan');\n    };\n    var hasRowspan = function (cell) {\n      return getSpan$1(cell, 'rowspan');\n    };\n    var getInt = function (element, property) {\n      return parseInt(get$2(element, property), 10);\n    };\n    var CellUtils = {\n      hasColspan: hasColspan,\n      hasRowspan: hasRowspan,\n      minWidth: constant(10),\n      minHeight: constant(10),\n      getInt: getInt\n    };\n\n    var getRaw$1 = function (cell, property, getter) {\n      return getRaw(cell, property).fold(function () {\n        return getter(cell) + 'px';\n      }, function (raw) {\n        return raw;\n      });\n    };\n    var getRawW = function (cell, tableSize) {\n      return getRaw$1(cell, 'width', function (e) {\n        return Sizes.getPixelWidth(e, tableSize);\n      });\n    };\n    var getRawH = function (cell) {\n      return getRaw$1(cell, 'height', Sizes.getHeight);\n    };\n    var getWidthFrom = function (warehouse, direction, getWidth, fallback, tableSize) {\n      var columns = Blocks.columns(warehouse);\n      var backups = map(columns, function (cellOption) {\n        return cellOption.map(direction.edge);\n      });\n      return map(columns, function (cellOption, c) {\n        var columnCell = cellOption.filter(not(CellUtils.hasColspan));\n        return columnCell.fold(function () {\n          var deduced = deduce(backups, c);\n          return fallback(deduced);\n        }, function (cell) {\n          return getWidth(cell, tableSize);\n        });\n      });\n    };\n    var getDeduced = function (deduced) {\n      return deduced.map(function (d) {\n        return d + 'px';\n      }).getOr('');\n    };\n    var getRawWidths = function (warehouse, direction, tableSize) {\n      return getWidthFrom(warehouse, direction, getRawW, getDeduced, tableSize);\n    };\n    var getPercentageWidths = function (warehouse, direction, tableSize) {\n      return getWidthFrom(warehouse, direction, Sizes.getPercentageWidth, function (deduced) {\n        return deduced.fold(function () {\n          return tableSize.minCellWidth();\n        }, function (cellWidth) {\n          return cellWidth / tableSize.pixelWidth() * 100;\n        });\n      }, tableSize);\n    };\n    var getPixelWidths = function (warehouse, direction, tableSize) {\n      return getWidthFrom(warehouse, direction, Sizes.getPixelWidth, function (deduced) {\n        return deduced.getOrThunk(tableSize.minCellWidth);\n      }, tableSize);\n    };\n    var getHeightFrom = function (warehouse, direction, getHeight, fallback) {\n      var rows = Blocks.rows(warehouse);\n      var backups = map(rows, function (cellOption) {\n        return cellOption.map(direction.edge);\n      });\n      return map(rows, function (cellOption, c) {\n        var rowCell = cellOption.filter(not(CellUtils.hasRowspan));\n        return rowCell.fold(function () {\n          var deduced = deduce(backups, c);\n          return fallback(deduced);\n        }, function (cell) {\n          return getHeight(cell);\n        });\n      });\n    };\n    var getPixelHeights = function (warehouse, direction) {\n      return getHeightFrom(warehouse, direction, Sizes.getHeight, function (deduced) {\n        return deduced.getOrThunk(CellUtils.minHeight);\n      });\n    };\n    var getRawHeights = function (warehouse, direction) {\n      return getHeightFrom(warehouse, direction, getRawH, getDeduced);\n    };\n    var ColumnSizes = {\n      getRawWidths: getRawWidths,\n      getPixelWidths: getPixelWidths,\n      getPercentageWidths: getPercentageWidths,\n      getPixelHeights: getPixelHeights,\n      getRawHeights: getRawHeights\n    };\n\n    var total = function (start, end, measures) {\n      var r = 0;\n      for (var i = start; i < end; i++) {\n        r += measures[i] !== undefined ? measures[i] : 0;\n      }\n      return r;\n    };\n    var recalculateWidth = function (warehouse, widths) {\n      var all = Warehouse.justCells(warehouse);\n      return map(all, function (cell) {\n        var width = total(cell.column(), cell.column() + cell.colspan(), widths);\n        return {\n          element: cell.element,\n          width: constant(width),\n          colspan: cell.colspan\n        };\n      });\n    };\n    var recalculateHeight = function (warehouse, heights) {\n      var all = Warehouse.justCells(warehouse);\n      return map(all, function (cell) {\n        var height = total(cell.row(), cell.row() + cell.rowspan(), heights);\n        return {\n          element: cell.element,\n          height: constant(height),\n          rowspan: cell.rowspan\n        };\n      });\n    };\n    var matchRowHeight = function (warehouse, heights) {\n      return map(warehouse.all(), function (row, i) {\n        return {\n          element: row.element,\n          height: constant(heights[i])\n        };\n      });\n    };\n    var Recalculations = {\n      recalculateWidth: recalculateWidth,\n      recalculateHeight: recalculateHeight,\n      matchRowHeight: matchRowHeight\n    };\n\n    var percentageSize = function (width, element) {\n      var floatWidth = parseFloat(width);\n      var pixelWidth = get$5(element);\n      var getCellDelta = function (delta) {\n        return delta / pixelWidth * 100;\n      };\n      var singleColumnWidth = function (w, _delta) {\n        return [100 - w];\n      };\n      var minCellWidth = function () {\n        return CellUtils.minWidth() / pixelWidth * 100;\n      };\n      var setTableWidth = function (table, _newWidths, delta) {\n        var ratio = delta / 100;\n        var change = ratio * floatWidth;\n        Sizes.setPercentageWidth(table, floatWidth + change);\n      };\n      return {\n        width: constant(floatWidth),\n        pixelWidth: constant(pixelWidth),\n        getWidths: ColumnSizes.getPercentageWidths,\n        getCellDelta: getCellDelta,\n        singleColumnWidth: singleColumnWidth,\n        minCellWidth: minCellWidth,\n        setElementWidth: Sizes.setPercentageWidth,\n        setTableWidth: setTableWidth\n      };\n    };\n    var pixelSize = function (width) {\n      var getCellDelta = identity;\n      var singleColumnWidth = function (w, delta) {\n        var newNext = Math.max(CellUtils.minWidth(), w + delta);\n        return [newNext - w];\n      };\n      var setTableWidth = function (table, newWidths, _delta) {\n        var total = foldr(newWidths, function (b, a) {\n          return b + a;\n        }, 0);\n        Sizes.setPixelWidth(table, total);\n      };\n      return {\n        width: constant(width),\n        pixelWidth: constant(width),\n        getWidths: ColumnSizes.getPixelWidths,\n        getCellDelta: getCellDelta,\n        singleColumnWidth: singleColumnWidth,\n        minCellWidth: CellUtils.minWidth,\n        setElementWidth: Sizes.setPixelWidth,\n        setTableWidth: setTableWidth\n      };\n    };\n    var chooseSize = function (element, width) {\n      var percentMatch = Sizes.percentageBasedSizeRegex().exec(width);\n      if (percentMatch !== null) {\n        return percentageSize(percentMatch[1], element);\n      }\n      var pixelMatch = Sizes.pixelBasedSizeRegex().exec(width);\n      if (pixelMatch !== null) {\n        var intWidth = parseInt(pixelMatch[1], 10);\n        return pixelSize(intWidth);\n      }\n      var fallbackWidth = get$5(element);\n      return pixelSize(fallbackWidth);\n    };\n    var getTableSize = function (element) {\n      var width = Sizes.getRawWidth(element);\n      return width.fold(function () {\n        var fallbackWidth = get$5(element);\n        return pixelSize(fallbackWidth);\n      }, function (w) {\n        return chooseSize(element, w);\n      });\n    };\n    var TableSize = { getTableSize: getTableSize };\n\n    var getWarehouse$1 = function (list) {\n      return Warehouse.generate(list);\n    };\n    var sumUp = function (newSize) {\n      return foldr(newSize, function (b, a) {\n        return b + a;\n      }, 0);\n    };\n    var getTableWarehouse = function (table) {\n      var list = DetailsList.fromTable(table);\n      return getWarehouse$1(list);\n    };\n    var adjustWidth = function (table, delta, index, direction) {\n      var tableSize = TableSize.getTableSize(table);\n      var step = tableSize.getCellDelta(delta);\n      var warehouse = getTableWarehouse(table);\n      var widths = tableSize.getWidths(warehouse, direction, tableSize);\n      var deltas = Deltas.determine(widths, index, step, tableSize);\n      var newWidths = map(deltas, function (dx, i) {\n        return dx + widths[i];\n      });\n      var newSizes = Recalculations.recalculateWidth(warehouse, newWidths);\n      each(newSizes, function (cell) {\n        tableSize.setElementWidth(cell.element(), cell.width());\n      });\n      if (index === warehouse.grid().columns() - 1) {\n        tableSize.setTableWidth(table, newWidths, step);\n      }\n    };\n    var adjustHeight = function (table, delta, index, direction) {\n      var warehouse = getTableWarehouse(table);\n      var heights = ColumnSizes.getPixelHeights(warehouse, direction);\n      var newHeights = map(heights, function (dy, i) {\n        return index === i ? Math.max(delta + dy, CellUtils.minHeight()) : dy;\n      });\n      var newCellSizes = Recalculations.recalculateHeight(warehouse, newHeights);\n      var newRowSizes = Recalculations.matchRowHeight(warehouse, newHeights);\n      each(newRowSizes, function (row) {\n        Sizes.setHeight(row.element(), row.height());\n      });\n      each(newCellSizes, function (cell) {\n        Sizes.setHeight(cell.element(), cell.height());\n      });\n      var total = sumUp(newHeights);\n      Sizes.setHeight(table, total);\n    };\n    var adjustWidthTo = function (table, list, direction) {\n      var tableSize = TableSize.getTableSize(table);\n      var warehouse = getWarehouse$1(list);\n      var widths = tableSize.getWidths(warehouse, direction, tableSize);\n      var newSizes = Recalculations.recalculateWidth(warehouse, widths);\n      each(newSizes, function (cell) {\n        tableSize.setElementWidth(cell.element(), cell.width());\n      });\n      if (newSizes.length > 0) {\n        tableSize.setTableWidth(table, widths, tableSize.getCellDelta(0));\n      }\n    };\n    var Adjustments = {\n      adjustWidth: adjustWidth,\n      adjustHeight: adjustHeight,\n      adjustWidthTo: adjustWidthTo\n    };\n\n    var base = function (handleUnsupported, required) {\n      return baseWith(handleUnsupported, required, {\n        validate: isFunction,\n        label: 'function'\n      });\n    };\n    var baseWith = function (handleUnsupported, required, pred) {\n      if (required.length === 0) {\n        throw new Error('You must specify at least one required field.');\n      }\n      validateStrArr('required', required);\n      checkDupes(required);\n      return function (obj) {\n        var keys$1 = keys(obj);\n        var allReqd = forall(required, function (req) {\n          return contains(keys$1, req);\n        });\n        if (!allReqd) {\n          reqMessage(required, keys$1);\n        }\n        handleUnsupported(required, keys$1);\n        var invalidKeys = filter(required, function (key) {\n          return !pred.validate(obj[key], key);\n        });\n        if (invalidKeys.length > 0) {\n          invalidTypeMessage(invalidKeys, pred.label);\n        }\n        return obj;\n      };\n    };\n    var handleExact = function (required, keys) {\n      var unsupported = filter(keys, function (key) {\n        return !contains(required, key);\n      });\n      if (unsupported.length > 0) {\n        unsuppMessage(unsupported);\n      }\n    };\n    var exactly = function (required) {\n      return base(handleExact, required);\n    };\n\n    var verifyGenerators = exactly([\n      'cell',\n      'row',\n      'replace',\n      'gap'\n    ]);\n    var elementToData = function (element) {\n      var colspan = has$1(element, 'colspan') ? parseInt(get$1(element, 'colspan'), 10) : 1;\n      var rowspan = has$1(element, 'rowspan') ? parseInt(get$1(element, 'rowspan'), 10) : 1;\n      return {\n        element: constant(element),\n        colspan: constant(colspan),\n        rowspan: constant(rowspan)\n      };\n    };\n    var modification = function (generators, toData) {\n      if (toData === void 0) {\n        toData = elementToData;\n      }\n      verifyGenerators(generators);\n      var position = Cell(Option.none());\n      var nu = function (data) {\n        return generators.cell(data);\n      };\n      var nuFrom = function (element) {\n        var data = toData(element);\n        return nu(data);\n      };\n      var add = function (element) {\n        var replacement = nuFrom(element);\n        if (position.get().isNone()) {\n          position.set(Option.some(replacement));\n        }\n        recent = Option.some({\n          item: element,\n          replacement: replacement\n        });\n        return replacement;\n      };\n      var recent = Option.none();\n      var getOrInit = function (element, comparator) {\n        return recent.fold(function () {\n          return add(element);\n        }, function (p) {\n          return comparator(element, p.item) ? p.replacement : add(element);\n        });\n      };\n      return {\n        getOrInit: getOrInit,\n        cursor: position.get\n      };\n    };\n    var transform = function (scope, tag) {\n      return function (generators) {\n        var position = Cell(Option.none());\n        verifyGenerators(generators);\n        var list = [];\n        var find$1 = function (element, comparator) {\n          return find(list, function (x) {\n            return comparator(x.item, element);\n          });\n        };\n        var makeNew = function (element) {\n          var attrs = { scope: scope };\n          var cell = generators.replace(element, tag, attrs);\n          list.push({\n            item: element,\n            sub: cell\n          });\n          if (position.get().isNone()) {\n            position.set(Option.some(cell));\n          }\n          return cell;\n        };\n        var replaceOrInit = function (element, comparator) {\n          return find$1(element, comparator).fold(function () {\n            return makeNew(element);\n          }, function (p) {\n            return comparator(element, p.item) ? p.sub : makeNew(element);\n          });\n        };\n        return {\n          replaceOrInit: replaceOrInit,\n          cursor: position.get\n        };\n      };\n    };\n    var merging = function (generators) {\n      verifyGenerators(generators);\n      var position = Cell(Option.none());\n      var combine = function (cell) {\n        if (position.get().isNone()) {\n          position.set(Option.some(cell));\n        }\n        return function () {\n          var raw = generators.cell({\n            element: constant(cell),\n            colspan: constant(1),\n            rowspan: constant(1)\n          });\n          remove$1(raw, 'width');\n          remove$1(cell, 'width');\n          return raw;\n        };\n      };\n      return {\n        combine: combine,\n        cursor: position.get\n      };\n    };\n    var Generators = {\n      modification: modification,\n      transform: transform,\n      merging: merging\n    };\n\n    var blockList = [\n      'body',\n      'p',\n      'div',\n      'article',\n      'aside',\n      'figcaption',\n      'figure',\n      'footer',\n      'header',\n      'nav',\n      'section',\n      'ol',\n      'ul',\n      'table',\n      'thead',\n      'tfoot',\n      'tbody',\n      'caption',\n      'tr',\n      'td',\n      'th',\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'blockquote',\n      'pre',\n      'address'\n    ];\n    var isList = function (universe, item) {\n      var tagName = universe.property().name(item);\n      return contains([\n        'ol',\n        'ul'\n      ], tagName);\n    };\n    var isBlock = function (universe, item) {\n      var tagName = universe.property().name(item);\n      return contains(blockList, tagName);\n    };\n    var isFormatting = function (universe, item) {\n      var tagName = universe.property().name(item);\n      return contains([\n        'address',\n        'pre',\n        'p',\n        'h1',\n        'h2',\n        'h3',\n        'h4',\n        'h5',\n        'h6'\n      ], tagName);\n    };\n    var isHeading = function (universe, item) {\n      var tagName = universe.property().name(item);\n      return contains([\n        'h1',\n        'h2',\n        'h3',\n        'h4',\n        'h5',\n        'h6'\n      ], tagName);\n    };\n    var isContainer = function (universe, item) {\n      return contains([\n        'div',\n        'li',\n        'td',\n        'th',\n        'blockquote',\n        'body',\n        'caption'\n      ], universe.property().name(item));\n    };\n    var isEmptyTag = function (universe, item) {\n      return contains([\n        'br',\n        'img',\n        'hr',\n        'input'\n      ], universe.property().name(item));\n    };\n    var isFrame = function (universe, item) {\n      return universe.property().name(item) === 'iframe';\n    };\n    var isInline = function (universe, item) {\n      return !(isBlock(universe, item) || isEmptyTag(universe, item)) && universe.property().name(item) !== 'li';\n    };\n    var Structure = {\n      isBlock: isBlock,\n      isList: isList,\n      isFormatting: isFormatting,\n      isHeading: isHeading,\n      isContainer: isContainer,\n      isEmptyTag: isEmptyTag,\n      isFrame: isFrame,\n      isInline: isInline\n    };\n\n    var universe$1 = DomUniverse();\n    var isBlock$1 = function (element) {\n      return Structure.isBlock(universe$1, element);\n    };\n    var isList$1 = function (element) {\n      return Structure.isList(universe$1, element);\n    };\n    var isFormatting$1 = function (element) {\n      return Structure.isFormatting(universe$1, element);\n    };\n    var isHeading$1 = function (element) {\n      return Structure.isHeading(universe$1, element);\n    };\n    var isContainer$1 = function (element) {\n      return Structure.isContainer(universe$1, element);\n    };\n    var isEmptyTag$1 = function (element) {\n      return Structure.isEmptyTag(universe$1, element);\n    };\n    var isFrame$1 = function (element) {\n      return Structure.isFrame(universe$1, element);\n    };\n    var isInline$1 = function (element) {\n      return Structure.isInline(universe$1, element);\n    };\n    var DomStructure = {\n      isBlock: isBlock$1,\n      isList: isList$1,\n      isFormatting: isFormatting$1,\n      isHeading: isHeading$1,\n      isContainer: isContainer$1,\n      isEmptyTag: isEmptyTag$1,\n      isFrame: isFrame$1,\n      isInline: isInline$1\n    };\n\n    var merge$2 = function (cells) {\n      var isBr = function (el) {\n        return name(el) === 'br';\n      };\n      var advancedBr = function (children) {\n        return forall(children, function (c) {\n          return isBr(c) || isText(c) && get$3(c).trim().length === 0;\n        });\n      };\n      var isListItem = function (el) {\n        return name(el) === 'li' || ancestor(el, DomStructure.isList).isSome();\n      };\n      var siblingIsBlock = function (el) {\n        return nextSibling(el).map(function (rightSibling) {\n          if (DomStructure.isBlock(rightSibling)) {\n            return true;\n          }\n          if (DomStructure.isEmptyTag(rightSibling)) {\n            return name(rightSibling) === 'img' ? false : true;\n          }\n          return false;\n        }).getOr(false);\n      };\n      var markCell = function (cell) {\n        return last$1(cell).bind(function (rightEdge) {\n          var rightSiblingIsBlock = siblingIsBlock(rightEdge);\n          return parent(rightEdge).map(function (parent) {\n            return rightSiblingIsBlock === true || isListItem(parent) || isBr(rightEdge) || DomStructure.isBlock(parent) && !eq(cell, parent) ? [] : [Element.fromTag('br')];\n          });\n        }).getOr([]);\n      };\n      var markContent = function () {\n        var content = bind(cells, function (cell) {\n          var children$1 = children(cell);\n          return advancedBr(children$1) ? [] : children$1.concat(markCell(cell));\n        });\n        return content.length === 0 ? [Element.fromTag('br')] : content;\n      };\n      var contents = markContent();\n      empty(cells[0]);\n      append$1(cells[0], contents);\n    };\n    var TableContent = { merge: merge$2 };\n\n    var prune = function (table) {\n      var cells = TableLookup.cells(table);\n      if (cells.length === 0) {\n        remove$2(table);\n      }\n    };\n    var outcome = Immutable('grid', 'cursor');\n    var elementFromGrid = function (grid, row, column) {\n      return findIn(grid, row, column).orThunk(function () {\n        return findIn(grid, 0, 0);\n      });\n    };\n    var findIn = function (grid, row, column) {\n      return Option.from(grid[row]).bind(function (r) {\n        return Option.from(r.cells()[column]).bind(function (c) {\n          return Option.from(c.element());\n        });\n      });\n    };\n    var bundle = function (grid, row, column) {\n      return outcome(grid, findIn(grid, row, column));\n    };\n    var uniqueRows = function (details) {\n      return foldl(details, function (rest, detail) {\n        return exists(rest, function (currentDetail) {\n          return currentDetail.row() === detail.row();\n        }) ? rest : rest.concat([detail]);\n      }, []).sort(function (detailA, detailB) {\n        return detailA.row() - detailB.row();\n      });\n    };\n    var uniqueColumns = function (details) {\n      return foldl(details, function (rest, detail) {\n        return exists(rest, function (currentDetail) {\n          return currentDetail.column() === detail.column();\n        }) ? rest : rest.concat([detail]);\n      }, []).sort(function (detailA, detailB) {\n        return detailA.column() - detailB.column();\n      });\n    };\n    var insertRowBefore = function (grid, detail, comparator, genWrappers) {\n      var example = detail.row();\n      var targetIndex = detail.row();\n      var newGrid = ModificationOperations.insertRowAt(grid, targetIndex, example, comparator, genWrappers.getOrInit);\n      return bundle(newGrid, targetIndex, detail.column());\n    };\n    var insertRowsBefore = function (grid, details, comparator, genWrappers) {\n      var example = details[0].row();\n      var targetIndex = details[0].row();\n      var rows = uniqueRows(details);\n      var newGrid = foldl(rows, function (newG, _row) {\n        return ModificationOperations.insertRowAt(newG, targetIndex, example, comparator, genWrappers.getOrInit);\n      }, grid);\n      return bundle(newGrid, targetIndex, details[0].column());\n    };\n    var insertRowAfter = function (grid, detail, comparator, genWrappers) {\n      var example = detail.row();\n      var targetIndex = detail.row() + detail.rowspan();\n      var newGrid = ModificationOperations.insertRowAt(grid, targetIndex, example, comparator, genWrappers.getOrInit);\n      return bundle(newGrid, targetIndex, detail.column());\n    };\n    var insertRowsAfter = function (grid, details, comparator, genWrappers) {\n      var rows = uniqueRows(details);\n      var example = rows[rows.length - 1].row();\n      var targetIndex = rows[rows.length - 1].row() + rows[rows.length - 1].rowspan();\n      var newGrid = foldl(rows, function (newG, _row) {\n        return ModificationOperations.insertRowAt(newG, targetIndex, example, comparator, genWrappers.getOrInit);\n      }, grid);\n      return bundle(newGrid, targetIndex, details[0].column());\n    };\n    var insertColumnBefore = function (grid, detail, comparator, genWrappers) {\n      var example = detail.column();\n      var targetIndex = detail.column();\n      var newGrid = ModificationOperations.insertColumnAt(grid, targetIndex, example, comparator, genWrappers.getOrInit);\n      return bundle(newGrid, detail.row(), targetIndex);\n    };\n    var insertColumnsBefore = function (grid, details, comparator, genWrappers) {\n      var columns = uniqueColumns(details);\n      var example = columns[0].column();\n      var targetIndex = columns[0].column();\n      var newGrid = foldl(columns, function (newG, _row) {\n        return ModificationOperations.insertColumnAt(newG, targetIndex, example, comparator, genWrappers.getOrInit);\n      }, grid);\n      return bundle(newGrid, details[0].row(), targetIndex);\n    };\n    var insertColumnAfter = function (grid, detail, comparator, genWrappers) {\n      var example = detail.column();\n      var targetIndex = detail.column() + detail.colspan();\n      var newGrid = ModificationOperations.insertColumnAt(grid, targetIndex, example, comparator, genWrappers.getOrInit);\n      return bundle(newGrid, detail.row(), targetIndex);\n    };\n    var insertColumnsAfter = function (grid, details, comparator, genWrappers) {\n      var example = details[details.length - 1].column();\n      var targetIndex = details[details.length - 1].column() + details[details.length - 1].colspan();\n      var columns = uniqueColumns(details);\n      var newGrid = foldl(columns, function (newG, _row) {\n        return ModificationOperations.insertColumnAt(newG, targetIndex, example, comparator, genWrappers.getOrInit);\n      }, grid);\n      return bundle(newGrid, details[0].row(), targetIndex);\n    };\n    var makeRowHeader = function (grid, detail, comparator, genWrappers) {\n      var newGrid = TransformOperations.replaceRow(grid, detail.row(), comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n    var makeColumnHeader = function (grid, detail, comparator, genWrappers) {\n      var newGrid = TransformOperations.replaceColumn(grid, detail.column(), comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n    var unmakeRowHeader = function (grid, detail, comparator, genWrappers) {\n      var newGrid = TransformOperations.replaceRow(grid, detail.row(), comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n    var unmakeColumnHeader = function (grid, detail, comparator, genWrappers) {\n      var newGrid = TransformOperations.replaceColumn(grid, detail.column(), comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n    var splitCellIntoColumns$1 = function (grid, detail, comparator, genWrappers) {\n      var newGrid = ModificationOperations.splitCellIntoColumns(grid, detail.row(), detail.column(), comparator, genWrappers.getOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n    var splitCellIntoRows$1 = function (grid, detail, comparator, genWrappers) {\n      var newGrid = ModificationOperations.splitCellIntoRows(grid, detail.row(), detail.column(), comparator, genWrappers.getOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n    var eraseColumns = function (grid, details, _comparator, _genWrappers) {\n      var columns = uniqueColumns(details);\n      var newGrid = ModificationOperations.deleteColumnsAt(grid, columns[0].column(), columns[columns.length - 1].column());\n      var cursor = elementFromGrid(newGrid, details[0].row(), details[0].column());\n      return outcome(newGrid, cursor);\n    };\n    var eraseRows = function (grid, details, _comparator, _genWrappers) {\n      var rows = uniqueRows(details);\n      var newGrid = ModificationOperations.deleteRowsAt(grid, rows[0].row(), rows[rows.length - 1].row());\n      var cursor = elementFromGrid(newGrid, details[0].row(), details[0].column());\n      return outcome(newGrid, cursor);\n    };\n    var mergeCells = function (grid, mergable, comparator, _genWrappers) {\n      var cells = mergable.cells();\n      TableContent.merge(cells);\n      var newGrid = MergingOperations.merge(grid, mergable.bounds(), comparator, constant(cells[0]));\n      return outcome(newGrid, Option.from(cells[0]));\n    };\n    var unmergeCells = function (grid, unmergable, comparator, genWrappers) {\n      var newGrid = foldr(unmergable, function (b, cell) {\n        return MergingOperations.unmerge(b, cell, comparator, genWrappers.combine(cell));\n      }, grid);\n      return outcome(newGrid, Option.from(unmergable[0]));\n    };\n    var pasteCells = function (grid, pasteDetails, comparator, _genWrappers) {\n      var gridify = function (table, generators) {\n        var list = DetailsList.fromTable(table);\n        var wh = Warehouse.generate(list);\n        return Transitions.toGrid(wh, generators, true);\n      };\n      var gridB = gridify(pasteDetails.clipboard(), pasteDetails.generators());\n      var startAddress = address(pasteDetails.row(), pasteDetails.column());\n      var mergedGrid = TableMerge.merge(startAddress, grid, gridB, pasteDetails.generators(), comparator);\n      return mergedGrid.fold(function () {\n        return outcome(grid, Option.some(pasteDetails.element()));\n      }, function (nuGrid) {\n        var cursor = elementFromGrid(nuGrid, pasteDetails.row(), pasteDetails.column());\n        return outcome(nuGrid, cursor);\n      });\n    };\n    var gridifyRows = function (rows, generators, example) {\n      var pasteDetails = DetailsList.fromPastedRows(rows, example);\n      var wh = Warehouse.generate(pasteDetails);\n      return Transitions.toGrid(wh, generators, true);\n    };\n    var pasteRowsBefore = function (grid, pasteDetails, comparator, _genWrappers) {\n      var example = grid[pasteDetails.cells[0].row()];\n      var index = pasteDetails.cells[0].row();\n      var gridB = gridifyRows(pasteDetails.clipboard(), pasteDetails.generators(), example);\n      var mergedGrid = TableMerge.insert(index, grid, gridB, pasteDetails.generators(), comparator);\n      var cursor = elementFromGrid(mergedGrid, pasteDetails.cells[0].row(), pasteDetails.cells[0].column());\n      return outcome(mergedGrid, cursor);\n    };\n    var pasteRowsAfter = function (grid, pasteDetails, comparator, _genWrappers) {\n      var example = grid[pasteDetails.cells[0].row()];\n      var index = pasteDetails.cells[pasteDetails.cells.length - 1].row() + pasteDetails.cells[pasteDetails.cells.length - 1].rowspan();\n      var gridB = gridifyRows(pasteDetails.clipboard(), pasteDetails.generators(), example);\n      var mergedGrid = TableMerge.insert(index, grid, gridB, pasteDetails.generators(), comparator);\n      var cursor = elementFromGrid(mergedGrid, pasteDetails.cells[0].row(), pasteDetails.cells[0].column());\n      return outcome(mergedGrid, cursor);\n    };\n    var resize = Adjustments.adjustWidthTo;\n    var TableOperations = {\n      insertRowBefore: run(insertRowBefore, onCell, noop, noop, Generators.modification),\n      insertRowsBefore: run(insertRowsBefore, onCells, noop, noop, Generators.modification),\n      insertRowAfter: run(insertRowAfter, onCell, noop, noop, Generators.modification),\n      insertRowsAfter: run(insertRowsAfter, onCells, noop, noop, Generators.modification),\n      insertColumnBefore: run(insertColumnBefore, onCell, resize, noop, Generators.modification),\n      insertColumnsBefore: run(insertColumnsBefore, onCells, resize, noop, Generators.modification),\n      insertColumnAfter: run(insertColumnAfter, onCell, resize, noop, Generators.modification),\n      insertColumnsAfter: run(insertColumnsAfter, onCells, resize, noop, Generators.modification),\n      splitCellIntoColumns: run(splitCellIntoColumns$1, onCell, resize, noop, Generators.modification),\n      splitCellIntoRows: run(splitCellIntoRows$1, onCell, noop, noop, Generators.modification),\n      eraseColumns: run(eraseColumns, onCells, resize, prune, Generators.modification),\n      eraseRows: run(eraseRows, onCells, noop, prune, Generators.modification),\n      makeColumnHeader: run(makeColumnHeader, onCell, noop, noop, Generators.transform('row', 'th')),\n      unmakeColumnHeader: run(unmakeColumnHeader, onCell, noop, noop, Generators.transform(null, 'td')),\n      makeRowHeader: run(makeRowHeader, onCell, noop, noop, Generators.transform('col', 'th')),\n      unmakeRowHeader: run(unmakeRowHeader, onCell, noop, noop, Generators.transform(null, 'td')),\n      mergeCells: run(mergeCells, onMergable, noop, noop, Generators.merging),\n      unmergeCells: run(unmergeCells, onUnmergable, resize, noop, Generators.merging),\n      pasteCells: run(pasteCells, onPaste, resize, noop, Generators.modification),\n      pasteRowsBefore: run(pasteRowsBefore, onPasteRows, noop, noop, Generators.modification),\n      pasteRowsAfter: run(pasteRowsAfter, onPasteRows, noop, noop, Generators.modification)\n    };\n\n    var getBody$1 = function (editor) {\n      return Element.fromDom(editor.getBody());\n    };\n    var getPixelWidth$1 = function (elm) {\n      return elm.getBoundingClientRect().width;\n    };\n    var getPixelHeight = function (elm) {\n      return elm.getBoundingClientRect().height;\n    };\n    var getIsRoot = function (editor) {\n      return function (element) {\n        return eq(element, getBody$1(editor));\n      };\n    };\n    var removePxSuffix = function (size) {\n      return size ? size.replace(/px$/, '') : '';\n    };\n    var addSizeSuffix = function (size) {\n      if (/^[0-9]+$/.test(size)) {\n        size += 'px';\n      }\n      return size;\n    };\n    var removeDataStyle = function (table) {\n      var dataStyleCells = descendants$1(table, 'td[data-mce-style],th[data-mce-style]');\n      remove(table, 'data-mce-style');\n      each(dataStyleCells, function (cell) {\n        remove(cell, 'data-mce-style');\n      });\n    };\n\n    var getDirection = function (element) {\n      return get$2(element, 'direction') === 'rtl' ? 'rtl' : 'ltr';\n    };\n\n    var ltr$1 = { isRtl: constant(false) };\n    var rtl$1 = { isRtl: constant(true) };\n    var directionAt = function (element) {\n      var dir = getDirection(element);\n      return dir === 'rtl' ? rtl$1 : ltr$1;\n    };\n    var Direction = { directionAt: directionAt };\n\n    var defaultTableToolbar = 'tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol';\n    var defaultStyles = {\n      'border-collapse': 'collapse',\n      'width': '100%'\n    };\n    var defaultAttributes = { border: '1' };\n    var getDefaultAttributes = function (editor) {\n      return editor.getParam('table_default_attributes', defaultAttributes, 'object');\n    };\n    var getDefaultStyles = function (editor) {\n      return editor.getParam('table_default_styles', defaultStyles, 'object');\n    };\n    var hasTableResizeBars = function (editor) {\n      return editor.getParam('table_resize_bars', true, 'boolean');\n    };\n    var hasTabNavigation = function (editor) {\n      return editor.getParam('table_tab_navigation', true, 'boolean');\n    };\n    var hasAdvancedCellTab = function (editor) {\n      return editor.getParam('table_cell_advtab', true, 'boolean');\n    };\n    var hasAdvancedRowTab = function (editor) {\n      return editor.getParam('table_row_advtab', true, 'boolean');\n    };\n    var hasAdvancedTableTab = function (editor) {\n      return editor.getParam('table_advtab', true, 'boolean');\n    };\n    var hasAppearanceOptions = function (editor) {\n      return editor.getParam('table_appearance_options', true, 'boolean');\n    };\n    var hasTableGrid = function (editor) {\n      return editor.getParam('table_grid', true, 'boolean');\n    };\n    var shouldStyleWithCss = function (editor) {\n      return editor.getParam('table_style_by_css', false, 'boolean');\n    };\n    var getCellClassList = function (editor) {\n      return editor.getParam('table_cell_class_list', [], 'array');\n    };\n    var getRowClassList = function (editor) {\n      return editor.getParam('table_row_class_list', [], 'array');\n    };\n    var getTableClassList = function (editor) {\n      return editor.getParam('table_class_list', [], 'array');\n    };\n    var isPercentagesForced = function (editor) {\n      return editor.getParam('table_responsive_width') === true;\n    };\n    var isPixelsForced = function (editor) {\n      return editor.getParam('table_responsive_width') === false;\n    };\n    var getToolbar = function (editor) {\n      return editor.getParam('table_toolbar', defaultTableToolbar);\n    };\n    var getCloneElements = function (editor) {\n      var cloneElements = editor.getParam('table_clone_elements');\n      if (isString(cloneElements)) {\n        return Option.some(cloneElements.split(/[ ,]/));\n      } else if (Array.isArray(cloneElements)) {\n        return Option.some(cloneElements);\n      } else {\n        return Option.none();\n      }\n    };\n    var hasObjectResizing = function (editor) {\n      var objectResizing = editor.getParam('object_resizing', true);\n      return isString(objectResizing) ? objectResizing === 'table' : objectResizing;\n    };\n\n    var fireNewRow = function (editor, row) {\n      return editor.fire('newrow', { node: row });\n    };\n    var fireNewCell = function (editor, cell) {\n      return editor.fire('newcell', { node: cell });\n    };\n    var fireObjectResizeStart = function (editor, target, width, height) {\n      editor.fire('ObjectResizeStart', {\n        target: target,\n        width: width,\n        height: height\n      });\n    };\n    var fireObjectResized = function (editor, target, width, height) {\n      editor.fire('ObjectResized', {\n        target: target,\n        width: width,\n        height: height\n      });\n    };\n    var fireTableSelectionChange = function (editor, cells, start, finish, otherCells) {\n      editor.fire('tableselectionchange', {\n        cells: cells,\n        start: start,\n        finish: finish,\n        otherCells: otherCells\n      });\n    };\n    var fireTableSelectionClear = function (editor) {\n      editor.fire('tableselectionclear');\n    };\n\n    var TableActions = function (editor, lazyWire) {\n      var isTableBody = function (editor) {\n        return name(getBody$1(editor)) === 'table';\n      };\n      var lastRowGuard = function (table) {\n        var size = TableGridSize.getGridSize(table);\n        return isTableBody(editor) === false || size.rows() > 1;\n      };\n      var lastColumnGuard = function (table) {\n        var size = TableGridSize.getGridSize(table);\n        return isTableBody(editor) === false || size.columns() > 1;\n      };\n      var cloneFormats = getCloneElements(editor);\n      var execute = function (operation, guard, mutate, lazyWire) {\n        return function (table, target) {\n          removeDataStyle(table);\n          var wire = lazyWire();\n          var doc = Element.fromDom(editor.getDoc());\n          var direction = TableDirection(Direction.directionAt);\n          var generators = TableFill.cellOperations(mutate, doc, cloneFormats);\n          return guard(table) ? operation(wire, table, target, generators, direction).bind(function (result) {\n            each(result.newRows(), function (row) {\n              fireNewRow(editor, row.dom());\n            });\n            each(result.newCells(), function (cell) {\n              fireNewCell(editor, cell.dom());\n            });\n            return result.cursor().map(function (cell) {\n              var rng = editor.dom.createRng();\n              rng.setStart(cell.dom(), 0);\n              rng.setEnd(cell.dom(), 0);\n              return rng;\n            });\n          }) : Option.none();\n        };\n      };\n      var deleteRow = execute(TableOperations.eraseRows, lastRowGuard, noop, lazyWire);\n      var deleteColumn = execute(TableOperations.eraseColumns, lastColumnGuard, noop, lazyWire);\n      var insertRowsBefore = execute(TableOperations.insertRowsBefore, always, noop, lazyWire);\n      var insertRowsAfter = execute(TableOperations.insertRowsAfter, always, noop, lazyWire);\n      var insertColumnsBefore = execute(TableOperations.insertColumnsBefore, always, CellMutations.halve, lazyWire);\n      var insertColumnsAfter = execute(TableOperations.insertColumnsAfter, always, CellMutations.halve, lazyWire);\n      var mergeCells = execute(TableOperations.mergeCells, always, noop, lazyWire);\n      var unmergeCells = execute(TableOperations.unmergeCells, always, noop, lazyWire);\n      var pasteRowsBefore = execute(TableOperations.pasteRowsBefore, always, noop, lazyWire);\n      var pasteRowsAfter = execute(TableOperations.pasteRowsAfter, always, noop, lazyWire);\n      var pasteCells = execute(TableOperations.pasteCells, always, noop, lazyWire);\n      return {\n        deleteRow: deleteRow,\n        deleteColumn: deleteColumn,\n        insertRowsBefore: insertRowsBefore,\n        insertRowsAfter: insertRowsAfter,\n        insertColumnsBefore: insertColumnsBefore,\n        insertColumnsAfter: insertColumnsAfter,\n        mergeCells: mergeCells,\n        unmergeCells: unmergeCells,\n        pasteRowsBefore: pasteRowsBefore,\n        pasteRowsAfter: pasteRowsAfter,\n        pasteCells: pasteCells\n      };\n    };\n\n    var copyRows = function (table, target, generators) {\n      var list = DetailsList.fromTable(table);\n      var house = Warehouse.generate(list);\n      var details = onCells(house, target);\n      return details.map(function (selectedCells) {\n        var grid = Transitions.toGrid(house, generators, false);\n        var slicedGrid = grid.slice(selectedCells[0].row(), selectedCells[selectedCells.length - 1].row() + selectedCells[selectedCells.length - 1].rowspan());\n        var slicedDetails = toDetailList(slicedGrid, generators);\n        return Redraw.copy(slicedDetails);\n      });\n    };\n    var CopyRows = { copyRows: copyRows };\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var getTDTHOverallStyle = function (dom, elm, name) {\n      var cells = dom.select('td,th', elm);\n      var firstChildStyle;\n      var checkChildren = function (firstChildStyle, elms) {\n        for (var i = 0; i < elms.length; i++) {\n          var currentStyle = dom.getStyle(elms[i], name);\n          if (typeof firstChildStyle === 'undefined') {\n            firstChildStyle = currentStyle;\n          }\n          if (firstChildStyle !== currentStyle) {\n            return '';\n          }\n        }\n        return firstChildStyle;\n      };\n      firstChildStyle = checkChildren(firstChildStyle, cells);\n      return firstChildStyle;\n    };\n    var applyAlign = function (editor, elm, name) {\n      if (name) {\n        editor.formatter.apply('align' + name, {}, elm);\n      }\n    };\n    var applyVAlign = function (editor, elm, name) {\n      if (name) {\n        editor.formatter.apply('valign' + name, {}, elm);\n      }\n    };\n    var unApplyAlign = function (editor, elm) {\n      global$1.each('left center right'.split(' '), function (name) {\n        editor.formatter.remove('align' + name, {}, elm);\n      });\n    };\n    var unApplyVAlign = function (editor, elm) {\n      global$1.each('top middle bottom'.split(' '), function (name) {\n        editor.formatter.remove('valign' + name, {}, elm);\n      });\n    };\n    var Styles$1 = {\n      applyAlign: applyAlign,\n      applyVAlign: applyVAlign,\n      unApplyAlign: unApplyAlign,\n      unApplyVAlign: unApplyVAlign,\n      getTDTHOverallStyle: getTDTHOverallStyle\n    };\n\n    var buildListItems = function (inputList, itemCallback, startItems) {\n      var appendItems = function (values, output) {\n        output = output || [];\n        global$1.each(values, function (item) {\n          var menuItem = { text: item.text || item.title };\n          if (item.menu) {\n            menuItem.menu = appendItems(item.menu);\n          } else {\n            menuItem.value = item.value;\n            if (itemCallback) {\n              itemCallback(menuItem);\n            }\n          }\n          output.push(menuItem);\n        });\n        return output;\n      };\n      return appendItems(inputList, startItems || []);\n    };\n    var extractAdvancedStyles = function (dom, elm) {\n      var rgbToHex = function (value) {\n        return startsWith(value, 'rgb') ? dom.toHex(value) : value;\n      };\n      var borderWidth = getRaw(Element.fromDom(elm), 'border-width').getOr('');\n      var borderStyle = getRaw(Element.fromDom(elm), 'border-style').getOr('');\n      var borderColor = getRaw(Element.fromDom(elm), 'border-color').map(rgbToHex).getOr('');\n      var bgColor = getRaw(Element.fromDom(elm), 'background-color').map(rgbToHex).getOr('');\n      return {\n        borderwidth: borderWidth,\n        borderstyle: borderStyle,\n        bordercolor: borderColor,\n        backgroundcolor: bgColor\n      };\n    };\n    var getSharedValues = function (data) {\n      var baseData = data[0];\n      var comparisonData = data.slice(1);\n      var keys$1 = keys(baseData);\n      each(comparisonData, function (items) {\n        each(keys$1, function (key) {\n          each$1(items, function (itemValue, itemKey) {\n            var comparisonValue = baseData[key];\n            if (comparisonValue !== '' && key === itemKey) {\n              if (comparisonValue !== itemValue) {\n                baseData[key] = '';\n              }\n            }\n          });\n        });\n      });\n      return baseData;\n    };\n    var getAdvancedTab = function (dialogName) {\n      var advTabItems = [\n        {\n          name: 'borderstyle',\n          type: 'selectbox',\n          label: 'Border style',\n          items: [\n            {\n              text: 'Select...',\n              value: ''\n            },\n            {\n              text: 'Solid',\n              value: 'solid'\n            },\n            {\n              text: 'Dotted',\n              value: 'dotted'\n            },\n            {\n              text: 'Dashed',\n              value: 'dashed'\n            },\n            {\n              text: 'Double',\n              value: 'double'\n            },\n            {\n              text: 'Groove',\n              value: 'groove'\n            },\n            {\n              text: 'Ridge',\n              value: 'ridge'\n            },\n            {\n              text: 'Inset',\n              value: 'inset'\n            },\n            {\n              text: 'Outset',\n              value: 'outset'\n            },\n            {\n              text: 'None',\n              value: 'none'\n            },\n            {\n              text: 'Hidden',\n              value: 'hidden'\n            }\n          ]\n        },\n        {\n          name: 'bordercolor',\n          type: 'colorinput',\n          label: 'Border color'\n        },\n        {\n          name: 'backgroundcolor',\n          type: 'colorinput',\n          label: 'Background color'\n        }\n      ];\n      var borderWidth = {\n        name: 'borderwidth',\n        type: 'input',\n        label: 'Border width'\n      };\n      var items = dialogName === 'cell' ? [borderWidth].concat(advTabItems) : advTabItems;\n      return {\n        title: 'Advanced',\n        name: 'advanced',\n        items: items\n      };\n    };\n    var getAlignment = function (alignments, formatName, dataName, editor, elm) {\n      var alignmentData = {};\n      global$1.each(alignments.split(' '), function (name) {\n        if (editor.formatter.matchNode(elm, formatName + name)) {\n          alignmentData[dataName] = name;\n        }\n      });\n      if (!alignmentData[dataName]) {\n        alignmentData[dataName] = '';\n      }\n      return alignmentData;\n    };\n    var getHAlignment = curry(getAlignment, 'left center right');\n    var getVAlignment = curry(getAlignment, 'top middle bottom');\n    var extractDataFromSettings = function (editor, hasAdvTableTab) {\n      var style = getDefaultStyles(editor);\n      var attrs = getDefaultAttributes(editor);\n      var extractAdvancedStyleData = function (dom) {\n        var rgbToHex = function (value) {\n          return startsWith(value, 'rgb') ? dom.toHex(value) : value;\n        };\n        var borderStyle = get(style, 'border-style').getOr('');\n        var borderColor = get(style, 'border-color').getOr('');\n        var bgColor = get(style, 'background-color').getOr('');\n        return {\n          borderstyle: borderStyle,\n          bordercolor: rgbToHex(borderColor),\n          backgroundcolor: rgbToHex(bgColor)\n        };\n      };\n      var defaultData = {\n        height: '',\n        width: '100%',\n        cellspacing: '',\n        cellpadding: '',\n        caption: false,\n        class: '',\n        align: '',\n        border: ''\n      };\n      var getBorder = function () {\n        var borderWidth = style['border-width'];\n        if (shouldStyleWithCss(editor) && borderWidth) {\n          return { border: borderWidth };\n        }\n        return get(attrs, 'border').fold(function () {\n          return {};\n        }, function (border) {\n          return { border: border };\n        });\n      };\n      var dom = editor.dom;\n      var advStyle = hasAdvTableTab ? extractAdvancedStyleData(dom) : {};\n      var getCellPaddingCellSpacing = function () {\n        var spacing = get(style, 'border-spacing').or(get(attrs, 'cellspacing')).fold(function () {\n          return {};\n        }, function (cellspacing) {\n          return { cellspacing: cellspacing };\n        });\n        var padding = get(style, 'border-padding').or(get(attrs, 'cellpadding')).fold(function () {\n          return {};\n        }, function (cellpadding) {\n          return { cellpadding: cellpadding };\n        });\n        return __assign(__assign({}, spacing), padding);\n      };\n      var data = __assign(__assign(__assign(__assign(__assign(__assign({}, defaultData), style), attrs), advStyle), getBorder()), getCellPaddingCellSpacing());\n      return data;\n    };\n    var extractDataFromTableElement = function (editor, elm, hasAdvTableTab) {\n      var getBorder = function (dom, elm) {\n        var optBorderWidth = getRaw(Element.fromDom(elm), 'border-width');\n        if (shouldStyleWithCss(editor) && optBorderWidth.isSome()) {\n          return optBorderWidth.getOr('');\n        }\n        return dom.getAttrib(elm, 'border') || Styles$1.getTDTHOverallStyle(editor.dom, elm, 'border-width') || Styles$1.getTDTHOverallStyle(editor.dom, elm, 'border');\n      };\n      var dom = editor.dom;\n      var data = __assign(__assign({\n        width: dom.getStyle(elm, 'width') || dom.getAttrib(elm, 'width'),\n        height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n        cellspacing: dom.getStyle(elm, 'border-spacing') || dom.getAttrib(elm, 'cellspacing'),\n        cellpadding: dom.getAttrib(elm, 'cellpadding') || Styles$1.getTDTHOverallStyle(editor.dom, elm, 'padding'),\n        border: getBorder(dom, elm),\n        caption: !!dom.select('caption', elm)[0],\n        class: dom.getAttrib(elm, 'class', '')\n      }, getHAlignment('align', 'align', editor, elm)), hasAdvTableTab ? extractAdvancedStyles(dom, elm) : {});\n      return data;\n    };\n    var extractDataFromRowElement = function (editor, elm, hasAdvancedRowTab) {\n      var dom = editor.dom;\n      var data = __assign(__assign({\n        height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n        scope: dom.getAttrib(elm, 'scope'),\n        class: dom.getAttrib(elm, 'class', ''),\n        align: '',\n        type: elm.parentNode.nodeName.toLowerCase()\n      }, getHAlignment('align', 'align', editor, elm)), hasAdvancedRowTab ? extractAdvancedStyles(dom, elm) : {});\n      return data;\n    };\n    var extractDataFromCellElement = function (editor, elm, hasAdvancedCellTab) {\n      var dom = editor.dom;\n      var data = __assign(__assign(__assign({\n        width: dom.getStyle(elm, 'width') || dom.getAttrib(elm, 'width'),\n        height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n        scope: dom.getAttrib(elm, 'scope'),\n        celltype: elm.nodeName.toLowerCase(),\n        class: dom.getAttrib(elm, 'class', '')\n      }, getHAlignment('align', 'halign', editor, elm)), getVAlignment('valign', 'valign', editor, elm)), hasAdvancedCellTab ? extractAdvancedStyles(dom, elm) : {});\n      return data;\n    };\n    var Helpers = {\n      buildListItems: buildListItems,\n      extractAdvancedStyles: extractAdvancedStyles,\n      getSharedValues: getSharedValues,\n      getAdvancedTab: getAdvancedTab,\n      extractDataFromTableElement: extractDataFromTableElement,\n      extractDataFromRowElement: extractDataFromRowElement,\n      extractDataFromCellElement: extractDataFromCellElement,\n      extractDataFromSettings: extractDataFromSettings\n    };\n\n    var getClassList = function (editor) {\n      var rowClassList = getCellClassList(editor);\n      var classes = Helpers.buildListItems(rowClassList, function (item) {\n        if (item.value) {\n          item.textStyle = function () {\n            return editor.formatter.getCssText({\n              block: 'tr',\n              classes: [item.value]\n            });\n          };\n        }\n      });\n      if (rowClassList.length > 0) {\n        return Option.some({\n          name: 'class',\n          type: 'selectbox',\n          label: 'Class',\n          items: classes\n        });\n      }\n      return Option.none();\n    };\n    var children$3 = [\n      {\n        name: 'width',\n        type: 'input',\n        label: 'Width'\n      },\n      {\n        name: 'height',\n        type: 'input',\n        label: 'Height'\n      },\n      {\n        name: 'celltype',\n        type: 'selectbox',\n        label: 'Cell type',\n        items: [\n          {\n            text: 'Cell',\n            value: 'td'\n          },\n          {\n            text: 'Header cell',\n            value: 'th'\n          }\n        ]\n      },\n      {\n        name: 'scope',\n        type: 'selectbox',\n        label: 'Scope',\n        items: [\n          {\n            text: 'None',\n            value: ''\n          },\n          {\n            text: 'Row',\n            value: 'row'\n          },\n          {\n            text: 'Column',\n            value: 'col'\n          },\n          {\n            text: 'Row group',\n            value: 'rowgroup'\n          },\n          {\n            text: 'Column group',\n            value: 'colgroup'\n          }\n        ]\n      },\n      {\n        name: 'halign',\n        type: 'selectbox',\n        label: 'H Align',\n        items: [\n          {\n            text: 'None',\n            value: ''\n          },\n          {\n            text: 'Left',\n            value: 'left'\n          },\n          {\n            text: 'Center',\n            value: 'center'\n          },\n          {\n            text: 'Right',\n            value: 'right'\n          }\n        ]\n      },\n      {\n        name: 'valign',\n        type: 'selectbox',\n        label: 'V Align',\n        items: [\n          {\n            text: 'None',\n            value: ''\n          },\n          {\n            text: 'Top',\n            value: 'top'\n          },\n          {\n            text: 'Middle',\n            value: 'middle'\n          },\n          {\n            text: 'Bottom',\n            value: 'bottom'\n          }\n        ]\n      }\n    ];\n    var getItems = function (editor) {\n      return getClassList(editor).fold(function () {\n        return children$3;\n      }, function (classlist) {\n        return children$3.concat(classlist);\n      });\n    };\n    var CellDialogGeneralTab = { getItems: getItems };\n\n    var normal = function (dom, node) {\n      var setAttrib = function (attr, value) {\n        dom.setAttrib(node, attr, value);\n      };\n      var setStyle = function (prop, value) {\n        dom.setStyle(node, prop, value);\n      };\n      return {\n        setAttrib: setAttrib,\n        setStyle: setStyle\n      };\n    };\n    var ifTruthy = function (dom, node) {\n      var setAttrib = function (attr, value) {\n        if (value) {\n          dom.setAttrib(node, attr, value);\n        }\n      };\n      var setStyle = function (prop, value) {\n        if (value) {\n          dom.setStyle(node, prop, value);\n        }\n      };\n      return {\n        setAttrib: setAttrib,\n        setStyle: setStyle\n      };\n    };\n    var DomModifier = {\n      normal: normal,\n      ifTruthy: ifTruthy\n    };\n\n    var updateSimpleProps = function (modifiers, data) {\n      modifiers.setAttrib('scope', data.scope);\n      modifiers.setAttrib('class', data.class);\n      modifiers.setStyle('width', addSizeSuffix(data.width));\n      modifiers.setStyle('height', addSizeSuffix(data.height));\n    };\n    var updateAdvancedProps = function (modifiers, data) {\n      modifiers.setStyle('background-color', data.backgroundcolor);\n      modifiers.setStyle('border-color', data.bordercolor);\n      modifiers.setStyle('border-style', data.borderstyle);\n      modifiers.setStyle('border-width', addSizeSuffix(data.borderwidth));\n    };\n    var applyToSingle = function (editor, cells, data) {\n      var dom = editor.dom;\n      var cellElm = data.celltype && cells[0].nodeName.toLowerCase() !== data.celltype ? dom.rename(cells[0], data.celltype) : cells[0];\n      var modifiers = DomModifier.normal(dom, cellElm);\n      updateSimpleProps(modifiers, data);\n      if (hasAdvancedCellTab(editor)) {\n        updateAdvancedProps(modifiers, data);\n      }\n      Styles$1.unApplyAlign(editor, cellElm);\n      Styles$1.unApplyVAlign(editor, cellElm);\n      if (data.halign) {\n        Styles$1.applyAlign(editor, cellElm, data.halign);\n      }\n      if (data.valign) {\n        Styles$1.applyVAlign(editor, cellElm, data.valign);\n      }\n    };\n    var applyToMultiple = function (editor, cells, data) {\n      var dom = editor.dom;\n      global$1.each(cells, function (cellElm) {\n        if (data.celltype && cellElm.nodeName.toLowerCase() !== data.celltype) {\n          cellElm = dom.rename(cellElm, data.celltype);\n        }\n        var modifiers = DomModifier.ifTruthy(dom, cellElm);\n        updateSimpleProps(modifiers, data);\n        if (hasAdvancedCellTab(editor)) {\n          updateAdvancedProps(modifiers, data);\n        }\n        if (data.halign) {\n          Styles$1.applyAlign(editor, cellElm, data.halign);\n        }\n        if (data.valign) {\n          Styles$1.applyVAlign(editor, cellElm, data.valign);\n        }\n      });\n    };\n    var onSubmitCellForm = function (editor, cells, api) {\n      var data = api.getData();\n      api.close();\n      editor.undoManager.transact(function () {\n        var applicator = cells.length === 1 ? applyToSingle : applyToMultiple;\n        applicator(editor, cells, data);\n        editor.focus();\n      });\n    };\n    var open = function (editor) {\n      var cellElm, cells = [];\n      cells = editor.dom.select('td[data-mce-selected],th[data-mce-selected]');\n      cellElm = editor.dom.getParent(editor.selection.getStart(), 'td,th');\n      if (!cells.length && cellElm) {\n        cells.push(cellElm);\n      }\n      cellElm = cellElm || cells[0];\n      if (!cellElm) {\n        return;\n      }\n      var cellsData = global$1.map(cells, function (cellElm) {\n        return Helpers.extractDataFromCellElement(editor, cellElm, hasAdvancedCellTab(editor));\n      });\n      var data = Helpers.getSharedValues(cellsData);\n      var dialogTabPanel = {\n        type: 'tabpanel',\n        tabs: [\n          {\n            title: 'General',\n            name: 'general',\n            items: CellDialogGeneralTab.getItems(editor)\n          },\n          Helpers.getAdvancedTab('cell')\n        ]\n      };\n      var dialogPanel = {\n        type: 'panel',\n        items: [{\n            type: 'grid',\n            columns: 2,\n            items: CellDialogGeneralTab.getItems(editor)\n          }]\n      };\n      editor.windowManager.open({\n        title: 'Cell Properties',\n        size: 'normal',\n        body: hasAdvancedCellTab(editor) ? dialogTabPanel : dialogPanel,\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: data,\n        onSubmit: curry(onSubmitCellForm, editor, cells)\n      });\n    };\n    var CellDialog = { open: open };\n\n    var getClassList$1 = function (editor) {\n      var rowClassList = getRowClassList(editor);\n      var classes = Helpers.buildListItems(rowClassList, function (item) {\n        if (item.value) {\n          item.textStyle = function () {\n            return editor.formatter.getCssText({\n              block: 'tr',\n              classes: [item.value]\n            });\n          };\n        }\n      });\n      if (rowClassList.length > 0) {\n        return Option.some({\n          name: 'class',\n          type: 'selectbox',\n          label: 'Class',\n          items: classes\n        });\n      }\n      return Option.none();\n    };\n    var formChildren = [\n      {\n        type: 'selectbox',\n        name: 'type',\n        label: 'Row type',\n        items: [\n          {\n            text: 'Header',\n            value: 'thead'\n          },\n          {\n            text: 'Body',\n            value: 'tbody'\n          },\n          {\n            text: 'Footer',\n            value: 'tfoot'\n          }\n        ]\n      },\n      {\n        type: 'selectbox',\n        name: 'align',\n        label: 'Alignment',\n        items: [\n          {\n            text: 'None',\n            value: ''\n          },\n          {\n            text: 'Left',\n            value: 'left'\n          },\n          {\n            text: 'Center',\n            value: 'center'\n          },\n          {\n            text: 'Right',\n            value: 'right'\n          }\n        ]\n      },\n      {\n        label: 'Height',\n        name: 'height',\n        type: 'input'\n      }\n    ];\n    var getItems$1 = function (editor) {\n      return getClassList$1(editor).fold(function () {\n        return formChildren;\n      }, function (classes) {\n        return formChildren.concat(classes);\n      });\n    };\n    var RowDialogGeneralTab = { getItems: getItems$1 };\n\n    var switchRowType = function (dom, rowElm, toType) {\n      var tableElm = dom.getParent(rowElm, 'table');\n      var oldParentElm = rowElm.parentNode;\n      var parentElm = dom.select(toType, tableElm)[0];\n      if (!parentElm) {\n        parentElm = dom.create(toType);\n        if (tableElm.firstChild) {\n          if (tableElm.firstChild.nodeName === 'CAPTION') {\n            dom.insertAfter(parentElm, tableElm.firstChild);\n          } else {\n            tableElm.insertBefore(parentElm, tableElm.firstChild);\n          }\n        } else {\n          tableElm.appendChild(parentElm);\n        }\n      }\n      parentElm.appendChild(rowElm);\n      if (!oldParentElm.hasChildNodes()) {\n        dom.remove(oldParentElm);\n      }\n    };\n    var updateAdvancedProps$1 = function (modifier, data) {\n      modifier.setStyle('background-color', data.backgroundcolor);\n      modifier.setStyle('border-color', data.bordercolor);\n      modifier.setStyle('border-style', data.borderstyle);\n    };\n    var onSubmitRowForm = function (editor, rows, oldData, api) {\n      var dom = editor.dom;\n      var data = api.getData();\n      api.close();\n      var createModifier = rows.length === 1 ? DomModifier.normal : DomModifier.ifTruthy;\n      editor.undoManager.transact(function () {\n        global$1.each(rows, function (rowElm) {\n          if (data.type !== rowElm.parentNode.nodeName.toLowerCase()) {\n            switchRowType(editor.dom, rowElm, data.type);\n          }\n          var modifier = createModifier(dom, rowElm);\n          modifier.setAttrib('scope', data.scope);\n          modifier.setAttrib('class', data.class);\n          modifier.setStyle('height', addSizeSuffix(data.height));\n          if (hasAdvancedRowTab(editor)) {\n            updateAdvancedProps$1(modifier, data);\n          }\n          if (data.align !== oldData.align) {\n            Styles$1.unApplyAlign(editor, rowElm);\n            Styles$1.applyAlign(editor, rowElm, data.align);\n          }\n        });\n        editor.focus();\n      });\n    };\n    var open$1 = function (editor) {\n      var dom = editor.dom;\n      var tableElm, cellElm, rowElm;\n      var rows = [];\n      tableElm = dom.getParent(editor.selection.getStart(), 'table');\n      if (!tableElm) {\n        return;\n      }\n      cellElm = dom.getParent(editor.selection.getStart(), 'td,th');\n      global$1.each(tableElm.rows, function (row) {\n        global$1.each(row.cells, function (cell) {\n          if ((dom.getAttrib(cell, 'data-mce-selected') || cell === cellElm) && rows.indexOf(row) < 0) {\n            rows.push(row);\n            return false;\n          }\n        });\n      });\n      rowElm = rows[0];\n      if (!rowElm) {\n        return;\n      }\n      var rowsData = global$1.map(rows, function (rowElm) {\n        return Helpers.extractDataFromRowElement(editor, rowElm, hasAdvancedRowTab(editor));\n      });\n      var data = Helpers.getSharedValues(rowsData);\n      var dialogTabPanel = {\n        type: 'tabpanel',\n        tabs: [\n          {\n            title: 'General',\n            name: 'general',\n            items: RowDialogGeneralTab.getItems(editor)\n          },\n          Helpers.getAdvancedTab('row')\n        ]\n      };\n      var dialogPanel = {\n        type: 'panel',\n        items: [{\n            type: 'grid',\n            columns: 2,\n            items: RowDialogGeneralTab.getItems(editor)\n          }]\n      };\n      editor.windowManager.open({\n        title: 'Row Properties',\n        size: 'normal',\n        body: hasAdvancedRowTab(editor) ? dialogTabPanel : dialogPanel,\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: data,\n        onSubmit: curry(onSubmitRowForm, editor, rows, data)\n      });\n    };\n    var RowDialog = { open: open$1 };\n\n    var hasOwnProperty$1 = Object.prototype.hasOwnProperty;\n    var shallow$1 = function (old, nu) {\n      return nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n        for (var i = 0; i < objects.length; i++) {\n          objects[i] = arguments[i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (hasOwnProperty$1.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var merge$3 = baseMerge(shallow$1);\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.Env');\n\n    var DefaultRenderOptions = {\n      styles: {\n        'border-collapse': 'collapse',\n        'width': '100%'\n      },\n      attributes: { border: '1' },\n      percentages: true\n    };\n    var makeTable = function () {\n      return Element.fromTag('table');\n    };\n    var tableBody = function () {\n      return Element.fromTag('tbody');\n    };\n    var tableRow = function () {\n      return Element.fromTag('tr');\n    };\n    var tableHeaderCell = function () {\n      return Element.fromTag('th');\n    };\n    var tableCell = function () {\n      return Element.fromTag('td');\n    };\n    var render$1 = function (rows, columns, rowHeaders, columnHeaders, renderOpts) {\n      if (renderOpts === void 0) {\n        renderOpts = DefaultRenderOptions;\n      }\n      var table = makeTable();\n      setAll$1(table, renderOpts.styles);\n      setAll(table, renderOpts.attributes);\n      var tbody = tableBody();\n      append(table, tbody);\n      var trs = [];\n      for (var i = 0; i < rows; i++) {\n        var tr = tableRow();\n        for (var j = 0; j < columns; j++) {\n          var td = i < rowHeaders || j < columnHeaders ? tableHeaderCell() : tableCell();\n          if (j < columnHeaders) {\n            set(td, 'scope', 'row');\n          }\n          if (i < rowHeaders) {\n            set(td, 'scope', 'col');\n          }\n          append(td, Element.fromTag('br'));\n          if (renderOpts.percentages) {\n            set$1(td, 'width', 100 / columns + '%');\n          }\n          append(tr, td);\n        }\n        trs.push(tr);\n      }\n      append$1(tbody, trs);\n      return table;\n    };\n\n    var get$8 = function (element) {\n      return element.dom().innerHTML;\n    };\n    var getOuter$2 = function (element) {\n      var container = Element.fromTag('div');\n      var clone = Element.fromDom(element.dom().cloneNode(true));\n      append(container, clone);\n      return get$8(container);\n    };\n\n    var placeCaretInCell = function (editor, cell) {\n      editor.selection.select(cell.dom(), true);\n      editor.selection.collapse(true);\n    };\n    var selectFirstCellInTable = function (editor, tableElm) {\n      descendant$1(tableElm, 'td,th').each(curry(placeCaretInCell, editor));\n    };\n    var fireEvents = function (editor, table) {\n      each(descendants$1(table, 'tr'), function (row) {\n        fireNewRow(editor, row.dom());\n        each(descendants$1(row, 'th,td'), function (cell) {\n          fireNewCell(editor, cell.dom());\n        });\n      });\n    };\n    var isPercentage = function (width) {\n      return isString(width) && width.indexOf('%') !== -1;\n    };\n    var insert$1 = function (editor, columns, rows) {\n      var defaultStyles = getDefaultStyles(editor);\n      var options = {\n        styles: defaultStyles,\n        attributes: getDefaultAttributes(editor),\n        percentages: isPercentage(defaultStyles.width) && !isPixelsForced(editor)\n      };\n      var table = render$1(rows, columns, 0, 0, options);\n      set(table, 'data-mce-id', '__mce');\n      var html = getOuter$2(table);\n      editor.insertContent(html);\n      return descendant$1(getBody$1(editor), 'table[data-mce-id=\"__mce\"]').map(function (table) {\n        if (isPixelsForced(editor)) {\n          set$1(table, 'width', get$2(table, 'width'));\n        }\n        remove(table, 'data-mce-id');\n        fireEvents(editor, table);\n        selectFirstCellInTable(editor, table);\n        return table.dom();\n      }).getOr(null);\n    };\n    var InsertTable = { insert: insert$1 };\n\n    var getItems$2 = function (editor, hasClasses, insertNewTable) {\n      var rowColCountItems = !insertNewTable ? [] : [\n        {\n          type: 'input',\n          name: 'cols',\n          label: 'Cols',\n          inputMode: 'numeric'\n        },\n        {\n          type: 'input',\n          name: 'rows',\n          label: 'Rows',\n          inputMode: 'numeric'\n        }\n      ];\n      var alwaysItems = [\n        {\n          type: 'input',\n          name: 'width',\n          label: 'Width'\n        },\n        {\n          type: 'input',\n          name: 'height',\n          label: 'Height'\n        }\n      ];\n      var appearanceItems = hasAppearanceOptions(editor) ? [\n        {\n          type: 'input',\n          name: 'cellspacing',\n          label: 'Cell spacing',\n          inputMode: 'numeric'\n        },\n        {\n          type: 'input',\n          name: 'cellpadding',\n          label: 'Cell padding',\n          inputMode: 'numeric'\n        },\n        {\n          type: 'input',\n          name: 'border',\n          label: 'Border width'\n        },\n        {\n          type: 'label',\n          label: 'Caption',\n          items: [{\n              type: 'checkbox',\n              name: 'caption',\n              label: 'Show caption'\n            }]\n        }\n      ] : [];\n      var alignmentItem = [{\n          type: 'selectbox',\n          name: 'align',\n          label: 'Alignment',\n          items: [\n            {\n              text: 'None',\n              value: ''\n            },\n            {\n              text: 'Left',\n              value: 'left'\n            },\n            {\n              text: 'Center',\n              value: 'center'\n            },\n            {\n              text: 'Right',\n              value: 'right'\n            }\n          ]\n        }];\n      var classListItem = hasClasses ? [{\n          type: 'selectbox',\n          name: 'class',\n          label: 'Class',\n          items: Helpers.buildListItems(getTableClassList(editor), function (item) {\n            if (item.value) {\n              item.textStyle = function () {\n                return editor.formatter.getCssText({\n                  block: 'table',\n                  classes: [item.value]\n                });\n              };\n            }\n          })\n        }] : [];\n      return rowColCountItems.concat(alwaysItems).concat(appearanceItems).concat(alignmentItem).concat(classListItem);\n    };\n    var TableDialogGeneralTab = { getItems: getItems$2 };\n\n    var styleTDTH = function (dom, elm, name, value) {\n      if (elm.tagName === 'TD' || elm.tagName === 'TH') {\n        if (isString(name)) {\n          dom.setStyle(elm, name, value);\n        } else {\n          dom.setStyle(elm, name);\n        }\n      } else {\n        if (elm.children) {\n          for (var i = 0; i < elm.children.length; i++) {\n            styleTDTH(dom, elm.children[i], name, value);\n          }\n        }\n      }\n    };\n    var applyDataToElement = function (editor, tableElm, data) {\n      var dom = editor.dom;\n      var attrs = {};\n      var styles = {};\n      attrs.class = data.class;\n      styles.height = addSizeSuffix(data.height);\n      if (dom.getAttrib(tableElm, 'width') && !shouldStyleWithCss(editor)) {\n        attrs.width = removePxSuffix(data.width);\n      } else {\n        styles.width = addSizeSuffix(data.width);\n      }\n      if (shouldStyleWithCss(editor)) {\n        styles['border-width'] = addSizeSuffix(data.border);\n        styles['border-spacing'] = addSizeSuffix(data.cellspacing);\n      } else {\n        attrs.border = data.border;\n        attrs.cellpadding = data.cellpadding;\n        attrs.cellspacing = data.cellspacing;\n      }\n      if (shouldStyleWithCss(editor) && tableElm.children) {\n        for (var i = 0; i < tableElm.children.length; i++) {\n          styleTDTH(dom, tableElm.children[i], {\n            'border-width': addSizeSuffix(data.border),\n            'padding': addSizeSuffix(data.cellpadding)\n          });\n          if (hasAdvancedTableTab(editor)) {\n            styleTDTH(dom, tableElm.children[i], { 'border-color': data.bordercolor });\n          }\n        }\n      }\n      if (hasAdvancedTableTab(editor)) {\n        styles['background-color'] = data.backgroundcolor;\n        styles['border-color'] = data.bordercolor;\n        styles['border-style'] = data.borderstyle;\n      }\n      attrs.style = dom.serializeStyle(merge$3(getDefaultStyles(editor), styles));\n      dom.setAttribs(tableElm, merge$3(getDefaultAttributes(editor), attrs));\n    };\n    var onSubmitTableForm = function (editor, tableElm, api) {\n      var dom = editor.dom;\n      var captionElm;\n      var data = api.getData();\n      api.close();\n      if (data.class === '') {\n        delete data.class;\n      }\n      editor.undoManager.transact(function () {\n        if (!tableElm) {\n          var cols = parseInt(data.cols, 10) || 1;\n          var rows = parseInt(data.rows, 10) || 1;\n          tableElm = InsertTable.insert(editor, cols, rows);\n        }\n        applyDataToElement(editor, tableElm, data);\n        captionElm = dom.select('caption', tableElm)[0];\n        if (captionElm && !data.caption) {\n          dom.remove(captionElm);\n        }\n        if (!captionElm && data.caption) {\n          captionElm = dom.create('caption');\n          captionElm.innerHTML = !global$2.ie ? '<br data-mce-bogus=\"1\"/>' : '\\xA0';\n          tableElm.insertBefore(captionElm, tableElm.firstChild);\n        }\n        if (data.align === '') {\n          Styles$1.unApplyAlign(editor, tableElm);\n        } else {\n          Styles$1.applyAlign(editor, tableElm, data.align);\n        }\n        editor.focus();\n        editor.addVisual();\n      });\n    };\n    var open$2 = function (editor, insertNewTable) {\n      var dom = editor.dom;\n      var tableElm;\n      var data = Helpers.extractDataFromSettings(editor, hasAdvancedTableTab(editor));\n      if (insertNewTable === false) {\n        tableElm = dom.getParent(editor.selection.getStart(), 'table');\n        if (tableElm) {\n          data = Helpers.extractDataFromTableElement(editor, tableElm, hasAdvancedTableTab(editor));\n        } else {\n          if (hasAdvancedTableTab(editor)) {\n            data.borderstyle = '';\n            data.bordercolor = '';\n            data.backgroundcolor = '';\n          }\n        }\n      } else {\n        data.cols = '1';\n        data.rows = '1';\n        if (hasAdvancedTableTab(editor)) {\n          data.borderstyle = '';\n          data.bordercolor = '';\n          data.backgroundcolor = '';\n        }\n      }\n      var hasClasses = getTableClassList(editor).length > 0;\n      if (hasClasses) {\n        if (data.class) {\n          data.class = data.class.replace(/\\s*mce\\-item\\-table\\s*/g, '');\n        }\n      }\n      var generalPanel = {\n        type: 'grid',\n        columns: 2,\n        items: TableDialogGeneralTab.getItems(editor, hasClasses, insertNewTable)\n      };\n      var nonAdvancedForm = function () {\n        return {\n          type: 'panel',\n          items: [generalPanel]\n        };\n      };\n      var advancedForm = function () {\n        return {\n          type: 'tabpanel',\n          tabs: [\n            {\n              title: 'General',\n              name: 'general',\n              items: [generalPanel]\n            },\n            Helpers.getAdvancedTab('table')\n          ]\n        };\n      };\n      var dialogBody = hasAdvancedTableTab(editor) ? advancedForm() : nonAdvancedForm();\n      editor.windowManager.open({\n        title: 'Table Properties',\n        size: 'normal',\n        body: dialogBody,\n        onSubmit: curry(onSubmitTableForm, editor, tableElm),\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: data\n      });\n    };\n    var TableDialog = { open: open$2 };\n\n    var getSelectionStartFromSelector = function (selector) {\n      return function (editor) {\n        return Option.from(editor.dom.getParent(editor.selection.getStart(), selector)).map(Element.fromDom);\n      };\n    };\n    var getSelectionStartCell = getSelectionStartFromSelector('th,td');\n    var getSelectionStartCellOrCaption = getSelectionStartFromSelector('th,td,caption');\n\n    var each$3 = global$1.each;\n    var registerCommands = function (editor, actions, cellSelection, selections, clipboardRows) {\n      var isRoot = getIsRoot(editor);\n      var eraseTable = function () {\n        getSelectionStartCellOrCaption(editor).each(function (cellOrCaption) {\n          var tableOpt = TableLookup.table(cellOrCaption, isRoot);\n          tableOpt.filter(not(isRoot)).each(function (table) {\n            var cursor = Element.fromText('');\n            after(table, cursor);\n            remove$2(table);\n            if (editor.dom.isEmpty(editor.getBody())) {\n              editor.setContent('');\n              editor.selection.setCursorLocation();\n            } else {\n              var rng = editor.dom.createRng();\n              rng.setStart(cursor.dom(), 0);\n              rng.setEnd(cursor.dom(), 0);\n              editor.selection.setRng(rng);\n              editor.nodeChanged();\n            }\n          });\n        });\n      };\n      var getTableFromCell = function (cell) {\n        return TableLookup.table(cell, isRoot);\n      };\n      var getSize = function (table) {\n        return {\n          width: getPixelWidth$1(table.dom()),\n          height: getPixelWidth$1(table.dom())\n        };\n      };\n      var resizeChange = function (editor, oldSize, table) {\n        var newSize = getSize(table);\n        if (oldSize.width !== newSize.width || oldSize.height !== newSize.height) {\n          fireObjectResizeStart(editor, table.dom(), oldSize.width, oldSize.height);\n          fireObjectResized(editor, table.dom(), newSize.width, newSize.height);\n        }\n      };\n      var actOnSelection = function (execute) {\n        getSelectionStartCell(editor).each(function (cell) {\n          getTableFromCell(cell).each(function (table) {\n            var targets = TableTargets.forMenu(selections, table, cell);\n            var beforeSize = getSize(table);\n            execute(table, targets).each(function (rng) {\n              resizeChange(editor, beforeSize, table);\n              editor.selection.setRng(rng);\n              editor.focus();\n              cellSelection.clear(table);\n              removeDataStyle(table);\n            });\n          });\n        });\n      };\n      var copyRowSelection = function (execute) {\n        return getSelectionStartCell(editor).map(function (cell) {\n          return getTableFromCell(cell).bind(function (table) {\n            var doc = Element.fromDom(editor.getDoc());\n            var targets = TableTargets.forMenu(selections, table, cell);\n            var generators = TableFill.cellOperations(noop, doc, Option.none());\n            return CopyRows.copyRows(table, targets, generators);\n          });\n        });\n      };\n      var pasteOnSelection = function (execute) {\n        clipboardRows.get().each(function (rows) {\n          var clonedRows = map(rows, function (row) {\n            return deep(row);\n          });\n          getSelectionStartCell(editor).each(function (cell) {\n            getTableFromCell(cell).each(function (table) {\n              var doc = Element.fromDom(editor.getDoc());\n              var generators = TableFill.paste(doc);\n              var targets = TableTargets.pasteRows(selections, table, cell, clonedRows, generators);\n              execute(table, targets).each(function (rng) {\n                editor.selection.setRng(rng);\n                editor.focus();\n                cellSelection.clear(table);\n              });\n            });\n          });\n        });\n      };\n      each$3({\n        mceTableSplitCells: function () {\n          actOnSelection(actions.unmergeCells);\n        },\n        mceTableMergeCells: function () {\n          actOnSelection(actions.mergeCells);\n        },\n        mceTableInsertRowBefore: function () {\n          actOnSelection(actions.insertRowsBefore);\n        },\n        mceTableInsertRowAfter: function () {\n          actOnSelection(actions.insertRowsAfter);\n        },\n        mceTableInsertColBefore: function () {\n          actOnSelection(actions.insertColumnsBefore);\n        },\n        mceTableInsertColAfter: function () {\n          actOnSelection(actions.insertColumnsAfter);\n        },\n        mceTableDeleteCol: function () {\n          actOnSelection(actions.deleteColumn);\n        },\n        mceTableDeleteRow: function () {\n          actOnSelection(actions.deleteRow);\n        },\n        mceTableCutRow: function (grid) {\n          copyRowSelection().each(function (selection) {\n            clipboardRows.set(selection);\n            actOnSelection(actions.deleteRow);\n          });\n        },\n        mceTableCopyRow: function (grid) {\n          copyRowSelection().each(function (selection) {\n            clipboardRows.set(selection);\n          });\n        },\n        mceTablePasteRowBefore: function (grid) {\n          pasteOnSelection(actions.pasteRowsBefore);\n        },\n        mceTablePasteRowAfter: function (grid) {\n          pasteOnSelection(actions.pasteRowsAfter);\n        },\n        mceTableDelete: eraseTable\n      }, function (func, name) {\n        editor.addCommand(name, func);\n      });\n      each$3({\n        mceInsertTable: curry(TableDialog.open, editor, true),\n        mceTableProps: curry(TableDialog.open, editor, false),\n        mceTableRowProps: curry(RowDialog.open, editor),\n        mceTableCellProps: curry(CellDialog.open, editor)\n      }, function (func, name) {\n        editor.addCommand(name, function () {\n          func();\n        });\n      });\n    };\n    var Commands = { registerCommands: registerCommands };\n\n    var only = function (element) {\n      var parent = Option.from(element.dom().documentElement).map(Element.fromDom).getOr(element);\n      return {\n        parent: constant(parent),\n        view: constant(element),\n        origin: constant(Position(0, 0))\n      };\n    };\n    var detached = function (editable, chrome) {\n      var origin = function () {\n        return absolute(chrome);\n      };\n      return {\n        parent: constant(chrome),\n        view: constant(editable),\n        origin: origin\n      };\n    };\n    var body$1 = function (editable, chrome) {\n      return {\n        parent: constant(chrome),\n        view: constant(editable),\n        origin: constant(Position(0, 0))\n      };\n    };\n    var ResizeWire = {\n      only: only,\n      detached: detached,\n      body: body$1\n    };\n\n    var Event = function (fields) {\n      var struct = Immutable.apply(null, fields);\n      var handlers = [];\n      var bind = function (handler) {\n        if (handler === undefined) {\n          throw new Error('Event bind error: undefined handler');\n        }\n        handlers.push(handler);\n      };\n      var unbind = function (handler) {\n        handlers = filter(handlers, function (h) {\n          return h !== handler;\n        });\n      };\n      var trigger = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        var event = struct.apply(null, args);\n        each(handlers, function (handler) {\n          handler(event);\n        });\n      };\n      return {\n        bind: bind,\n        unbind: unbind,\n        trigger: trigger\n      };\n    };\n\n    var create$1 = function (typeDefs) {\n      var registry = map$1(typeDefs, function (event) {\n        return {\n          bind: event.bind,\n          unbind: event.unbind\n        };\n      });\n      var trigger = map$1(typeDefs, function (event) {\n        return event.trigger;\n      });\n      return {\n        registry: registry,\n        trigger: trigger\n      };\n    };\n    var Events = { create: create$1 };\n\n    var mkEvent = function (target, x, y, stop, prevent, kill, raw) {\n      return {\n        target: constant(target),\n        x: constant(x),\n        y: constant(y),\n        stop: stop,\n        prevent: prevent,\n        kill: kill,\n        raw: constant(raw)\n      };\n    };\n    var fromRawEvent = function (rawEvent) {\n      var target = Element.fromDom(rawEvent.target);\n      var stop = function () {\n        rawEvent.stopPropagation();\n      };\n      var prevent = function () {\n        rawEvent.preventDefault();\n      };\n      var kill = compose(prevent, stop);\n      return mkEvent(target, rawEvent.clientX, rawEvent.clientY, stop, prevent, kill, rawEvent);\n    };\n    var handle = function (filter, handler) {\n      return function (rawEvent) {\n        if (!filter(rawEvent)) {\n          return;\n        }\n        handler(fromRawEvent(rawEvent));\n      };\n    };\n    var binder = function (element, event, filter, handler, useCapture) {\n      var wrapped = handle(filter, handler);\n      element.dom().addEventListener(event, wrapped, useCapture);\n      return { unbind: curry(unbind, element, event, wrapped, useCapture) };\n    };\n    var bind$1 = function (element, event, filter, handler) {\n      return binder(element, event, filter, handler, false);\n    };\n    var unbind = function (element, event, handler, useCapture) {\n      element.dom().removeEventListener(event, handler, useCapture);\n    };\n\n    var filter$1 = constant(true);\n    var bind$2 = function (element, event, handler) {\n      return bind$1(element, event, filter$1, handler);\n    };\n\n    var styles$1 = css('ephox-dragster');\n    var Styles$2 = { resolve: styles$1.resolve };\n\n    var Blocker = function (options) {\n      var settings = merge$3({ layerClass: Styles$2.resolve('blocker') }, options);\n      var div = Element.fromTag('div');\n      set(div, 'role', 'presentation');\n      setAll$1(div, {\n        position: 'fixed',\n        left: '0px',\n        top: '0px',\n        width: '100%',\n        height: '100%'\n      });\n      add$2(div, Styles$2.resolve('blocker'));\n      add$2(div, settings.layerClass);\n      var element = function () {\n        return div;\n      };\n      var destroy = function () {\n        remove$2(div);\n      };\n      return {\n        element: element,\n        destroy: destroy\n      };\n    };\n\n    var DragMode = exactly([\n      'compare',\n      'extract',\n      'mutate',\n      'sink'\n    ]);\n    var DragSink = exactly([\n      'element',\n      'start',\n      'stop',\n      'destroy'\n    ]);\n    var DragApi = exactly([\n      'forceDrop',\n      'drop',\n      'move',\n      'delayDrop'\n    ]);\n\n    var compare = function (old, nu) {\n      return Position(nu.left() - old.left(), nu.top() - old.top());\n    };\n    var extract$1 = function (event) {\n      return Option.some(Position(event.x(), event.y()));\n    };\n    var mutate = function (mutation, info) {\n      mutation.mutate(info.left(), info.top());\n    };\n    var sink = function (dragApi, settings) {\n      var blocker = Blocker(settings);\n      var mdown = bind$2(blocker.element(), 'mousedown', dragApi.forceDrop);\n      var mup = bind$2(blocker.element(), 'mouseup', dragApi.drop);\n      var mmove = bind$2(blocker.element(), 'mousemove', dragApi.move);\n      var mout = bind$2(blocker.element(), 'mouseout', dragApi.delayDrop);\n      var destroy = function () {\n        blocker.destroy();\n        mup.unbind();\n        mmove.unbind();\n        mout.unbind();\n        mdown.unbind();\n      };\n      var start = function (parent) {\n        append(parent, blocker.element());\n      };\n      var stop = function () {\n        remove$2(blocker.element());\n      };\n      return DragSink({\n        element: blocker.element,\n        start: start,\n        stop: stop,\n        destroy: destroy\n      });\n    };\n    var MouseDrag = DragMode({\n      compare: compare,\n      extract: extract$1,\n      sink: sink,\n      mutate: mutate\n    });\n\n    var last$2 = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          domGlobals.clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer !== null) {\n          domGlobals.clearTimeout(timer);\n        }\n        timer = domGlobals.setTimeout(function () {\n          fn.apply(null, args);\n          timer = null;\n        }, rate);\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    function InDrag () {\n      var previous = Option.none();\n      var reset = function () {\n        previous = Option.none();\n      };\n      var update = function (mode, nu) {\n        var result = previous.map(function (old) {\n          return mode.compare(old, nu);\n        });\n        previous = Option.some(nu);\n        return result;\n      };\n      var onEvent = function (event, mode) {\n        var dataOption = mode.extract(event);\n        dataOption.each(function (data) {\n          var offset = update(mode, data);\n          offset.each(function (d) {\n            events.trigger.move(d);\n          });\n        });\n      };\n      var events = Events.create({ move: Event(['info']) });\n      return {\n        onEvent: onEvent,\n        reset: reset,\n        events: events.registry\n      };\n    }\n\n    function NoDrag () {\n      return {\n        onEvent: noop,\n        reset: noop\n      };\n    }\n\n    function Movement () {\n      var noDragState = NoDrag();\n      var inDragState = InDrag();\n      var dragState = noDragState;\n      var on = function () {\n        dragState.reset();\n        dragState = inDragState;\n      };\n      var off = function () {\n        dragState.reset();\n        dragState = noDragState;\n      };\n      var onEvent = function (event, mode) {\n        dragState.onEvent(event, mode);\n      };\n      var isOn = function () {\n        return dragState === inDragState;\n      };\n      return {\n        on: on,\n        off: off,\n        isOn: isOn,\n        onEvent: onEvent,\n        events: inDragState.events\n      };\n    }\n\n    var setup = function (mutation, mode, settings) {\n      var active = false;\n      var events = Events.create({\n        start: Event([]),\n        stop: Event([])\n      });\n      var movement = Movement();\n      var drop = function () {\n        sink.stop();\n        if (movement.isOn()) {\n          movement.off();\n          events.trigger.stop();\n        }\n      };\n      var throttledDrop = last$2(drop, 200);\n      var go = function (parent) {\n        sink.start(parent);\n        movement.on();\n        events.trigger.start();\n      };\n      var mousemove = function (event) {\n        throttledDrop.cancel();\n        movement.onEvent(event, mode);\n      };\n      movement.events.move.bind(function (event) {\n        mode.mutate(mutation, event.info());\n      });\n      var on = function () {\n        active = true;\n      };\n      var off = function () {\n        active = false;\n      };\n      var runIfActive = function (f) {\n        return function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          if (active) {\n            f.apply(null, args);\n          }\n        };\n      };\n      var sink = mode.sink(DragApi({\n        forceDrop: drop,\n        drop: runIfActive(drop),\n        move: runIfActive(mousemove),\n        delayDrop: runIfActive(throttledDrop.throttle)\n      }), settings);\n      var destroy = function () {\n        sink.destroy();\n      };\n      return {\n        element: sink.element,\n        go: go,\n        on: on,\n        off: off,\n        destroy: destroy,\n        events: events.registry\n      };\n    };\n    var Dragging = { setup: setup };\n\n    var transform$1 = function (mutation, settings) {\n      if (settings === void 0) {\n        settings = {};\n      }\n      var mode = settings.mode !== undefined ? settings.mode : MouseDrag;\n      return Dragging.setup(mutation, mode, settings);\n    };\n    var Dragger = { transform: transform$1 };\n\n    var Mutation = function () {\n      var events = Events.create({\n        drag: Event([\n          'xDelta',\n          'yDelta'\n        ])\n      });\n      var mutate = function (x, y) {\n        events.trigger.drag(x, y);\n      };\n      return {\n        mutate: mutate,\n        events: events.registry\n      };\n    };\n\n    var BarMutation = function () {\n      var events = Events.create({\n        drag: Event([\n          'xDelta',\n          'yDelta',\n          'target'\n        ])\n      });\n      var target = Option.none();\n      var delegate = Mutation();\n      delegate.events.drag.bind(function (event) {\n        target.each(function (t) {\n          events.trigger.drag(event.xDelta(), event.yDelta(), t);\n        });\n      });\n      var assign = function (t) {\n        target = Option.some(t);\n      };\n      var get = function () {\n        return target;\n      };\n      return {\n        assign: assign,\n        get: get,\n        mutate: delegate.mutate,\n        events: events.registry\n      };\n    };\n\n    var isContentEditableTrue = function (elm) {\n      return get$1(elm, 'contenteditable') === 'true';\n    };\n    var findClosestContentEditable = function (target, isRoot) {\n      return closest$1(target, '[contenteditable]', isRoot);\n    };\n\n    var resizeBarDragging = Styles.resolve('resizer-bar-dragging');\n    var BarManager = function (wire, direction, hdirection) {\n      var mutation = BarMutation();\n      var resizing = Dragger.transform(mutation, {});\n      var hoverTable = Option.none();\n      var getResizer = function (element, type) {\n        return Option.from(get$1(element, type));\n      };\n      mutation.events.drag.bind(function (event) {\n        getResizer(event.target(), 'data-row').each(function (_dataRow) {\n          var currentRow = CellUtils.getInt(event.target(), 'top');\n          set$1(event.target(), 'top', currentRow + event.yDelta() + 'px');\n        });\n        getResizer(event.target(), 'data-column').each(function (_dataCol) {\n          var currentCol = CellUtils.getInt(event.target(), 'left');\n          set$1(event.target(), 'left', currentCol + event.xDelta() + 'px');\n        });\n      });\n      var getDelta = function (target, dir) {\n        var newX = CellUtils.getInt(target, dir);\n        var oldX = parseInt(get$1(target, 'data-initial-' + dir), 10);\n        return newX - oldX;\n      };\n      resizing.events.stop.bind(function () {\n        mutation.get().each(function (target) {\n          hoverTable.each(function (table) {\n            getResizer(target, 'data-row').each(function (row) {\n              var delta = getDelta(target, 'top');\n              remove(target, 'data-initial-top');\n              events.trigger.adjustHeight(table, delta, parseInt(row, 10));\n            });\n            getResizer(target, 'data-column').each(function (column) {\n              var delta = getDelta(target, 'left');\n              remove(target, 'data-initial-left');\n              events.trigger.adjustWidth(table, delta, parseInt(column, 10));\n            });\n            Bars.refresh(wire, table, hdirection, direction);\n          });\n        });\n      });\n      var handler = function (target, dir) {\n        events.trigger.startAdjust();\n        mutation.assign(target);\n        set(target, 'data-initial-' + dir, parseInt(get$2(target, dir), 10));\n        add$2(target, resizeBarDragging);\n        set$1(target, 'opacity', '0.2');\n        resizing.go(wire.parent());\n      };\n      var mousedown = bind$2(wire.parent(), 'mousedown', function (event) {\n        if (Bars.isRowBar(event.target())) {\n          handler(event.target(), 'top');\n        }\n        if (Bars.isColBar(event.target())) {\n          handler(event.target(), 'left');\n        }\n      });\n      var isRoot = function (e) {\n        return eq(e, wire.view());\n      };\n      var findClosestEditableTable = function (target) {\n        return closest$1(target, 'table', isRoot).filter(function (table) {\n          return findClosestContentEditable(table, isRoot).exists(isContentEditableTrue);\n        });\n      };\n      var mouseover = bind$2(wire.view(), 'mouseover', function (event) {\n        findClosestEditableTable(event.target()).fold(function () {\n          if (inBody(event.target())) {\n            Bars.destroy(wire);\n          }\n        }, function (table) {\n          hoverTable = Option.some(table);\n          Bars.refresh(wire, table, hdirection, direction);\n        });\n      });\n      var destroy = function () {\n        mousedown.unbind();\n        mouseover.unbind();\n        resizing.destroy();\n        Bars.destroy(wire);\n      };\n      var refresh = function (tbl) {\n        Bars.refresh(wire, tbl, hdirection, direction);\n      };\n      var events = Events.create({\n        adjustHeight: Event([\n          'table',\n          'delta',\n          'row'\n        ]),\n        adjustWidth: Event([\n          'table',\n          'delta',\n          'column'\n        ]),\n        startAdjust: Event([])\n      });\n      return {\n        destroy: destroy,\n        refresh: refresh,\n        on: resizing.on,\n        off: resizing.off,\n        hideBars: curry(Bars.hide, wire),\n        showBars: curry(Bars.show, wire),\n        events: events.registry\n      };\n    };\n\n    var create$2 = function (wire, vdirection) {\n      var hdirection = BarPositions.height;\n      var manager = BarManager(wire, vdirection, hdirection);\n      var events = Events.create({\n        beforeResize: Event(['table']),\n        afterResize: Event(['table']),\n        startDrag: Event([])\n      });\n      manager.events.adjustHeight.bind(function (event) {\n        events.trigger.beforeResize(event.table());\n        var delta = hdirection.delta(event.delta(), event.table());\n        Adjustments.adjustHeight(event.table(), delta, event.row(), hdirection);\n        events.trigger.afterResize(event.table());\n      });\n      manager.events.startAdjust.bind(function (event) {\n        events.trigger.startDrag();\n      });\n      manager.events.adjustWidth.bind(function (event) {\n        events.trigger.beforeResize(event.table());\n        var delta = vdirection.delta(event.delta(), event.table());\n        Adjustments.adjustWidth(event.table(), delta, event.column(), vdirection);\n        events.trigger.afterResize(event.table());\n      });\n      return {\n        on: manager.on,\n        off: manager.off,\n        hideBars: manager.hideBars,\n        showBars: manager.showBars,\n        destroy: manager.destroy,\n        events: events.registry\n      };\n    };\n    var TableResize = { create: create$2 };\n\n    var createContainer = function () {\n      var container = Element.fromTag('div');\n      setAll$1(container, {\n        position: 'static',\n        height: '0',\n        width: '0',\n        padding: '0',\n        margin: '0',\n        border: '0'\n      });\n      append(body(), container);\n      return container;\n    };\n    var get$9 = function (editor, container) {\n      return editor.inline ? ResizeWire.body(getBody$1(editor), createContainer()) : ResizeWire.only(Element.fromDom(editor.getDoc()));\n    };\n    var remove$6 = function (editor, wire) {\n      if (editor.inline) {\n        remove$2(wire.parent());\n      }\n    };\n    var TableWire = {\n      get: get$9,\n      remove: remove$6\n    };\n\n    var calculatePercentageWidth = function (element, parent) {\n      return getPixelWidth$1(element.dom()) / getPixelWidth$1(parent.dom()) * 100 + '%';\n    };\n    var enforcePercentage = function (rawTable) {\n      var table = Element.fromDom(rawTable);\n      parent(table).map(function (parent) {\n        return calculatePercentageWidth(table, parent);\n      }).each(function (tablePercentage) {\n        set$1(table, 'width', tablePercentage);\n        each(descendants$1(table, 'tr'), function (tr) {\n          each(children(tr), function (td) {\n            set$1(td, 'width', calculatePercentageWidth(td, tr));\n          });\n        });\n      });\n    };\n    var enforcePixels = function (table) {\n      set$1(Element.fromDom(table), 'width', getPixelWidth$1(table).toString() + 'px');\n    };\n\n    var getResizeHandler = function (editor) {\n      var selectionRng = Option.none();\n      var resize = Option.none();\n      var wire = Option.none();\n      var percentageBasedSizeRegex = /(\\d+(\\.\\d+)?)%/;\n      var startW;\n      var startRawW;\n      var isTable = function (elm) {\n        return elm.nodeName === 'TABLE';\n      };\n      var getRawWidth = function (elm) {\n        var raw = editor.dom.getStyle(elm, 'width') || editor.dom.getAttrib(elm, 'width');\n        return Option.from(raw).filter(function (s) {\n          return s.length > 0;\n        });\n      };\n      var lazyResize = function () {\n        return resize;\n      };\n      var lazyWire = function () {\n        return wire.getOr(ResizeWire.only(Element.fromDom(editor.getBody())));\n      };\n      var destroy = function () {\n        resize.each(function (sz) {\n          sz.destroy();\n        });\n        wire.each(function (w) {\n          TableWire.remove(editor, w);\n        });\n      };\n      editor.on('init', function () {\n        var direction = TableDirection(Direction.directionAt);\n        var rawWire = TableWire.get(editor);\n        wire = Option.some(rawWire);\n        if (hasObjectResizing(editor) && hasTableResizeBars(editor)) {\n          var sz = TableResize.create(rawWire, direction);\n          sz.on();\n          sz.events.startDrag.bind(function (event) {\n            selectionRng = Option.some(editor.selection.getRng());\n          });\n          sz.events.beforeResize.bind(function (event) {\n            var rawTable = event.table().dom();\n            fireObjectResizeStart(editor, rawTable, getPixelWidth$1(rawTable), getPixelHeight(rawTable));\n          });\n          sz.events.afterResize.bind(function (event) {\n            var table = event.table();\n            var rawTable = table.dom();\n            removeDataStyle(table);\n            selectionRng.each(function (rng) {\n              editor.selection.setRng(rng);\n              editor.focus();\n            });\n            fireObjectResized(editor, rawTable, getPixelWidth$1(rawTable), getPixelHeight(rawTable));\n            editor.undoManager.add();\n          });\n          resize = Option.some(sz);\n        }\n      });\n      editor.on('ObjectResizeStart', function (e) {\n        var targetElm = e.target;\n        if (isTable(targetElm)) {\n          var tableHasPercentage = getRawWidth(targetElm).map(function (w) {\n            return percentageBasedSizeRegex.test(w);\n          }).getOr(false);\n          if (tableHasPercentage && isPixelsForced(editor)) {\n            enforcePixels(targetElm);\n          } else if (!tableHasPercentage && isPercentagesForced(editor)) {\n            enforcePercentage(targetElm);\n          }\n          startW = e.width;\n          startRawW = getRawWidth(targetElm).getOr('');\n        }\n      });\n      editor.on('ObjectResized', function (e) {\n        var targetElm = e.target;\n        if (isTable(targetElm)) {\n          var table = targetElm;\n          if (percentageBasedSizeRegex.test(startRawW)) {\n            var percentW = parseFloat(percentageBasedSizeRegex.exec(startRawW)[1]);\n            var targetPercentW = e.width * percentW / startW;\n            editor.dom.setStyle(table, 'width', targetPercentW + '%');\n          } else {\n            var newCellSizes_1 = [];\n            global$1.each(table.rows, function (row) {\n              global$1.each(row.cells, function (cell) {\n                var width = editor.dom.getStyle(cell, 'width', true);\n                newCellSizes_1.push({\n                  cell: cell,\n                  width: width\n                });\n              });\n            });\n            global$1.each(newCellSizes_1, function (newCellSize) {\n              editor.dom.setStyle(newCellSize.cell, 'width', newCellSize.width);\n              editor.dom.setAttrib(newCellSize.cell, 'width', null);\n            });\n          }\n        }\n      });\n      editor.on('SwitchMode', function () {\n        lazyResize().each(function (resize) {\n          if (editor.readonly) {\n            resize.hideBars();\n          } else {\n            resize.showBars();\n          }\n        });\n      });\n      return {\n        lazyResize: lazyResize,\n        lazyWire: lazyWire,\n        destroy: destroy\n      };\n    };\n\n    var adt$1 = Adt.generate([\n      { none: ['current'] },\n      { first: ['current'] },\n      {\n        middle: [\n          'current',\n          'target'\n        ]\n      },\n      { last: ['current'] }\n    ]);\n    var none$1 = function (current) {\n      if (current === void 0) {\n        current = undefined;\n      }\n      return adt$1.none(current);\n    };\n    var CellLocation = __assign(__assign({}, adt$1), { none: none$1 });\n\n    var detect$4 = function (current, isRoot) {\n      return TableLookup.table(current, isRoot).bind(function (table) {\n        var all = TableLookup.cells(table);\n        var index = findIndex(all, function (x) {\n          return eq(current, x);\n        });\n        return index.map(function (ind) {\n          return {\n            index: constant(ind),\n            all: constant(all)\n          };\n        });\n      });\n    };\n    var next = function (current, isRoot) {\n      var detection = detect$4(current, isRoot);\n      return detection.fold(function () {\n        return CellLocation.none(current);\n      }, function (info) {\n        return info.index() + 1 < info.all().length ? CellLocation.middle(current, info.all()[info.index() + 1]) : CellLocation.last(current);\n      });\n    };\n    var prev = function (current, isRoot) {\n      var detection = detect$4(current, isRoot);\n      return detection.fold(function () {\n        return CellLocation.none();\n      }, function (info) {\n        return info.index() - 1 >= 0 ? CellLocation.middle(current, info.all()[info.index() - 1]) : CellLocation.first(current);\n      });\n    };\n    var CellNavigation = {\n      next: next,\n      prev: prev\n    };\n\n    var create$3 = Immutable('start', 'soffset', 'finish', 'foffset');\n    var SimRange = { create: create$3 };\n\n    var adt$2 = Adt.generate([\n      { before: ['element'] },\n      {\n        on: [\n          'element',\n          'offset'\n        ]\n      },\n      { after: ['element'] }\n    ]);\n    var cata$1 = function (subject, onBefore, onOn, onAfter) {\n      return subject.fold(onBefore, onOn, onAfter);\n    };\n    var getStart = function (situ) {\n      return situ.fold(identity, identity, identity);\n    };\n    var before$2 = adt$2.before;\n    var on = adt$2.on;\n    var after$2 = adt$2.after;\n    var Situ = {\n      before: before$2,\n      on: on,\n      after: after$2,\n      cata: cata$1,\n      getStart: getStart\n    };\n\n    var adt$3 = Adt.generate([\n      { domRange: ['rng'] },\n      {\n        relative: [\n          'startSitu',\n          'finishSitu'\n        ]\n      },\n      {\n        exact: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var exactFromRange = function (simRange) {\n      return adt$3.exact(simRange.start(), simRange.soffset(), simRange.finish(), simRange.foffset());\n    };\n    var getStart$1 = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return Element.fromDom(rng.startContainer);\n        },\n        relative: function (startSitu, finishSitu) {\n          return Situ.getStart(startSitu);\n        },\n        exact: function (start, soffset, finish, foffset) {\n          return start;\n        }\n      });\n    };\n    var domRange = adt$3.domRange;\n    var relative = adt$3.relative;\n    var exact = adt$3.exact;\n    var getWin = function (selection) {\n      var start = getStart$1(selection);\n      return defaultView(start);\n    };\n    var range$1 = SimRange.create;\n    var Selection = {\n      domRange: domRange,\n      relative: relative,\n      exact: exact,\n      exactFromRange: exactFromRange,\n      getWin: getWin,\n      range: range$1\n    };\n\n    var selectNodeContents = function (win, element) {\n      var rng = win.document.createRange();\n      selectNodeContentsUsing(rng, element);\n      return rng;\n    };\n    var selectNodeContentsUsing = function (rng, element) {\n      rng.selectNodeContents(element.dom());\n    };\n    var setStart = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setStartBefore(e.dom());\n      }, function (e, o) {\n        rng.setStart(e.dom(), o);\n      }, function (e) {\n        rng.setStartAfter(e.dom());\n      });\n    };\n    var setFinish = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setEndBefore(e.dom());\n      }, function (e, o) {\n        rng.setEnd(e.dom(), o);\n      }, function (e) {\n        rng.setEndAfter(e.dom());\n      });\n    };\n    var relativeToNative = function (win, startSitu, finishSitu) {\n      var range = win.document.createRange();\n      setStart(range, startSitu);\n      setFinish(range, finishSitu);\n      return range;\n    };\n    var exactToNative = function (win, start, soffset, finish, foffset) {\n      var rng = win.document.createRange();\n      rng.setStart(start.dom(), soffset);\n      rng.setEnd(finish.dom(), foffset);\n      return rng;\n    };\n    var toRect = function (rect) {\n      return {\n        left: constant(rect.left),\n        top: constant(rect.top),\n        right: constant(rect.right),\n        bottom: constant(rect.bottom),\n        width: constant(rect.width),\n        height: constant(rect.height)\n      };\n    };\n    var getFirstRect = function (rng) {\n      var rects = rng.getClientRects();\n      var rect = rects.length > 0 ? rects[0] : rng.getBoundingClientRect();\n      return rect.width > 0 || rect.height > 0 ? Option.some(rect).map(toRect) : Option.none();\n    };\n\n    var adt$4 = Adt.generate([\n      {\n        ltr: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      },\n      {\n        rtl: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var fromRange = function (win, type, range) {\n      return type(Element.fromDom(range.startContainer), range.startOffset, Element.fromDom(range.endContainer), range.endOffset);\n    };\n    var getRanges = function (win, selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return {\n            ltr: constant(rng),\n            rtl: Option.none\n          };\n        },\n        relative: function (startSitu, finishSitu) {\n          return {\n            ltr: cached(function () {\n              return relativeToNative(win, startSitu, finishSitu);\n            }),\n            rtl: cached(function () {\n              return Option.some(relativeToNative(win, finishSitu, startSitu));\n            })\n          };\n        },\n        exact: function (start, soffset, finish, foffset) {\n          return {\n            ltr: cached(function () {\n              return exactToNative(win, start, soffset, finish, foffset);\n            }),\n            rtl: cached(function () {\n              return Option.some(exactToNative(win, finish, foffset, start, soffset));\n            })\n          };\n        }\n      });\n    };\n    var doDiagnose = function (win, ranges) {\n      var rng = ranges.ltr();\n      if (rng.collapsed) {\n        var reversed = ranges.rtl().filter(function (rev) {\n          return rev.collapsed === false;\n        });\n        return reversed.map(function (rev) {\n          return adt$4.rtl(Element.fromDom(rev.endContainer), rev.endOffset, Element.fromDom(rev.startContainer), rev.startOffset);\n        }).getOrThunk(function () {\n          return fromRange(win, adt$4.ltr, rng);\n        });\n      } else {\n        return fromRange(win, adt$4.ltr, rng);\n      }\n    };\n    var diagnose = function (win, selection) {\n      var ranges = getRanges(win, selection);\n      return doDiagnose(win, ranges);\n    };\n    var asLtrRange = function (win, selection) {\n      var diagnosis = diagnose(win, selection);\n      return diagnosis.match({\n        ltr: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(start.dom(), soffset);\n          rng.setEnd(finish.dom(), foffset);\n          return rng;\n        },\n        rtl: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(finish.dom(), foffset);\n          rng.setEnd(start.dom(), soffset);\n          return rng;\n        }\n      });\n    };\n\n    var searchForPoint = function (rectForOffset, x, y, maxX, length) {\n      if (length === 0) {\n        return 0;\n      } else if (x === maxX) {\n        return length - 1;\n      }\n      var xDelta = maxX;\n      for (var i = 1; i < length; i++) {\n        var rect = rectForOffset(i);\n        var curDeltaX = Math.abs(x - rect.left);\n        if (y <= rect.bottom) {\n          if (y < rect.top || curDeltaX > xDelta) {\n            return i - 1;\n          } else {\n            xDelta = curDeltaX;\n          }\n        }\n      }\n      return 0;\n    };\n    var inRect = function (rect, x, y) {\n      return x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom;\n    };\n\n    var locateOffset = function (doc, textnode, x, y, rect) {\n      var rangeForOffset = function (o) {\n        var r = doc.dom().createRange();\n        r.setStart(textnode.dom(), o);\n        r.collapse(true);\n        return r;\n      };\n      var rectForOffset = function (o) {\n        var r = rangeForOffset(o);\n        return r.getBoundingClientRect();\n      };\n      var length = get$3(textnode).length;\n      var offset = searchForPoint(rectForOffset, x, y, rect.right, length);\n      return rangeForOffset(offset);\n    };\n    var locate = function (doc, node, x, y) {\n      var r = doc.dom().createRange();\n      r.selectNode(node.dom());\n      var rects = r.getClientRects();\n      var foundRect = findMap(rects, function (rect) {\n        return inRect(rect, x, y) ? Option.some(rect) : Option.none();\n      });\n      return foundRect.map(function (rect) {\n        return locateOffset(doc, node, x, y, rect);\n      });\n    };\n\n    var searchInChildren = function (doc, node, x, y) {\n      var r = doc.dom().createRange();\n      var nodes = children(node);\n      return findMap(nodes, function (n) {\n        r.selectNode(n.dom());\n        return inRect(r.getBoundingClientRect(), x, y) ? locateNode(doc, n, x, y) : Option.none();\n      });\n    };\n    var locateNode = function (doc, node, x, y) {\n      return isText(node) ? locate(doc, node, x, y) : searchInChildren(doc, node, x, y);\n    };\n    var locate$1 = function (doc, node, x, y) {\n      var r = doc.dom().createRange();\n      r.selectNode(node.dom());\n      var rect = r.getBoundingClientRect();\n      var boundedX = Math.max(rect.left, Math.min(rect.right, x));\n      var boundedY = Math.max(rect.top, Math.min(rect.bottom, y));\n      return locateNode(doc, node, boundedX, boundedY);\n    };\n\n    var COLLAPSE_TO_LEFT = true;\n    var COLLAPSE_TO_RIGHT = false;\n    var getCollapseDirection = function (rect, x) {\n      return x - rect.left < rect.right - x ? COLLAPSE_TO_LEFT : COLLAPSE_TO_RIGHT;\n    };\n    var createCollapsedNode = function (doc, target, collapseDirection) {\n      var r = doc.dom().createRange();\n      r.selectNode(target.dom());\n      r.collapse(collapseDirection);\n      return r;\n    };\n    var locateInElement = function (doc, node, x) {\n      var cursorRange = doc.dom().createRange();\n      cursorRange.selectNode(node.dom());\n      var rect = cursorRange.getBoundingClientRect();\n      var collapseDirection = getCollapseDirection(rect, x);\n      var f = collapseDirection === COLLAPSE_TO_LEFT ? first : last$1;\n      return f(node).map(function (target) {\n        return createCollapsedNode(doc, target, collapseDirection);\n      });\n    };\n    var locateInEmpty = function (doc, node, x) {\n      var rect = node.dom().getBoundingClientRect();\n      var collapseDirection = getCollapseDirection(rect, x);\n      return Option.some(createCollapsedNode(doc, node, collapseDirection));\n    };\n    var search = function (doc, node, x) {\n      var f = children(node).length === 0 ? locateInEmpty : locateInElement;\n      return f(doc, node, x);\n    };\n\n    var caretPositionFromPoint = function (doc, x, y) {\n      return Option.from(doc.dom().caretPositionFromPoint(x, y)).bind(function (pos) {\n        if (pos.offsetNode === null) {\n          return Option.none();\n        }\n        var r = doc.dom().createRange();\n        r.setStart(pos.offsetNode, pos.offset);\n        r.collapse();\n        return Option.some(r);\n      });\n    };\n    var caretRangeFromPoint = function (doc, x, y) {\n      return Option.from(doc.dom().caretRangeFromPoint(x, y));\n    };\n    var searchTextNodes = function (doc, node, x, y) {\n      var r = doc.dom().createRange();\n      r.selectNode(node.dom());\n      var rect = r.getBoundingClientRect();\n      var boundedX = Math.max(rect.left, Math.min(rect.right, x));\n      var boundedY = Math.max(rect.top, Math.min(rect.bottom, y));\n      return locate$1(doc, node, boundedX, boundedY);\n    };\n    var searchFromPoint = function (doc, x, y) {\n      return Element.fromPoint(doc, x, y).bind(function (elem) {\n        var fallback = function () {\n          return search(doc, elem, x);\n        };\n        return children(elem).length === 0 ? fallback() : searchTextNodes(doc, elem, x, y).orThunk(fallback);\n      });\n    };\n    var availableSearch = document.caretPositionFromPoint ? caretPositionFromPoint : document.caretRangeFromPoint ? caretRangeFromPoint : searchFromPoint;\n    var fromPoint$1 = function (win, x, y) {\n      var doc = Element.fromDom(win.document);\n      return availableSearch(doc, x, y).map(function (rng) {\n        return SimRange.create(Element.fromDom(rng.startContainer), rng.startOffset, Element.fromDom(rng.endContainer), rng.endOffset);\n      });\n    };\n\n    var beforeSpecial = function (element, offset) {\n      var name$1 = name(element);\n      if ('input' === name$1) {\n        return Situ.after(element);\n      } else if (!contains([\n          'br',\n          'img'\n        ], name$1)) {\n        return Situ.on(element, offset);\n      } else {\n        return offset === 0 ? Situ.before(element) : Situ.after(element);\n      }\n    };\n    var preprocessRelative = function (startSitu, finishSitu) {\n      var start = startSitu.fold(Situ.before, beforeSpecial, Situ.after);\n      var finish = finishSitu.fold(Situ.before, beforeSpecial, Situ.after);\n      return Selection.relative(start, finish);\n    };\n    var preprocessExact = function (start, soffset, finish, foffset) {\n      var startSitu = beforeSpecial(start, soffset);\n      var finishSitu = beforeSpecial(finish, foffset);\n      return Selection.relative(startSitu, finishSitu);\n    };\n    var preprocess = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          var start = Element.fromDom(rng.startContainer);\n          var finish = Element.fromDom(rng.endContainer);\n          return preprocessExact(start, rng.startOffset, finish, rng.endOffset);\n        },\n        relative: preprocessRelative,\n        exact: preprocessExact\n      });\n    };\n\n    var makeRange = function (start, soffset, finish, foffset) {\n      var doc = owner(start);\n      var rng = doc.dom().createRange();\n      rng.setStart(start.dom(), soffset);\n      rng.setEnd(finish.dom(), foffset);\n      return rng;\n    };\n    var after$3 = function (start, soffset, finish, foffset) {\n      var r = makeRange(start, soffset, finish, foffset);\n      var same = eq(start, finish) && soffset === foffset;\n      return r.collapsed && !same;\n    };\n\n    var doSetNativeRange = function (win, rng) {\n      Option.from(win.getSelection()).each(function (selection) {\n        selection.removeAllRanges();\n        selection.addRange(rng);\n      });\n    };\n    var doSetRange = function (win, start, soffset, finish, foffset) {\n      var rng = exactToNative(win, start, soffset, finish, foffset);\n      doSetNativeRange(win, rng);\n    };\n    var setLegacyRtlRange = function (win, selection, start, soffset, finish, foffset) {\n      selection.collapse(start.dom(), soffset);\n      selection.extend(finish.dom(), foffset);\n    };\n    var setRangeFromRelative = function (win, relative) {\n      return diagnose(win, relative).match({\n        ltr: function (start, soffset, finish, foffset) {\n          doSetRange(win, start, soffset, finish, foffset);\n        },\n        rtl: function (start, soffset, finish, foffset) {\n          var selection = win.getSelection();\n          if (selection.setBaseAndExtent) {\n            selection.setBaseAndExtent(start.dom(), soffset, finish.dom(), foffset);\n          } else if (selection.extend) {\n            try {\n              setLegacyRtlRange(win, selection, start, soffset, finish, foffset);\n            } catch (e) {\n              doSetRange(win, finish, foffset, start, soffset);\n            }\n          } else {\n            doSetRange(win, finish, foffset, start, soffset);\n          }\n        }\n      });\n    };\n    var setExact = function (win, start, soffset, finish, foffset) {\n      var relative = preprocessExact(start, soffset, finish, foffset);\n      setRangeFromRelative(win, relative);\n    };\n    var setRelative = function (win, startSitu, finishSitu) {\n      var relative = preprocessRelative(startSitu, finishSitu);\n      setRangeFromRelative(win, relative);\n    };\n    var toNative = function (selection) {\n      var win = Selection.getWin(selection).dom();\n      var getDomRange = function (start, soffset, finish, foffset) {\n        return exactToNative(win, start, soffset, finish, foffset);\n      };\n      var filtered = preprocess(selection);\n      return diagnose(win, filtered).match({\n        ltr: getDomRange,\n        rtl: getDomRange\n      });\n    };\n    var readRange = function (selection) {\n      if (selection.rangeCount > 0) {\n        var firstRng = selection.getRangeAt(0);\n        var lastRng = selection.getRangeAt(selection.rangeCount - 1);\n        return Option.some(SimRange.create(Element.fromDom(firstRng.startContainer), firstRng.startOffset, Element.fromDom(lastRng.endContainer), lastRng.endOffset));\n      } else {\n        return Option.none();\n      }\n    };\n    var doGetExact = function (selection) {\n      var anchor = Element.fromDom(selection.anchorNode);\n      var focus = Element.fromDom(selection.focusNode);\n      return after$3(anchor, selection.anchorOffset, focus, selection.focusOffset) ? Option.some(SimRange.create(anchor, selection.anchorOffset, focus, selection.focusOffset)) : readRange(selection);\n    };\n    var setToElement = function (win, element) {\n      var rng = selectNodeContents(win, element);\n      doSetNativeRange(win, rng);\n    };\n    var getExact = function (win) {\n      return Option.from(win.getSelection()).filter(function (sel) {\n        return sel.rangeCount > 0;\n      }).bind(doGetExact);\n    };\n    var get$a = function (win) {\n      return getExact(win).map(function (range) {\n        return Selection.exact(range.start(), range.soffset(), range.finish(), range.foffset());\n      });\n    };\n    var getFirstRect$1 = function (win, selection) {\n      var rng = asLtrRange(win, selection);\n      return getFirstRect(rng);\n    };\n    var getAtPoint = function (win, x, y) {\n      return fromPoint$1(win, x, y);\n    };\n    var clear = function (win) {\n      var selection = win.getSelection();\n      selection.removeAllRanges();\n    };\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var forward = function (editor, isRoot, cell, lazyWire) {\n      return go(editor, isRoot, CellNavigation.next(cell), lazyWire);\n    };\n    var backward = function (editor, isRoot, cell, lazyWire) {\n      return go(editor, isRoot, CellNavigation.prev(cell), lazyWire);\n    };\n    var getCellFirstCursorPosition = function (editor, cell) {\n      var selection = Selection.exact(cell, 0, cell, 0);\n      return toNative(selection);\n    };\n    var getNewRowCursorPosition = function (editor, table) {\n      var rows = descendants$1(table, 'tr');\n      return last(rows).bind(function (last) {\n        return descendant$1(last, 'td,th').map(function (first) {\n          return getCellFirstCursorPosition(editor, first);\n        });\n      });\n    };\n    var go = function (editor, isRoot, cell, actions, lazyWire) {\n      return cell.fold(Option.none, Option.none, function (current, next) {\n        return first(next).map(function (cell) {\n          return getCellFirstCursorPosition(editor, cell);\n        });\n      }, function (current) {\n        return TableLookup.table(current, isRoot).bind(function (table) {\n          var targets = TableTargets.noMenu(current);\n          editor.undoManager.transact(function () {\n            actions.insertRowsAfter(table, targets);\n          });\n          return getNewRowCursorPosition(editor, table);\n        });\n      });\n    };\n    var rootElements = [\n      'table',\n      'li',\n      'dl'\n    ];\n    var handle$1 = function (event, editor, actions, lazyWire) {\n      if (event.keyCode === global$3.TAB) {\n        var body_1 = getBody$1(editor);\n        var isRoot_1 = function (element) {\n          var name$1 = name(element);\n          return eq(element, body_1) || contains(rootElements, name$1);\n        };\n        var rng = editor.selection.getRng();\n        if (rng.collapsed) {\n          var start = Element.fromDom(rng.startContainer);\n          TableLookup.cell(start, isRoot_1).each(function (cell) {\n            event.preventDefault();\n            var navigation = event.shiftKey ? backward : forward;\n            var rng = navigation(editor, isRoot_1, cell, actions, lazyWire);\n            rng.each(function (range) {\n              editor.selection.setRng(range);\n            });\n          });\n        }\n      }\n    };\n    var TabContext = { handle: handle$1 };\n\n    var create$4 = Immutable('selection', 'kill');\n    var Response = { create: create$4 };\n\n    var create$5 = function (start, soffset, finish, foffset) {\n      return {\n        start: constant(Situ.on(start, soffset)),\n        finish: constant(Situ.on(finish, foffset))\n      };\n    };\n    var Situs = { create: create$5 };\n\n    var convertToRange = function (win, selection) {\n      var rng = asLtrRange(win, selection);\n      return SimRange.create(Element.fromDom(rng.startContainer), rng.startOffset, Element.fromDom(rng.endContainer), rng.endOffset);\n    };\n    var makeSitus = Situs.create;\n    var Util = {\n      convertToRange: convertToRange,\n      makeSitus: makeSitus\n    };\n\n    var sync = function (container, isRoot, start, soffset, finish, foffset, selectRange) {\n      if (!(eq(start, finish) && soffset === foffset)) {\n        return closest$1(start, 'td,th', isRoot).bind(function (s) {\n          return closest$1(finish, 'td,th', isRoot).bind(function (f) {\n            return detect$5(container, isRoot, s, f, selectRange);\n          });\n        });\n      } else {\n        return Option.none();\n      }\n    };\n    var detect$5 = function (container, isRoot, start, finish, selectRange) {\n      if (!eq(start, finish)) {\n        return CellSelection.identify(start, finish, isRoot).bind(function (cellSel) {\n          var boxes = cellSel.boxes().getOr([]);\n          if (boxes.length > 0) {\n            selectRange(container, boxes, cellSel.start(), cellSel.finish());\n            return Option.some(Response.create(Option.some(Util.makeSitus(start, 0, start, getEnd(start))), true));\n          } else {\n            return Option.none();\n          }\n        });\n      } else {\n        return Option.none();\n      }\n    };\n    var update = function (rows, columns, container, selected, annotations) {\n      var updateSelection = function (newSels) {\n        annotations.clearBeforeUpdate(container);\n        annotations.selectRange(container, newSels.boxes(), newSels.start(), newSels.finish());\n        return newSels.boxes();\n      };\n      return CellSelection.shiftSelection(selected, rows, columns, annotations.firstSelectedSelector(), annotations.lastSelectedSelector()).map(updateSelection);\n    };\n    var KeySelection = {\n      sync: sync,\n      detect: detect$5,\n      update: update\n    };\n\n    var traverse = Immutable('item', 'mode');\n    var backtrack = function (universe, item, _direction, transition) {\n      if (transition === void 0) {\n        transition = sidestep;\n      }\n      return universe.property().parent(item).map(function (p) {\n        return traverse(p, transition);\n      });\n    };\n    var sidestep = function (universe, item, direction, transition) {\n      if (transition === void 0) {\n        transition = advance;\n      }\n      return direction.sibling(universe, item).map(function (p) {\n        return traverse(p, transition);\n      });\n    };\n    var advance = function (universe, item, direction, transition) {\n      if (transition === void 0) {\n        transition = advance;\n      }\n      var children = universe.property().children(item);\n      var result = direction.first(children);\n      return result.map(function (r) {\n        return traverse(r, transition);\n      });\n    };\n    var successors = [\n      {\n        current: backtrack,\n        next: sidestep,\n        fallback: Option.none()\n      },\n      {\n        current: sidestep,\n        next: advance,\n        fallback: Option.some(backtrack)\n      },\n      {\n        current: advance,\n        next: advance,\n        fallback: Option.some(sidestep)\n      }\n    ];\n    var go$1 = function (universe, item, mode, direction, rules) {\n      if (rules === void 0) {\n        rules = successors;\n      }\n      var ruleOpt = find(rules, function (succ) {\n        return succ.current === mode;\n      });\n      return ruleOpt.bind(function (rule) {\n        return rule.current(universe, item, direction, rule.next).orThunk(function () {\n          return rule.fallback.bind(function (fb) {\n            return go$1(universe, item, fb, direction);\n          });\n        });\n      });\n    };\n\n    var left = function () {\n      var sibling = function (universe, item) {\n        return universe.query().prevSibling(item);\n      };\n      var first = function (children) {\n        return children.length > 0 ? Option.some(children[children.length - 1]) : Option.none();\n      };\n      return {\n        sibling: sibling,\n        first: first\n      };\n    };\n    var right = function () {\n      var sibling = function (universe, item) {\n        return universe.query().nextSibling(item);\n      };\n      var first = function (children) {\n        return children.length > 0 ? Option.some(children[0]) : Option.none();\n      };\n      return {\n        sibling: sibling,\n        first: first\n      };\n    };\n    var Walkers = {\n      left: left,\n      right: right\n    };\n\n    var hone = function (universe, item, predicate, mode, direction, isRoot) {\n      var next = go$1(universe, item, mode, direction);\n      return next.bind(function (n) {\n        if (isRoot(n.item())) {\n          return Option.none();\n        } else {\n          return predicate(n.item()) ? Option.some(n.item()) : hone(universe, n.item(), predicate, n.mode(), direction, isRoot);\n        }\n      });\n    };\n    var left$1 = function (universe, item, predicate, isRoot) {\n      return hone(universe, item, predicate, sidestep, Walkers.left(), isRoot);\n    };\n    var right$1 = function (universe, item, predicate, isRoot) {\n      return hone(universe, item, predicate, sidestep, Walkers.right(), isRoot);\n    };\n\n    var isLeaf = function (universe) {\n      return function (element) {\n        return universe.property().children(element).length === 0;\n      };\n    };\n    var before$3 = function (universe, item, isRoot) {\n      return seekLeft(universe, item, isLeaf(universe), isRoot);\n    };\n    var after$4 = function (universe, item, isRoot) {\n      return seekRight(universe, item, isLeaf(universe), isRoot);\n    };\n    var seekLeft = left$1;\n    var seekRight = right$1;\n\n    var universe$2 = DomUniverse();\n    var before$4 = function (element, isRoot) {\n      return before$3(universe$2, element, isRoot);\n    };\n    var after$5 = function (element, isRoot) {\n      return after$4(universe$2, element, isRoot);\n    };\n    var seekLeft$1 = function (element, predicate, isRoot) {\n      return seekLeft(universe$2, element, predicate, isRoot);\n    };\n    var seekRight$1 = function (element, predicate, isRoot) {\n      return seekRight(universe$2, element, predicate, isRoot);\n    };\n\n    var ancestor$2 = function (scope, predicate, isRoot) {\n      return ancestor(scope, predicate, isRoot).isSome();\n    };\n\n    var point = Immutable('element', 'offset');\n    var delta = Immutable('element', 'deltaOffset');\n    var range$2 = Immutable('element', 'start', 'finish');\n    var points = Immutable('begin', 'end');\n    var text = Immutable('element', 'text');\n\n    var adt$5 = Adt.generate([\n      { none: ['message'] },\n      { success: [] },\n      { failedUp: ['cell'] },\n      { failedDown: ['cell'] }\n    ]);\n    var isOverlapping = function (bridge, before, after) {\n      var beforeBounds = bridge.getRect(before);\n      var afterBounds = bridge.getRect(after);\n      return afterBounds.right > beforeBounds.left && afterBounds.left < beforeBounds.right;\n    };\n    var isRow = function (elem) {\n      return closest$1(elem, 'tr');\n    };\n    var verify = function (bridge, before, beforeOffset, after, afterOffset, failure, isRoot) {\n      return closest$1(after, 'td,th', isRoot).bind(function (afterCell) {\n        return closest$1(before, 'td,th', isRoot).map(function (beforeCell) {\n          if (!eq(afterCell, beforeCell)) {\n            return DomParent.sharedOne(isRow, [\n              afterCell,\n              beforeCell\n            ]).fold(function () {\n              return isOverlapping(bridge, beforeCell, afterCell) ? adt$5.success() : failure(beforeCell);\n            }, function (_sharedRow) {\n              return failure(beforeCell);\n            });\n          } else {\n            return eq(after, afterCell) && getEnd(afterCell) === afterOffset ? failure(beforeCell) : adt$5.none('in same cell');\n          }\n        });\n      }).getOr(adt$5.none('default'));\n    };\n    var cata$2 = function (subject, onNone, onSuccess, onFailedUp, onFailedDown) {\n      return subject.fold(onNone, onSuccess, onFailedUp, onFailedDown);\n    };\n    var BeforeAfter = __assign(__assign({}, adt$5), {\n      verify: verify,\n      cata: cata$2\n    });\n\n    var inAncestor = Immutable('ancestor', 'descendants', 'element', 'index');\n    var inParent = Immutable('parent', 'children', 'element', 'index');\n    var indexInParent = function (element) {\n      return parent(element).bind(function (parent) {\n        var children$1 = children(parent);\n        return indexOf(children$1, element).map(function (index) {\n          return inParent(parent, children$1, element, index);\n        });\n      });\n    };\n    var indexOf = function (elements, element) {\n      return findIndex(elements, curry(eq, element));\n    };\n\n    var isBr = function (elem) {\n      return name(elem) === 'br';\n    };\n    var gatherer = function (cand, gather, isRoot) {\n      return gather(cand, isRoot).bind(function (target) {\n        return isText(target) && get$3(target).trim().length === 0 ? gatherer(target, gather, isRoot) : Option.some(target);\n      });\n    };\n    var handleBr = function (isRoot, element, direction) {\n      return direction.traverse(element).orThunk(function () {\n        return gatherer(element, direction.gather, isRoot);\n      }).map(direction.relative);\n    };\n    var findBr = function (element, offset) {\n      return child(element, offset).filter(isBr).orThunk(function () {\n        return child(element, offset - 1).filter(isBr);\n      });\n    };\n    var handleParent = function (isRoot, element, offset, direction) {\n      return findBr(element, offset).bind(function (br) {\n        return direction.traverse(br).fold(function () {\n          return gatherer(br, direction.gather, isRoot).map(direction.relative);\n        }, function (adjacent) {\n          return indexInParent(adjacent).map(function (info) {\n            return Situ.on(info.parent(), info.index());\n          });\n        });\n      });\n    };\n    var tryBr = function (isRoot, element, offset, direction) {\n      var target = isBr(element) ? handleBr(isRoot, element, direction) : handleParent(isRoot, element, offset, direction);\n      return target.map(function (tgt) {\n        return {\n          start: constant(tgt),\n          finish: constant(tgt)\n        };\n      });\n    };\n    var process = function (analysis) {\n      return BeforeAfter.cata(analysis, function (message) {\n        return Option.none();\n      }, function () {\n        return Option.none();\n      }, function (cell) {\n        return Option.some(point(cell, 0));\n      }, function (cell) {\n        return Option.some(point(cell, getEnd(cell)));\n      });\n    };\n    var BrTags = {\n      tryBr: tryBr,\n      process: process\n    };\n\n    var nu$3 = MixedBag([\n      'left',\n      'top',\n      'right',\n      'bottom'\n    ], []);\n    var moveDown = function (caret, amount) {\n      return nu$3({\n        left: caret.left(),\n        top: caret.top() + amount,\n        right: caret.right(),\n        bottom: caret.bottom() + amount\n      });\n    };\n    var moveUp = function (caret, amount) {\n      return nu$3({\n        left: caret.left(),\n        top: caret.top() - amount,\n        right: caret.right(),\n        bottom: caret.bottom() - amount\n      });\n    };\n    var moveBottomTo = function (caret, bottom) {\n      var height = caret.bottom() - caret.top();\n      return nu$3({\n        left: caret.left(),\n        top: bottom - height,\n        right: caret.right(),\n        bottom: bottom\n      });\n    };\n    var moveTopTo = function (caret, top) {\n      var height = caret.bottom() - caret.top();\n      return nu$3({\n        left: caret.left(),\n        top: top,\n        right: caret.right(),\n        bottom: top + height\n      });\n    };\n    var translate = function (caret, xDelta, yDelta) {\n      return nu$3({\n        left: caret.left() + xDelta,\n        top: caret.top() + yDelta,\n        right: caret.right() + xDelta,\n        bottom: caret.bottom() + yDelta\n      });\n    };\n    var getTop$1 = function (caret) {\n      return caret.top();\n    };\n    var getBottom = function (caret) {\n      return caret.bottom();\n    };\n    var toString = function (caret) {\n      return '(' + caret.left() + ', ' + caret.top() + ') -> (' + caret.right() + ', ' + caret.bottom() + ')';\n    };\n    var Carets = {\n      nu: nu$3,\n      moveUp: moveUp,\n      moveDown: moveDown,\n      moveBottomTo: moveBottomTo,\n      moveTopTo: moveTopTo,\n      getTop: getTop$1,\n      getBottom: getBottom,\n      translate: translate,\n      toString: toString\n    };\n\n    var getPartialBox = function (bridge, element, offset) {\n      if (offset >= 0 && offset < getEnd(element)) {\n        return bridge.getRangedRect(element, offset, element, offset + 1);\n      } else if (offset > 0) {\n        return bridge.getRangedRect(element, offset - 1, element, offset);\n      }\n      return Option.none();\n    };\n    var toCaret = function (rect) {\n      return Carets.nu({\n        left: rect.left,\n        top: rect.top,\n        right: rect.right,\n        bottom: rect.bottom\n      });\n    };\n    var getElemBox = function (bridge, element) {\n      return Option.some(bridge.getRect(element));\n    };\n    var getBoxAt = function (bridge, element, offset) {\n      if (isElement(element)) {\n        return getElemBox(bridge, element).map(toCaret);\n      } else if (isText(element)) {\n        return getPartialBox(bridge, element, offset).map(toCaret);\n      } else {\n        return Option.none();\n      }\n    };\n    var getEntireBox = function (bridge, element) {\n      if (isElement(element)) {\n        return getElemBox(bridge, element).map(toCaret);\n      } else if (isText(element)) {\n        return bridge.getRangedRect(element, 0, element, getEnd(element)).map(toCaret);\n      } else {\n        return Option.none();\n      }\n    };\n    var Rectangles = {\n      getBoxAt: getBoxAt,\n      getEntireBox: getEntireBox\n    };\n\n    var JUMP_SIZE = 5;\n    var NUM_RETRIES = 100;\n    var adt$6 = Adt.generate([\n      { none: [] },\n      { retry: ['caret'] }\n    ]);\n    var isOutside = function (caret, box) {\n      return caret.left() < box.left() || Math.abs(box.right() - caret.left()) < 1 || caret.left() > box.right();\n    };\n    var inOutsideBlock = function (bridge, element, caret) {\n      return closest(element, DomStructure.isBlock).fold(constant(false), function (cell) {\n        return Rectangles.getEntireBox(bridge, cell).exists(function (box) {\n          return isOutside(caret, box);\n        });\n      });\n    };\n    var adjustDown = function (bridge, element, guessBox, original, caret) {\n      var lowerCaret = Carets.moveDown(caret, JUMP_SIZE);\n      if (Math.abs(guessBox.bottom() - original.bottom()) < 1) {\n        return adt$6.retry(lowerCaret);\n      } else if (guessBox.top() > caret.bottom()) {\n        return adt$6.retry(lowerCaret);\n      } else if (guessBox.top() === caret.bottom()) {\n        return adt$6.retry(Carets.moveDown(caret, 1));\n      } else {\n        return inOutsideBlock(bridge, element, caret) ? adt$6.retry(Carets.translate(lowerCaret, JUMP_SIZE, 0)) : adt$6.none();\n      }\n    };\n    var adjustUp = function (bridge, element, guessBox, original, caret) {\n      var higherCaret = Carets.moveUp(caret, JUMP_SIZE);\n      if (Math.abs(guessBox.top() - original.top()) < 1) {\n        return adt$6.retry(higherCaret);\n      } else if (guessBox.bottom() < caret.top()) {\n        return adt$6.retry(higherCaret);\n      } else if (guessBox.bottom() === caret.top()) {\n        return adt$6.retry(Carets.moveUp(caret, 1));\n      } else {\n        return inOutsideBlock(bridge, element, caret) ? adt$6.retry(Carets.translate(higherCaret, JUMP_SIZE, 0)) : adt$6.none();\n      }\n    };\n    var upMovement = {\n      point: Carets.getTop,\n      adjuster: adjustUp,\n      move: Carets.moveUp,\n      gather: before$4\n    };\n    var downMovement = {\n      point: Carets.getBottom,\n      adjuster: adjustDown,\n      move: Carets.moveDown,\n      gather: after$5\n    };\n    var isAtTable = function (bridge, x, y) {\n      return bridge.elementFromPoint(x, y).filter(function (elm) {\n        return name(elm) === 'table';\n      }).isSome();\n    };\n    var adjustForTable = function (bridge, movement, original, caret, numRetries) {\n      return adjustTil(bridge, movement, original, movement.move(caret, JUMP_SIZE), numRetries);\n    };\n    var adjustTil = function (bridge, movement, original, caret, numRetries) {\n      if (numRetries === 0) {\n        return Option.some(caret);\n      }\n      if (isAtTable(bridge, caret.left(), movement.point(caret))) {\n        return adjustForTable(bridge, movement, original, caret, numRetries - 1);\n      }\n      return bridge.situsFromPoint(caret.left(), movement.point(caret)).bind(function (guess) {\n        return guess.start().fold(Option.none, function (element) {\n          return Rectangles.getEntireBox(bridge, element).bind(function (guessBox) {\n            return movement.adjuster(bridge, element, guessBox, original, caret).fold(Option.none, function (newCaret) {\n              return adjustTil(bridge, movement, original, newCaret, numRetries - 1);\n            });\n          }).orThunk(function () {\n            return Option.some(caret);\n          });\n        }, Option.none);\n      });\n    };\n    var ieTryDown = function (bridge, caret) {\n      return bridge.situsFromPoint(caret.left(), caret.bottom() + JUMP_SIZE);\n    };\n    var ieTryUp = function (bridge, caret) {\n      return bridge.situsFromPoint(caret.left(), caret.top() - JUMP_SIZE);\n    };\n    var checkScroll = function (movement, adjusted, bridge) {\n      if (movement.point(adjusted) > bridge.getInnerHeight()) {\n        return Option.some(movement.point(adjusted) - bridge.getInnerHeight());\n      } else if (movement.point(adjusted) < 0) {\n        return Option.some(-movement.point(adjusted));\n      } else {\n        return Option.none();\n      }\n    };\n    var retry = function (movement, bridge, caret) {\n      var moved = movement.move(caret, JUMP_SIZE);\n      var adjusted = adjustTil(bridge, movement, caret, moved, NUM_RETRIES).getOr(moved);\n      return checkScroll(movement, adjusted, bridge).fold(function () {\n        return bridge.situsFromPoint(adjusted.left(), movement.point(adjusted));\n      }, function (delta) {\n        bridge.scrollBy(0, delta);\n        return bridge.situsFromPoint(adjusted.left(), movement.point(adjusted) - delta);\n      });\n    };\n    var Retries = {\n      tryUp: curry(retry, upMovement),\n      tryDown: curry(retry, downMovement),\n      ieTryUp: ieTryUp,\n      ieTryDown: ieTryDown,\n      getJumpSize: constant(JUMP_SIZE)\n    };\n\n    var MAX_RETRIES = 20;\n    var platform$2 = detect$3();\n    var findSpot = function (bridge, isRoot, direction) {\n      return bridge.getSelection().bind(function (sel) {\n        return BrTags.tryBr(isRoot, sel.finish(), sel.foffset(), direction).fold(function () {\n          return Option.some(point(sel.finish(), sel.foffset()));\n        }, function (brNeighbour) {\n          var range = bridge.fromSitus(brNeighbour);\n          var analysis = BeforeAfter.verify(bridge, sel.finish(), sel.foffset(), range.finish(), range.foffset(), direction.failure, isRoot);\n          return BrTags.process(analysis);\n        });\n      });\n    };\n    var scan = function (bridge, isRoot, element, offset, direction, numRetries) {\n      if (numRetries === 0) {\n        return Option.none();\n      }\n      return tryCursor(bridge, isRoot, element, offset, direction).bind(function (situs) {\n        var range = bridge.fromSitus(situs);\n        var analysis = BeforeAfter.verify(bridge, element, offset, range.finish(), range.foffset(), direction.failure, isRoot);\n        return BeforeAfter.cata(analysis, function () {\n          return Option.none();\n        }, function () {\n          return Option.some(situs);\n        }, function (cell) {\n          if (eq(element, cell) && offset === 0) {\n            return tryAgain(bridge, element, offset, Carets.moveUp, direction);\n          } else {\n            return scan(bridge, isRoot, cell, 0, direction, numRetries - 1);\n          }\n        }, function (cell) {\n          if (eq(element, cell) && offset === getEnd(cell)) {\n            return tryAgain(bridge, element, offset, Carets.moveDown, direction);\n          } else {\n            return scan(bridge, isRoot, cell, getEnd(cell), direction, numRetries - 1);\n          }\n        });\n      });\n    };\n    var tryAgain = function (bridge, element, offset, move, direction) {\n      return Rectangles.getBoxAt(bridge, element, offset).bind(function (box) {\n        return tryAt(bridge, direction, move(box, Retries.getJumpSize()));\n      });\n    };\n    var tryAt = function (bridge, direction, box) {\n      if (platform$2.browser.isChrome() || platform$2.browser.isSafari() || platform$2.browser.isFirefox() || platform$2.browser.isEdge()) {\n        return direction.otherRetry(bridge, box);\n      } else if (platform$2.browser.isIE()) {\n        return direction.ieRetry(bridge, box);\n      } else {\n        return Option.none();\n      }\n    };\n    var tryCursor = function (bridge, isRoot, element, offset, direction) {\n      return Rectangles.getBoxAt(bridge, element, offset).bind(function (box) {\n        return tryAt(bridge, direction, box);\n      });\n    };\n    var handle$2 = function (bridge, isRoot, direction) {\n      return findSpot(bridge, isRoot, direction).bind(function (spot) {\n        return scan(bridge, isRoot, spot.element(), spot.offset(), direction, MAX_RETRIES).map(bridge.fromSitus);\n      });\n    };\n    var TableKeys = { handle: handle$2 };\n\n    var detection = detect$3();\n    var inSameTable = function (elem, table) {\n      return ancestor$2(elem, function (e) {\n        return parent(e).exists(function (p) {\n          return eq(p, table);\n        });\n      });\n    };\n    var simulate = function (bridge, isRoot, direction, initial, anchor) {\n      return closest$1(initial, 'td,th', isRoot).bind(function (start) {\n        return closest$1(start, 'table', isRoot).bind(function (table) {\n          if (!inSameTable(anchor, table)) {\n            return Option.none();\n          }\n          return TableKeys.handle(bridge, isRoot, direction).bind(function (range) {\n            return closest$1(range.finish(), 'td,th', isRoot).map(function (finish) {\n              return {\n                start: constant(start),\n                finish: constant(finish),\n                range: constant(range)\n              };\n            });\n          });\n        });\n      });\n    };\n    var navigate = function (bridge, isRoot, direction, initial, anchor, precheck) {\n      if (detection.browser.isIE()) {\n        return Option.none();\n      } else {\n        return precheck(initial, isRoot).orThunk(function () {\n          return simulate(bridge, isRoot, direction, initial, anchor).map(function (info) {\n            var range = info.range();\n            return Response.create(Option.some(Util.makeSitus(range.start(), range.soffset(), range.finish(), range.foffset())), true);\n          });\n        });\n      }\n    };\n    var firstUpCheck = function (initial, isRoot) {\n      return closest$1(initial, 'tr', isRoot).bind(function (startRow) {\n        return closest$1(startRow, 'table', isRoot).bind(function (table) {\n          var rows = descendants$1(table, 'tr');\n          if (eq(startRow, rows[0])) {\n            return seekLeft$1(table, function (element) {\n              return last$1(element).isSome();\n            }, isRoot).map(function (last) {\n              var lastOffset = getEnd(last);\n              return Response.create(Option.some(Util.makeSitus(last, lastOffset, last, lastOffset)), true);\n            });\n          } else {\n            return Option.none();\n          }\n        });\n      });\n    };\n    var lastDownCheck = function (initial, isRoot) {\n      return closest$1(initial, 'tr', isRoot).bind(function (startRow) {\n        return closest$1(startRow, 'table', isRoot).bind(function (table) {\n          var rows = descendants$1(table, 'tr');\n          if (eq(startRow, rows[rows.length - 1])) {\n            return seekRight$1(table, function (element) {\n              return first(element).isSome();\n            }, isRoot).map(function (first) {\n              return Response.create(Option.some(Util.makeSitus(first, 0, first, 0)), true);\n            });\n          } else {\n            return Option.none();\n          }\n        });\n      });\n    };\n    var select = function (bridge, container, isRoot, direction, initial, anchor, selectRange) {\n      return simulate(bridge, isRoot, direction, initial, anchor).bind(function (info) {\n        return KeySelection.detect(container, isRoot, info.start(), info.finish(), selectRange);\n      });\n    };\n    var VerticalMovement = {\n      navigate: navigate,\n      select: select,\n      firstUpCheck: firstUpCheck,\n      lastDownCheck: lastDownCheck\n    };\n\n    var findCell = function (target, isRoot) {\n      return closest$1(target, 'td,th', isRoot);\n    };\n    function MouseSelection (bridge, container, isRoot, annotations) {\n      var cursor = Option.none();\n      var clearState = function () {\n        cursor = Option.none();\n      };\n      var mousedown = function (event) {\n        annotations.clear(container);\n        cursor = findCell(event.target(), isRoot);\n      };\n      var mouseover = function (event) {\n        cursor.each(function (start) {\n          annotations.clearBeforeUpdate(container);\n          findCell(event.target(), isRoot).each(function (finish) {\n            CellSelection.identify(start, finish, isRoot).each(function (cellSel) {\n              var boxes = cellSel.boxes().getOr([]);\n              if (boxes.length > 1 || boxes.length === 1 && !eq(start, finish)) {\n                annotations.selectRange(container, boxes, cellSel.start(), cellSel.finish());\n                bridge.selectContents(finish);\n              }\n            });\n          });\n        });\n      };\n      var mouseup = function (_event) {\n        cursor.each(clearState);\n      };\n      return {\n        mousedown: mousedown,\n        mouseover: mouseover,\n        mouseup: mouseup\n      };\n    }\n\n    var down = {\n      traverse: nextSibling,\n      gather: after$5,\n      relative: Situ.before,\n      otherRetry: Retries.tryDown,\n      ieRetry: Retries.ieTryDown,\n      failure: BeforeAfter.failedDown\n    };\n    var up = {\n      traverse: prevSibling,\n      gather: before$4,\n      relative: Situ.before,\n      otherRetry: Retries.tryUp,\n      ieRetry: Retries.ieTryUp,\n      failure: BeforeAfter.failedUp\n    };\n    var KeyDirection = {\n      down: down,\n      up: up\n    };\n\n    var isKey = function (key) {\n      return function (keycode) {\n        return keycode === key;\n      };\n    };\n    var isUp = isKey(38);\n    var isDown = isKey(40);\n    var isNavigation = function (keycode) {\n      return keycode >= 37 && keycode <= 40;\n    };\n    var SelectionKeys = {\n      ltr: {\n        isBackward: isKey(37),\n        isForward: isKey(39)\n      },\n      rtl: {\n        isBackward: isKey(39),\n        isForward: isKey(37)\n      },\n      isUp: isUp,\n      isDown: isDown,\n      isNavigation: isNavigation\n    };\n\n    var toRaw = function (sr) {\n      return {\n        left: sr.left(),\n        top: sr.top(),\n        right: sr.right(),\n        bottom: sr.bottom(),\n        width: sr.width(),\n        height: sr.height()\n      };\n    };\n    var Rect = { toRaw: toRaw };\n\n    var isSafari = detect$3().browser.isSafari();\n    var get$b = function (_DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom() : domGlobals.document;\n      var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n      var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n      return Position(x, y);\n    };\n    var by = function (x, y, _DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom() : domGlobals.document;\n      var win = doc.defaultView;\n      win.scrollBy(x, y);\n    };\n\n    var WindowBridge = function (win) {\n      var elementFromPoint = function (x, y) {\n        return Element.fromPoint(Element.fromDom(win.document), x, y);\n      };\n      var getRect = function (element) {\n        return element.dom().getBoundingClientRect();\n      };\n      var getRangedRect = function (start, soffset, finish, foffset) {\n        var sel = Selection.exact(start, soffset, finish, foffset);\n        return getFirstRect$1(win, sel).map(Rect.toRaw);\n      };\n      var getSelection = function () {\n        return get$a(win).map(function (exactAdt) {\n          return Util.convertToRange(win, exactAdt);\n        });\n      };\n      var fromSitus = function (situs) {\n        var relative = Selection.relative(situs.start(), situs.finish());\n        return Util.convertToRange(win, relative);\n      };\n      var situsFromPoint = function (x, y) {\n        return getAtPoint(win, x, y).map(function (exact) {\n          return Situs.create(exact.start(), exact.soffset(), exact.finish(), exact.foffset());\n        });\n      };\n      var clearSelection = function () {\n        clear(win);\n      };\n      var selectContents = function (element) {\n        setToElement(win, element);\n      };\n      var setSelection = function (sel) {\n        setExact(win, sel.start(), sel.soffset(), sel.finish(), sel.foffset());\n      };\n      var setRelativeSelection = function (start, finish) {\n        setRelative(win, start, finish);\n      };\n      var getInnerHeight = function () {\n        return win.innerHeight;\n      };\n      var getScrollY = function () {\n        var pos = get$b(Element.fromDom(win.document));\n        return pos.top();\n      };\n      var scrollBy = function (x, y) {\n        by(x, y, Element.fromDom(win.document));\n      };\n      return {\n        elementFromPoint: elementFromPoint,\n        getRect: getRect,\n        getRangedRect: getRangedRect,\n        getSelection: getSelection,\n        fromSitus: fromSitus,\n        situsFromPoint: situsFromPoint,\n        clearSelection: clearSelection,\n        setSelection: setSelection,\n        setRelativeSelection: setRelativeSelection,\n        selectContents: selectContents,\n        getInnerHeight: getInnerHeight,\n        getScrollY: getScrollY,\n        scrollBy: scrollBy\n      };\n    };\n\n    var rc = Immutable('rows', 'cols');\n    var mouse = function (win, container, isRoot, annotations) {\n      var bridge = WindowBridge(win);\n      var handlers = MouseSelection(bridge, container, isRoot, annotations);\n      return {\n        mousedown: handlers.mousedown,\n        mouseover: handlers.mouseover,\n        mouseup: handlers.mouseup\n      };\n    };\n    var keyboard = function (win, container, isRoot, annotations) {\n      var bridge = WindowBridge(win);\n      var clearToNavigate = function () {\n        annotations.clear(container);\n        return Option.none();\n      };\n      var keydown = function (event, start, soffset, finish, foffset, direction) {\n        var realEvent = event.raw();\n        var keycode = realEvent.which;\n        var shiftKey = realEvent.shiftKey === true;\n        var handler = CellSelection.retrieve(container, annotations.selectedSelector()).fold(function () {\n          if (SelectionKeys.isDown(keycode) && shiftKey) {\n            return curry(VerticalMovement.select, bridge, container, isRoot, KeyDirection.down, finish, start, annotations.selectRange);\n          } else if (SelectionKeys.isUp(keycode) && shiftKey) {\n            return curry(VerticalMovement.select, bridge, container, isRoot, KeyDirection.up, finish, start, annotations.selectRange);\n          } else if (SelectionKeys.isDown(keycode)) {\n            return curry(VerticalMovement.navigate, bridge, isRoot, KeyDirection.down, finish, start, VerticalMovement.lastDownCheck);\n          } else if (SelectionKeys.isUp(keycode)) {\n            return curry(VerticalMovement.navigate, bridge, isRoot, KeyDirection.up, finish, start, VerticalMovement.firstUpCheck);\n          } else {\n            return Option.none;\n          }\n        }, function (selected) {\n          var update = function (attempts) {\n            return function () {\n              var navigation = findMap(attempts, function (delta) {\n                return KeySelection.update(delta.rows(), delta.cols(), container, selected, annotations);\n              });\n              return navigation.fold(function () {\n                return CellSelection.getEdges(container, annotations.firstSelectedSelector(), annotations.lastSelectedSelector()).map(function (edges) {\n                  var relative = SelectionKeys.isDown(keycode) || direction.isForward(keycode) ? Situ.after : Situ.before;\n                  bridge.setRelativeSelection(Situ.on(edges.first(), 0), relative(edges.table()));\n                  annotations.clear(container);\n                  return Response.create(Option.none(), true);\n                });\n              }, function (_) {\n                return Option.some(Response.create(Option.none(), true));\n              });\n            };\n          };\n          if (SelectionKeys.isDown(keycode) && shiftKey) {\n            return update([rc(+1, 0)]);\n          } else if (SelectionKeys.isUp(keycode) && shiftKey) {\n            return update([rc(-1, 0)]);\n          } else if (direction.isBackward(keycode) && shiftKey) {\n            return update([\n              rc(0, -1),\n              rc(-1, 0)\n            ]);\n          } else if (direction.isForward(keycode) && shiftKey) {\n            return update([\n              rc(0, +1),\n              rc(+1, 0)\n            ]);\n          } else if (SelectionKeys.isNavigation(keycode) && shiftKey === false) {\n            return clearToNavigate;\n          } else {\n            return Option.none;\n          }\n        });\n        return handler();\n      };\n      var keyup = function (event, start, soffset, finish, foffset) {\n        return CellSelection.retrieve(container, annotations.selectedSelector()).fold(function () {\n          var realEvent = event.raw();\n          var keycode = realEvent.which;\n          var shiftKey = realEvent.shiftKey === true;\n          if (shiftKey === false) {\n            return Option.none();\n          }\n          if (SelectionKeys.isNavigation(keycode)) {\n            return KeySelection.sync(container, isRoot, start, soffset, finish, foffset, annotations.selectRange);\n          } else {\n            return Option.none();\n          }\n        }, Option.none);\n      };\n      return {\n        keydown: keydown,\n        keyup: keyup\n      };\n    };\n    var platform$3 = detect$3();\n    var external = function (win, container, isRoot, annotations) {\n      var bridge = WindowBridge(win);\n      return function (start, finish) {\n        annotations.clearBeforeUpdate(container);\n        CellSelection.identify(start, finish, isRoot).each(function (cellSel) {\n          var boxes = cellSel.boxes().getOr([]);\n          annotations.selectRange(container, boxes, cellSel.start(), cellSel.finish());\n          if (platform$3.deviceType.isTouch()) {\n            bridge.clearSelection();\n          } else {\n            bridge.selectContents(finish);\n          }\n        });\n      };\n    };\n    var InputHandlers = {\n      mouse: mouse,\n      keyboard: keyboard,\n      external: external\n    };\n\n    var remove$7 = function (element, classes) {\n      each(classes, function (x) {\n        remove$5(element, x);\n      });\n    };\n\n    var addClass = function (clazz) {\n      return function (element) {\n        add$2(element, clazz);\n      };\n    };\n    var removeClasses = function (classes) {\n      return function (element) {\n        remove$7(element, classes);\n      };\n    };\n\n    var byClass = function (ephemera) {\n      var addSelectionClass = addClass(ephemera.selected());\n      var removeSelectionClasses = removeClasses([\n        ephemera.selected(),\n        ephemera.lastSelected(),\n        ephemera.firstSelected()\n      ]);\n      var clear = function (container) {\n        var sels = descendants$1(container, ephemera.selectedSelector());\n        each(sels, removeSelectionClasses);\n      };\n      var selectRange = function (container, cells, start, finish) {\n        clear(container);\n        each(cells, addSelectionClass);\n        add$2(start, ephemera.firstSelected());\n        add$2(finish, ephemera.lastSelected());\n      };\n      return {\n        clearBeforeUpdate: clear,\n        clear: clear,\n        selectRange: selectRange,\n        selectedSelector: ephemera.selectedSelector,\n        firstSelectedSelector: ephemera.firstSelectedSelector,\n        lastSelectedSelector: ephemera.lastSelectedSelector\n      };\n    };\n    var byAttr = function (ephemera, onSelection, onClear) {\n      var removeSelectionAttributes = function (element) {\n        remove(element, ephemera.selected());\n        remove(element, ephemera.firstSelected());\n        remove(element, ephemera.lastSelected());\n      };\n      var addSelectionAttribute = function (element) {\n        set(element, ephemera.selected(), '1');\n      };\n      var clear = function (container) {\n        clearBeforeUpdate(container);\n        onClear();\n      };\n      var clearBeforeUpdate = function (container) {\n        var sels = descendants$1(container, ephemera.selectedSelector());\n        each(sels, removeSelectionAttributes);\n      };\n      var selectRange = function (container, cells, start, finish) {\n        clear(container);\n        each(cells, addSelectionAttribute);\n        set(start, ephemera.firstSelected(), '1');\n        set(finish, ephemera.lastSelected(), '1');\n        onSelection(cells, start, finish);\n      };\n      return {\n        clearBeforeUpdate: clearBeforeUpdate,\n        clear: clear,\n        selectRange: selectRange,\n        selectedSelector: ephemera.selectedSelector,\n        firstSelectedSelector: ephemera.firstSelectedSelector,\n        lastSelectedSelector: ephemera.lastSelectedSelector\n      };\n    };\n    var SelectionAnnotation = {\n      byClass: byClass,\n      byAttr: byAttr\n    };\n\n    var getUpOrLeftCells = function (grid, selectedCells, generators) {\n      var upGrid = grid.slice(0, selectedCells[selectedCells.length - 1].row() + 1);\n      var upDetails = toDetailList(upGrid, generators);\n      return bind(upDetails, function (detail) {\n        var slicedCells = detail.cells().slice(0, selectedCells[selectedCells.length - 1].column() + 1);\n        return map(slicedCells, function (cell) {\n          return cell.element();\n        });\n      });\n    };\n    var getDownOrRightCells = function (grid, selectedCells, generators) {\n      var downGrid = grid.slice(selectedCells[0].row() + selectedCells[0].rowspan() - 1, grid.length);\n      var downDetails = toDetailList(downGrid, generators);\n      return bind(downDetails, function (detail) {\n        var slicedCells = detail.cells().slice(selectedCells[0].column() + selectedCells[0].colspan() - 1, +detail.cells().length);\n        return map(slicedCells, function (cell) {\n          return cell.element();\n        });\n      });\n    };\n    var getOtherCells = function (table, target, generators) {\n      var list = DetailsList.fromTable(table);\n      var house = Warehouse.generate(list);\n      var details = onCells(house, target);\n      return details.map(function (selectedCells) {\n        var grid = Transitions.toGrid(house, generators, false);\n        var upOrLeftCells = getUpOrLeftCells(grid, selectedCells, generators);\n        var downOrRightCells = getDownOrRightCells(grid, selectedCells, generators);\n        return {\n          upOrLeftCells: upOrLeftCells,\n          downOrRightCells: downOrRightCells\n        };\n      });\n    };\n    var OtherCells = { getOtherCells: getOtherCells };\n\n    var hasInternalTarget = function (e) {\n      return has$2(Element.fromDom(e.target), 'ephox-snooker-resizer-bar') === false;\n    };\n    function CellSelection$1 (editor, lazyResize, selectionTargets) {\n      var handlerStruct = MixedBag([\n        'mousedown',\n        'mouseover',\n        'mouseup',\n        'keyup',\n        'keydown'\n      ], []);\n      var handlers = Option.none();\n      var cloneFormats = getCloneElements(editor);\n      var onSelection = function (cells, start, finish) {\n        selectionTargets.targets().each(function (targets) {\n          var tableOpt = TableLookup.table(start);\n          tableOpt.each(function (table) {\n            var doc = Element.fromDom(editor.getDoc());\n            var generators = TableFill.cellOperations(noop, doc, cloneFormats);\n            var otherCells = OtherCells.getOtherCells(table, targets, generators);\n            fireTableSelectionChange(editor, cells, start, finish, otherCells);\n          });\n        });\n      };\n      var onClear = function () {\n        fireTableSelectionClear(editor);\n      };\n      var annotations = SelectionAnnotation.byAttr(Ephemera, onSelection, onClear);\n      editor.on('init', function (e) {\n        var win = editor.getWin();\n        var body = getBody$1(editor);\n        var isRoot = getIsRoot(editor);\n        var syncSelection = function () {\n          var sel = editor.selection;\n          var start = Element.fromDom(sel.getStart());\n          var end = Element.fromDom(sel.getEnd());\n          var shared = DomParent.sharedOne(TableLookup.table, [\n            start,\n            end\n          ]);\n          shared.fold(function () {\n            annotations.clear(body);\n          }, noop);\n        };\n        var mouseHandlers = InputHandlers.mouse(win, body, isRoot, annotations);\n        var keyHandlers = InputHandlers.keyboard(win, body, isRoot, annotations);\n        var external = InputHandlers.external(win, body, isRoot, annotations);\n        var hasShiftKey = function (event) {\n          return event.raw().shiftKey === true;\n        };\n        editor.on('tableselectorchange', function (e) {\n          external(e.start, e.finish);\n        });\n        var handleResponse = function (event, response) {\n          if (!hasShiftKey(event)) {\n            return;\n          }\n          if (response.kill()) {\n            event.kill();\n          }\n          response.selection().each(function (ns) {\n            var relative = Selection.relative(ns.start(), ns.finish());\n            var rng = asLtrRange(win, relative);\n            editor.selection.setRng(rng);\n          });\n        };\n        var keyup = function (event) {\n          var wrappedEvent = wrapEvent(event);\n          if (wrappedEvent.raw().shiftKey && SelectionKeys.isNavigation(wrappedEvent.raw().which)) {\n            var rng = editor.selection.getRng();\n            var start = Element.fromDom(rng.startContainer);\n            var end = Element.fromDom(rng.endContainer);\n            keyHandlers.keyup(wrappedEvent, start, rng.startOffset, end, rng.endOffset).each(function (response) {\n              handleResponse(wrappedEvent, response);\n            });\n          }\n        };\n        var keydown = function (event) {\n          var wrappedEvent = wrapEvent(event);\n          lazyResize().each(function (resize) {\n            resize.hideBars();\n          });\n          var rng = editor.selection.getRng();\n          var startContainer = Element.fromDom(editor.selection.getStart());\n          var start = Element.fromDom(rng.startContainer);\n          var end = Element.fromDom(rng.endContainer);\n          var direction = Direction.directionAt(startContainer).isRtl() ? SelectionKeys.rtl : SelectionKeys.ltr;\n          keyHandlers.keydown(wrappedEvent, start, rng.startOffset, end, rng.endOffset, direction).each(function (response) {\n            handleResponse(wrappedEvent, response);\n          });\n          lazyResize().each(function (resize) {\n            resize.showBars();\n          });\n        };\n        var isMouseEvent = function (event) {\n          return event.hasOwnProperty('x') && event.hasOwnProperty('y');\n        };\n        var wrapEvent = function (event) {\n          var target = Element.fromDom(event.target);\n          var stop = function () {\n            event.stopPropagation();\n          };\n          var prevent = function () {\n            event.preventDefault();\n          };\n          var kill = compose(prevent, stop);\n          return {\n            target: constant(target),\n            x: constant(isMouseEvent(event) ? event.x : null),\n            y: constant(isMouseEvent(event) ? event.y : null),\n            stop: stop,\n            prevent: prevent,\n            kill: kill,\n            raw: constant(event)\n          };\n        };\n        var isLeftMouse = function (raw) {\n          return raw.button === 0;\n        };\n        var isLeftButtonPressed = function (raw) {\n          if (raw.buttons === undefined) {\n            return true;\n          }\n          return (raw.buttons & 1) !== 0;\n        };\n        var mouseDown = function (e) {\n          if (isLeftMouse(e) && hasInternalTarget(e)) {\n            mouseHandlers.mousedown(wrapEvent(e));\n          }\n        };\n        var mouseOver = function (e) {\n          if (isLeftButtonPressed(e) && hasInternalTarget(e)) {\n            mouseHandlers.mouseover(wrapEvent(e));\n          }\n        };\n        var mouseUp = function (e) {\n          if (isLeftMouse(e) && hasInternalTarget(e)) {\n            mouseHandlers.mouseup(wrapEvent(e));\n          }\n        };\n        var getDoubleTap = function () {\n          var lastTarget = Cell(Element.fromDom(body));\n          var lastTimeStamp = Cell(0);\n          var touchEnd = function (t) {\n            var target = Element.fromDom(t.target);\n            if (name(target) === 'td' || name(target) === 'th') {\n              var lT = lastTarget.get();\n              var lTS = lastTimeStamp.get();\n              if (eq(lT, target) && t.timeStamp - lTS < 300) {\n                t.preventDefault();\n                external(target, target);\n              }\n            }\n            lastTarget.set(target);\n            lastTimeStamp.set(t.timeStamp);\n          };\n          return { touchEnd: touchEnd };\n        };\n        var doubleTap = getDoubleTap();\n        editor.on('mousedown', mouseDown);\n        editor.on('mouseover', mouseOver);\n        editor.on('mouseup', mouseUp);\n        editor.on('touchend', doubleTap.touchEnd);\n        editor.on('keyup', keyup);\n        editor.on('keydown', keydown);\n        editor.on('NodeChange', syncSelection);\n        handlers = Option.some(handlerStruct({\n          mousedown: mouseDown,\n          mouseover: mouseOver,\n          mouseup: mouseUp,\n          keyup: keyup,\n          keydown: keydown\n        }));\n      });\n      var destroy = function () {\n        handlers.each(function (handlers) {\n        });\n      };\n      return {\n        clear: annotations.clear,\n        destroy: destroy\n      };\n    }\n\n    var Selections = function (editor) {\n      var get = function () {\n        var body = getBody$1(editor);\n        return TableSelection.retrieve(body, Ephemera.selectedSelector()).fold(function () {\n          if (editor.selection.getStart() === undefined) {\n            return SelectionTypes.none();\n          } else {\n            return SelectionTypes.single(editor.selection);\n          }\n        }, function (cells) {\n          return SelectionTypes.multiple(cells);\n        });\n      };\n      return { get: get };\n    };\n\n    var getSelectionTargets = function (editor, selections) {\n      var targets = Cell(Option.none());\n      var changeHandlers = Cell([]);\n      var findTargets = function () {\n        return getSelectionStartCellOrCaption(editor).bind(function (cellOrCaption) {\n          var table = TableLookup.table(cellOrCaption);\n          return table.map(function (table) {\n            if (name(cellOrCaption) === 'caption') {\n              return TableTargets.notCell(cellOrCaption);\n            } else {\n              return TableTargets.forMenu(selections, table, cellOrCaption);\n            }\n          });\n        });\n      };\n      var resetTargets = function () {\n        targets.set(cached(findTargets)());\n        each(changeHandlers.get(), function (handler) {\n          return handler();\n        });\n      };\n      var onSetup = function (api, isDisabled) {\n        var handler = function () {\n          return targets.get().fold(function () {\n            api.setDisabled(true);\n          }, function (targets) {\n            api.setDisabled(isDisabled(targets));\n          });\n        };\n        handler();\n        changeHandlers.set(changeHandlers.get().concat([handler]));\n        return function () {\n          changeHandlers.set(filter(changeHandlers.get(), function (h) {\n            return h !== handler;\n          }));\n        };\n      };\n      var onSetupTable = function (api) {\n        return onSetup(api, function (_) {\n          return false;\n        });\n      };\n      var onSetupCellOrRow = function (api) {\n        return onSetup(api, function (targets) {\n          return name(targets.element()) === 'caption';\n        });\n      };\n      var onSetupMergeable = function (api) {\n        return onSetup(api, function (targets) {\n          return targets.mergable().isNone();\n        });\n      };\n      var onSetupUnmergeable = function (api) {\n        return onSetup(api, function (targets) {\n          return targets.unmergable().isNone();\n        });\n      };\n      editor.on('NodeChange', resetTargets);\n      return {\n        onSetupTable: onSetupTable,\n        onSetupCellOrRow: onSetupCellOrRow,\n        onSetupMergeable: onSetupMergeable,\n        onSetupUnmergeable: onSetupUnmergeable,\n        resetTargets: resetTargets,\n        targets: function () {\n          return targets.get();\n        }\n      };\n    };\n\n    var addButtons = function (editor, selectionTargets) {\n      editor.ui.registry.addMenuButton('table', {\n        tooltip: 'Table',\n        icon: 'table',\n        fetch: function (callback) {\n          return callback('inserttable tableprops deletetable | cell row column');\n        }\n      });\n      var cmd = function (command) {\n        return function () {\n          return editor.execCommand(command);\n        };\n      };\n      editor.ui.registry.addButton('tableprops', {\n        tooltip: 'Table properties',\n        onAction: cmd('mceTableProps'),\n        icon: 'table',\n        onSetup: selectionTargets.onSetupTable\n      });\n      editor.ui.registry.addButton('tabledelete', {\n        tooltip: 'Delete table',\n        onAction: cmd('mceTableDelete'),\n        icon: 'table-delete-table',\n        onSetup: selectionTargets.onSetupTable\n      });\n      editor.ui.registry.addButton('tablecellprops', {\n        tooltip: 'Cell properties',\n        onAction: cmd('mceTableCellProps'),\n        icon: 'table-cell-properties',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablemergecells', {\n        tooltip: 'Merge cells',\n        onAction: cmd('mceTableMergeCells'),\n        icon: 'table-merge-cells',\n        onSetup: selectionTargets.onSetupMergeable\n      });\n      editor.ui.registry.addButton('tablesplitcells', {\n        tooltip: 'Split cell',\n        onAction: cmd('mceTableSplitCells'),\n        icon: 'table-split-cells',\n        onSetup: selectionTargets.onSetupUnmergeable\n      });\n      editor.ui.registry.addButton('tableinsertrowbefore', {\n        tooltip: 'Insert row before',\n        onAction: cmd('mceTableInsertRowBefore'),\n        icon: 'table-insert-row-above',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tableinsertrowafter', {\n        tooltip: 'Insert row after',\n        onAction: cmd('mceTableInsertRowAfter'),\n        icon: 'table-insert-row-after',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tabledeleterow', {\n        tooltip: 'Delete row',\n        onAction: cmd('mceTableDeleteRow'),\n        icon: 'table-delete-row',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablerowprops', {\n        tooltip: 'Row properties',\n        onAction: cmd('mceTableRowProps'),\n        icon: 'table-row-properties',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tableinsertcolbefore', {\n        tooltip: 'Insert column before',\n        onAction: cmd('mceTableInsertColBefore'),\n        icon: 'table-insert-column-before',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tableinsertcolafter', {\n        tooltip: 'Insert column after',\n        onAction: cmd('mceTableInsertColAfter'),\n        icon: 'table-insert-column-after',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tabledeletecol', {\n        tooltip: 'Delete column',\n        onAction: cmd('mceTableDeleteCol'),\n        icon: 'table-delete-column',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablecutrow', {\n        tooltip: 'Cut row',\n        onAction: cmd('mceTableCutRow'),\n        icon: 'temporary-placeholder',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablecopyrow', {\n        tooltip: 'Copy row',\n        onAction: cmd('mceTableCopyRow'),\n        icon: 'temporary-placeholder',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablepasterowbefore', {\n        tooltip: 'Paste row before',\n        onAction: cmd('mceTablePasteRowBefore'),\n        icon: 'temporary-placeholder',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablepasterowafter', {\n        tooltip: 'Paste row after',\n        onAction: cmd('mceTablePasteRowAfter'),\n        icon: 'temporary-placeholder',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tableinsertdialog', {\n        tooltip: 'Insert table',\n        onAction: cmd('mceInsertTable'),\n        icon: 'table'\n      });\n    };\n    var addToolbars = function (editor) {\n      var isTable = function (table) {\n        return editor.dom.is(table, 'table') && editor.getBody().contains(table);\n      };\n      var toolbar = getToolbar(editor);\n      if (toolbar.length > 0) {\n        editor.ui.registry.addContextToolbar('table', {\n          predicate: isTable,\n          items: toolbar,\n          scope: 'node',\n          position: 'node'\n        });\n      }\n    };\n    var Buttons = {\n      addButtons: addButtons,\n      addToolbars: addToolbars\n    };\n\n    var addMenuItems = function (editor, selectionTargets) {\n      var cmd = function (command) {\n        return function () {\n          return editor.execCommand(command);\n        };\n      };\n      var insertTableAction = function (_a) {\n        var numRows = _a.numRows, numColumns = _a.numColumns;\n        editor.undoManager.transact(function () {\n          InsertTable.insert(editor, numColumns, numRows);\n        });\n        editor.addVisual();\n      };\n      var tableProperties = {\n        text: 'Table properties',\n        onSetup: selectionTargets.onSetupTable,\n        onAction: cmd('mceTableProps')\n      };\n      var deleteTable = {\n        text: 'Delete table',\n        icon: 'table-delete-table',\n        onSetup: selectionTargets.onSetupTable,\n        onAction: cmd('mceTableDelete')\n      };\n      var rowItems = [\n        {\n          type: 'menuitem',\n          text: 'Insert row before',\n          icon: 'table-insert-row-above',\n          onAction: cmd('mceTableInsertRowBefore'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Insert row after',\n          icon: 'table-insert-row-after',\n          onAction: cmd('mceTableInsertRowAfter'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Delete row',\n          icon: 'table-delete-row',\n          onAction: cmd('mceTableDeleteRow'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Row properties',\n          icon: 'table-row-properties',\n          onAction: cmd('mceTableRowProps'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        { type: 'separator' },\n        {\n          type: 'menuitem',\n          text: 'Cut row',\n          onAction: cmd('mceTableCutRow'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Copy row',\n          onAction: cmd('mceTableCopyRow'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Paste row before',\n          onAction: cmd('mceTablePasteRowBefore'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Paste row after',\n          onAction: cmd('mceTablePasteRowAfter'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        }\n      ];\n      var row = {\n        type: 'nestedmenuitem',\n        text: 'Row',\n        getSubmenuItems: function () {\n          return rowItems;\n        }\n      };\n      var columnItems = [\n        {\n          type: 'menuitem',\n          text: 'Insert column before',\n          icon: 'table-insert-column-before',\n          onAction: cmd('mceTableInsertColBefore'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Insert column after',\n          icon: 'table-insert-column-after',\n          onAction: cmd('mceTableInsertColAfter'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Delete column',\n          icon: 'table-delete-column',\n          onAction: cmd('mceTableDeleteCol'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        }\n      ];\n      var column = {\n        type: 'nestedmenuitem',\n        text: 'Column',\n        getSubmenuItems: function () {\n          return columnItems;\n        }\n      };\n      var cellItems = [\n        {\n          type: 'menuitem',\n          text: 'Cell properties',\n          icon: 'table-cell-properties',\n          onAction: cmd('mceTableCellProps'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Merge cells',\n          icon: 'table-merge-cells',\n          onAction: cmd('mceTableMergeCells'),\n          onSetup: selectionTargets.onSetupMergeable\n        },\n        {\n          type: 'menuitem',\n          text: 'Split cell',\n          icon: 'table-split-cells',\n          onAction: cmd('mceTableSplitCells'),\n          onSetup: selectionTargets.onSetupUnmergeable\n        }\n      ];\n      var cell = {\n        type: 'nestedmenuitem',\n        text: 'Cell',\n        getSubmenuItems: function () {\n          return cellItems;\n        }\n      };\n      if (hasTableGrid(editor) === false) {\n        editor.ui.registry.addMenuItem('inserttable', {\n          text: 'Table',\n          icon: 'table',\n          onAction: cmd('mceInsertTable')\n        });\n      } else {\n        editor.ui.registry.addNestedMenuItem('inserttable', {\n          text: 'Table',\n          icon: 'table',\n          getSubmenuItems: function () {\n            return [{\n                type: 'fancymenuitem',\n                fancytype: 'inserttable',\n                onAction: insertTableAction\n              }];\n          }\n        });\n      }\n      editor.ui.registry.addMenuItem('inserttabledialog', {\n        text: 'Insert table',\n        icon: 'table',\n        onAction: cmd('mceInsertTable')\n      });\n      editor.ui.registry.addMenuItem('tableprops', tableProperties);\n      editor.ui.registry.addMenuItem('deletetable', deleteTable);\n      editor.ui.registry.addNestedMenuItem('row', row);\n      editor.ui.registry.addNestedMenuItem('column', column);\n      editor.ui.registry.addNestedMenuItem('cell', cell);\n      editor.ui.registry.addContextMenu('table', {\n        update: function () {\n          selectionTargets.resetTargets();\n          return selectionTargets.targets().fold(function () {\n            return '';\n          }, function (targets) {\n            if (name(targets.element()) === 'caption') {\n              return 'tableprops deletetable';\n            } else {\n              return 'cell row column | tableprops deletetable';\n            }\n          });\n        }\n      });\n      return {\n        rowItems: rowItems,\n        columnItems: columnItems,\n        cellItems: cellItems\n      };\n    };\n    var MenuItems = { addMenuItems: addMenuItems };\n\n    var getClipboardRows = function (clipboardRows) {\n      return clipboardRows.get().fold(function () {\n        return;\n      }, function (rows) {\n        return map(rows, function (row) {\n          return row.dom();\n        });\n      });\n    };\n    var setClipboardRows = function (rows, clipboardRows) {\n      var sugarRows = map(rows, Element.fromDom);\n      clipboardRows.set(Option.from(sugarRows));\n    };\n    var getApi = function (editor, clipboardRows, resizeHandler, selectionTargets, menuItems) {\n      return {\n        insertTable: function (columns, rows) {\n          return InsertTable.insert(editor, columns, rows);\n        },\n        setClipboardRows: function (rows) {\n          return setClipboardRows(rows, clipboardRows);\n        },\n        getClipboardRows: function () {\n          return getClipboardRows(clipboardRows);\n        },\n        resizeHandler: resizeHandler,\n        menuItems: menuItems,\n        selectionTargets: selectionTargets\n      };\n    };\n\n    function Plugin(editor) {\n      var selections = Selections(editor);\n      var selectionTargets = getSelectionTargets(editor, selections);\n      var resizeHandler = getResizeHandler(editor);\n      var cellSelection = CellSelection$1(editor, resizeHandler.lazyResize, selectionTargets);\n      var actions = TableActions(editor, resizeHandler.lazyWire);\n      var clipboardRows = Cell(Option.none());\n      Commands.registerCommands(editor, actions, cellSelection, selections, clipboardRows);\n      Clipboard.registerEvents(editor, selections, actions, cellSelection);\n      var menuItems = MenuItems.addMenuItems(editor, selectionTargets);\n      Buttons.addButtons(editor, selectionTargets);\n      Buttons.addToolbars(editor);\n      editor.on('PreInit', function () {\n        editor.serializer.addTempAttr(Ephemera.firstSelected());\n        editor.serializer.addTempAttr(Ephemera.lastSelected());\n      });\n      if (hasTabNavigation(editor)) {\n        editor.on('keydown', function (e) {\n          TabContext.handle(e, editor, actions, resizeHandler.lazyWire);\n        });\n      }\n      editor.on('remove', function () {\n        resizeHandler.destroy();\n        cellSelection.destroy();\n      });\n      return getApi(editor, clipboardRows, resizeHandler, selectionTargets, menuItems);\n    }\n    function Plugin$1 () {\n      global.add('table', Plugin);\n    }\n\n    Plugin$1();\n\n}(window));\n"]}