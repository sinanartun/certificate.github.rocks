!function(t){"use strict";function e(t){return t}var n=function(t){function e(){return r}var r=t;return{get:e,set:function(t){r=t},clone:function(){return n(e())}}},r=function(){},o=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))}},i=function(t){return function(){return t}};function u(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=e.concat(n);return t.apply(null,o)}}function c(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return!t.apply(null,e)}}function a(){return d}var l,f=i(!1),s=i(!0),d=(l={fold:function(t,e){return t()},is:f,isSome:f,isNone:s,getOr:p,getOrThunk:g,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:p,orThunk:g,map:a,each:r,bind:a,exists:f,forall:s,filter:a,equals:m,equals_:m,toArray:function(){return[]},toString:i("none()")},Object.freeze&&Object.freeze(l),l);function m(t){return t.isNone()}function g(t){return t()}function p(t){return t}function h(t){return function(e){return function(t){if(null===t)return"null";var e=typeof t;return"object"==e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e}(e)===t}}function v(t,e){return-1<function(t,e){return zt.call(t,e)}(t,e)}function b(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n))return!0;return!1}function w(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o)}return r}function y(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n)}function C(t,e){for(var n=[],r=0,o=t.length;r<o;r++){var i=t[r];e(i,r)&&n.push(i)}return n}function S(t,e,n){return function(t,e){for(var n=t.length-1;0<=n;n--)e(t[n])}(t,function(t){n=e(n,t)}),n}function x(t,e,n){return y(t,function(t){n=e(n,t)}),n}function R(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n))return Bt.some(o)}return Bt.none()}function T(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n))return Bt.some(n);return Bt.none()}function O(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!Mt(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);Ht.apply(e,t[n])}return e}function D(t,e){return O(w(t,e))}function A(t,e){for(var n=0,r=t.length;n<r;++n)if(!0!==e(t[n],n))return!1;return!0}function E(t){var e=jt.call(t,0);return e.reverse(),e}function N(t,e){for(var n=Ft(t),r=0,o=n.length;r<o;r++){var i=n[r];e(t[i],i)}}function I(t,e){return qt(t,function(t,n){return{k:n,v:e(t,n)}})}function B(t,e){return Vt(t,e)?Bt.from(t[e]):Bt.none()}function k(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+e.length+" arguments");var r={};return y(t,function(t,n){r[t]=i(e[n])}),r}}function P(t){return t.slice(0).sort()}function M(t,e){throw new Error("All required keys ("+P(t).join(", ")+") were not specified. Specified keys were: "+P(e).join(", ")+".")}function W(t){throw new Error("Unsupported keys for object: "+P(t).join(", "))}function _(t,e){if(!Mt(e))throw new Error("The "+t+" fields must be an array. Was: "+e+".");y(e,function(e){if(!Pt(e))throw new Error("The value "+e+" in the "+t+" fields was not a string.")})}function L(t){var e=P(t);R(e,function(t,n){return n<e.length-1&&t===e[n+1]}).each(function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+e.join(", ")+"].")})}function j(t){return t.dom().nodeType}function z(t){return function(e){return j(e)===t}}function H(t){return j(t)===Yt||"#comment"===Jt(t)}function F(e,n,r){if(!(Pt(r)||Wt(r)||Lt(r)))throw t.console.error("Invalid call to Attr.set. Key ",n,":: Value ",r,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,r+"")}function U(t,e,n){F(t.dom(),e,n)}function q(t,e){var n=t.dom();N(e,function(t,e){F(n,e,t)})}function V(t,e){var n=t.dom().getAttribute(e);return null===n?void 0:n}function G(t,e){var n=t.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(e)}function Y(t,e){t.dom().removeAttribute(e)}function K(t){return x(t.dom().attributes,function(t,e){return t[e.name]=e.value,t},{})}function X(t,e,n){return""===e||!(t.length<e.length)&&t.substr(n,n+e.length)===e}function $(t,e){return-1!==t.indexOf(e)}function J(t,e){return X(t,e,0)}function Q(t){return void 0!==t.style&&_t(t.style.getPropertyValue)}function Z(t){var e,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,e=t.apply(null,r)),e}}function tt(t){var e=Zt(t)?t.dom().parentNode:t.dom();return null!=e&&e.ownerDocument.body.contains(e)}function et(e,n,r){if(!Pt(r))throw t.console.error("Invalid call to CSS.set. Property ",n,":: Value ",r,":: Element ",e),new Error("CSS value must be a string: "+r);Q(e)&&e.style.setProperty(n,r)}function nt(t,e,n){et(t.dom(),e,n)}function rt(t,e){var n=t.dom();N(e,function(t,e){et(n,e,t)})}function ot(e,n){var r=e.dom(),o=t.window.getComputedStyle(r).getPropertyValue(n),i=""!==o||tt(e)?o:oe(r,n);return null===i?void 0:i}function it(t,e){var n=t.dom(),r=oe(n,e);return Bt.from(r).filter(function(t){return 0<t.length})}function ut(t,e){!function(t,e){Q(t)&&t.style.removeProperty(e)}(t.dom(),e),G(t,"style")&&""===function(t){return t.replace(/^\s+|\s+$/g,"")}(V(t,"style"))&&Y(t,"style")}function ct(t,e){return function(){return e===t}}function at(t,e){return function(){return e===t}}function lt(t,e){var n=String(e).toLowerCase();return R(t,function(t){return t.search(n)})}function ft(t){return function(e){return $(e,t)}}function st(){return Te.get()}function dt(t,e){var n=t.dom();if(n.nodeType!==Oe)return!1;var r=n;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function mt(t){return t.nodeType!==Oe&&t.nodeType!==De||0===t.childElementCount}function gt(t){return ee.fromDom(t.dom().ownerDocument)}function pt(t){return Bt.from(t.dom().parentNode).map(ee.fromDom)}function ht(t,e){for(var n=_t(e)?e:f,r=t.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=ee.fromDom(i);if(o.push(u),!0===n(u))break;r=i}return o}function vt(t){return Bt.from(t.dom().previousSibling).map(ee.fromDom)}function bt(t){return Bt.from(t.dom().nextSibling).map(ee.fromDom)}function wt(t){return w(t.dom().childNodes,ee.fromDom)}function yt(t,e){var n=t.dom().childNodes;return Bt.from(n[e]).map(ee.fromDom)}function Ct(t,e){pt(t).each(function(n){n.dom().insertBefore(e.dom(),t.dom())})}function St(t,e){bt(t).fold(function(){pt(t).each(function(t){Ie(t,e)})},function(t){Ct(t,e)})}function xt(t,e){yt(t,0).fold(function(){Ie(t,e)},function(n){t.dom().insertBefore(e.dom(),n.dom())})}function Rt(t,e){Ct(t,e),Ie(e,t)}function Tt(t,e){y(e,function(n,r){St(0===r?t:e[r-1],n)})}function Ot(t,e){y(e,function(e){Ie(t,e)})}function Dt(t){t.dom().textContent="",y(wt(t),function(t){Be(t)})}function At(t){var e=wt(t);0<e.length&&function(t,e){y(e,function(e){Ct(t,e)})}(t,e),Be(t)}function Et(t,e,n){return function(t,e,n){return C(ht(t,n),e)}(t,function(t){return dt(t,e)},n)}function Nt(e,n){return function(e,n){var r=void 0===n?t.document:n.dom();return mt(r)?[]:w(r.querySelectorAll(e),ee.fromDom)}(n,e)}var It=function(t){function e(){return o}function n(e){return e(t)}var r=i(t),o={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:s,isNone:f,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:e,orThunk:e,map:function(e){return It(e(t))},each:function(e){e(t)},bind:n,exists:n,forall:n,filter:function(e){return e(t)?o:d},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(f,function(e){return n(t,e)})}};return o},Bt={some:It,none:a,from:function(t){return null==t?d:It(t)}},kt=tinymce.util.Tools.resolve("tinymce.PluginManager"),Pt=h("string"),Mt=h("array"),Wt=h("boolean"),_t=h("function"),Lt=h("number"),jt=Array.prototype.slice,zt=Array.prototype.indexOf,Ht=Array.prototype.push,Ft=(_t(Array.from)&&Array.from,Object.keys),Ut=Object.hasOwnProperty,qt=function(t,e){var n={};return N(t,function(t,r){var o=e(t,r);n[o.k]=o.v}),n},Vt=function(t,e){return Ut.call(t,e)},Gt=function(t,e){var n=t.concat(e);if(0===n.length)throw new Error("You must specify at least one required or optional field.");return _("required",t),_("optional",e),L(n),function(r){var o=Ft(r);A(t,function(t){return v(o,t)})||M(t,o);var u=C(o,function(t){return!v(n,t)});0<u.length&&W(u);var c={};return y(t,function(t){c[t]=i(r[t])}),y(e,function(t){c[t]=i(Object.prototype.hasOwnProperty.call(r,t)?Bt.some(r[t]):Bt.none())}),c}},Yt=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE),Kt=t.Node.DOCUMENT_NODE,Xt=(t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE),$t=t.Node.TEXT_NODE,Jt=(t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,void 0!==t.window?t.window:Function("return this;")(),function(t){return t.dom().nodeName.toLowerCase()}),Qt=z(Xt),Zt=z($t),te=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:i(t)}},ee={fromHtml:function(e,n){var r=(n||t.document).createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||1<r.childNodes.length)throw t.console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return te(r.childNodes[0])},fromTag:function(e,n){var r=(n||t.document).createElement(e);return te(r)},fromText:function(e,n){var r=(n||t.document).createTextNode(e);return te(r)},fromDom:te,fromPoint:function(t,e,n){var r=t.dom();return Bt.from(r.elementFromPoint(e,n)).map(te)}},ne=Z(function(){return re(ee.fromDom(t.document))}),re=function(t){var e=t.dom().body;if(null==e)throw new Error("Body is not available yet");return ee.fromDom(e)},oe=function(t,e){return Q(t)?t.style.getPropertyValue(e):""},ie=function(){return(ie=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ue=function(){return ce(0,0)},ce=function(t,e){return{major:t,minor:e}},ae=function(t,e){var n=String(e).toLowerCase();return 0===t.length?ue():function(t,e){var n=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.test(e))return r}}(t,e);if(!n)return{major:0,minor:0};function r(t){return Number(e.replace(n,"$"+t))}return ce(r(1),r(2))}(t,n)},le=ue,fe="Firefox",se=function(t){var e=t.current;return{current:e,version:t.version,isEdge:ct("Edge",e),isChrome:ct("Chrome",e),isIE:ct("IE",e),isOpera:ct("Opera",e),isFirefox:ct(fe,e),isSafari:ct("Safari",e)}},de=function(){return se({current:void 0,version:le()})},me=se,ge=(i("Edge"),i("Chrome"),i("IE"),i("Opera"),i(fe),i("Safari"),"Windows"),pe="Android",he="Solaris",ve="FreeBSD",be=function(t){var e=t.current;return{current:e,version:t.version,isWindows:at(ge,e),isiOS:at("iOS",e),isAndroid:at(pe,e),isOSX:at("OSX",e),isLinux:at("Linux",e),isSolaris:at(he,e),isFreeBSD:at(ve,e)}},we=function(){return be({current:void 0,version:le()})},ye=be,Ce=(i(ge),i("iOS"),i(pe),i("Linux"),i("OSX"),i(he),i(ve),/.*?version\/\ ?([0-9]+)\.([0-9]+).*/),Se=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return $(t,"edge/")&&$(t,"chrome")&&$(t,"safari")&&$(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ce],search:function(t){return $(t,"chrome")&&!$(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return $(t,"msie")||$(t,"trident")}},{name:"Opera",versionRegexes:[Ce,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ft("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ft("firefox")},{name:"Safari",versionRegexes:[Ce,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return($(t,"safari")||$(t,"mobile/"))&&$(t,"applewebkit")}}],xe=[{name:"Windows",search:ft("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return $(t,"iphone")||$(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ft("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ft("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ft("linux"),versionRegexes:[]},{name:"Solaris",search:ft("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ft("freebsd"),versionRegexes:[]}],Re={browsers:i(Se),oses:i(xe)},Te=n(function(e,n){var r=Re.browsers(),o=Re.oses(),u=function(t,e){return lt(t,e).map(function(t){var n=ae(t.versionRegexes,e);return{current:t.name,version:n}})}(r,e).fold(de,me),c=function(t,e){return lt(t,e).map(function(t){var n=ae(t.versionRegexes,e);return{current:t.name,version:n}})}(o,e).fold(we,ye);return{browser:u,os:c,deviceType:function(t,e,n,r){var o=t.isiOS()&&!0===/ipad/i.test(n),u=t.isiOS()&&!o,c=t.isiOS()||t.isAndroid(),a=c||r("(pointer:coarse)"),l=o||!u&&c&&r("(min-device-width:768px)"),f=u||c&&!l,s=e.isSafari()&&t.isiOS()&&!1===/safari/i.test(n),d=!f&&!l&&!s;return{isiPad:i(o),isiPhone:i(u),isTablet:i(l),isPhone:i(f),isTouch:i(a),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:i(s),isDesktop:i(d)}}(c,u,e,function(e){return t.window.matchMedia(e).matches})}}(t.navigator.userAgent)),Oe=Xt,De=Kt,Ae=function(t,e){return t.dom()===e.dom()},Ee=st().browser.isIE()?function(e,n){return function(e,n){return function(t,e,n){return 0!=(t.compareDocumentPosition(e)&n)}(e,n,t.Node.DOCUMENT_POSITION_CONTAINED_BY)}(e.dom(),n.dom())}:function(t,e){var n=t.dom(),r=e.dom();return n!==r&&n.contains(r)},Ne=dt,Ie=(k("element","offset"),function(t,e){t.dom().appendChild(e.dom())}),Be=function(t){var e=t.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},ke=(k("width","height"),k("width","height"),k("rows","columns")),Pe=k("row","column"),Me=(k("x","y"),k("element","rowspan","colspan")),We=k("element","rowspan","colspan","isNew"),_e=k("element","rowspan","colspan","row","column"),Le=k("element","cells","section"),je=k("element","isNew"),ze=k("element","cells","section","isNew"),He=k("cells","section"),Fe=k("details","section"),Ue=k("startRow","startCol","finishRow","finishCol"),qe=function(t,e){var n=[];return y(wt(t),function(t){e(t)&&(n=n.concat([t])),n=n.concat(qe(t,e))}),n};function Ve(t,e,n,r,o){return t(n,r)?Bt.some(n):_t(o)&&o(n)?Bt.none():e(n,r,o)}function Ge(t,e,n){for(var r=t.dom(),o=_t(n)?n:i(!1);r.parentNode;){r=r.parentNode;var u=ee.fromDom(r);if(e(u))return Bt.some(u);if(o(u))break}return Bt.none()}function Ye(t,e,n){return Ge(t,function(t){return dt(t,e)},n)}function Ke(t,e){return function(t,e){return R(t.dom().childNodes,function(t){return e(ee.fromDom(t))}).map(ee.fromDom)}(t,function(t){return dt(t,e)})}function Xe(e,n){return function(e,n){var r=void 0===n?t.document:n.dom();return mt(r)?Bt.none():Bt.from(r.querySelector(e)).map(ee.fromDom)}(n,e)}function $e(t,e,n){return Ve(dt,Ye,t,e,n)}function Je(t,e,n){return void 0===n&&(n=f),n(e)?Bt.none():v(t,Jt(e))?Bt.some(e):Ye(e,t.join(","),function(t){return dt(t,"table")||n(t)})}function Qe(t,e){return pt(e).map(function(e){return function(t,e){return function(t,e){return C(wt(t),e)}(t,function(t){return dt(t,e)})}(e,t)})}function Ze(t,e){return parseInt(V(t,e),10)}function tn(t,e){return t+","+e}var en=function(t,e,n){return D(wt(t),function(t){return dt(t,e)?n(t)?[t]:[]:en(t,e,n)})},nn={firstLayer:function(t,e){return en(t,e,i(!0))},filterFirstLayer:en},rn={cell:function(t,e){return Je(["td","th"],t,e)},firstCell:function(t){return Xe(t,"th,td")},cells:function(t){return nn.firstLayer(t,"th,td")},neighbourCells:u(Qe,"th,td"),table:function(t,e){return $e(t,"table",e)},row:function(t,e){return Je(["tr"],t,e)},rows:function(t){return nn.firstLayer(t,"tr")},notCell:function(t,e){return Je(["caption","tr","tbody","tfoot","thead"],t,e)},neighbourRows:u(Qe,"tr"),attr:Ze,grid:function(t,e,n){var r=Ze(t,e),o=Ze(t,n);return ke(r,o)}},on=function(t){return w(rn.rows(t),function(t){var e=t,n=pt(e).map(function(t){var e=Jt(t);return"tfoot"===e||"thead"===e||"tbody"===e?e:"tbody"}).getOr("tbody"),r=w(rn.cells(t),function(t){var e=G(t,"rowspan")?parseInt(V(t,"rowspan"),10):1,n=G(t,"colspan")?parseInt(V(t,"colspan"),10):1;return Me(t,e,n)});return Le(e,r,n)})},un=function(t,e){return w(t,function(t){var n=w(rn.cells(t),function(t){var e=G(t,"rowspan")?parseInt(V(t,"rowspan"),10):1,n=G(t,"colspan")?parseInt(V(t,"colspan"),10):1;return Me(t,e,n)});return Le(t,n,e.section())})},cn=function(t,e){return C(D(t.all(),function(t){return t.cells()}),e)},an={generate:function(t){var e={},n=[],r=t.length,o=0;y(t,function(t,r){var i=[];y(t.cells(),function(t){for(var n=0;void 0!==e[tn(r,n)];)n++;for(var u=_e(t.element(),t.rowspan(),t.colspan(),r,n),c=0;c<t.colspan();c++)for(var a=0;a<t.rowspan();a++){var l=n+c,f=tn(r+a,l);e[f]=u,o=Math.max(o,l+1)}i.push(u)}),n.push(Le(t.element(),i,t.section()))});var u=ke(r,o);return{grid:i(u),access:i(e),all:i(n)}},getAt:function(t,e,n){var r=t.access()[tn(e,n)];return void 0!==r?Bt.some(r):Bt.none()},findItem:function(t,e,n){var r=cn(t,function(t){return n(e,t.element())});return 0<r.length?Bt.some(r[0]):Bt.none()},filterItems:cn,justCells:function(t){return O(w(t.all(),function(t){return t.cells()}))}},ln=k("minRow","minCol","maxRow","maxCol"),fn=function(t,e){function n(t){return dt(t.element(),e)}var r=on(t),o=an.generate(r),i=function(t,e){var n=t.grid().columns(),r=t.grid().rows(),o=n,i=0,u=0;return N(t.access(),function(t){if(e(t)){var n=t.row(),c=n+t.rowspan()-1,a=t.column(),l=a+t.colspan()-1;n<r?r=n:i<c&&(i=c),a<o?o=a:u<l&&(u=l)}}),ln(r,o,i,u)}(o,n),u="th:not("+e+"),td:not("+e+")";return y(nn.filterFirstLayer(t,"th,td",function(t){return dt(t,u)}),Be),function(t,e,n,r){for(var o,i,u,c=e.grid().columns(),a=e.grid().rows(),l=0;l<a;l++)for(var f=!1,s=0;s<c;s++)l<n.minRow()||l>n.maxRow()||s<n.minCol()||s>n.maxCol()||(an.getAt(e,l,s).filter(r).isNone()?(o=f,i=t[l].element(),u=ee.fromTag("td"),Ie(u,ee.fromTag("br")),(o?Ie:xt)(i,u)):f=!0)}(r,o,i,n),function(t,e){y(C(nn.firstLayer(t,"tr"),function(t){return 0===t.dom().childElementCount}),Be),e.minCol()!==e.maxCol()&&e.minRow()!==e.maxRow()||y(nn.firstLayer(t,"th,td"),function(t){Y(t,"rowspan"),Y(t,"colspan")}),Y(t,"width"),Y(t,"height"),ut(t,"width"),ut(t,"height")}(t,i),t};function sn(t){return Dn.get(t)}function dn(t){return Dn.getOption(t)}function mn(t,e){Dn.set(t,e)}function gn(t){return"img"===Jt(t)?1:dn(t).fold(function(){return wt(t).length},function(t){return t.length})}function pn(t){return function(t){return dn(t).filter(function(t){return 0!==t.trim().length||-1<t.indexOf(" ")}).isSome()}(t)||v(An,Jt(t))}function hn(t){return function(t,e){var n=function(t){for(var r=0;r<t.childNodes.length;r++){var o=ee.fromDom(t.childNodes[r]);if(e(o))return Bt.some(o);var i=n(t.childNodes[r]);if(i.isSome())return i}return Bt.none()};return n(t.dom())}(t,pn)}function vn(t){return En(t,pn)}function bn(t,e){return ee.fromDom(t.dom().cloneNode(e))}function wn(t){return bn(t,!1)}function yn(t){return bn(t,!0)}function Cn(){var t=ee.fromTag("td");return Ie(t,ee.fromTag("br")),t}function Sn(t,e,n){var r=function(t,e){var n=function(t,e){var n=ee.fromTag(e);return q(n,K(t)),n}(t,e);return Ot(n,wt(yn(t))),n}(t,e);return N(n,function(t,e){null===t?Y(r,e):U(r,e,t)}),r}function xn(t){return t}function Rn(t){return function(){return ee.fromTag("tr",t.dom())}}function Tn(t,e){return e.column()>=t.startCol()&&e.column()+e.colspan()-1<=t.finishCol()&&e.row()>=t.startRow()&&e.row()+e.rowspan()-1<=t.finishRow()}function On(t,e,n){var r=an.findItem(t,e,Ae),o=an.findItem(t,n,Ae);return r.bind(function(t){return o.map(function(e){return function(t,e){return Ue(Math.min(t.row(),e.row()),Math.min(t.column(),e.column()),Math.max(t.row()+t.rowspan()-1,e.row()+e.rowspan()-1),Math.max(t.column()+t.colspan()-1,e.column()+e.colspan()-1))}(t,e)})})}var Dn=function(t,e){var n=function(e){return t(e)?Bt.from(e.dom().nodeValue):Bt.none()};return{get:function(r){if(!t(r))throw new Error("Can only get "+e+" value of a "+e+" node");return n(r).getOr("")},getOption:n,set:function(n,r){if(!t(n))throw new Error("Can only set raw "+e+" value of a "+e+" node");n.dom().nodeValue=r}}}(Zt,"text"),An=["img","br"],En=function(t,e){var n=function(t){for(var r=wt(t),o=r.length-1;0<=o;o--){var i=r[o];if(e(i))return Bt.some(i);var u=n(i);if(u.isSome())return u}return Bt.none()};return n(t)},Nn={cellOperations:function(t,e,n){return{row:Rn(e),cell:function(e){var r=gt(e.element()),o=ee.fromTag(Jt(e.element()),r.dom()),i=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),u=0<i.length?function(t,e,n){return hn(t).map(function(r){return S(Et(r,n.join(","),function(e){return Ae(e,t)}),function(t,e){var n=wn(e);return Y(n,"contenteditable"),Ie(t,n),n},e)}).getOr(e)}(e.element(),o,i):o;return Ie(u,ee.fromTag("br")),function(t,e){var n=t.dom(),r=e.dom();Q(n)&&Q(r)&&(r.style.cssText=n.style.cssText)}(e.element(),o),ut(o,"height"),1!==e.colspan()&&ut(e.element(),"width"),t(e.element(),o),o},replace:Sn,gap:Cn}},paste:function(t){return{row:Rn(t),cell:Cn,replace:xn,gap:Cn}}},In=function(t,e){var n=e.column(),r=e.column()+e.colspan()-1,o=e.row(),i=e.row()+e.rowspan()-1;return n<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},Bn=On,kn=function(t,e,n){return On(t,e,n).bind(function(e){return function(t,e){for(var n=!0,r=u(Tn,e),o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)n=n&&an.getAt(t,o,i).exists(r);return n?Bt.some(e):Bt.none()}(t,e)})},Pn=function(t,e,n){return Bn(t,e,n).map(function(e){return w(an.filterItems(t,u(In,e)),function(t){return t.element()})})},Mn=function(t,e){return an.findItem(t,e,function(t,e){return Ee(e,t)}).map(function(t){return t.element()})},Wn=function(t){var e=on(t);return an.generate(e)},_n=function(t,e,n){return rn.table(t).bind(function(r){return function(t,e,n,r){return an.findItem(t,e,Ae).bind(function(e){var o=0<n?e.row()+e.rowspan()-1:e.row(),i=0<r?e.column()+e.colspan()-1:e.column();return an.getAt(t,o+n,i+r).map(function(t){return t.element()})})}(Wn(r),t,e,n)})},Ln=function(t,e,n){var r=Wn(t);return Pn(r,e,n)},jn=function(t,e,n,r,o){var i=Wn(t),u=Ae(t,n)?Bt.some(e):Mn(i,e),c=Ae(t,o)?Bt.some(r):Mn(i,r);return u.bind(function(t){return c.bind(function(e){return Pn(i,t,e)})})},zn=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Hn(){return{up:i({selector:Ye,closest:$e,predicate:Ge,all:ht}),down:i({selector:Nt,predicate:qe}),styles:i({get:ot,getRaw:it,set:nt,remove:ut}),attrs:i({get:V,set:U,remove:Y,copyTo:function(t,e){q(e,K(t))}}),insert:i({before:Ct,after:St,afterAll:Tt,append:Ie,appendAll:Ot,prepend:xt,wrap:Rt}),remove:i({unwrap:At,remove:Be}),create:i({nu:ee.fromTag,clone:function(t){return ee.fromDom(t.dom().cloneNode(!1))},text:ee.fromText}),query:i({comparePosition:function(t,e){return t.dom().compareDocumentPosition(e.dom())},prevSibling:vt,nextSibling:bt}),property:i({children:wt,name:Jt,parent:pt,document:function(t){return t.dom().ownerDocument},isText:Zt,isComment:H,isElement:Qt,getText:sn,setText:mn,isBoundary:function(t){return!!Qt(t)&&("body"===Jt(t)||v(zn,Jt(t)))},isEmptyTag:function(t){return!!Qt(t)&&v(["br","img","hr","input"],Jt(t))}}),eq:Ae,is:Ne}}function Fn(t,e,n){var r=t.property().children(e);return T(r,u(t.eq,n)).map(function(t){return{before:i(r.slice(0,t)),after:i(r.slice(t+1))}})}function Un(t,e){return u(t.eq,e)}function qn(t,e,n,r){function o(t){return T(t,r).fold(function(){return t},function(e){return t.slice(0,e+1)})}void 0===r&&(r=f);var u=[e].concat(t.up().all(e)),c=[n].concat(t.up().all(n)),a=o(u),l=o(c),s=R(a,function(e){return b(l,Un(t,e))});return{firstpath:i(a),secondpath:i(l),shared:i(s)}}function Vn(t){return Ye(t,"table")}function Gn(t,e,n){function r(t){return function(e){return void 0!==n&&n(e)||Ae(e,t)}}return Ae(t,e)?Bt.some(nr.create({boxes:Bt.some([t]),start:t,finish:e})):Vn(t).bind(function(o){return Vn(e).bind(function(i){if(Ae(o,i))return Bt.some(nr.create({boxes:Ln(o,t,e),start:t,finish:e}));if(Ee(o,i)){var u=0<(c=Et(e,"td,th",r(o))).length?c[c.length-1]:e;return Bt.some(nr.create({boxes:jn(o,t,o,e,i),start:t,finish:u}))}if(Ee(i,o)){var c,a=0<(c=Et(t,"td,th",r(i))).length?c[c.length-1]:t;return Bt.some(nr.create({boxes:jn(i,t,o,e,i),start:t,finish:a}))}return er.ancestors(t,e).shared().bind(function(u){return $e(u,"table",n).bind(function(n){var u=Et(e,"td,th",r(n)),c=0<u.length?u[u.length-1]:e,a=Et(t,"td,th",r(n)),l=0<a.length?a[a.length-1]:t;return Bt.some(nr.create({boxes:jn(n,t,o,e,i),start:l,finish:c}))})})})})}function Yn(t,n){return fr.cata(n.get(),i([]),e,i([t]))}function Kn(t){return{element:i(t),mergable:Bt.none,unmergable:Bt.none,selection:i([t])}}var Xn=k("left","right"),$n=k("first","second","splits"),Jn=function(t,e,n,r){return S(r,function(n,r){var o=e(t,r);return Qn(t,n,o)},e(t,n))},Qn=function(t,e,n){return e.bind(function(e){return n.filter(u(t.eq,e))})},Zn={sharedOne:function(t,e,n){return 0<n.length?function(t,e,n,r){return Jn(t,e,n[0],n.slice(1))}(t,e,n):Bt.none()},subset:function(t,e,n){var r=qn(t,e,n);return r.shared().bind(function(e){return function(t,e,n,r){var o=t.property().children(e);if(t.eq(e,n[0]))return Bt.some([n[0]]);if(t.eq(e,r[0]))return Bt.some([r[0]]);function i(n){var r=E(n),i=T(r,Un(t,e)).getOr(-1),u=i<r.length-1?r[i+1]:r[i];return T(o,Un(t,u))}var u=i(n),c=i(r);return u.bind(function(t){return c.map(function(e){var n=Math.min(t,e),r=Math.max(t,e);return o.slice(n,r+1)})})}(t,e,r.firstpath(),r.secondpath())})},ancestors:qn,breakToLeft:function(t,e,n){return Fn(t,e,n).map(function(r){var o=t.create().clone(e);return t.insert().appendAll(o,r.before().concat([n])),t.insert().appendAll(e,r.after()),t.insert().before(e,o),Xn(o,e)})},breakToRight:function(t,e,n){return Fn(t,e,n).map(function(n){var r=t.create().clone(e);return t.insert().appendAll(r,n.after()),t.insert().after(e,r),Xn(e,r)})},breakPath:function(t,e,n,r){var o=function(e,i,u){var c=$n(e,Bt.none(),u);return n(e)?$n(e,i,u):t.property().parent(e).bind(function(i){return r(t,i,e).map(function(t){var e=[{first:t.left,second:t.right}],r=n(i)?i:t.left();return o(r,Bt.some(t.right()),u.concat(e))})}).getOr(c)};return o(e,Bt.none(),[])}},tr=Hn(),er={sharedOne:function(t,e){return Zn.sharedOne(tr,function(e,n){return t(n)},e)},subset:function(t,e){return Zn.subset(tr,t,e)},ancestors:function(t,e,n){return Zn.ancestors(tr,t,e,n)},breakToLeft:function(t,e){return Zn.breakToLeft(tr,t,e)},breakToRight:function(t,e){return Zn.breakToRight(tr,t,e)},breakPath:function(t,e,n){return Zn.breakPath(tr,t,e,function(t,e,r){return n(e,r)})}},nr={create:Gt(["boxes","start","finish"],[])},rr=Gn,or=function(t,e){var n=Nt(t,e);return 0<n.length?Bt.some(n):Bt.none()},ir=function(t,e,n){return Xe(t,e).bind(function(e){return Xe(t,n).bind(function(t){return er.sharedOne(Vn,[e,t]).map(function(n){return{first:i(e),last:i(t),table:i(n)}})})})},ur=function(t,e,n){return ir(t,e,n).bind(function(e){function n(e){return Ae(t,e)}var r=Ye(e.first(),"thead,tfoot,tbody,table",n),o=Ye(e.last(),"thead,tfoot,tbody,table",n);return r.bind(function(t){return o.bind(function(n){return Ae(t,n)?function(t,e,n){var r=Wn(t);return kn(r,e,n)}(e.table(),e.first(),e.last()):Bt.none()})})})},cr={selected:i("data-mce-selected"),selectedSelector:i("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:i("[data-mce-selected]"),firstSelected:i("data-mce-first-selected"),firstSelectedSelector:i("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:i("data-mce-last-selected"),lastSelectedSelector:i("td[data-mce-last-selected],th[data-mce-last-selected]")},ar=function(e){if(!Mt(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var n=[],r={};return y(e,function(o,i){var u=Ft(o);if(1!==u.length)throw new Error("one and only one name per case");var c=u[0],a=o[c];if(void 0!==r[c])throw new Error("duplicate key detected:"+c);if("cata"===c)throw new Error("cannot have a case named cata (sorry)");if(!Mt(a))throw new Error("case arguments must be an array");n.push(c),r[c]=function(){var r=arguments.length;if(r!==a.length)throw new Error("Wrong number of arguments to case "+c+". Expected "+a.length+" ("+a+"), got "+r);for(var o=new Array(r),u=0;u<o.length;u++)o[u]=arguments[u];return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);return arguments[i].apply(null,o)},match:function(t){var e=Ft(t);if(n.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+e.join(","));if(!A(n,function(t){return v(e,t)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+n.join(", "));return t[c].apply(null,o)},log:function(e){t.console.log(e,{constructors:n,constructor:c,params:o})}}}}),r},lr=ar([{none:[]},{multiple:["elements"]},{single:["selection"]}]),fr={cata:function(t,e,n,r){return t.fold(e,n,r)},none:lr.none,multiple:lr.multiple,single:lr.single},sr=function(t,e){return fr.cata(e.get(),Bt.none,function(e,n){return 0===e.length?Bt.none():ur(t,cr.firstSelectedSelector(),cr.lastSelectedSelector()).bind(function(t){return 1<e.length?Bt.some({bounds:i(t),cells:i(e)}):Bt.none()})},Bt.none)},dr=function(t,e){var n=Yn(t,e);return 0<n.length&&A(n,function(t){return G(t,"rowspan")&&1<parseInt(V(t,"rowspan"),10)||G(t,"colspan")&&1<parseInt(V(t,"colspan"),10)})?Bt.some(n):Bt.none()},mr=Yn,gr={noMenu:Kn,forMenu:function(t,e,n){return{element:i(n),mergable:i(sr(e,t)),unmergable:i(dr(n,t)),selection:i(mr(n,t))}},notCell:function(t){return Kn(t)},paste:k("element","clipboard","generators"),pasteRows:function(t,e,n,r,o){return{element:i(n),mergable:Bt.none,unmergable:Bt.none,selection:i(mr(n,t)),clipboard:i(r),generators:i(o)}}},pr={registerEvents:function(e,n,o,i){e.on("BeforeGetContent",function(t){!0===t.selection&&fr.cata(n.get(),r,function(n){t.preventDefault(),function(t){return rn.table(t[0]).map(yn).map(function(t){return[fn(t,cr.attributeSelector())]})}(n).each(function(n){t.content="text"===t.format?function(t){return w(t,function(t){return t.dom().innerText}).join("")}(n):function(t,e){return w(e,function(e){return t.selection.serializer.serialize(e.dom(),{})}).join("")}(e,n)})},r)}),e.on("BeforeSetContent",function(n){!0===n.selection&&!0===n.paste&&Bt.from(e.dom.getParent(e.selection.getStart(),"th,td")).each(function(r){var u=ee.fromDom(r);rn.table(u).each(function(r){var c=C(function(e,n){var r=t.document.createElement("div");return r.innerHTML=e,wt(ee.fromDom(r))}(n.content),function(t){return"meta"!==Jt(t)});if(1===c.length&&"table"===Jt(c[0])){n.preventDefault();var a=ee.fromDom(e.getDoc()),l=Nn.paste(a),f=gr.paste(u,c[0],l);o.pasteCells(r,f).each(function(t){e.selection.setRng(t),e.focus(),i.clear(r)})}})})})}};function hr(t,e){function n(n){var r=e(n);if(r<=0||null===r){var o=ot(n,t);return parseFloat(o)||0}return r}function r(t,e){return x(e,function(e,n){var r=ot(t,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o},0)}return{set:function(e,n){if(!Lt(n)&&!n.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+n);var r=e.dom();Q(r)&&(r.style[t]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(t,e,n){var o=r(t,n);return o<e?e-o:0}}}function vr(t){return Wr.get(t)}function br(t){return Wr.getOuter(t)}function wr(t){return _r.get(t)}function yr(t){return _r.getOuter(t)}function Cr(t,e,n){return function(t,e){var n=parseFloat(t);return isNaN(n)?e:n}(ot(t,e),n)}function Sr(t,e){nt(t,"height",e+"px")}function xr(t){var e=function(t){return it(t,"height").getOrThunk(function(){return jr(t)+"px"})}(t);return e?function(t,e,n,r){var o=parseInt(t,10);return function(t,e){return X(t,"%",t.length-"%".length)}(t)&&"table"!==Jt(e)?function(t,e,n,r){var o=rn.table(t).map(function(t){var r=n(t);return Math.floor(e/100*r)}).getOr(e);return r(t,o),o}(e,o,n,r):o}(e,t,vr,Sr):vr(t)}function Rr(t){return it(t,"width").fold(function(){return Bt.from(V(t,"width"))},function(t){return Bt.some(t)})}function Tr(t,e){return t/e.pixelWidth()*100}function Or(t,e){return void 0!==t?t:void 0!==e?e:0}function Dr(t){var e=t.dom().ownerDocument,n=e.body,r=e.defaultView,o=e.documentElement;if(n===t.dom())return Gr(n.offsetLeft,n.offsetTop);var i=Or(r.pageYOffset,o.scrollTop),u=Or(r.pageXOffset,o.scrollLeft),c=Or(o.clientTop,n.clientTop),a=Or(o.clientLeft,n.clientLeft);return Yr(t).translate(u-a,i-c)}function Ar(t){return Dr(t).left()+yr(t)}function Er(t){return Dr(t).left()}function Nr(t,e){return Xr(t,Er(e))}function Ir(t,e){return Xr(t,Ar(e))}function Br(t){return Dr(t).top()}function kr(t,e){return Kr(t,Br(e))}function Pr(t,e){return Kr(t,Br(e)+br(e))}function Mr(t,e,n){if(0===n.length)return[];var r=w(n.slice(1),function(e,n){return e.map(function(e){return t(n,e)})}),o=n[n.length-1].map(function(t){return e(n.length-1,t)});return r.concat([o])}var Wr=hr("height",function(t){var e=t.dom();return tt(t)?e.getBoundingClientRect().height:e.offsetHeight}),_r=hr("width",function(t){return t.dom().offsetWidth}),Lr=st(),jr=function(t){return Lr.browser.isIE()||Lr.browser.isEdge()?function(t){var e=Cr(t,"padding-top",0),n=Cr(t,"padding-bottom",0),r=Cr(t,"border-top-width",0),o=Cr(t,"border-bottom-width",0),i=t.dom().getBoundingClientRect().height;return"border-box"===ot(t,"box-sizing")?i:i-e-n-(r+o)}(t):Cr(t,"height",vr(t))},zr=/(\d+(\.\d+)?)(\w|%)*/,Hr=/(\d+(\.\d+)?)%/,Fr=/(\d+(\.\d+)?)px|em/,Ur={percentageBasedSizeRegex:i(Hr),pixelBasedSizeRegex:i(Fr),setPixelWidth:function(t,e){nt(t,"width",e+"px")},setPercentageWidth:function(t,e){nt(t,"width",e+"%")},setHeight:Sr,getPixelWidth:function(t,e){return Rr(t).fold(function(){return wr(t)},function(n){return function(t,e,n){var r=Fr.exec(e);if(null!==r)return parseInt(r[1],10);var o=Hr.exec(e);return null===o?wr(t):parseFloat(o[1])/100*n.pixelWidth()}(t,n,e)})},getPercentageWidth:function(t,e){return Rr(t).fold(function(){return Tr(wr(t),e)},function(n){return function(t,e,n){var r=Hr.exec(e);return null!==r?parseFloat(r[1]):Tr(wr(t),n)}(t,n,e)})},getGenericWidth:function(t){return Rr(t).bind(function(t){var e=zr.exec(t);return null!==e?Bt.some({width:i(parseFloat(e[1])),unit:i(e[3])}):Bt.none()})},setGenericWidth:function(t,e,n){nt(t,"width",e+n)},getHeight:function(t){return function(t,e,n){return xr(t)/function(t,e){return G(t,e)?parseInt(V(t,e),10):1}(t,"rowspan")}(t)},getRawWidth:Rr},qr=function(t,e){Ur.getGenericWidth(t).each(function(n){var r=n.width()/2;Ur.setGenericWidth(t,r,n.unit()),Ur.setGenericWidth(e,r,n.unit())})},Vr=function(t,e){return{left:i(t),top:i(e),translate:function(n,r){return Vr(t+n,e+r)}}},Gr=Vr,Yr=function(t){var e=t.dom(),n=e.ownerDocument.body;return n===e?Gr(n.offsetLeft,n.offsetTop):tt(t)?function(t){var e=t.getBoundingClientRect();return Gr(e.left,e.top)}(e):Gr(0,0)},Kr=k("row","y"),Xr=k("col","x"),$r={height:{delta:e,positions:function(t){return Mr(kr,Pr,t)},edge:Br},rtl:{delta:function(t){return-t},edge:Ar,positions:function(t){return Mr(Ir,Nr,t)}},ltr:{delta:e,edge:Er,positions:function(t){return Mr(Nr,Ir,t)}}},Jr={ltr:$r.ltr,rtl:$r.rtl};function Qr(t){function e(e){return t(e).isRtl()?Jr.rtl:Jr.ltr}return{delta:function(t,n){return e(n).delta(t,n)},edge:function(t){return e(t).edge(t)},positions:function(t,n){return e(n).positions(t,n)}}}function Zr(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e}function to(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return Bt.none()}function eo(t,e,n,r){n===r?Y(t,e):U(t,e,n)}function no(t,e){var n=V(t,e);return void 0===n||""===n?[]:n.split(" ")}function ro(t){return void 0!==t.dom().classList}function oo(t,e){ro(t)?t.dom().classList.add(e):function(t,e){(function(t,e,n){U(t,e,no(t,e).concat([n]).join(" "))})(t,"class",e)}(t,e)}function io(t,e){return ro(t)&&t.dom().classList.contains(e)}function uo(t,e){for(var n=[],r=t;r<e;r++)n.push(r);return n}function co(t,e){if(e<0||e>=t.length-1)return Bt.none();var n=t[e].fold(function(){return to(E(t.slice(0,e)),function(t,e){return t.map(function(t){return{value:t,delta:e+1}})})},function(t){return Bt.some({value:t,delta:0})}),r=t[e+1].fold(function(){return to(t.slice(e+1),function(t,e){return t.map(function(t){return{value:t,delta:e+1}})})},function(t){return Bt.some({value:t,delta:1})});return n.bind(function(t){return r.map(function(e){var n=e.delta+t.delta;return Math.abs(e.value-t.value)/n})})}function ao(t){var e=t.replace(/\./g,"-");return{resolve:function(t){return e+"-"+t}}}function lo(t){y(Nt(t.parent(),"."+Ai),Be)}function fo(t,e,n){var r=t.origin();y(e,function(e,o){e.each(function(e){var o=n(r,e);oo(o,Ai),Ie(t.parent(),o)})})}function so(t,e){y(Nt(t.parent(),"."+Ai),e)}function mo(t,e){return t.cells()[e]}function go(t,e){if(0===t.length)return 0;var n=t[0];return T(t,function(t){return!e(n.element(),t.element())}).fold(function(){return t.length},function(t){return t})}function po(t,e){return function(t,e){return w(t,function(t){var n=function(t){return to(t,function(t){return pt(t.element()).map(function(t){var e=pt(t).isNone();return je(t,e)})}).getOrThunk(function(){return je(e.row(),!0)})}(t.details());return ze(n.element(),t.details(),t.section(),n.isNew())})}(ji(t,Ae),e)}function ho(t,e){return R(O(w(t.all(),function(t){return t.cells()})),function(t){return Ae(e,t.element())})}function vo(t,e,n,r,o){return function(u,c,a,l,f){var s=on(c),d=an.generate(s);return e(d,a).map(function(e){var n=zi(d,l,!1),r=t(n,e,Ae,o(l)),u=po(r.grid(),l);return{grid:i(u),cursor:r.cursor}}).fold(function(){return Bt.none()},function(t){var e=Ci(c,t.grid());return n(c,t.grid(),f),r(c),Ii(u,c,$r.height,f),Bt.some({cursor:t.cursor,newRows:e.newRows,newCells:e.newCells})})}}function bo(t,e){return rn.cell(e.element()).bind(function(e){return ho(t,e)})}function wo(t,e){var n=Zr(w(e.selection(),function(e){return rn.cell(e).bind(function(e){return ho(t,e)})}));return 0<n.length?Bt.some({cells:n,generators:e.generators,clipboard:e.clipboard}):Bt.none()}function yo(t,e){var n=Zr(w(e.selection(),function(e){return rn.cell(e).bind(function(e){return ho(t,e)})}));return 0<n.length?Bt.some(n):Bt.none()}function Co(t,e){return w(t,function(){return je(e.cell(),!0)})}function So(t,e,n){return w(t,function(t){return Li.setCells(t,t.cells().concat(Co(uo(0,e),n)))})}function xo(t,e,n,r){return w(t,function(t){return Li.mapCells(t,function(t){return function(t){return b(e,function(e){return n(t.element(),e.element())})}(t)?je(r(t.element(),n),!0):t})})}function Ro(t,e,n,r){return void 0!==Li.getCellElement(t[e],n)&&0<e&&r(Li.getCellElement(t[e-1],n),Li.getCellElement(t[e],n))}function To(t,e,n){return 0<e&&n(Li.getCellElement(t,e-1),Li.getCellElement(t,e))}function Oo(t,e){return G(t,e)&&1<parseInt(V(t,e),10)}function Do(t,e,n){return it(t,e).fold(function(){return n(t)+"px"},function(t){return t})}function Ao(t,e){return Do(t,"width",function(t){return Ur.getPixelWidth(t,e)})}function Eo(t){return Do(t,"height",Ur.getHeight)}function No(t,e,n,r,o){var i=xi(t),u=w(i,function(t){return t.map(e.edge)});return w(i,function(t,e){return t.filter(c(eu.hasColspan)).fold(function(){var t=co(u,e);return r(t)},function(t){return n(t,o)})})}function Io(t){return t.map(function(t){return t+"px"}).getOr("")}function Bo(t,e,n,r){var o=Ri(t),i=w(o,function(t){return t.map(e.edge)});return w(o,function(t,e){return t.filter(c(eu.hasRowspan)).fold(function(){var t=co(i,e);return r(t)},function(t){return n(t)})})}function ko(t,e,n){for(var r=0,o=t;o<e;o++)r+=void 0!==n[o]?n[o]:0;return r}function Po(t){var n=e;return{width:i(t),pixelWidth:i(t),getWidths:nu.getPixelWidths,getCellDelta:n,singleColumnWidth:function(t,e){return[Math.max(eu.minWidth(),t+e)-t]},minCellWidth:eu.minWidth,setElementWidth:Ur.setPixelWidth,setTableWidth:function(t,e,n){var r=S(e,function(t,e){return t+e},0);Ur.setPixelWidth(t,r)}}}function Mo(t){return an.generate(t)}function Wo(t){return Mo(on(t))}function _o(t,e){var n=C(e,function(e){return!v(t,e)});0<n.length&&W(n)}function Lo(t){return cu(_o,t,{validate:_t,label:"function"})}function jo(t){var e=G(t,"colspan")?parseInt(V(t,"colspan"),10):1,n=G(t,"rowspan")?parseInt(V(t,"rowspan"),10):1;return{element:i(t),colspan:i(e),rowspan:i(n)}}function zo(t){0===rn.cells(t).length&&Be(t)}function Ho(t,e,n){return Cu(t,e,n).orThunk(function(){return Cu(t,0,0)})}function Fo(t,e,n){return yu(t,Cu(t,e,n))}function Uo(t){return x(t,function(t,e){return b(t,function(t){return t.row()===e.row()})?t:t.concat([e])},[]).sort(function(t,e){return t.row()-e.row()})}function qo(t){return x(t,function(t,e){return b(t,function(t){return t.column()===e.column()})?t:t.concat([e])},[]).sort(function(t,e){return t.column()-e.column()})}function Vo(t,e,n){var r=un(t,n),o=an.generate(r);return zi(o,e,!0)}function Go(t){return t.getBoundingClientRect().width}function Yo(t){return t.getBoundingClientRect().height}function Ko(t){return/^[0-9]+$/.test(t)&&(t+="px"),t}function Xo(t){var e=Nt(t,"td[data-mce-style],th[data-mce-style]");Y(t,"data-mce-style"),y(e,function(t){Y(t,"data-mce-style")})}function $o(t){return t.getParam("table_default_attributes",Nu,"object")}function Jo(t){return t.getParam("table_default_styles",Eu,"object")}function Qo(t){return t.getParam("table_cell_advtab",!0,"boolean")}function Zo(t){return t.getParam("table_row_advtab",!0,"boolean")}function ti(t){return t.getParam("table_advtab",!0,"boolean")}function ei(t){return t.getParam("table_style_by_css",!1,"boolean")}function ni(t){return t.getParam("table_class_list",[],"array")}function ri(t){return!1===t.getParam("table_responsive_width")}function oi(t,e){return t.fire("newrow",{node:e})}function ii(t,e){return t.fire("newcell",{node:e})}function ui(t,e,n,r){t.fire("ObjectResizeStart",{target:e,width:n,height:r})}function ci(t,e,n,r){t.fire("ObjectResized",{target:e,width:n,height:r})}function ai(t,e){function n(e){return J(e,"rgb")?t.toHex(e):e}return{borderwidth:it(ee.fromDom(e),"border-width").getOr(""),borderstyle:it(ee.fromDom(e),"border-style").getOr(""),bordercolor:it(ee.fromDom(e),"border-color").map(n).getOr(""),backgroundcolor:it(ee.fromDom(e),"background-color").map(n).getOr("")}}function li(t,e,n,r,o){var i={};return _u.each(t.split(" "),function(t){r.formatter.matchNode(o,e+t)&&(i[n]=t)}),i[n]||(i[n]=""),i}function fi(t,e){t.setAttrib("scope",e.scope),t.setAttrib("class",e.class),t.setStyle("width",Ko(e.width)),t.setStyle("height",Ko(e.height))}function si(t,e){t.setStyle("background-color",e.backgroundcolor),t.setStyle("border-color",e.bordercolor),t.setStyle("border-style",e.borderstyle),t.setStyle("border-width",Ko(e.borderwidth))}function di(t,e,n){var r=n.getData();n.close(),t.undoManager.transact(function(){(1===e.length?function(t,e,n){var r=t.dom,o=n.celltype&&e[0].nodeName.toLowerCase()!==n.celltype?r.rename(e[0],n.celltype):e[0],i=$u.normal(r,o);fi(i,n),Qo(t)&&si(i,n),zu(t,o),Hu(t,o),n.halign&&Lu(t,o,n.halign),n.valign&&ju(t,o,n.valign)}:function(t,e,n){var r=t.dom;_u.each(e,function(e){n.celltype&&e.nodeName.toLowerCase()!==n.celltype&&(e=r.rename(e,n.celltype));var o=$u.ifTruthy(r,e);fi(o,n),Qo(t)&&si(o,n),n.halign&&Lu(t,e,n.halign),n.valign&&ju(t,e,n.valign)})})(t,e,r),t.focus()})}function mi(t,e,n,r){var o=t.dom,i=r.getData();r.close();var u=1===e.length?$u.normal:$u.ifTruthy;t.undoManager.transact(function(){_u.each(e,function(e){i.type!==e.parentNode.nodeName.toLowerCase()&&function(t,e,n){var r=t.getParent(e,"table"),o=e.parentNode,i=t.select(n,r)[0];i||(i=t.create(n),r.firstChild?"CAPTION"===r.firstChild.nodeName?t.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(e),o.hasChildNodes()||t.remove(o)}(t.dom,e,i.type);var r=u(o,e);r.setAttrib("scope",i.scope),r.setAttrib("class",i.class),r.setStyle("height",Ko(i.height)),Zo(t)&&function(t,e){t.setStyle("background-color",e.backgroundcolor),t.setStyle("border-color",e.bordercolor),t.setStyle("border-style",e.borderstyle)}(r,i),i.align!==n.align&&(zu(t,e),Lu(t,e,i.align))}),t.focus()})}function gi(t,e){t.selection.select(e.dom(),!0),t.selection.collapse(!0)}function pi(t,e,n){var r,o=t.dom,i=n.getData();n.close(),""===i.class&&delete i.class,t.undoManager.transact(function(){if(!e){var n=parseInt(i.cols,10)||1,u=parseInt(i.rows,10)||1;e=ic(t,n,u)}!function(t,e,n){var r=t.dom,o={},i={};if(o.class=n.class,i.height=Ko(n.height),r.getAttrib(e,"width")&&!ei(t)?o.width=function(t){return t?t.replace(/px$/,""):""}(n.width):i.width=Ko(n.width),ei(t)?(i["border-width"]=Ko(n.border),i["border-spacing"]=Ko(n.cellspacing)):(o.border=n.border,o.cellpadding=n.cellpadding,o.cellspacing=n.cellspacing),ei(t)&&e.children)for(var u=0;u<e.children.length;u++)cc(r,e.children[u],{"border-width":Ko(n.border),padding:Ko(n.cellpadding)}),ti(t)&&cc(r,e.children[u],{"border-color":n.bordercolor});ti(t)&&(i["background-color"]=n.backgroundcolor,i["border-color"]=n.bordercolor,i["border-style"]=n.borderstyle),o.style=r.serializeStyle(nc(Jo(t),i)),r.setAttribs(e,nc($o(t),o))}(t,e,i),(r=o.select("caption",e)[0])&&!i.caption&&o.remove(r),!r&&i.caption&&((r=o.create("caption")).innerHTML=rc.ie?" ":'<br data-mce-bogus="1"/>',e.insertBefore(r,e.firstChild)),""===i.align?zu(t,e):Lu(t,e,i.align),t.focus(),t.addVisual()})}function hi(t){return function(e){return Bt.from(e.dom.getParent(e.selection.getStart(),t)).map(ee.fromDom)}}function vi(t,e,n,r,c){var a=function(t,e){return function(n){t(n)&&e(function(t){function e(){t.stopPropagation()}function n(){t.preventDefault()}var r=ee.fromDom(t.target),u=o(n,e);return function(t,e,n,r,o,u,c){return{target:i(t),x:i(e),y:i(n),stop:r,prevent:o,kill:u,raw:i(c)}}(r,t.clientX,t.clientY,e,n,u,t)}(n))}}(n,r);return t.dom().addEventListener(e,a,c),{unbind:u(hc,t,e,a,c)}}function bi(t,e,n){return function(t,e,n,r){return vi(t,e,vc,r,!1)}(t,e,0,n)}var wi,yi=function(t){var e=on(t);return an.generate(e).grid()},Ci=function(t,e){function n(e,n){0<e.length?function(e,n){var i=Ke(t,n).getOrThunk(function(){var e=ee.fromTag(n,gt(t).dom());return Ie(t,e),e});Dt(i),Ot(i,w(e,function(t){t.isNew()&&r.push(t.element());var e=t.element();return Dt(e),y(t.cells(),function(t){t.isNew()&&o.push(t.element()),eo(t.element(),"colspan",t.colspan(),1),eo(t.element(),"rowspan",t.rowspan(),1),Ie(e,t.element())}),e}))}(e,n):Ke(t,n).each(Be)}var r=[],o=[],u=[],c=[],a=[];return y(e,function(t){switch(t.section()){case"thead":u.push(t);break;case"tbody":c.push(t);break;case"tfoot":a.push(t)}}),n(u,"thead"),n(c,"tbody"),n(a,"tfoot"),{newRows:i(r),newCells:i(o)}},Si=function(t,e,n){var r=t();return R(r,e).orThunk(function(){return Bt.from(r[0]).orThunk(n)}).map(function(t){return t.element()})},xi=function(t){var e=t.grid(),n=uo(0,e.columns()),r=uo(0,e.rows());return w(n,function(e){return Si(function(){return D(r,function(n){return an.getAt(t,n,e).filter(function(t){return t.column()===e}).fold(i([]),function(t){return[t]})})},function(t){return 1===t.colspan()},function(){return an.getAt(t,0,e)})})},Ri=function(t){var e=t.grid(),n=uo(0,e.rows()),r=uo(0,e.columns());return w(n,function(e){return Si(function(){return D(r,function(n){return an.getAt(t,e,n).filter(function(t){return t.row()===e}).fold(i([]),function(t){return[t]})})},function(t){return 1===t.rowspan()},function(){return an.getAt(t,e,0)})})},Ti={resolve:ao("ephox-snooker").resolve},Oi=function(t,e,n,r,o){var i=ee.fromTag("div");return rt(i,{position:"absolute",left:e-r/2+"px",top:n+"px",height:o+"px",width:r+"px"}),q(i,{"data-column":t,role:"presentation"}),i},Di=function(t,e,n,r,o){var i=ee.fromTag("div");return rt(i,{position:"absolute",left:e+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),q(i,{"data-row":t,role:"presentation"}),i},Ai=Ti.resolve("resizer-bar"),Ei=Ti.resolve("resizer-rows"),Ni=Ti.resolve("resizer-cols"),Ii=function(t,e,n,r){lo(t);var o=on(e),i=an.generate(o);!function(t,e,n,r,o,i){var u=Dr(e);!function(t,e,n,r){fo(t,e,function(t,e){var o=Di(e.row(),n.left()-t.left(),e.y()-t.top(),r,7);return oo(o,Ei),o})}(t,0<n.length?o.positions(n,e):[],u,yr(e)),function(t,e,n,r){fo(t,e,function(t,e){var o=Oi(e.col(),e.x()-t.left(),n.top()-t.top(),7,r);return oo(o,Ni),o})}(t,0<r.length?i.positions(r,e):[],u,br(e))}(t,e,Ri(i),xi(i),n,r)},Bi=function(t){so(t,function(t){nt(t,"display","none")})},ki=function(t){so(t,function(t){nt(t,"display","block")})},Pi=lo,Mi=function(t){return io(t,Ei)},Wi=function(t){return io(t,Ni)},_i=function(t,e){return He(e,t.section())},Li={addCell:function(t,e,n){var r=t.cells(),o=r.slice(0,e),i=r.slice(e),u=o.concat([n]).concat(i);return _i(t,u)},setCells:_i,mutateCell:function(t,e,n){t.cells()[e]=n},getCell:mo,getCellElement:function(t,e){return mo(t,e).element()},mapCells:function(t,e){var n=w(t.cells(),e);return He(n,t.section())},cellLength:function(t){return t.cells().length}},ji=function(t,e){var n=w(t,function(t,e){return w(t.cells(),function(t,e){return!1})});return w(t,function(r,o){var u=D(r.cells(),function(r,u){if(!1!==n[o][u])return[];var c=function(t,e,n,r){var o=go(function(t,e){return t[e]}(t,e).cells().slice(n),r),u=go(function(t,e){return w(t,function(t){return Li.getCell(t,e)})}(t,n).slice(e),r);return{colspan:i(o),rowspan:i(u)}}(t,o,u,e);return function(t,e,r,o){for(var i=t;i<t+r;i++)for(var u=e;u<e+o;u++)n[i][u]=!0}(o,u,c.rowspan(),c.colspan()),[We(r.element(),c.rowspan(),c.colspan(),r.isNew())]});return Fe(u,r.section())})},zi=function(t,e,n){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var c=an.getAt(t,o,u).map(function(t){return je(t.element(),n)}).getOrThunk(function(){return je(e.gap(),!0)});i.push(c)}var a=He(i,t.all()[o].section());r.push(a)}return r},Hi=function(t){return{is:function(e){return t===e},isValue:s,isError:f,getOr:i(t),getOrThunk:i(t),getOrDie:i(t),or:function(e){return Hi(t)},orThunk:function(e){return Hi(t)},fold:function(e,n){return n(t)},map:function(e){return Hi(e(t))},mapError:function(e){return Hi(t)},each:function(e){e(t)},bind:function(e){return e(t)},exists:function(e){return e(t)},forall:function(e){return e(t)},toOption:function(){return Bt.some(t)}}},Fi=function(t){return{is:f,isValue:f,isError:s,getOr:e,getOrThunk:function(t){return t()},getOrDie:function(){return(e=String(t),function(){throw new Error(e)})();var e},or:function(t){return t},orThunk:function(t){return t()},fold:function(e,n){return e(t)},map:function(e){return Fi(t)},mapError:function(e){return Fi(e(t))},each:r,bind:function(e){return Fi(t)},exists:f,forall:s,toOption:Bt.none}},Ui={value:Hi,error:Fi,fromOption:function(t,e){return t.fold(function(){return Fi(e)},Hi)}},qi=function(t,e){var n=Li.cellLength(t[0]),r=Li.cellLength(e[0]);return{rowDelta:i(0),colDelta:i(n-r)}},Vi=function(t,n,r){var o=n.colDelta()<0?So:e;return(n.rowDelta()<0?function(t,e,n){return t.concat(function(t,e){for(var n=[],r=0;r<t;r++)n.push(e());return n}(e,function(e){return Li.setCells(t[t.length-1],Co(t[t.length-1].cells(),n))}))}:e)(o(t,Math.abs(n.colDelta()),r),Math.abs(n.rowDelta()),r)},Gi=function(t,e,n,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<Li.cellLength(t[0]);u++){var c=n(Li.getCellElement(t[i],u),e);!0===c&&!1===o?Li.mutateCell(t[i],u,je(r(),!0)):!0===c&&(o=!1)}return t},Yi=function(t,e,n,r,o){return function(t,e,n){if(t.row()>=e.length||t.column()>Li.cellLength(e[0]))return Ui.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var r=e.slice(t.row()),o=r[0].cells().slice(t.column()),u=Li.cellLength(n[0]),c=n.length;return Ui.value({rowDelta:i(r.length-c),colDelta:i(o.length-u)})}(t,e,n).map(function(i){var c=Vi(e,i,r);return function(t,e,n,r,o){for(var i,c,a,l,f,s=t.row(),d=t.column(),m=s+n.length,g=d+Li.cellLength(n[0]),p=s;p<m;p++)for(var h=d;h<g;h++){i=e,c=p,a=h,f=l=void 0,l=u(o,Li.getCell(i[c],a).element()),f=i[c],1<i.length&&1<Li.cellLength(f)&&(0<a&&l(Li.getCellElement(f,a-1))||a<f.cells().length-1&&l(Li.getCellElement(f,a+1))||0<c&&l(Li.getCellElement(i[c-1],a))||c<i.length-1&&l(Li.getCellElement(i[c+1],a)))&&Gi(e,Li.getCellElement(e[p],h),o,r.cell);var v=Li.getCellElement(n[p-s],h-d),b=r.replace(v);Li.mutateCell(e[p],h,je(b,!0))}return e}(t,c,n,r,o)})},Ki=function(t,e,n,r,o){!function(t,e,n,r){0<e&&e<t.length&&y(function(t,e){return x(t,function(t,n){return b(t,function(t){return e(t.element(),n.element())})?t:t.concat([n])},[])}(t[e-1].cells(),n),function(o){for(var i=Bt.none(),u=function(e){for(var u=function(u){var c=t[e].cells()[u];n(c.element(),o.element())&&(i.isNone()&&(i=Bt.some(r())),i.each(function(n){Li.mutateCell(t[e],u,je(n,!0))}))},c=0;c<Li.cellLength(t[0]);c++)u(c)},c=e;c<t.length;c++)u(c)})}(e,t,o,r.cell);var i=qi(n,e),u=Vi(n,i,r),c=qi(e,u),a=Vi(e,c,r);return a.slice(0,t).concat(u).concat(a.slice(t,a.length))},Xi=function(t,e,n,r,o){var i=t.slice(0,e),u=t.slice(e),c=Li.mapCells(t[n],function(n,i){return 0<e&&e<t.length&&r(Li.getCellElement(t[e-1],i),Li.getCellElement(t[e],i))?Li.getCell(t[e],i):je(o(n.element(),r),!0)});return i.concat([c]).concat(u)},$i=function(t,e,n,r,o){return w(t,function(t){var i=0<e&&e<Li.cellLength(t)&&r(Li.getCellElement(t,e-1),Li.getCellElement(t,e))?Li.getCell(t,e):je(o(Li.getCellElement(t,n),r),!0);return Li.addCell(t,e,i)})},Ji=function(t,e,n,r){var o=D(t,function(r,o){return Ro(t,o,e,n)||To(r,e,n)?[]:[Li.getCell(r,e)]});return xo(t,o,n,r)},Qi=function(t,e,n,r){var o=t[e],i=D(o.cells(),function(r,i){return Ro(t,e,i,n)||To(o,i,n)?[]:[r]});return xo(t,i,n,r)},Zi=ar([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),tu=ie({},Zi),eu={hasColspan:function(t){return Oo(t,"colspan")},hasRowspan:function(t){return Oo(t,"rowspan")},minWidth:i(10),minHeight:i(10),getInt:function(t,e){return parseInt(ot(t,e),10)}},nu={getRawWidths:function(t,e,n){return No(t,e,Ao,Io,n)},getPixelWidths:function(t,e,n){return No(t,e,Ur.getPixelWidth,function(t){return t.getOrThunk(n.minCellWidth)},n)},getPercentageWidths:function(t,e,n){return No(t,e,Ur.getPercentageWidth,function(t){return t.fold(function(){return n.minCellWidth()},function(t){return t/n.pixelWidth()*100})},n)},getPixelHeights:function(t,e){return Bo(t,e,Ur.getHeight,function(t){return t.getOrThunk(eu.minHeight)})},getRawHeights:function(t,e){return Bo(t,e,Eo,Io)}},ru=function(t,e){return w(an.justCells(t),function(t){var n=ko(t.column(),t.column()+t.colspan(),e);return{element:t.element,width:i(n),colspan:t.colspan}})},ou=function(t){return Ur.getRawWidth(t).fold(function(){return Po(wr(t))},function(e){return function(t,e){var n=Ur.percentageBasedSizeRegex().exec(e);if(null!==n)return function(t,e){var n=parseFloat(t),r=wr(e);return{width:i(n),pixelWidth:i(r),getWidths:nu.getPercentageWidths,getCellDelta:function(t){return t/r*100},singleColumnWidth:function(t,e){return[100-t]},minCellWidth:function(){return eu.minWidth()/r*100},setElementWidth:Ur.setPercentageWidth,setTableWidth:function(t,e,r){var o=r/100*n;Ur.setPercentageWidth(t,n+o)}}}(n[1],t);var r=Ur.pixelBasedSizeRegex().exec(e);return Po(null!==r?parseInt(r[1],10):wr(t))}(t,e)})},iu=function(t,e,n,r){var o=ou(t),u=o.getCellDelta(e),c=Wo(t),a=o.getWidths(c,r,o),l=function(t,e,n,r){function o(t){return w(t,i(0))}function u(t,e){if(0<=n){var i=Math.max(r.minCellWidth(),c[e]-n);return o(c.slice(0,t)).concat([n,i-c[e]]).concat(o(c.slice(e+1)))}var u=Math.max(r.minCellWidth(),c[t]+n),a=c[t]-u;return o(c.slice(0,t)).concat([u-c[t],a]).concat(o(c.slice(e+1)))}var c=t.slice(0),a=function(t,e){return 0===t.length?tu.none():1===t.length?tu.only(0):0===e?tu.left(0,1):e===t.length-1?tu.right(e-1,e):0<e&&e<t.length-1?tu.middle(e-1,e,e+1):tu.none()}(t,e),l=i(o(c)),f=u;return a.fold(l,function(t){return r.singleColumnWidth(c[t],n)},f,function(t,e,n){return u(e,n)},function(t,e){if(0<=n)return o(c.slice(0,e)).concat([n]);var i=Math.max(r.minCellWidth(),c[e]+n);return o(c.slice(0,e)).concat([i-c[e]])})}(a,n,u,o),f=w(l,function(t,e){return t+a[e]});y(ru(c,f),function(t){o.setElementWidth(t.element(),t.width())}),n===c.grid().columns()-1&&o.setTableWidth(t,f,u)},uu=function(t,e,n,r){var o=Wo(t),u=w(nu.getPixelHeights(o,r),function(t,r){return n===r?Math.max(e+t,eu.minHeight()):t}),c=function(t,e){return w(an.justCells(t),function(t){var n=ko(t.row(),t.row()+t.rowspan(),e);return{element:t.element,height:i(n),rowspan:t.rowspan}})}(o,u);y(function(t,e){return w(t.all(),function(t,n){return{element:t.element,height:i(e[n])}})}(o,u),function(t){Ur.setHeight(t.element(),t.height())}),y(c,function(t){Ur.setHeight(t.element(),t.height())});var a=S(u,function(t,e){return t+e},0);Ur.setHeight(t,a)},cu=function(t,e,n){if(0===e.length)throw new Error("You must specify at least one required field.");return _("required",e),L(e),function(r){var o=Ft(r);A(e,function(t){return v(o,t)})||M(e,o),t(e,o);var i=C(e,function(t){return!n.validate(r[t],t)});return 0<i.length&&function(t,e){throw new Error("All values need to be of type: "+e+". Keys ("+P(t).join(", ")+") were not.")}(i,n.label),r}},au=Lo(["cell","row","replace","gap"]),lu=function(t,e){function r(n){return function(e){return t.cell(e)}(e(n))}function o(t){var e=r(t);return i.get().isNone()&&i.set(Bt.some(e)),u=Bt.some({item:t,replacement:e}),e}void 0===e&&(e=jo),au(t);var i=n(Bt.none()),u=Bt.none();return{getOrInit:function(t,e){return u.fold(function(){return o(t)},function(n){return e(t,n.item)?n.replacement:o(t)})},cursor:i.get}},fu=function(t,e){return function(r){var o=n(Bt.none());function i(n){var i={scope:t},c=r.replace(n,e,i);return u.push({item:n,sub:c}),o.get().isNone()&&o.set(Bt.some(c)),c}au(r);var u=[];return{replaceOrInit:function(t,e){return function(t,e){return R(u,function(n){return e(n.item,t)})}(t,e).fold(function(){return i(t)},function(n){return e(t,n.item)?n.sub:i(t)})},cursor:o.get}}},su=function(t){au(t);var e=n(Bt.none());return{combine:function(n){return e.get().isNone()&&e.set(Bt.some(n)),function(){var e=t.cell({element:i(n),colspan:i(1),rowspan:i(1)});return ut(e,"width"),ut(n,"width"),e}},cursor:e.get}},du=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],mu=function(t,e){var n=t.property().name(e);return v(du,n)},gu=function(t,e){return v(["br","img","hr","input"],t.property().name(e))},pu=Hn(),hu=function(t){return mu(pu,t)},vu=function(t){return function(t,e){return v(["ol","ul"],t.property().name(e))}(pu,t)},bu=function(t){return gu(pu,t)},wu=function(t){function e(t){return"br"===Jt(t)}var n,r=0===(n=D(t,function(t){var n,r=wt(t);return A(r,function(t){return e(t)||Zt(t)&&0===sn(t).trim().length})?[]:r.concat(vn(n=t).bind(function(t){var r=bt(t).map(function(t){return!!hu(t)||!!bu(t)&&"img"!==Jt(t)}).getOr(!1);return pt(t).map(function(o){return!0===r||function(t){return"li"===Jt(t)||Ge(t,vu).isSome()}(o)||e(t)||hu(o)&&!Ae(n,o)?[]:[ee.fromTag("br")]})}).getOr([]))})).length?[ee.fromTag("br")]:n;Dt(t[0]),Ot(t[0],r)},yu=k("grid","cursor"),Cu=function(t,e,n){return Bt.from(t[e]).bind(function(t){return Bt.from(t.cells()[n]).bind(function(t){return Bt.from(t.element())})})},Su=function(t,e,n){var r=ou(t),o=Mo(e),i=r.getWidths(o,n,r),u=ru(o,i);y(u,function(t){r.setElementWidth(t.element(),t.width())}),0<u.length&&r.setTableWidth(t,i,r.getCellDelta(0))},xu={insertRowBefore:vo(function(t,e,n,r){var o=e.row(),i=e.row();return Fo(Xi(t,i,o,n,r.getOrInit),i,e.column())},bo,r,r,lu),insertRowsBefore:vo(function(t,e,n,r){var o=e[0].row(),i=e[0].row();return Fo(x(Uo(e),function(t,e){return Xi(t,i,o,n,r.getOrInit)},t),i,e[0].column())},yo,r,r,lu),insertRowAfter:vo(function(t,e,n,r){var o=e.row(),i=e.row()+e.rowspan();return Fo(Xi(t,i,o,n,r.getOrInit),i,e.column())},bo,r,r,lu),insertRowsAfter:vo(function(t,e,n,r){var o=Uo(e),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan();return Fo(x(o,function(t,e){return Xi(t,u,i,n,r.getOrInit)},t),u,e[0].column())},yo,r,r,lu),insertColumnBefore:vo(function(t,e,n,r){var o=e.column(),i=e.column();return Fo($i(t,i,o,n,r.getOrInit),e.row(),i)},bo,Su,r,lu),insertColumnsBefore:vo(function(t,e,n,r){var o=qo(e),i=o[0].column(),u=o[0].column();return Fo(x(o,function(t,e){return $i(t,u,i,n,r.getOrInit)},t),e[0].row(),u)},yo,Su,r,lu),insertColumnAfter:vo(function(t,e,n,r){var o=e.column(),i=e.column()+e.colspan();return Fo($i(t,i,o,n,r.getOrInit),e.row(),i)},bo,Su,r,lu),insertColumnsAfter:vo(function(t,e,n,r){var o=e[e.length-1].column(),i=e[e.length-1].column()+e[e.length-1].colspan();return Fo(x(qo(e),function(t,e){return $i(t,i,o,n,r.getOrInit)},t),e[0].row(),i)},yo,Su,r,lu),splitCellIntoColumns:vo(function(t,e,n,r){return Fo(function(t,e,n,r,o){var i=n+1;return w(t,function(t,u){var c=u===e?je(o(Li.getCellElement(t,n),r),!0):Li.getCell(t,n);return Li.addCell(t,i,c)})}(t,e.row(),e.column(),n,r.getOrInit),e.row(),e.column())},bo,Su,r,lu),splitCellIntoRows:vo(function(t,e,n,r){return Fo(function(t,e,n,r,o){var i=e+1,u=t.slice(0,i),c=t.slice(i),a=Li.mapCells(t[e],function(t,e){return e===n?je(o(t.element(),r),!0):t});return u.concat([a]).concat(c)}(t,e.row(),e.column(),n,r.getOrInit),e.row(),e.column())},bo,r,r,lu),eraseColumns:vo(function(t,e,n,r){var o=qo(e),i=function(t,e,n){return C(w(t,function(t){var r=t.cells().slice(0,e).concat(t.cells().slice(n+1));return He(r,t.section())}),function(t){return 0<t.cells().length})}(t,o[0].column(),o[o.length-1].column()),u=Ho(i,e[0].row(),e[0].column());return yu(i,u)},yo,Su,zo,lu),eraseRows:vo(function(t,e,n,r){var o=Uo(e),i=function(t,e,n){return t.slice(0,e).concat(t.slice(n+1))}(t,o[0].row(),o[o.length-1].row()),u=Ho(i,e[0].row(),e[0].column());return yu(i,u)},yo,r,zo,lu),makeColumnHeader:vo(function(t,e,n,r){return Fo(Ji(t,e.column(),n,r.replaceOrInit),e.row(),e.column())},bo,r,r,fu("row","th")),unmakeColumnHeader:vo(function(t,e,n,r){return Fo(Ji(t,e.column(),n,r.replaceOrInit),e.row(),e.column())},bo,r,r,fu(null,"td")),makeRowHeader:vo(function(t,e,n,r){return Fo(Qi(t,e.row(),n,r.replaceOrInit),e.row(),e.column())},bo,r,r,fu("col","th")),unmakeRowHeader:vo(function(t,e,n,r){return Fo(Qi(t,e.row(),n,r.replaceOrInit),e.row(),e.column())},bo,r,r,fu(null,"td")),mergeCells:vo(function(t,e,n,r){var o=e.cells();wu(o);var u=function(t,e,n,r){if(0===t.length)return t;for(var o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)Li.mutateCell(t[o],i,je(r(),!1));return t}(t,e.bounds(),0,i(o[0]));return yu(u,Bt.from(o[0]))},function(t,e){return e.mergable()},r,r,su),unmergeCells:vo(function(t,e,n,r){var o=S(e,function(t,e){return Gi(t,e,n,r.combine(e))},t);return yu(o,Bt.from(e[0]))},function(t,e){return e.unmergable()},Su,r,su),pasteCells:vo(function(t,e,n,r){var o,i,u,c,a=(o=e.clipboard(),i=e.generators(),u=on(o),c=an.generate(u),zi(c,i,!0)),l=Pe(e.row(),e.column());return Yi(l,t,a,e.generators(),n).fold(function(){return yu(t,Bt.some(e.element()))},function(t){var n=Ho(t,e.row(),e.column());return yu(t,n)})},function(t,e){return rn.cell(e.element()).bind(function(n){return ho(t,n).map(function(t){return ie(ie({},t),{generators:e.generators,clipboard:e.clipboard})})})},Su,r,lu),pasteRowsBefore:vo(function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[0].row(),u=Vo(e.clipboard(),e.generators(),o),c=Ki(i,t,u,e.generators(),n),a=Ho(c,e.cells[0].row(),e.cells[0].column());return yu(c,a)},wo,r,r,lu),pasteRowsAfter:vo(function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[e.cells.length-1].row()+e.cells[e.cells.length-1].rowspan(),u=Vo(e.clipboard(),e.generators(),o),c=Ki(i,t,u,e.generators(),n),a=Ho(c,e.cells[0].row(),e.cells[0].column());return yu(c,a)},wo,r,r,lu)},Ru=function(t){return ee.fromDom(t.getBody())},Tu=function(t){return function(e){return Ae(e,Ru(t))}},Ou={isRtl:i(!1)},Du={isRtl:i(!0)},Au={directionAt:function(t){return"rtl"===function(t){return"rtl"===ot(t,"direction")?"rtl":"ltr"}(t)?Du:Ou}},Eu={"border-collapse":"collapse",width:"100%"},Nu={border:"1"},Iu=function(t){return t.getParam("table_tab_navigation",!0,"boolean")},Bu=function(t){var e=t.getParam("table_clone_elements");return Pt(e)?Bt.some(e.split(/[ ,]/)):Array.isArray(e)?Bt.some(e):Bt.none()},ku=function(t,e,n,r,o){t.fire("tableselectionchange",{cells:e,start:n,finish:r,otherCells:o})},Pu=function(t){t.fire("tableselectionclear")},Mu=function(t,e){function n(t){return"table"===Jt(Ru(t))}function o(e,n,r,o){return function(u,c){Xo(u);var a=o(),l=ee.fromDom(t.getDoc()),f=Qr(Au.directionAt),s=Nn.cellOperations(r,l,i);return n(u)?e(a,u,c,s,f).bind(function(e){return y(e.newRows(),function(e){oi(t,e.dom())}),y(e.newCells(),function(e){ii(t,e.dom())}),e.cursor().map(function(e){var n=t.dom.createRng();return n.setStart(e.dom(),0),n.setEnd(e.dom(),0),n})}):Bt.none()}}var i=Bu(t);return{deleteRow:o(xu.eraseRows,function(e){var r=yi(e);return!1===n(t)||1<r.rows()},r,e),deleteColumn:o(xu.eraseColumns,function(e){var r=yi(e);return!1===n(t)||1<r.columns()},r,e),insertRowsBefore:o(xu.insertRowsBefore,s,r,e),insertRowsAfter:o(xu.insertRowsAfter,s,r,e),insertColumnsBefore:o(xu.insertColumnsBefore,s,qr,e),insertColumnsAfter:o(xu.insertColumnsAfter,s,qr,e),mergeCells:o(xu.mergeCells,s,r,e),unmergeCells:o(xu.unmergeCells,s,r,e),pasteRowsBefore:o(xu.pasteRowsBefore,s,r,e),pasteRowsAfter:o(xu.pasteRowsAfter,s,r,e),pasteCells:o(xu.pasteCells,s,r,e)}},Wu=function(t,e,n){var r=on(t),o=an.generate(r);return yo(o,e).map(function(t){return function(t){return w(t,function(t){var e=wn(t.element());return y(t.cells(),function(t){var n=yn(t.element());eo(n,"colspan",t.colspan(),1),eo(n,"rowspan",t.rowspan(),1),Ie(e,n)}),e})}(po(zi(o,n,!1).slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan()),n))})},_u=tinymce.util.Tools.resolve("tinymce.util.Tools"),Lu=function(t,e,n){n&&t.formatter.apply("align"+n,{},e)},ju=function(t,e,n){n&&t.formatter.apply("valign"+n,{},e)},zu=function(t,e){_u.each("left center right".split(" "),function(n){t.formatter.remove("align"+n,{},e)})},Hu=function(t,e){_u.each("top middle bottom".split(" "),function(n){t.formatter.remove("valign"+n,{},e)})},Fu=function(t,e,n){var r;return function(e,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],n);if(void 0===e&&(e=i),e!==i)return""}return e}(r,t.select("td,th",e))},Uu=u(li,"left center right"),qu=u(li,"top middle bottom"),Vu=function(t,e,n){var r=function(t,n){return n=n||[],_u.each(t,function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,e&&e(o)),n.push(o)}),n};return r(t,n||[])},Gu=function(t){var e=t[0],n=t.slice(1),r=Ft(e);return y(n,function(t){y(r,function(n){N(t,function(t,r){var o=e[n];""!==o&&n===r&&o!==t&&(e[n]="")})})}),e},Yu=function(t){var e=[{name:"borderstyle",type:"selectbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===t?[{name:"borderwidth",type:"input",label:"Border width"}].concat(e):e}},Ku=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"selectbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"selectbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"selectbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"selectbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],Xu=function(t){return function(t){var e=t.getParam("table_cell_class_list",[],"array"),n=Vu(e,function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[e.value]})})});return 0<e.length?Bt.some({name:"class",type:"selectbox",label:"Class",items:n}):Bt.none()}(t).fold(function(){return Ku},function(t){return Ku.concat(t)})},$u={normal:function(t,e){return{setAttrib:function(n,r){t.setAttrib(e,n,r)},setStyle:function(n,r){t.setStyle(e,n,r)}}},ifTruthy:function(t,e){return{setAttrib:function(n,r){r&&t.setAttrib(e,n,r)},setStyle:function(n,r){r&&t.setStyle(e,n,r)}}}},Ju=function(t){var e,n=[];if(n=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),e=t.dom.getParent(t.selection.getStart(),"td,th"),!n.length&&e&&n.push(e),e=e||n[0]){var r=_u.map(n,function(e){return function(t,e,n){var r=t.dom;return ie(ie(ie({width:r.getStyle(e,"width")||r.getAttrib(e,"width"),height:r.getStyle(e,"height")||r.getAttrib(e,"height"),scope:r.getAttrib(e,"scope"),celltype:e.nodeName.toLowerCase(),class:r.getAttrib(e,"class","")},Uu("align","halign",t,e)),qu("valign","valign",t,e)),n?ai(r,e):{})}(t,e,Qo(t))}),o=Gu(r),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:Xu(t)},Yu("cell")]},c={type:"panel",items:[{type:"grid",columns:2,items:Xu(t)}]};t.windowManager.open({title:"Cell Properties",size:"normal",body:Qo(t)?i:c,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:u(di,t,n)})}},Qu=[{type:"selectbox",name:"type",label:"Row type",items:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Zu=function(t){return function(t){var e=t.getParam("table_row_class_list",[],"array"),n=Vu(e,function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[e.value]})})});return 0<e.length?Bt.some({name:"class",type:"selectbox",label:"Class",items:n}):Bt.none()}(t).fold(function(){return Qu},function(t){return Qu.concat(t)})},tc=function(t){var e,n,r=t.dom,o=[];if((e=r.getParent(t.selection.getStart(),"table"))&&(n=r.getParent(t.selection.getStart(),"td,th"),_u.each(e.rows,function(t){_u.each(t.cells,function(e){if((r.getAttrib(e,"data-mce-selected")||e===n)&&o.indexOf(t)<0)return o.push(t),!1})}),o[0])){var i=_u.map(o,function(e){return function(t,e,n){var r=t.dom;return ie(ie({height:r.getStyle(e,"height")||r.getAttrib(e,"height"),scope:r.getAttrib(e,"scope"),class:r.getAttrib(e,"class",""),align:"",type:e.parentNode.nodeName.toLowerCase()},Uu("align","align",t,e)),n?ai(r,e):{})}(t,e,Zo(t))}),c=Gu(i),a={type:"tabpanel",tabs:[{title:"General",name:"general",items:Zu(t)},Yu("row")]},l={type:"panel",items:[{type:"grid",columns:2,items:Zu(t)}]};t.windowManager.open({title:"Row Properties",size:"normal",body:Zo(t)?a:l,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:c,onSubmit:u(mi,t,o,c)})}},ec=Object.prototype.hasOwnProperty,nc=(wi=function(t,e){return e},function(){for(var t=new Array(arguments.length),e=0;e<t.length;e++)t[e]=arguments[e];if(0===t.length)throw new Error("Can't merge zero objects");for(var n={},r=0;r<t.length;r++){var o=t[r];for(var i in o)ec.call(o,i)&&(n[i]=wi(n[i],o[i]))}return n}),rc=tinymce.util.Tools.resolve("tinymce.Env"),oc={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},ic=function(t,e,n){var r=Jo(t),o={styles:r,attributes:$o(t),percentages:function(t){return Pt(t)&&-1!==t.indexOf("%")}(r.width)&&!ri(t)},i=function(t,e,n,r,o){void 0===o&&(o=oc);var i=ee.fromTag("table");rt(i,o.styles),q(i,o.attributes);var u=ee.fromTag("tbody");Ie(i,u);for(var c=[],a=0;a<t;a++){for(var l=ee.fromTag("tr"),f=0;f<e;f++){var s=a<n||f<r?ee.fromTag("th"):ee.fromTag("td");f<r&&U(s,"scope","row"),a<n&&U(s,"scope","col"),Ie(s,ee.fromTag("br")),o.percentages&&nt(s,"width",100/e+"%"),Ie(l,s)}c.push(l)}return Ot(u,c),i}(n,e,0,0,o);U(i,"data-mce-id","__mce");var c=function(t){var e=ee.fromTag("div"),n=ee.fromDom(t.dom().cloneNode(!0));return Ie(e,n),e.dom().innerHTML}(i);return t.insertContent(c),Xe(Ru(t),'table[data-mce-id="__mce"]').map(function(e){return ri(t)&&nt(e,"width",ot(e,"width")),Y(e,"data-mce-id"),function(t,e){y(Nt(e,"tr"),function(e){oi(t,e.dom()),y(Nt(e,"th,td"),function(e){ii(t,e.dom())})})}(t,e),function(t,e){Xe(e,"td,th").each(u(gi,t))}(t,e),e.dom()}).getOr(null)},uc=function(t,e,n){var r=n?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],o=t.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],i=e?[{type:"selectbox",name:"class",label:"Class",items:Vu(ni(t),function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[e.value]})})})}]:[];return r.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(o).concat([{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(i)},cc=function(t,e,n,r){if("TD"===e.tagName||"TH"===e.tagName)Pt(n)?t.setStyle(e,n,r):t.setStyle(e,n);else if(e.children)for(var o=0;o<e.children.length;o++)cc(t,e.children[o],n,r)},ac=function(t,e){var n,r=t.dom,o=function(t,e){var n,r,o,i,u,c,a,l=Jo(t),f=$o(t),s=t.dom,d=e?(n=s,r=B(l,"border-style").getOr(""),o=B(l,"border-color").getOr(""),i=B(l,"background-color").getOr(""),{borderstyle:r,bordercolor:m(o),backgroundcolor:m(i)}):{};function m(t){return J(t,"rgb")?n.toHex(t):t}return ie(ie(ie(ie(ie(ie({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),l),f),d),(a=l["border-width"],ei(t)&&a?{border:a}:B(f,"border").fold(function(){return{}},function(t){return{border:t}}))),(u=B(l,"border-spacing").or(B(f,"cellspacing")).fold(function(){return{}},function(t){return{cellspacing:t}}),c=B(l,"border-padding").or(B(f,"cellpadding")).fold(function(){return{}},function(t){return{cellpadding:t}}),ie(ie({},u),c)))}(t,ti(t));!1===e?(n=r.getParent(t.selection.getStart(),"table"))?o=function(t,e,n){var r,o,i,u=t.dom;return ie(ie({width:u.getStyle(e,"width")||u.getAttrib(e,"width"),height:u.getStyle(e,"height")||u.getAttrib(e,"height"),cellspacing:u.getStyle(e,"border-spacing")||u.getAttrib(e,"cellspacing"),cellpadding:u.getAttrib(e,"cellpadding")||Fu(t.dom,e,"padding"),border:(r=u,o=e,i=it(ee.fromDom(o),"border-width"),ei(t)&&i.isSome()?i.getOr(""):r.getAttrib(o,"border")||Fu(t.dom,o,"border-width")||Fu(t.dom,o,"border")),caption:!!u.select("caption",e)[0],class:u.getAttrib(e,"class","")},Uu("align","align",t,e)),n?ai(u,e):{})}(t,n,ti(t)):ti(t)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""):(o.cols="1",o.rows="1",ti(t)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""));var i=0<ni(t).length;i&&o.class&&(o.class=o.class.replace(/\s*mce\-item\-table\s*/g,""));var c={type:"grid",columns:2,items:uc(t,i,e)},a=ti(t)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[c]},Yu("table")]}:{type:"panel",items:[c]};t.windowManager.open({title:"Table Properties",size:"normal",body:a,onSubmit:u(pi,t,n),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o})},lc=hi("th,td"),fc=hi("th,td,caption"),sc=_u.each,dc={registerCommands:function(t,e,n,o,i){function a(t){return rn.table(t,m)}function l(t){return{width:Go(t.dom()),height:Go(t.dom())}}function f(e){lc(t).each(function(r){a(r).each(function(i){var u=gr.forMenu(o,i,r),c=l(i);e(i,u).each(function(e){!function(t,e,n){var r=l(n);e.width===r.width&&e.height===r.height||(ui(t,n.dom(),e.width,e.height),ci(t,n.dom(),r.width,r.height))}(t,c,i),t.selection.setRng(e),t.focus(),n.clear(i),Xo(i)})})})}function s(e){return lc(t).map(function(e){return a(e).bind(function(n){var i=ee.fromDom(t.getDoc()),u=gr.forMenu(o,n,e),c=Nn.cellOperations(r,i,Bt.none());return Wu(n,u,c)})})}function d(e){i.get().each(function(r){var i=w(r,function(t){return yn(t)});lc(t).each(function(r){a(r).each(function(u){var c=ee.fromDom(t.getDoc()),a=Nn.paste(c),l=gr.pasteRows(o,u,r,i,a);e(u,l).each(function(e){t.selection.setRng(e),t.focus(),n.clear(u)})})})})}var m=Tu(t);sc({mceTableSplitCells:function(){f(e.unmergeCells)},mceTableMergeCells:function(){f(e.mergeCells)},mceTableInsertRowBefore:function(){f(e.insertRowsBefore)},mceTableInsertRowAfter:function(){f(e.insertRowsAfter)},mceTableInsertColBefore:function(){f(e.insertColumnsBefore)},mceTableInsertColAfter:function(){f(e.insertColumnsAfter)},mceTableDeleteCol:function(){f(e.deleteColumn)},mceTableDeleteRow:function(){f(e.deleteRow)},mceTableCutRow:function(t){s().each(function(t){i.set(t),f(e.deleteRow)})},mceTableCopyRow:function(t){s().each(function(t){i.set(t)})},mceTablePasteRowBefore:function(t){d(e.pasteRowsBefore)},mceTablePasteRowAfter:function(t){d(e.pasteRowsAfter)},mceTableDelete:function(){fc(t).each(function(e){rn.table(e,m).filter(c(m)).each(function(e){var n=ee.fromText("");if(St(e,n),Be(e),t.dom.isEmpty(t.getBody()))t.setContent(""),t.selection.setCursorLocation();else{var r=t.dom.createRng();r.setStart(n.dom(),0),r.setEnd(n.dom(),0),t.selection.setRng(r),t.nodeChanged()}})})}},function(e,n){t.addCommand(n,e)}),sc({mceInsertTable:u(ac,t,!0),mceTableProps:u(ac,t,!1),mceTableRowProps:u(tc,t),mceTableCellProps:u(Ju,t)},function(e,n){t.addCommand(n,function(){e()})})}},mc=function(t){var e=Bt.from(t.dom().documentElement).map(ee.fromDom).getOr(t);return{parent:i(e),view:i(t),origin:i(Gr(0,0))}},gc=function(t){var e=k.apply(null,t),n=[];return{bind:function(t){if(void 0===t)throw new Error("Event bind error: undefined handler");n.push(t)},unbind:function(t){n=C(n,function(e){return e!==t})},trigger:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=e.apply(null,t);y(n,function(t){t(o)})}}},pc={create:function(t){return{registry:I(t,function(t){return{bind:t.bind,unbind:t.unbind}}),trigger:I(t,function(t){return t.trigger})}}},hc=function(t,e,n,r){t.dom().removeEventListener(e,n,r)},vc=i(!0),bc={resolve:ao("ephox-dragster").resolve},wc=Lo(["compare","extract","mutate","sink"]),yc=Lo(["element","start","stop","destroy"]),Cc=Lo(["forceDrop","drop","move","delayDrop"]),Sc=wc({compare:function(t,e){return Gr(e.left()-t.left(),e.top()-t.top())},extract:function(t){return Bt.some(Gr(t.x(),t.y()))},sink:function(t,e){var n=function(t){var e=nc({layerClass:bc.resolve("blocker")},t),n=ee.fromTag("div");return U(n,"role","presentation"),rt(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),oo(n,bc.resolve("blocker")),oo(n,e.layerClass),{element:function(){return n},destroy:function(){Be(n)}}}(e),r=bi(n.element(),"mousedown",t.forceDrop),o=bi(n.element(),"mouseup",t.drop),i=bi(n.element(),"mousemove",t.move),u=bi(n.element(),"mouseout",t.delayDrop);return yc({element:n.element,start:function(t){Ie(t,n.element())},stop:function(){Be(n.element())},destroy:function(){n.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()}})},mutate:function(t,e){t.mutate(e.left(),e.top())}});function xc(){var t={onEvent:r,reset:r},e=function(){var t=Bt.none(),e=pc.create({move:gc(["info"])});return{onEvent:function(n,r){r.extract(n).each(function(n){(function(e,n){var r=t.map(function(t){return e.compare(t,n)});return t=Bt.some(n),r})(r,n).each(function(t){e.trigger.move(t)})})},reset:function(){t=Bt.none()},events:e.registry}}(),n=t;return{on:function(){n.reset(),n=e},off:function(){n.reset(),n=t},isOn:function(){return n===e},onEvent:function(t,e){n.onEvent(t,e)},events:e.events}}function Rc(t){return"true"===V(t,"contenteditable")}function Tc(t,e,n){function r(t,e){return Bt.from(V(t,e))}var o=function(){var t=pc.create({drag:gc(["xDelta","yDelta","target"])}),e=Bt.none(),n=function(){var t=pc.create({drag:gc(["xDelta","yDelta"])});return{mutate:function(e,n){t.trigger.drag(e,n)},events:t.registry}}();return n.events.drag.bind(function(n){e.each(function(e){t.trigger.drag(n.xDelta(),n.yDelta(),e)})}),{assign:function(t){e=Bt.some(t)},get:function(){return e},mutate:n.mutate,events:t.registry}}(),i=na(o,{}),c=Bt.none();function a(t,e){return eu.getInt(t,e)-parseInt(V(t,"data-initial-"+e),10)}function l(e,n){m.trigger.startAdjust(),o.assign(e),U(e,"data-initial-"+n,parseInt(ot(e,n),10)),oo(e,ra),nt(e,"opacity","0.2"),i.go(t.parent())}function f(e){return Ae(e,t.view())}o.events.drag.bind(function(t){r(t.target(),"data-row").each(function(e){var n=eu.getInt(t.target(),"top");nt(t.target(),"top",n+t.yDelta()+"px")}),r(t.target(),"data-column").each(function(e){var n=eu.getInt(t.target(),"left");nt(t.target(),"left",n+t.xDelta()+"px")})}),i.events.stop.bind(function(){o.get().each(function(o){c.each(function(i){r(o,"data-row").each(function(t){var e=a(o,"top");Y(o,"data-initial-top"),m.trigger.adjustHeight(i,e,parseInt(t,10))}),r(o,"data-column").each(function(t){var e=a(o,"left");Y(o,"data-initial-left"),m.trigger.adjustWidth(i,e,parseInt(t,10))}),Ii(t,i,n,e)})})});var s=bi(t.parent(),"mousedown",function(t){Mi(t.target())&&l(t.target(),"top"),Wi(t.target())&&l(t.target(),"left")}),d=bi(t.view(),"mouseover",function(r){(function(t){return $e(t,"table",f).filter(function(t){return function(t,e){return $e(t,"[contenteditable]",f)}(t).exists(Rc)})})(r.target()).fold(function(){tt(r.target())&&Pi(t)},function(r){c=Bt.some(r),Ii(t,r,n,e)})}),m=pc.create({adjustHeight:gc(["table","delta","row"]),adjustWidth:gc(["table","delta","column"]),startAdjust:gc([])});return{destroy:function(){s.unbind(),d.unbind(),i.destroy(),Pi(t)},refresh:function(r){Ii(t,r,n,e)},on:i.on,off:i.off,hideBars:u(Bi,t),showBars:u(ki,t),events:m.registry}}function Oc(t,e){return Go(t.dom())/Go(e.dom())*100+"%"}function Dc(t,e){return rn.table(t,e).bind(function(e){var n=rn.cells(e);return T(n,function(e){return Ae(t,e)}).map(function(t){return{index:i(t),all:i(n)}})})}function Ac(t,e,n){var r=t.document.createRange();return function(t,n){e.fold(function(e){t.setStartBefore(e.dom())},function(e,n){t.setStart(e.dom(),n)},function(e){t.setStartAfter(e.dom())})}(r),function(t,e){e.fold(function(e){t.setEndBefore(e.dom())},function(e,n){t.setEnd(e.dom(),n)},function(e){t.setEndAfter(e.dom())})}(r,n),r}function Ec(t,e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i}function Nc(t){return{left:i(t.left),top:i(t.top),right:i(t.right),bottom:i(t.bottom),width:i(t.width),height:i(t.height)}}function Ic(t,e,n){return e(ee.fromDom(n.startContainer),n.startOffset,ee.fromDom(n.endContainer),n.endOffset)}function Bc(t,e){return function(t,e){var n=e.ltr();return n.collapsed?e.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return ha.rtl(ee.fromDom(t.endContainer),t.endOffset,ee.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return Ic(0,ha.ltr,n)}):Ic(0,ha.ltr,n)}(0,(n=t,e.match({domRange:function(t){return{ltr:i(t),rtl:Bt.none}},relative:function(t,e){return{ltr:Z(function(){return Ac(n,t,e)}),rtl:Z(function(){return Bt.some(Ac(n,e,t))})}},exact:function(t,e,r,o){return{ltr:Z(function(){return Ec(n,t,e,r,o)}),rtl:Z(function(){return Bt.some(Ec(n,r,o,t,e))})}}})));var n}function kc(t,e,n){return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom}function Pc(t,e){return e-t.left<t.right-e}function Mc(t,e,n){var r=t.dom().createRange();return r.selectNode(e.dom()),r.collapse(n),r}function Wc(t,e){var n=Jt(t);return"input"===n?da.after(t):v(["br","img"],n)?0===e?da.before(t):da.after(t):da.on(t,e)}function _c(t,e){var n=t.fold(da.before,Wc,da.after),r=e.fold(da.before,Wc,da.after);return ga.relative(n,r)}function Lc(t,e,n,r){var o=Wc(t,e),i=Wc(n,r);return ga.relative(o,i)}function jc(t,e){Bt.from(t.getSelection()).each(function(t){t.removeAllRanges(),t.addRange(e)})}function zc(t,e,n,r,o){jc(t,Ec(t,e,n,r,o))}function Hc(t,e){return Bc(t,e).match({ltr:function(e,n,r,o){zc(t,e,n,r,o)},rtl:function(e,n,r,o){var i=t.getSelection();if(i.setBaseAndExtent)i.setBaseAndExtent(e.dom(),n,r.dom(),o);else if(i.extend)try{!function(t,e,n,r,o,i){e.collapse(n.dom(),r),e.extend(o.dom(),i)}(0,i,e,n,r,o)}catch(i){zc(t,r,o,e,n)}else zc(t,r,o,e,n)}})}function Fc(t){var e=ee.fromDom(t.anchorNode),n=ee.fromDom(t.focusNode);return function(t,e,n,r){var o=function(t,e,n,r){var o=gt(t).dom().createRange();return o.setStart(t.dom(),e),o.setEnd(n.dom(),r),o}(t,e,n,r),i=Ae(t,n)&&e===r;return o.collapsed&&!i}(e,t.anchorOffset,n,t.focusOffset)?Bt.some(fa.create(e,t.anchorOffset,n,t.focusOffset)):function(t){if(0<t.rangeCount){var e=t.getRangeAt(0),n=t.getRangeAt(t.rangeCount-1);return Bt.some(fa.create(ee.fromDom(e.startContainer),e.startOffset,ee.fromDom(n.endContainer),n.endOffset))}return Bt.none()}(t)}function Uc(t,e){return function(t){function e(t,e,r,o){return Ec(n,t,e,r,o)}var n=ga.getWin(t).dom(),r=function(t){return t.match({domRange:function(t){var e=ee.fromDom(t.startContainer),n=ee.fromDom(t.endContainer);return Lc(e,t.startOffset,n,t.endOffset)},relative:_c,exact:Lc})}(t);return Bc(n,r).match({ltr:e,rtl:e})}(ga.exact(e,0,e,0))}function qc(t,e,n,r){return void 0===r&&(r=Na),t.property().parent(e).map(function(t){return Ea(t,r)})}function Vc(t){return function(e){return 0===t.property().children(e).length}}function Gc(t,e){return function(t,e,n){return Ma(_a,e,Vc(_a),n)}(0,t,e)}function Yc(t,e){return function(t,e,n){return Wa(_a,e,Vc(_a),n)}(0,t,e)}function Kc(t){return $e(t,"tr")}function Xc(t){return"br"===Jt(t)}function $c(t){return Ga.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})}function Jc(t,e){return Bt.some(t.getRect(e))}function Qc(t,e,n){return function(t,e,n){return Ve(function(t,e){return e(t)},Ge,t,hu,void 0)}(e).fold(i(!1),function(e){return Ka(t,e).exists(function(t){return function(t,e){return t.left()<e.left()||Math.abs(e.right()-t.left())<1||t.left()>e.right()}(n,t)})})}function Zc(t,e,n){var r=t.move(n,5),o=Qa(e,t,n,r,100).getOr(r);return function(t,e,n){return t.point(e)>n.getInnerHeight()?Bt.some(t.point(e)-n.getInnerHeight()):t.point(e)<0?Bt.some(-t.point(e)):Bt.none()}(t,o,e).fold(function(){return e.situsFromPoint(o.left(),t.point(o))},function(n){return e.scrollBy(0,n),e.situsFromPoint(o.left(),t.point(o)-n)})}function ta(t,e,n,r,o){return $e(r,"td,th",e).bind(function(r){return $e(r,"table",e).bind(function(u){return function(t,e){return function(t,e,n){return Ge(t,e,void 0).isSome()}(t,function(t){return pt(t).exists(function(t){return Ae(t,e)})})}(o,u)?il(t,e,n).bind(function(t){return $e(t.finish(),"td,th",e).map(function(e){return{start:i(r),finish:i(e),range:i(t)}})}):Bt.none()})})}function ea(t,e){return $e(t,"td,th",e)}var na=function(e,n){return void 0===n&&(n={}),function(e,n,r){function o(){f.stop(),c.isOn()&&(c.off(),u.trigger.stop())}var i=!1,u=pc.create({start:gc([]),stop:gc([])}),c=xc(),a=function(e,n){var r=null;return{cancel:function(){null!==r&&(t.clearTimeout(r),r=null)},throttle:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];null!==r&&t.clearTimeout(r),r=t.setTimeout(function(){e.apply(null,n),r=null},200)}}}(o);function l(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];i&&t.apply(null,e)}}c.events.move.bind(function(t){n.mutate(e,t.info())});var f=n.sink(Cc({forceDrop:o,drop:l(o),move:l(function(t){a.cancel(),c.onEvent(t,n)}),delayDrop:l(a.throttle)}),r);return{element:f.element,go:function(t){f.start(t),c.on(),u.trigger.start()},on:function(){i=!0},off:function(){i=!1},destroy:function(){f.destroy()},events:u.registry}}(e,void 0!==n.mode?n.mode:Sc,n)},ra=Ti.resolve("resizer-bar-dragging"),oa=function(t,e){return t.inline?function(t,e){return{parent:i(e),view:i(t),origin:i(Gr(0,0))}}(Ru(t),function(){var t=ee.fromTag("div");return rt(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Ie(ne(),t),t}()):mc(ee.fromDom(t.getDoc()))},ia=function(t){function e(t){return"TABLE"===t.nodeName}function n(e){var n=t.dom.getStyle(e,"width")||t.dom.getAttrib(e,"width");return Bt.from(n).filter(function(t){return 0<t.length})}function r(){return c}var o,i,u=Bt.none(),c=Bt.none(),a=Bt.none(),l=/(\d+(\.\d+)?)%/;return t.on("init",function(){var e=Qr(Au.directionAt),n=oa(t);if(a=Bt.some(n),function(e){var n=t.getParam("object_resizing",!0);return Pt(n)?"table"===n:n}()&&t.getParam("table_resize_bars",!0,"boolean")){var r=function(t,e){var n=$r.height,r=Tc(t,e,n),o=pc.create({beforeResize:gc(["table"]),afterResize:gc(["table"]),startDrag:gc([])});return r.events.adjustHeight.bind(function(t){o.trigger.beforeResize(t.table());var e=n.delta(t.delta(),t.table());uu(t.table(),e,t.row(),n),o.trigger.afterResize(t.table())}),r.events.startAdjust.bind(function(t){o.trigger.startDrag()}),r.events.adjustWidth.bind(function(t){o.trigger.beforeResize(t.table());var n=e.delta(t.delta(),t.table());iu(t.table(),n,t.column(),e),o.trigger.afterResize(t.table())}),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}}(n,e);r.on(),r.events.startDrag.bind(function(e){u=Bt.some(t.selection.getRng())}),r.events.beforeResize.bind(function(e){var n=e.table().dom();ui(t,n,Go(n),Yo(n))}),r.events.afterResize.bind(function(e){var n=e.table(),r=n.dom();Xo(n),u.each(function(e){t.selection.setRng(e),t.focus()}),ci(t,r,Go(r),Yo(r)),t.undoManager.add()}),c=Bt.some(r)}}),t.on("ObjectResizeStart",function(r){var u=r.target;if(e(u)){var c=n(u).map(function(t){return l.test(t)}).getOr(!1);c&&ri(t)?function(t){nt(ee.fromDom(t),"width",Go(t).toString()+"px")}(u):!c&&!0===t.getParam("table_responsive_width")&&function(t){var e=ee.fromDom(t);pt(e).map(function(t){return Oc(e,t)}).each(function(t){nt(e,"width",t),y(Nt(e,"tr"),function(t){y(wt(t),function(e){nt(e,"width",Oc(e,t))})})})}(u),o=r.width,i=n(u).getOr("")}}),t.on("ObjectResized",function(n){var r=n.target;if(e(r)){var u=r;if(l.test(i)){var c=parseFloat(l.exec(i)[1]),a=n.width*c/o;t.dom.setStyle(u,"width",a+"%")}else{var f=[];_u.each(u.rows,function(e){_u.each(e.cells,function(e){var n=t.dom.getStyle(e,"width",!0);f.push({cell:e,width:n})})}),_u.each(f,function(e){t.dom.setStyle(e.cell,"width",e.width),t.dom.setAttrib(e.cell,"width",null)})}}}),t.on("SwitchMode",function(){r().each(function(e){t.readonly?e.hideBars():e.showBars()})}),{lazyResize:r,lazyWire:function(){return a.getOr(mc(ee.fromDom(t.getBody())))},destroy:function(){c.each(function(t){t.destroy()}),a.each(function(e){!function(t,e){t.inline&&Be(e.parent())}(t,e)})}}},ua=ar([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),ca=ie(ie({},ua),{none:function(t){return void 0===t&&(t=void 0),ua.none(t)}}),aa=function(t,e){return Dc(t,e).fold(function(){return ca.none(t)},function(e){return e.index()+1<e.all().length?ca.middle(t,e.all()[e.index()+1]):ca.last(t)})},la=function(t,e){return Dc(t,e).fold(function(){return ca.none()},function(e){return 0<=e.index()-1?ca.middle(t,e.all()[e.index()-1]):ca.first(t)})},fa={create:k("start","soffset","finish","foffset")},sa=ar([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),da={before:sa.before,on:sa.on,after:sa.after,cata:function(t,e,n,r){return t.fold(e,n,r)},getStart:function(t){return t.fold(e,e,e)}},ma=ar([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),ga={domRange:ma.domRange,relative:ma.relative,exact:ma.exact,exactFromRange:function(t){return ma.exact(t.start(),t.soffset(),t.finish(),t.foffset())},getWin:function(t){return function(t){return ee.fromDom(t.dom().ownerDocument.defaultView)}(function(t){return t.match({domRange:function(t){return ee.fromDom(t.startContainer)},relative:function(t,e){return da.getStart(t)},exact:function(t,e,n,r){return t}})}(t))},range:fa.create},pa=function(t,e){t.selectNodeContents(e.dom())},ha=ar([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),va=function(t,e){return Bc(t,e).match({ltr:function(e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(e,n,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(e.dom(),n),i}})},ba=function(t,e,n,r){return Zt(e)?function(t,e,n,r){var o=t.dom().createRange();return o.selectNode(e.dom()),to(o.getClientRects(),function(t){return kc(t,n,r)?Bt.some(t):Bt.none()}).map(function(o){return function(t,e,n,r,o){function i(n){var r=t.dom().createRange();return r.setStart(e.dom(),n),r.collapse(!0),r}var u=sn(e).length,c=function(t,e,n,r,o){if(0===o)return 0;if(e===r)return o-1;for(var i=r,u=1;u<o;u++){var c=t(u),a=Math.abs(e-c.left);if(n<=c.bottom){if(n<c.top||i<a)return u-1;i=a}}return 0}(function(t){return i(t).getBoundingClientRect()},n,r,o.right,u);return i(c)}(t,e,n,r,o)})}(t,e,n,r):function(t,e,n,r){var o=t.dom().createRange();return to(wt(e),function(e){return o.selectNode(e.dom()),kc(o.getBoundingClientRect(),n,r)?ba(t,e,n,r):Bt.none()})}(t,e,n,r)},wa=document.caretPositionFromPoint?function(t,e,n){return Bt.from(t.dom().caretPositionFromPoint(e,n)).bind(function(e){if(null===e.offsetNode)return Bt.none();var n=t.dom().createRange();return n.setStart(e.offsetNode,e.offset),n.collapse(),Bt.some(n)})}:document.caretRangeFromPoint?function(t,e,n){return Bt.from(t.dom().caretRangeFromPoint(e,n))}:function(t,e,n){return ee.fromPoint(t,e,n).bind(function(r){function o(){return function(t,e,n){return(0===wt(e).length?function(t,e,n){var r=Pc(e.dom().getBoundingClientRect(),n);return Bt.some(Mc(t,e,r))}:function(t,e,n){var r=t.dom().createRange();r.selectNode(e.dom());var o=Pc(r.getBoundingClientRect(),n);return(!0===o?hn:vn)(e).map(function(e){return Mc(t,e,o)})})(t,e,n)}(t,r,e)}return 0===wt(r).length?o():function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect();return function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),c=Math.max(i.top,Math.min(i.bottom,r));return ba(t,e,u,c)}(t,e,Math.max(i.left,Math.min(i.right,n)),Math.max(i.top,Math.min(i.bottom,r)))}(t,r,e,n).orThunk(o)})},ya=tinymce.util.Tools.resolve("tinymce.util.VK"),Ca=function(t,e,n,r,o){return n.fold(Bt.none,Bt.none,function(t,e){return hn(e).map(function(t){return Uc(0,t)})},function(n){return rn.table(n,e).bind(function(e){var o=gr.noMenu(n);return t.undoManager.transact(function(){r.insertRowsAfter(e,o)}),function(t,e){return function(t){return 0===t.length?Bt.none():Bt.some(t[t.length-1])}(Nt(e,"tr")).bind(function(t){return Xe(t,"td,th").map(function(t){return Uc(0,t)})})}(0,e)})})},Sa=["table","li","dl"],xa={handle:function(t,e,n,r){if(t.keyCode===ya.TAB){var o=Ru(e),i=function(t){var e=Jt(t);return Ae(t,o)||v(Sa,e)},u=e.selection.getRng();if(u.collapsed){var c=ee.fromDom(u.startContainer);rn.cell(c,i).each(function(o){t.preventDefault(),(t.shiftKey?function(t,e,n,r){return Ca(t,e,la(n),r)}:function(t,e,n,r){return Ca(t,e,aa(n),r)})(e,i,o,n,r).each(function(t){e.selection.setRng(t)})})}}}},Ra={create:k("selection","kill")},Ta=function(t,e,n,r){return{start:i(da.on(t,e)),finish:i(da.on(n,r))}},Oa={convertToRange:function(t,e){var n=va(t,e);return fa.create(ee.fromDom(n.startContainer),n.startOffset,ee.fromDom(n.endContainer),n.endOffset)},makeSitus:Ta},Da=function(t,e,n,r,o){return Ae(n,r)?Bt.none():rr(n,r,e).bind(function(e){var r=e.boxes().getOr([]);return 0<r.length?(o(t,r,e.start(),e.finish()),Bt.some(Ra.create(Bt.some(Oa.makeSitus(n,0,n,gn(n))),!0))):Bt.none()})},Aa={sync:function(t,e,n,r,o,i,u){return Ae(n,o)&&r===i?Bt.none():$e(n,"td,th",e).bind(function(n){return $e(o,"td,th",e).bind(function(r){return Da(t,e,n,r,u)})})},detect:Da,update:function(t,e,n,r,o){return function(t,e,n,r,o){return function(t,e){return R(t,function(t){return dt(t,e)})}(t,o).bind(function(t){return _n(t,e,n).bind(function(t){return n=r,Ye(e=t,"table").bind(function(t){return Xe(t,n).bind(function(t){return Gn(t,e).bind(function(t){return t.boxes().map(function(e){return{boxes:i(e),start:i(t.start()),finish:i(t.finish())}})})})});var e,n})})}(r,t,e,o.firstSelectedSelector(),o.lastSelectedSelector()).map(function(t){return o.clearBeforeUpdate(n),o.selectRange(n,t.boxes(),t.start(),t.finish()),t.boxes()})}},Ea=k("item","mode"),Na=function(t,e,n,r){return void 0===r&&(r=Ia),n.sibling(t,e).map(function(t){return Ea(t,r)})},Ia=function(t,e,n,r){void 0===r&&(r=Ia);var o=t.property().children(e);return n.first(o).map(function(t){return Ea(t,r)})},Ba=[{current:qc,next:Na,fallback:Bt.none()},{current:Na,next:Ia,fallback:Bt.some(qc)},{current:Ia,next:Ia,fallback:Bt.some(Na)}],ka=function(t,e,n,r,o){return void 0===o&&(o=Ba),R(o,function(t){return t.current===n}).bind(function(n){return n.current(t,e,r,n.next).orThunk(function(){return n.fallback.bind(function(n){return ka(t,e,n,r)})})})},Pa=function(t,e,n,r,o,i){return ka(t,e,r,o).bind(function(e){return i(e.item())?Bt.none():n(e.item())?Bt.some(e.item()):Pa(t,e.item(),n,e.mode(),o,i)})},Ma=function(t,e,n,r){return Pa(t,e,n,Na,{sibling:function(t,e){return t.query().prevSibling(e)},first:function(t){return 0<t.length?Bt.some(t[t.length-1]):Bt.none()}},r)},Wa=function(t,e,n,r){return Pa(t,e,n,Na,{sibling:function(t,e){return t.query().nextSibling(e)},first:function(t){return 0<t.length?Bt.some(t[0]):Bt.none()}},r)},_a=Hn(),La=k("element","offset"),ja=(k("element","deltaOffset"),k("element","start","finish"),k("begin","end"),k("element","text"),ar([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}])),za=ie(ie({},ja),{verify:function(t,e,n,r,o,i,u){return $e(r,"td,th",u).bind(function(n){return $e(e,"td,th",u).map(function(e){return Ae(n,e)?Ae(r,n)&&gn(n)===o?i(e):ja.none("in same cell"):er.sharedOne(Kc,[n,e]).fold(function(){return function(t,e,n){var r=t.getRect(e),o=t.getRect(n);return o.right>r.left&&o.left<r.right}(t,e,n)?ja.success():i(e)},function(t){return i(e)})})}).getOr(ja.none("default"))},cata:function(t,e,n,r,o){return t.fold(e,n,r,o)}}),Ha=(k("ancestor","descendants","element","index"),k("parent","children","element","index")),Fa=function(t,e){return T(t,u(Ae,e))},Ua=function(t,e,n){return e(t,n).bind(function(t){return Zt(t)&&0===sn(t).trim().length?Ua(t,e,n):Bt.some(t)})},qa=function(t,e,n,r){return(Xc(e)?function(t,e,n){return n.traverse(e).orThunk(function(){return Ua(e,n.gather,t)}).map(n.relative)}(t,e,r):function(t,e,n,r){return function(t,e){return yt(t,e).filter(Xc).orThunk(function(){return yt(t,e-1).filter(Xc)})}(e,n).bind(function(e){return r.traverse(e).fold(function(){return Ua(e,r.gather,t).map(r.relative)},function(t){return(e=t,pt(e).bind(function(t){var n=wt(t);return Fa(n,e).map(function(r){return Ha(t,n,e,r)})})).map(function(t){return da.on(t.parent(),t.index())});var e})})}(t,e,n,r)).map(function(t){return{start:i(t),finish:i(t)}})},Va=Gt(["left","top","right","bottom"],[]),Ga={nu:Va,moveUp:function(t,e){return Va({left:t.left(),top:t.top()-e,right:t.right(),bottom:t.bottom()-e})},moveDown:function(t,e){return Va({left:t.left(),top:t.top()+e,right:t.right(),bottom:t.bottom()+e})},moveBottomTo:function(t,e){var n=t.bottom()-t.top();return Va({left:t.left(),top:e-n,right:t.right(),bottom:e})},moveTopTo:function(t,e){var n=t.bottom()-t.top();return Va({left:t.left(),top:e,right:t.right(),bottom:e+n})},getTop:function(t){return t.top()},getBottom:function(t){return t.bottom()},translate:function(t,e,n){return Va({left:t.left()+e,top:t.top()+n,right:t.right()+e,bottom:t.bottom()+n})},toString:function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"}},Ya=function(t,e,n){return Qt(e)?Jc(t,e).map($c):Zt(e)?function(t,e,n){return 0<=n&&n<gn(e)?t.getRangedRect(e,n,e,n+1):0<n?t.getRangedRect(e,n-1,e,n):Bt.none()}(t,e,n).map($c):Bt.none()},Ka=function(t,e){return Qt(e)?Jc(t,e).map($c):Zt(e)?t.getRangedRect(e,0,e,gn(e)).map($c):Bt.none()},Xa=ar([{none:[]},{retry:["caret"]}]),$a={point:Ga.getTop,adjuster:function(t,e,n,r,o){var i=Ga.moveUp(o,5);return Math.abs(n.top()-r.top())<1?Xa.retry(i):n.bottom()<o.top()?Xa.retry(i):n.bottom()===o.top()?Xa.retry(Ga.moveUp(o,1)):Qc(t,e,o)?Xa.retry(Ga.translate(i,5,0)):Xa.none()},move:Ga.moveUp,gather:Gc},Ja={point:Ga.getBottom,adjuster:function(t,e,n,r,o){var i=Ga.moveDown(o,5);return Math.abs(n.bottom()-r.bottom())<1?Xa.retry(i):n.top()>o.bottom()?Xa.retry(i):n.top()===o.bottom()?Xa.retry(Ga.moveDown(o,1)):Qc(t,e,o)?Xa.retry(Ga.translate(i,5,0)):Xa.none()},move:Ga.moveDown,gather:Yc},Qa=function(t,e,n,r,o){return 0===o?Bt.some(r):function(t,e,n){return t.elementFromPoint(e,n).filter(function(t){return"table"===Jt(t)}).isSome()}(t,r.left(),e.point(r))?function(t,e,n,r,o){return Qa(t,e,n,e.move(r,5),o)}(t,e,n,r,o-1):t.situsFromPoint(r.left(),e.point(r)).bind(function(i){return i.start().fold(Bt.none,function(i){return Ka(t,i).bind(function(u){return e.adjuster(t,i,u,n,r).fold(Bt.none,function(r){return Qa(t,e,n,r,o-1)})}).orThunk(function(){return Bt.some(r)})},Bt.none)})},Za={tryUp:u(Zc,$a),tryDown:u(Zc,Ja),ieTryUp:function(t,e){return t.situsFromPoint(e.left(),e.top()-5)},ieTryDown:function(t,e){return t.situsFromPoint(e.left(),e.bottom()+5)},getJumpSize:i(5)},tl=st(),el=function(t,e,n,r,o,i){return 0===i?Bt.none():ol(t,e,n,r,o).bind(function(u){var c=t.fromSitus(u),a=za.verify(t,n,r,c.finish(),c.foffset(),o.failure,e);return za.cata(a,function(){return Bt.none()},function(){return Bt.some(u)},function(u){return Ae(n,u)&&0===r?nl(t,n,r,Ga.moveUp,o):el(t,e,u,0,o,i-1)},function(u){return Ae(n,u)&&r===gn(u)?nl(t,n,r,Ga.moveDown,o):el(t,e,u,gn(u),o,i-1)})})},nl=function(t,e,n,r,o){return Ya(t,e,n).bind(function(e){return rl(t,o,r(e,Za.getJumpSize()))})},rl=function(t,e,n){return tl.browser.isChrome()||tl.browser.isSafari()||tl.browser.isFirefox()||tl.browser.isEdge()?e.otherRetry(t,n):tl.browser.isIE()?e.ieRetry(t,n):Bt.none()},ol=function(t,e,n,r,o){return Ya(t,n,r).bind(function(e){return rl(t,o,e)})},il=function(t,e,n){return(r=t,o=e,i=n,r.getSelection().bind(function(t){return qa(o,t.finish(),t.foffset(),i).fold(function(){return Bt.some(La(t.finish(),t.foffset()))},function(e){var n=r.fromSitus(e);return function(t){return za.cata(t,function(t){return Bt.none()},function(){return Bt.none()},function(t){return Bt.some(La(t,0))},function(t){return Bt.some(La(t,gn(t)))})}(za.verify(r,t.finish(),t.foffset(),n.finish(),n.foffset(),i.failure,o))})})).bind(function(r){return el(t,e,r.element(),r.offset(),n,20).map(t.fromSitus)});var r,o,i},ul=st(),cl=function(t,e,n,r,o,i){return ul.browser.isIE()?Bt.none():i(r,e).orThunk(function(){return ta(t,e,n,r,o).map(function(t){var e=t.range();return Ra.create(Bt.some(Oa.makeSitus(e.start(),e.soffset(),e.finish(),e.foffset())),!0)})})},al=function(t,e,n,r,o,i,u){return ta(t,n,r,o,i).bind(function(t){return Aa.detect(e,n,t.start(),t.finish(),u)})},ll=function(t,e){return $e(t,"tr",e).bind(function(t){return $e(t,"table",e).bind(function(n){var r=Nt(n,"tr");return Ae(t,r[0])?function(t,n,r){return Ma(_a,t,function(t){return vn(t).isSome()},e)}(n).map(function(t){var e=gn(t);return Ra.create(Bt.some(Oa.makeSitus(t,e,t,e)),!0)}):Bt.none()})})},fl=function(t,e){return $e(t,"tr",e).bind(function(t){return $e(t,"table",e).bind(function(n){var r=Nt(n,"tr");return Ae(t,r[r.length-1])?function(t,n,r){return Wa(_a,t,function(t){return hn(t).isSome()},e)}(n).map(function(t){return Ra.create(Bt.some(Oa.makeSitus(t,0,t,0)),!0)}):Bt.none()})})};function sl(t){return function(e){return e===t}}function dl(e){return{elementFromPoint:function(t,n){return ee.fromPoint(ee.fromDom(e.document),t,n)},getRect:function(t){return t.dom().getBoundingClientRect()},getRangedRect:function(t,n,r,o){var i=ga.exact(t,n,r,o);return function(t,e){return function(t){var e=t.getClientRects(),n=0<e.length?e[0]:t.getBoundingClientRect();return 0<n.width||0<n.height?Bt.some(n).map(Nc):Bt.none()}(va(t,e))}(e,i).map(bl)},getSelection:function(){return(t=e,function(t){return Bt.from(t.getSelection()).filter(function(t){return 0<t.rangeCount}).bind(Fc)}(t).map(function(t){return ga.exact(t.start(),t.soffset(),t.finish(),t.foffset())})).map(function(t){return Oa.convertToRange(e,t)});var t},fromSitus:function(t){var n=ga.relative(t.start(),t.finish());return Oa.convertToRange(e,n)},situsFromPoint:function(t,n){return function(t,e,n){return function(t,e,n){var r=ee.fromDom(t.document);return wa(r,e,n).map(function(t){return fa.create(ee.fromDom(t.startContainer),t.startOffset,ee.fromDom(t.endContainer),t.endOffset)})}(t,e,n)}(e,t,n).map(function(t){return Ta(t.start(),t.soffset(),t.finish(),t.foffset())})},clearSelection:function(){e.getSelection().removeAllRanges()},setSelection:function(t){!function(t,e,n,r,o){Hc(t,Lc(e,n,r,o))}(e,t.start(),t.soffset(),t.finish(),t.foffset())},setRelativeSelection:function(t,n){!function(t,n,r){Hc(e,_c(n,r))}(0,t,n)},selectContents:function(t){!function(t,e){var n=function(t,e){var n=t.document.createRange();return pa(n,e),n}(t,e);jc(t,n)}(e,t)},getInnerHeight:function(){return e.innerHeight},getScrollY:function(){return(n=ee.fromDom(e.document),r=void 0!==n?n.dom():t.document,o=r.body.scrollLeft||r.documentElement.scrollLeft,i=r.body.scrollTop||r.documentElement.scrollTop,Gr(o,i)).top();var n,r,o,i},scrollBy:function(n,r){!function(e,n,r){(void 0!==r?r.dom():t.document).defaultView.scrollBy(e,n)}(n,r,ee.fromDom(e.document))}}}function ml(t,e){y(e,function(e){!function(t,e){ro(t)?t.dom().classList.remove(e):function(t,e){(function(t,e,n){var r=C(no(t,e),function(t){return t!==n});0<r.length?U(t,e,r.join(" ")):Y(t,e)})(t,"class",e)}(t,e),function(t){0===(ro(t)?t.dom().classList:function(t){return no(t,"class")}(t)).length&&Y(t,"class")}(t)}(t,e)})}var gl={down:{traverse:bt,gather:Yc,relative:da.before,otherRetry:Za.tryDown,ieRetry:Za.ieTryDown,failure:za.failedDown},up:{traverse:vt,gather:Gc,relative:da.before,otherRetry:Za.tryUp,ieRetry:Za.ieTryUp,failure:za.failedUp}},pl=sl(38),hl=sl(40),vl={ltr:{isBackward:sl(37),isForward:sl(39)},rtl:{isBackward:sl(39),isForward:sl(37)},isUp:pl,isDown:hl,isNavigation:function(t){return 37<=t&&t<=40}},bl=function(t){return{left:t.left(),top:t.top(),right:t.right(),bottom:t.bottom(),width:t.width(),height:t.height()}},wl=(st().browser.isSafari(),k("rows","cols")),yl=st(),Cl={mouse:function(t,e,n,r){var o=function(t,e,n,r){function o(){i=Bt.none()}var i=Bt.none();return{mousedown:function(t){r.clear(e),i=ea(t.target(),n)},mouseover:function(o){i.each(function(i){r.clearBeforeUpdate(e),ea(o.target(),n).each(function(o){rr(i,o,n).each(function(n){var u=n.boxes().getOr([]);(1<u.length||1===u.length&&!Ae(i,o))&&(r.selectRange(e,u,n.start(),n.finish()),t.selectContents(o))})})})},mouseup:function(t){i.each(o)}}}(dl(t),e,n,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},keyboard:function(t,e,n,r){function o(){return r.clear(e),Bt.none()}var i=dl(t);return{keydown:function(t,c,a,l,f,s){var d=t.raw(),m=d.which,g=!0===d.shiftKey;return or(e,r.selectedSelector()).fold(function(){return vl.isDown(m)&&g?u(al,i,e,n,gl.down,l,c,r.selectRange):vl.isUp(m)&&g?u(al,i,e,n,gl.up,l,c,r.selectRange):vl.isDown(m)?u(cl,i,n,gl.down,l,c,fl):vl.isUp(m)?u(cl,i,n,gl.up,l,c,ll):Bt.none},function(t){function n(n){return function(){return to(n,function(n){return Aa.update(n.rows(),n.cols(),e,t,r)}).fold(function(){return ir(e,r.firstSelectedSelector(),r.lastSelectedSelector()).map(function(t){var n=vl.isDown(m)||s.isForward(m)?da.after:da.before;return i.setRelativeSelection(da.on(t.first(),0),n(t.table())),r.clear(e),Ra.create(Bt.none(),!0)})},function(t){return Bt.some(Ra.create(Bt.none(),!0))})}}return vl.isDown(m)&&g?n([wl(1,0)]):vl.isUp(m)&&g?n([wl(-1,0)]):s.isBackward(m)&&g?n([wl(0,-1),wl(-1,0)]):s.isForward(m)&&g?n([wl(0,1),wl(1,0)]):vl.isNavigation(m)&&0==g?o:Bt.none})()},keyup:function(t,o,i,u,c){return or(e,r.selectedSelector()).fold(function(){var a=t.raw(),l=a.which;return 0==(!0===a.shiftKey)?Bt.none():vl.isNavigation(l)?Aa.sync(e,n,o,i,u,c,r.selectRange):Bt.none()},Bt.none)}}},external:function(t,e,n,r){var o=dl(t);return function(t,i){r.clearBeforeUpdate(e),rr(t,i,n).each(function(t){var n=t.boxes().getOr([]);r.selectRange(e,n,t.start(),t.finish()),yl.deviceType.isTouch()?o.clearSelection():o.selectContents(i)})}}},Sl={byClass:function(t){function e(e){y(Nt(e,t.selectedSelector()),o)}var n,r=(n=t.selected(),function(t){oo(t,n)}),o=function(t){return function(e){ml(e,t)}}([t.selected(),t.lastSelected(),t.firstSelected()]);return{clearBeforeUpdate:e,clear:e,selectRange:function(n,o,i,u){e(n),y(o,r),oo(i,t.firstSelected()),oo(u,t.lastSelected())},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},byAttr:function(t,e,n){function r(e){Y(e,t.selected()),Y(e,t.firstSelected()),Y(e,t.lastSelected())}function o(e){U(e,t.selected(),"1")}function i(t){u(t),n()}var u=function(e){y(Nt(e,t.selectedSelector()),r)};return{clearBeforeUpdate:u,clear:i,selectRange:function(n,r,u,c){i(n),y(r,o),U(u,t.firstSelected(),"1"),U(c,t.lastSelected(),"1"),e(r,u,c)},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}}},xl={getOtherCells:function(t,e,n){var r=on(t),o=an.generate(r);return yo(o,e).map(function(t){var e=zi(o,n,!1);return{upOrLeftCells:function(t,e,n){return D(po(t.slice(0,e[e.length-1].row()+1),n),function(t){return w(t.cells().slice(0,e[e.length-1].column()+1),function(t){return t.element()})})}(e,t,n),downOrRightCells:function(t,e,n){return D(po(t.slice(e[0].row()+e[0].rowspan()-1,t.length),n),function(t){return w(t.cells().slice(e[0].column()+e[0].colspan()-1,+t.cells().length),function(t){return t.element()})})}(e,t,n)}})}},Rl=function(t){return!1===io(ee.fromDom(t.target),"ephox-snooker-resizer-bar")};var Tl=function(t){return{get:function(){return function(t,e){return or(t,e)}(Ru(t),cr.selectedSelector()).fold(function(){return void 0===t.selection.getStart()?fr.none():fr.single(t.selection)},function(t){return fr.multiple(t)})}}},Ol=function(t,e){function r(){return fc(t).bind(function(t){return rn.table(t).map(function(n){return"caption"===Jt(t)?gr.notCell(t):gr.forMenu(e,n,t)})})}function o(){u.set(Z(r)()),y(c.get(),function(t){return t()})}function i(t,e){function n(){return u.get().fold(function(){t.setDisabled(!0)},function(n){t.setDisabled(e(n))})}return n(),c.set(c.get().concat([n])),function(){c.set(C(c.get(),function(t){return t!==n}))}}var u=n(Bt.none()),c=n([]);return t.on("NodeChange",o),{onSetupTable:function(t){return i(t,function(t){return!1})},onSetupCellOrRow:function(t){return i(t,function(t){return"caption"===Jt(t.element())})},onSetupMergeable:function(t){return i(t,function(t){return t.mergable().isNone()})},onSetupUnmergeable:function(t){return i(t,function(t){return t.unmergable().isNone()})},resetTargets:o,targets:function(){return u.get()}}},Dl={addButtons:function(t,e){function n(e){return function(){return t.execCommand(e)}}t.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(t){return t("inserttable tableprops deletetable | cell row column")}}),t.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:n("mceTableProps"),icon:"table",onSetup:e.onSetupTable}),t.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:n("mceTableDelete"),icon:"table-delete-table",onSetup:e.onSetupTable}),t.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:n("mceTableCellProps"),icon:"table-cell-properties",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:n("mceTableMergeCells"),icon:"table-merge-cells",onSetup:e.onSetupMergeable}),t.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:n("mceTableSplitCells"),icon:"table-split-cells",onSetup:e.onSetupUnmergeable}),t.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:n("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:n("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:n("mceTableDeleteRow"),icon:"table-delete-row",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:n("mceTableRowProps"),icon:"table-row-properties",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:n("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:n("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:n("mceTableDeleteCol"),icon:"table-delete-column",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",onAction:n("mceTableCutRow"),icon:"temporary-placeholder",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",onAction:n("mceTableCopyRow"),icon:"temporary-placeholder",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",onAction:n("mceTablePasteRowBefore"),icon:"temporary-placeholder",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",onAction:n("mceTablePasteRowAfter"),icon:"temporary-placeholder",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:n("mceInsertTable"),icon:"table"})},addToolbars:function(t){var e=t.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol");0<e.length&&t.ui.registry.addContextToolbar("table",{predicate:function(e){return t.dom.is(e,"table")&&t.getBody().contains(e)},items:e,scope:"node",position:"node"})}},Al={addMenuItems:function(t,e){function n(e){return function(){return t.execCommand(e)}}function r(e){var n=e.numRows,r=e.numColumns;t.undoManager.transact(function(){ic(t,r,n)}),t.addVisual()}var o={text:"Table properties",onSetup:e.onSetupTable,onAction:n("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:e.onSetupTable,onAction:n("mceTableDelete")},u=[{type:"menuitem",text:"Insert row before",icon:"table-insert-row-above",onAction:n("mceTableInsertRowBefore"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Insert row after",icon:"table-insert-row-after",onAction:n("mceTableInsertRowAfter"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Delete row",icon:"table-delete-row",onAction:n("mceTableDeleteRow"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Row properties",icon:"table-row-properties",onAction:n("mceTableRowProps"),onSetup:e.onSetupCellOrRow},{type:"separator"},{type:"menuitem",text:"Cut row",onAction:n("mceTableCutRow"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Copy row",onAction:n("mceTableCopyRow"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Paste row before",onAction:n("mceTablePasteRowBefore"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Paste row after",onAction:n("mceTablePasteRowAfter"),onSetup:e.onSetupCellOrRow}],c={type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return u}},a=[{type:"menuitem",text:"Insert column before",icon:"table-insert-column-before",onAction:n("mceTableInsertColBefore"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Insert column after",icon:"table-insert-column-after",onAction:n("mceTableInsertColAfter"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Delete column",icon:"table-delete-column",onAction:n("mceTableDeleteCol"),onSetup:e.onSetupCellOrRow}],l={type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return a}},f=[{type:"menuitem",text:"Cell properties",icon:"table-cell-properties",onAction:n("mceTableCellProps"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Merge cells",icon:"table-merge-cells",onAction:n("mceTableMergeCells"),onSetup:e.onSetupMergeable},{type:"menuitem",text:"Split cell",icon:"table-split-cells",onAction:n("mceTableSplitCells"),onSetup:e.onSetupUnmergeable}],s={type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return f}};return!1===t.getParam("table_grid",!0,"boolean")?t.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:n("mceInsertTable")}):t.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:r}]}}),t.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:n("mceInsertTable")}),t.ui.registry.addMenuItem("tableprops",o),t.ui.registry.addMenuItem("deletetable",i),t.ui.registry.addNestedMenuItem("row",c),t.ui.registry.addNestedMenuItem("column",l),t.ui.registry.addNestedMenuItem("cell",s),t.ui.registry.addContextMenu("table",{update:function(){return e.resetTargets(),e.targets().fold(function(){return""},function(t){return"caption"===Jt(t.element())?"tableprops deletetable":"cell row column | tableprops deletetable"})}}),{rowItems:u,columnItems:a,cellItems:f}}},El=function(t,e,n,r,o){return{insertTable:function(e,n){return ic(t,e,n)},setClipboardRows:function(t){return function(t,e){var n=w(t,ee.fromDom);e.set(Bt.from(n))}(t,e)},getClipboardRows:function(){return e.get().fold(function(){},function(t){return w(t,function(t){return t.dom()})})},resizeHandler:n,menuItems:o,selectionTargets:r}};function Nl(t){var e=Tl(t),u=Ol(t,e),c=ia(t),a=function(t,e,u){var c=Gt(["mousedown","mouseover","mouseup","keyup","keydown"],[]),a=Bt.none(),l=Bu(t),f=Sl.byAttr(cr,function(e,n,o){u.targets().each(function(i){rn.table(n).each(function(u){var c=ee.fromDom(t.getDoc()),a=Nn.cellOperations(r,c,l),f=xl.getOtherCells(u,i,a);ku(t,e,n,o,f)})})},function(){Pu(t)});return t.on("init",function(u){var l=t.getWin(),s=Ru(t),d=Tu(t),m=Cl.mouse(l,s,d,f),g=Cl.keyboard(l,s,d,f),p=Cl.external(l,s,d,f);function h(e,n){!function(t){return!0===t.raw().shiftKey}(e)||(n.kill()&&e.kill(),n.selection().each(function(e){var n=ga.relative(e.start(),e.finish()),r=va(l,n);t.selection.setRng(r)}))}function v(e){var n=O(e);if(n.raw().shiftKey&&vl.isNavigation(n.raw().which)){var r=t.selection.getRng(),o=ee.fromDom(r.startContainer),i=ee.fromDom(r.endContainer);g.keyup(n,o,r.startOffset,i,r.endOffset).each(function(t){h(n,t)})}}function b(n){var r=O(n);e().each(function(t){t.hideBars()});var o=t.selection.getRng(),i=ee.fromDom(t.selection.getStart()),u=ee.fromDom(o.startContainer),c=ee.fromDom(o.endContainer),a=Au.directionAt(i).isRtl()?vl.rtl:vl.ltr;g.keydown(r,u,o.startOffset,c,o.endOffset,a).each(function(t){h(r,t)}),e().each(function(t){t.showBars()})}function w(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")}function y(t){return 0===t.button}function C(t){y(t)&&Rl(t)&&m.mousedown(O(t))}function S(t){(function(t){return void 0===t.buttons||0!=(1&t.buttons)})(t)&&Rl(t)&&m.mouseover(O(t))}function x(t){y(t)&&Rl(t)&&m.mouseup(O(t))}t.on("tableselectorchange",function(t){p(t.start,t.finish)});var R,T,O=function(t){function e(){t.stopPropagation()}function n(){t.preventDefault()}var r=ee.fromDom(t.target),u=o(n,e);return{target:i(r),x:i(w(t)?t.x:null),y:i(w(t)?t.y:null),stop:e,prevent:n,kill:u,raw:i(t)}},D=(R=n(ee.fromDom(s)),T=n(0),{touchEnd:function(t){var e=ee.fromDom(t.target);if("td"===Jt(e)||"th"===Jt(e)){var n=R.get(),r=T.get();Ae(n,e)&&t.timeStamp-r<300&&(t.preventDefault(),p(e,e))}R.set(e),T.set(t.timeStamp)}});t.on("mousedown",C),t.on("mouseover",S),t.on("mouseup",x),t.on("touchend",D.touchEnd),t.on("keyup",v),t.on("keydown",b),t.on("NodeChange",function(){var e=t.selection,n=ee.fromDom(e.getStart()),o=ee.fromDom(e.getEnd());er.sharedOne(rn.table,[n,o]).fold(function(){f.clear(s)},r)}),a=Bt.some(c({mousedown:C,mouseover:S,mouseup:x,keyup:v,keydown:b}))}),{clear:f.clear,destroy:function(){a.each(function(t){})}}}(t,c.lazyResize,u),l=Mu(t,c.lazyWire),f=n(Bt.none());dc.registerCommands(t,l,a,e,f),pr.registerEvents(t,e,l,a);var s=Al.addMenuItems(t,u);return Dl.addButtons(t,u),Dl.addToolbars(t),t.on("PreInit",function(){t.serializer.addTempAttr(cr.firstSelected()),t.serializer.addTempAttr(cr.lastSelected())}),Iu(t)&&t.on("keydown",function(e){xa.handle(e,t,l,c.lazyWire)}),t.on("remove",function(){c.destroy(),a.destroy()}),El(t,f,c,u,s)}kt.add("table",Nl)}(window);
//# sourceMappingURL=plugin.min.js.map
