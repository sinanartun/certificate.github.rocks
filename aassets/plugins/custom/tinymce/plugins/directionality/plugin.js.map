{"version":3,"sources":["directionality/plugin.js"],"names":["domGlobals","eq","call","id","me","t","global","tinymce","util","Tools","resolve","global$1","Direction","editor","dir","curDir","dom","blocks","selection","getSelectedBlocks","length","getAttrib","each","block","getParent","parentNode","getRoot","setAttrib","nodeChanged","Commands","register","addCommand","noop","constant","value","never","always","none","NONE","o","isNone","fold","n","s","is","isSome","getOr","getOrThunk","thunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","bind","exists","forall","filter","equals","equals_","toArray","toString","Object","freeze","some","a","constant_a","self","f","v","elementEq","b","Option","fromDom","node","Element","fromHtml","html","scope","div","document","createElement","innerHTML","hasChildNodes","childNodes","console","error","fromTag","tag","fromText","text","createTextNode","fromPoint","docElm","x","y","doc","elementFromPoint","isFunction","type","Array","prototype","isPrototypeOf","constructor","name","String","typeOf","isType","nativeSlice","slice","TEXT","from","Node","ATTRIBUTE_NODE","CDATA_SECTION_NODE","COMMENT_NODE","DOCUMENT_NODE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT_NODE","ELEMENT_NODE","TEXT_NODE","isText","PROCESSING_INSTRUCTION_NODE","ENTITY_REFERENCE_NODE","ENTITY_NODE","NOTATION_NODE","window","Function","element","nodeType","get","property","r","getComputedStyle","getPropertyValue","ownerDocument","body","contains","inBody","getUnsafeProperty","style","isSupported","getNodeChangeHandler","api","nodeChangeHandler","e","setActive","getDirection","on","off","Buttons","ui","registry","addToggleButton","tooltip","icon","onAction","execCommand","onSetup","add"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var setDir = function (editor, dir) {\n      var dom = editor.dom;\n      var curDir;\n      var blocks = editor.selection.getSelectedBlocks();\n      if (blocks.length) {\n        curDir = dom.getAttrib(blocks[0], 'dir');\n        global$1.each(blocks, function (block) {\n          if (!dom.getParent(block.parentNode, '*[dir=\"' + dir + '\"]', dom.getRoot())) {\n            dom.setAttrib(block, 'dir', curDir !== dir ? dir : null);\n          }\n        });\n        editor.nodeChanged();\n      }\n    };\n    var Direction = { setDir: setDir };\n\n    var register = function (editor) {\n      editor.addCommand('mceDirectionLTR', function () {\n        Direction.setDir(editor, 'ltr');\n      });\n      editor.addCommand('mceDirectionRTL', function () {\n        Direction.setDir(editor, 'rtl');\n      });\n    };\n    var Commands = { register: register };\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        domGlobals.console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: constant(node) };\n    };\n    var fromPoint = function (docElm, x, y) {\n      var doc = docElm.dom();\n      return Option.from(doc.elementFromPoint(x, y)).map(fromDom);\n    };\n    var Element = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isFunction = isType('function');\n\n    var nativeSlice = Array.prototype.slice;\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var isSupported = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var ATTRIBUTE = domGlobals.Node.ATTRIBUTE_NODE;\n    var CDATA_SECTION = domGlobals.Node.CDATA_SECTION_NODE;\n    var COMMENT = domGlobals.Node.COMMENT_NODE;\n    var DOCUMENT = domGlobals.Node.DOCUMENT_NODE;\n    var DOCUMENT_TYPE = domGlobals.Node.DOCUMENT_TYPE_NODE;\n    var DOCUMENT_FRAGMENT = domGlobals.Node.DOCUMENT_FRAGMENT_NODE;\n    var ELEMENT = domGlobals.Node.ELEMENT_NODE;\n    var TEXT = domGlobals.Node.TEXT_NODE;\n    var PROCESSING_INSTRUCTION = domGlobals.Node.PROCESSING_INSTRUCTION_NODE;\n    var ENTITY_REFERENCE = domGlobals.Node.ENTITY_REFERENCE_NODE;\n    var ENTITY = domGlobals.Node.ENTITY_NODE;\n    var NOTATION = domGlobals.Node.NOTATION_NODE;\n\n    var Global = typeof domGlobals.window !== 'undefined' ? domGlobals.window : Function('return this;')();\n\n    var type = function (element) {\n      return element.dom().nodeType;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isText = isType$1(TEXT);\n\n    var inBody = function (element) {\n      var dom = isText(element) ? element.dom().parentNode : element.dom();\n      return dom !== undefined && dom !== null && dom.ownerDocument.body.contains(dom);\n    };\n\n    var get = function (element, property) {\n      var dom = element.dom();\n      var styles = domGlobals.window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      var v = r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n      return v === null ? undefined : v;\n    };\n    var getUnsafeProperty = function (dom, property) {\n      return isSupported(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n\n    var getDirection = function (element) {\n      return get(element, 'direction') === 'rtl' ? 'rtl' : 'ltr';\n    };\n\n    var getNodeChangeHandler = function (editor, dir) {\n      return function (api) {\n        var nodeChangeHandler = function (e) {\n          var element = Element.fromDom(e.element);\n          api.setActive(getDirection(element) === dir);\n        };\n        editor.on('NodeChange', nodeChangeHandler);\n        return function () {\n          return editor.off('NodeChange', nodeChangeHandler);\n        };\n      };\n    };\n    var register$1 = function (editor) {\n      editor.ui.registry.addToggleButton('ltr', {\n        tooltip: 'Left to right',\n        icon: 'ltr',\n        onAction: function () {\n          return editor.execCommand('mceDirectionLTR');\n        },\n        onSetup: getNodeChangeHandler(editor, 'ltr')\n      });\n      editor.ui.registry.addToggleButton('rtl', {\n        tooltip: 'Right to left',\n        icon: 'rtl',\n        onAction: function () {\n          return editor.execCommand('mceDirectionRTL');\n        },\n        onSetup: getNodeChangeHandler(editor, 'rtl')\n      });\n    };\n    var Buttons = { register: register$1 };\n\n    function Plugin () {\n      global.add('directionality', function (editor) {\n        Commands.register(editor);\n        Buttons.register(editor);\n      });\n    }\n\n    Plugin();\n\n}(window));\n"]}