{"version":3,"sources":["toc/plugin.min.js"],"names":["e","n","t","setDisabled","readonly","v","hasHeaders","on","tinymce","util","Tools","resolve","u","l","i","c","getParam","d","test","s","Date","getTime","toString","m","o","push","join","f","parseInt","a","r","$","length","filter","dom","hasClass","parentNode","map","id","level","nodeName","replace","title","text","element","DOM","encode","translate","undoManager","transact","html","insertToc","getParents","insertContent","updateToc","add","addCommand","ui","registry","addButton","icon","tooltip","onAction","execCommand","onSetup","addMenuItem","addContextToolbar","items","predicate","is","getBody","contains","scope","position","h","node","removeAttr","find","attr","children","g"],"mappings":"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","file":"plugin.min.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n!function(){\"use strict\";function e(n){return function(t){function e(){return t.setDisabled(n.readonly||!v.hasHeaders(n))}return e(),n.on(\"LoadContent SetContent change\",e),function(){return n.on(\"LoadContent SetContent change\",e)}}}var t=tinymce.util.Tools.resolve(\"tinymce.PluginManager\"),u=tinymce.util.Tools.resolve(\"tinymce.dom.DOMUtils\"),l=tinymce.util.Tools.resolve(\"tinymce.util.I18n\"),i=tinymce.util.Tools.resolve(\"tinymce.util.Tools\"),c=function(t){return t.getParam(\"toc_class\",\"mce-toc\")},d=function(t){var e=t.getParam(\"toc_header\",\"h2\");return/^h[1-6]$/.test(e)?e:\"h2\"},a=function(t){var e=parseInt(t.getParam(\"toc_depth\",\"3\"),10);return 1<=e&&e<=9?e:3},s=function(e){var n=0;return function(){var t=(new Date).getTime().toString(32);return e+t+(n++).toString(32)}}(\"mcetoc_\"),f=function f(t){var e,n=[];for(e=1;e<=t;e++)n.push(\"h\"+e);return n.join(\",\")},m=function(n){var o=c(n),t=d(n),e=f(a(n)),r=n.$(e);return r.length&&/^h[1-9]$/i.test(t)&&(r=r.filter(function(t,e){return!n.dom.hasClass(e.parentNode,o)})),i.map(r,function(t){return{id:t.id?t.id:s(),level:parseInt(t.nodeName.replace(/^H/i,\"\"),10),title:n.$.text(t),element:t}})},o=function(t){var e,n,o,r,i=\"\",c=m(t),a=function(t){var e,n=9;for(e=0;e<t.length;e++)if(t[e].level<n&&(n=t[e].level),1===n)return n;return n}(c)-1;if(!c.length)return\"\";for(i+=function(t,e){var n=\"</\"+t+\">\";return\"<\"+t+' contenteditable=\"true\">'+u.DOM.encode(e)+n}(d(t),l.translate(\"Table of Contents\")),e=0;e<c.length;e++){if((o=c[e]).element.id=o.id,r=c[e+1]&&c[e+1].level,a===o.level)i+=\"<li>\";else for(n=a;n<o.level;n++)i+=\"<ul><li>\";if(i+='<a href=\"#'+o.id+'\">'+o.title+\"</a>\",r!==o.level&&r)for(n=o.level;r<n;n--)i+=\"</li></ul><li>\";else i+=\"</li>\",r||(i+=\"</ul>\");a=o.level}return i},r=function(t){var e=c(t),n=t.$(\".\"+e);n.length&&t.undoManager.transact(function(){n.html(o(t))})},v={hasHeaders:function(t){return 0<m(t).length},insertToc:function(t){var e=c(t),n=t.$(\".\"+e);!function(t,e){return!e.length||0<t.dom.getParents(e[0],\".mce-offscreen-selection\").length}(t,n)?r(t):t.insertContent(function(t){var e=o(t);return'<div class=\"'+t.dom.encode(c(t))+'\" contenteditable=\"false\">'+e+\"</div>\"}(t))},updateToc:r},n=function(t){t.addCommand(\"mceInsertToc\",function(){v.insertToc(t)}),t.addCommand(\"mceUpdateToc\",function(){v.updateToc(t)})},g=function(t){var n=t.$,o=c(t);t.on(\"PreProcess\",function(t){var e=n(\".\"+o,t.node);e.length&&(e.removeAttr(\"contentEditable\"),e.find(\"[contenteditable]\").removeAttr(\"contentEditable\"))}),t.on(\"SetContent\",function(){var t=n(\".\"+o);t.length&&(t.attr(\"contentEditable\",!1),t.children(\":first-child\").attr(\"contentEditable\",!0))})},h=function(t){t.ui.registry.addButton(\"toc\",{icon:\"toc\",tooltip:\"Table of contents\",onAction:function(){return t.execCommand(\"mceInsertToc\")},onSetup:e(t)}),t.ui.registry.addButton(\"tocupdate\",{icon:\"reload\",tooltip:\"Update\",onAction:function(){return t.execCommand(\"mceUpdateToc\")}}),t.ui.registry.addMenuItem(\"toc\",{icon:\"toc\",text:\"Table of contents\",onAction:function(){return t.execCommand(\"mceInsertToc\")},onSetup:e(t)}),t.ui.registry.addContextToolbar(\"toc\",{items:\"tocupdate\",predicate:function(e){return function(t){return t&&e.dom.is(t,\".\"+c(e))&&e.getBody().contains(t)}}(t),scope:\"node\",position:\"node\"})};!function p(){t.add(\"toc\",function(t){n(t),h(t),g(t)})}()}();"]}