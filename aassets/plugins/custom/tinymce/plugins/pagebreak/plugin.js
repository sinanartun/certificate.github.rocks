!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env"),a=function(e){return e.getParam("pagebreak_separator","\x3c!-- pagebreak --\x3e")},n=function(e){return e.getParam("pagebreak_split_block",!1)},r=function(){return"mce-pagebreak"},o=function(){return'<img src="'+t.transparentSrc+'" class="mce-pagebreak" data-mce-resize="false" data-mce-placeholder />'},i={setup:function(e){var t=a(e),r=new RegExp(t.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(e){return"\\"+e}),"gi");e.on("BeforeSetContent",function(e){e.content=e.content.replace(r,o())}),e.on("PreInit",function(){e.serializer.addNodeFilter("img",function(a){for(var r,o,i=a.length;i--;)if((o=(r=a[i]).attr("class"))&&-1!==o.indexOf("mce-pagebreak")){var c=r.parent;if(e.schema.getBlockElements()[c.name]&&n(e)){c.type=3,c.value=t,c.raw=!0,r.remove();continue}r.type=3,r.value=t,r.raw=!0}})})},getPlaceholderHtml:o,getPageBreakClass:r},c={register:function(e){e.addCommand("mcePageBreak",function(){e.settings.pagebreak_split_block?e.insertContent("<p>"+i.getPlaceholderHtml()+"</p>"):e.insertContent(i.getPlaceholderHtml())})}},g={setup:function(e){e.on("ResolveName",function(t){"IMG"===t.target.nodeName&&e.dom.hasClass(t.target,i.getPageBreakClass())&&(t.name="pagebreak")})}},s={register:function(e){e.ui.registry.addButton("pagebreak",{icon:"page-break",tooltip:"Page break",onAction:function(){return e.execCommand("mcePageBreak")}}),e.ui.registry.addMenuItem("pagebreak",{text:"Page break",icon:"page-break",onAction:function(){return e.execCommand("mcePageBreak")}})}};e.add("pagebreak",function(e){c.register(e),s.register(e),i.setup(e),g.setup(e)})}();
//# sourceMappingURL=plugin.js.map
