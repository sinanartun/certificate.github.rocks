!function(){"use strict";var e=function(t){var n=t,r=function(){return n};return{get:r,set:function(e){n=e},clone:function(){return e(r())}}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=tinymce.util.Tools.resolve("tinymce.util.Tools");function o(e){return e&&1===e.nodeType&&"false"===e.contentEditable}var a,i,c,u,d,l={findAndReplaceDOMText:function(e,t,n,r,a){var i,c,u,d,l,s,f=[],g=0;function m(e,t){if(t=t||0,!e[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");var n=e.index;if(t>0){var r=e[t];if(!r)throw new Error("Invalid capture group");n+=e[0].indexOf(r),e[0]=r}return[n,n+e[0].length,[e[0]]]}if(u=t.ownerDocument,d=a.getBlockElements(),l=a.getWhiteSpaceElements(),s=a.getShortEndedElements(),c=function e(t){var n;if(3===t.nodeType)return t.data;if(l[t.nodeName]&&!d[t.nodeName])return"";if(n="",o(t))return"\n";if((d[t.nodeName]||s[t.nodeName])&&(n+="\n"),t=t.firstChild)do{n+=e(t)}while(t=t.nextSibling);return n}(t)){if(e.global)for(;i=e.exec(c);)f.push(m(i,r));else i=c.match(e),f.push(m(i,r));return f.length&&(g=f.length,function(e,t,n){var r,a,i,c,u=[],f=0,g=e,m=t.shift(),p=0;e:for(;;){if((d[g.nodeName]||s[g.nodeName]||o(g))&&f++,3===g.nodeType&&(!a&&g.length+f>=m[1]?(a=g,c=m[1]-f):r&&u.push(g),!r&&g.length+f>m[0]&&(r=g,i=m[0]-f),f+=g.length),r&&a){if(g=n({startNode:r,startNodeIndex:i,endNode:a,endNodeIndex:c,innerNodes:u,match:m[2],matchIndex:p}),f-=a.length-c,r=null,a=null,u=[],p++,!(m=t.shift()))break}else if(l[g.nodeName]&&!d[g.nodeName]||!g.firstChild){if(g.nextSibling){g=g.nextSibling;continue}}else if(!o(g)){g=g.firstChild;continue}for(;;){if(g.nextSibling){g=g.nextSibling;break}if(g.parentNode===e)break e;g=g.parentNode}}}(t,f,function(e){var t;if("function"!=typeof e){var n=e.nodeType?e:u.createElement(e);t=function(e,t){var r=n.cloneNode(!1);return r.setAttribute("data-mce-index",t),e&&r.appendChild(u.createTextNode(e)),r}}else t=e;return function(e){var n,r,o,a=e.startNode,i=e.endNode,c=e.matchIndex;if(a===i){var d=a;o=d.parentNode,e.startNodeIndex>0&&(n=u.createTextNode(d.data.substring(0,e.startNodeIndex)),o.insertBefore(n,d));var l=t(e.match[0],c);return o.insertBefore(l,d),e.endNodeIndex<d.length&&(r=u.createTextNode(d.data.substring(e.endNodeIndex)),o.insertBefore(r,d)),d.parentNode.removeChild(d),l}n=u.createTextNode(a.data.substring(0,e.startNodeIndex)),r=u.createTextNode(i.data.substring(e.endNodeIndex));for(var s=t(a.data.substring(e.startNodeIndex),c),f=0,g=e.innerNodes.length;f<g;++f){var m=e.innerNodes[f],p=t(m.data,c);m.parentNode.replaceChild(p,m)}var h=t(i.data.substring(0,e.endNodeIndex),c);return(o=a.parentNode).insertBefore(n,a),o.insertBefore(s,a),o.removeChild(a),(o=i.parentNode).insertBefore(h,i),o.insertBefore(r,i),o.removeChild(i),h}}(n))),g}}},s=function(e){var t=e.getAttribute("data-mce-index");return"number"==typeof t?""+t:t},f=function(e){var t=e.parentNode;e.firstChild&&t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)},g=function(e,t){var n,o=[];if((n=r.toArray(e.getBody().getElementsByTagName("span"))).length)for(var a=0;a<n.length;a++){var i=s(n[a]);null!==i&&i.length&&(i===t.toString()&&o.push(n[a]))}return o},m=function(e,t,n){var r=t.get(),o=r.index,a=e.dom;(n=!1!==n)?o+1===r.count?o=0:o++:o-1==-1?o=r.count-1:o--,a.removeClass(g(e,r.index),"mce-match-marker-selected");var i=g(e,o);return i.length?(a.addClass(g(e,o),"mce-match-marker-selected"),e.selection.scrollIntoView(i[0]),o):-1},p=function(e,t){var n=t.parentNode;e.remove(t),e.isEmpty(n)&&e.remove(n)},h=function(e,t,n,r,o){n=(n=n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")).replace(/\s/g,"[^\\S\\r\\n]"),n=o?"\\b"+n+"\\b":n;var a=function(e,t,n){var r,o;return(o=e.dom.create("span",{"data-mce-bogus":1})).className="mce-match-marker",r=e.getBody(),N(e,t,!1),l.findAndReplaceDOMText(n,r,o,!1,e.schema)}(e,t,new RegExp(n,r?"g":"gi"));if(a){var i=m(e,t,!0);t.set({index:i,count:a,text:n,matchCase:r,wholeWord:o})}return a},x=function(e,t){var r=m(e,t,!0);t.set(n(n({},t.get()),{index:r}))},v=function(e,t){var r=m(e,t,!1);t.set(n(n({},t.get()),{index:r}))},b=function(e){var t=s(e);return null!==t&&t.length>0},y=function(e,t,o,a,i){var c,u,d,l,g,m=t.get(),h=m.index,y=h;for(a=!1!==a,d=e.getBody(),u=r.grep(r.toArray(d.getElementsByTagName("span")),b),c=0;c<u.length;c++){var N=s(u[c]);if(l=g=parseInt(N,10),i||l===m.index){for(o.length?(u[c].firstChild.nodeValue=o,f(u[c])):p(e.dom,u[c]);u[++c];){if((l=parseInt(s(u[c]),10))!==g){c--;break}p(e.dom,u[c])}a&&y--}else g>h&&u[c].setAttribute("data-mce-index",String(g-1))}return t.set(n(n({},m),{count:i?0:m.count-1,index:y})),a?x(e,t):v(e,t),!i&&t.get().count>0},N=function(e,t,o){var a,i,c,u,d=t.get();for(i=r.toArray(e.getBody().getElementsByTagName("span")),a=0;a<i.length;a++){var l=s(i[a]);null!==l&&l.length&&(l===d.index.toString()&&(c||(c=i[a].firstChild),u=i[a].firstChild),f(i[a]))}if(t.set(n(n({},d),{index:-1,count:0,text:""})),c&&u){var g=e.dom.createRng();return g.setStart(c,0),g.setEnd(u,u.data.length),!1!==o&&e.selection.setRng(g),g}},w=function(e,t){return t.get().count>1},C=function(e,t){return t.get().count>1},O={get:function(e,t){return{done:function(n){return N(e,t,n)},find:function(n,r,o){return h(e,t,n,r,o)},next:function(){return x(e,t)},prev:function(){return v(e,t)},replace:function(n,r,o){return y(e,t,n,r,o)}}}},S=function(){},T=function(e){return function(){return e}},A=T(!1),B=T(!0),I=function(){return k},k=(a=function(e){return e.isNone()},u={fold:function(e,t){return e()},is:A,isSome:A,isNone:B,getOr:c=function(e){return e},getOrThunk:i=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:T(null),getOrUndefined:T(void 0),or:c,orThunk:i,map:I,each:S,bind:I,exists:A,forall:B,filter:I,equals:a,equals_:a,toArray:function(){return[]},toString:T("none()")},Object.freeze&&Object.freeze(u),u),E=function(e){var t=T(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:B,isNone:A,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return E(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:k},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(A,function(t){return n(e,t)})}};return o},M={some:E,none:I,from:function(e){return null==e?k:E(e)}},R=(d="function",function(e){return function(e){if(null===e)return"null";var t=typeof e;return"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t}(e)===d}),D=Array.prototype.slice,F=(R(Array.from)&&Array.from,function(t,n){var o,a=(o=e(M.none()),{clear:function(){o.set(M.none())},set:function(e){o.set(M.some(e))},isSet:function(){return o.get().isSome()},on:function(e){o.get().each(e)}});t.undoManager.add();var i=r.trim(t.selection.getContent({format:"text"}));function c(e){(w(t,n)?e.enable:e.disable)("next"),(C(t,n)?e.enable:e.disable)("prev")}var u=function(e,t){!function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}(["replace","replaceall","prev","next"],t?e.disable:e.enable)};var d=function(e){N(t,n,!1),u(e,!0),c(e)},l=function(e){var r=e.getData(),o=n.get();if(r.findtext.length){if(o.text===r.findtext&&o.matchCase===r.matchcase&&o.wholeWord===r.wholewords)x(t,n);else{var a=h(t,n,r.findtext,r.matchcase,r.wholewords);a<=0&&function(e){t.windowManager.alert("Could not find the specified string.",function(){e.focus("findtext")})}(e),u(e,0===a)}c(e)}else d(e)},s=n.get(),f={title:"Find and Replace",size:"normal",body:{type:"panel",items:[{type:"bar",items:[{type:"input",name:"findtext",placeholder:"Find",maximized:!0,inputMode:"search"},{type:"button",name:"prev",text:"Previous",icon:"action-prev",disabled:!0,borderless:!0},{type:"button",name:"next",text:"Next",icon:"action-next",disabled:!0,borderless:!0}]},{type:"input",name:"replacetext",placeholder:"Replace with",inputMode:"search"}]},buttons:[{type:"menu",name:"options",icon:"preferences",tooltip:"Preferences",align:"start",items:[{type:"togglemenuitem",name:"matchcase",text:"Match case"},{type:"togglemenuitem",name:"wholewords",text:"Find whole words only"}]},{type:"custom",name:"find",text:"Find",primary:!0},{type:"custom",name:"replace",text:"Replace",disabled:!0},{type:"custom",name:"replaceall",text:"Replace All",disabled:!0}],initialData:{findtext:i,replacetext:"",wholewords:s.wholeWord,matchcase:s.matchCase},onChange:function(e,t){"findtext"===t.name&&n.get().count>0&&d(e)},onAction:function(e,r){var o=e.getData();switch(r.name){case"find":l(e);break;case"replace":y(t,n,o.replacetext)?c(e):d(e);break;case"replaceall":y(t,n,o.replacetext,!0,!0),d(e);break;case"prev":v(t,n),c(e);break;case"next":x(t,n),c(e)}},onSubmit:l,onClose:function(){t.focus(),N(t,n),t.undoManager.add()}};a.set(t.windowManager.open(f,{inline:"toolbar"}))}),j={register:function(e,t){e.addCommand("SearchReplace",function(){F(e,t)})}},P=function(e,t){return function(){F(e,t)}},z={register:function(e,t){e.ui.registry.addMenuItem("searchreplace",{text:"Find and replace...",shortcut:"Meta+F",onAction:P(e,t),icon:"search"}),e.ui.registry.addButton("searchreplace",{tooltip:"Find and replace",onAction:P(e,t),icon:"search"}),e.shortcuts.add("Meta+F","",P(e,t))}};t.add("searchreplace",function(t){var n=e({index:-1,count:0,text:"",matchCase:!1,wholeWord:!1});return j.register(t,n),z.register(t,n),O.get(t,n)})}();
//# sourceMappingURL=plugin.js.map
