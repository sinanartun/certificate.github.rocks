{"version":3,"sources":["searchreplace/plugin.js"],"names":["Cell","initial","value","get","set","v","clone","global","tinymce","util","Tools","resolve","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","global$1","isContentEditableFalse","node","nodeType","contentEditable","eq","id","me","type","FindReplaceText","findAndReplaceDOMText","regex","replacementNode","captureGroup","schema","m","text","doc","blockElementsMap","hiddenTextElementsMap","shortEndedElementsMap","matches","count","getMatchIndexes","Error","index","cg","indexOf","ownerDocument","getBlockElements","getWhiteSpaceElements","getShortEndedElements","getText","txt","data","nodeName","firstChild","nextSibling","exec","push","match","replaceFn","startNode","endNode","startNodeIndex","endNodeIndex","innerNodes","atIndex","curNode","matchLocation","shift","matchIndex","out","parentNode","stepThroughMatches","makeReplacementNode","stencilNode_1","createElement","fill","cloneNode","setAttribute","appendChild","createTextNode","range","before","after","node_1","substring","insertBefore","el","removeChild","elA","l","innerNode","innerEl","replaceChild","elB","genReplacer","getElmIndex","elm","getAttribute","unwrap","findSpansByIndex","editor","nodes","spans","toArray","getBody","getElementsByTagName","nodeIndex","toString","moveSelection","currentSearchState","forward","searchState","testIndex","dom","removeClass","addClass","selection","scrollIntoView","removeNode","parent","remove","isEmpty","find","matchCase","wholeWord","replace","marker","create","data-mce-bogus","className","done","markAllMatches","RegExp","newIndex","next","prev","isMatchSpan","all","currentMatchIndex","currentIndex","nextIndex","grep","parseInt","nodeValue","String","keepEditorSelection","startContainer","endContainer","rng","createRng","setStart","setEnd","setRng","hasNext","hasPrev","Api","currentState","noop","constant","never","always","none","NONE","o","isNone","fold","is","isSome","getOr","getOrThunk","thunk","getOrDie","msg","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","freeze","some","a","constant_a","self","f","elementEq","b","Option","from","isFunction","x","Array","isPrototypeOf","constructor","name","typeOf","nativeSlice","slice","Dialog","subject","dialogApi","clear","isSet","on","undoManager","add","selectedText","trim","getContent","format","updateButtonStates","api","enable","disable","disableAll","xs","len","reset","doFind","getData","last","findtext","matchcase","wholewords","windowManager","alert","focus","notFoundAlert","initialState","spec","title","size","body","items","placeholder","maximized","inputMode","icon","disabled","borderless","buttons","tooltip","align","primary","initialData","replacetext","onChange","details","onAction","onSubmit","onClose","open","inline","Commands","register","addCommand","showDialog","Buttons","ui","registry","addMenuItem","shortcut","addButton","shortcuts"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function () {\n    'use strict';\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      var clone = function () {\n        return Cell(get());\n      };\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    function isContentEditableFalse(node) {\n      return node && node.nodeType === 1 && node.contentEditable === 'false';\n    }\n    function findAndReplaceDOMText(regex, node, replacementNode, captureGroup, schema) {\n      var m;\n      var matches = [];\n      var text, count = 0, doc;\n      var blockElementsMap, hiddenTextElementsMap, shortEndedElementsMap;\n      doc = node.ownerDocument;\n      blockElementsMap = schema.getBlockElements();\n      hiddenTextElementsMap = schema.getWhiteSpaceElements();\n      shortEndedElementsMap = schema.getShortEndedElements();\n      function getMatchIndexes(m, captureGroup) {\n        captureGroup = captureGroup || 0;\n        if (!m[0]) {\n          throw new Error('findAndReplaceDOMText cannot handle zero-length matches');\n        }\n        var index = m.index;\n        if (captureGroup > 0) {\n          var cg = m[captureGroup];\n          if (!cg) {\n            throw new Error('Invalid capture group');\n          }\n          index += m[0].indexOf(cg);\n          m[0] = cg;\n        }\n        return [\n          index,\n          index + m[0].length,\n          [m[0]]\n        ];\n      }\n      function getText(node) {\n        var txt;\n        if (node.nodeType === 3) {\n          return node.data;\n        }\n        if (hiddenTextElementsMap[node.nodeName] && !blockElementsMap[node.nodeName]) {\n          return '';\n        }\n        txt = '';\n        if (isContentEditableFalse(node)) {\n          return '\\n';\n        }\n        if (blockElementsMap[node.nodeName] || shortEndedElementsMap[node.nodeName]) {\n          txt += '\\n';\n        }\n        if (node = node.firstChild) {\n          do {\n            txt += getText(node);\n          } while (node = node.nextSibling);\n        }\n        return txt;\n      }\n      function stepThroughMatches(node, matches, replaceFn) {\n        var startNode, endNode, startNodeIndex, endNodeIndex, innerNodes = [], atIndex = 0, curNode = node, matchLocation = matches.shift(), matchIndex = 0;\n        out:\n          while (true) {\n            if (blockElementsMap[curNode.nodeName] || shortEndedElementsMap[curNode.nodeName] || isContentEditableFalse(curNode)) {\n              atIndex++;\n            }\n            if (curNode.nodeType === 3) {\n              if (!endNode && curNode.length + atIndex >= matchLocation[1]) {\n                endNode = curNode;\n                endNodeIndex = matchLocation[1] - atIndex;\n              } else if (startNode) {\n                innerNodes.push(curNode);\n              }\n              if (!startNode && curNode.length + atIndex > matchLocation[0]) {\n                startNode = curNode;\n                startNodeIndex = matchLocation[0] - atIndex;\n              }\n              atIndex += curNode.length;\n            }\n            if (startNode && endNode) {\n              curNode = replaceFn({\n                startNode: startNode,\n                startNodeIndex: startNodeIndex,\n                endNode: endNode,\n                endNodeIndex: endNodeIndex,\n                innerNodes: innerNodes,\n                match: matchLocation[2],\n                matchIndex: matchIndex\n              });\n              atIndex -= endNode.length - endNodeIndex;\n              startNode = null;\n              endNode = null;\n              innerNodes = [];\n              matchLocation = matches.shift();\n              matchIndex++;\n              if (!matchLocation) {\n                break;\n              }\n            } else if ((!hiddenTextElementsMap[curNode.nodeName] || blockElementsMap[curNode.nodeName]) && curNode.firstChild) {\n              if (!isContentEditableFalse(curNode)) {\n                curNode = curNode.firstChild;\n                continue;\n              }\n            } else if (curNode.nextSibling) {\n              curNode = curNode.nextSibling;\n              continue;\n            }\n            while (true) {\n              if (curNode.nextSibling) {\n                curNode = curNode.nextSibling;\n                break;\n              } else if (curNode.parentNode !== node) {\n                curNode = curNode.parentNode;\n              } else {\n                break out;\n              }\n            }\n          }\n      }\n      function genReplacer(nodeName) {\n        var makeReplacementNode;\n        if (typeof nodeName !== 'function') {\n          var stencilNode_1 = nodeName.nodeType ? nodeName : doc.createElement(nodeName);\n          makeReplacementNode = function (fill, matchIndex) {\n            var clone = stencilNode_1.cloneNode(false);\n            clone.setAttribute('data-mce-index', matchIndex);\n            if (fill) {\n              clone.appendChild(doc.createTextNode(fill));\n            }\n            return clone;\n          };\n        } else {\n          makeReplacementNode = nodeName;\n        }\n        return function (range) {\n          var before;\n          var after;\n          var parentNode;\n          var startNode = range.startNode;\n          var endNode = range.endNode;\n          var matchIndex = range.matchIndex;\n          if (startNode === endNode) {\n            var node_1 = startNode;\n            parentNode = node_1.parentNode;\n            if (range.startNodeIndex > 0) {\n              before = doc.createTextNode(node_1.data.substring(0, range.startNodeIndex));\n              parentNode.insertBefore(before, node_1);\n            }\n            var el = makeReplacementNode(range.match[0], matchIndex);\n            parentNode.insertBefore(el, node_1);\n            if (range.endNodeIndex < node_1.length) {\n              after = doc.createTextNode(node_1.data.substring(range.endNodeIndex));\n              parentNode.insertBefore(after, node_1);\n            }\n            node_1.parentNode.removeChild(node_1);\n            return el;\n          }\n          before = doc.createTextNode(startNode.data.substring(0, range.startNodeIndex));\n          after = doc.createTextNode(endNode.data.substring(range.endNodeIndex));\n          var elA = makeReplacementNode(startNode.data.substring(range.startNodeIndex), matchIndex);\n          for (var i = 0, l = range.innerNodes.length; i < l; ++i) {\n            var innerNode = range.innerNodes[i];\n            var innerEl = makeReplacementNode(innerNode.data, matchIndex);\n            innerNode.parentNode.replaceChild(innerEl, innerNode);\n          }\n          var elB = makeReplacementNode(endNode.data.substring(0, range.endNodeIndex), matchIndex);\n          parentNode = startNode.parentNode;\n          parentNode.insertBefore(before, startNode);\n          parentNode.insertBefore(elA, startNode);\n          parentNode.removeChild(startNode);\n          parentNode = endNode.parentNode;\n          parentNode.insertBefore(elB, endNode);\n          parentNode.insertBefore(after, endNode);\n          parentNode.removeChild(endNode);\n          return elB;\n        };\n      }\n      text = getText(node);\n      if (!text) {\n        return;\n      }\n      if (regex.global) {\n        while (m = regex.exec(text)) {\n          matches.push(getMatchIndexes(m, captureGroup));\n        }\n      } else {\n        m = text.match(regex);\n        matches.push(getMatchIndexes(m, captureGroup));\n      }\n      if (matches.length) {\n        count = matches.length;\n        stepThroughMatches(node, matches, genReplacer(replacementNode));\n      }\n      return count;\n    }\n    var FindReplaceText = { findAndReplaceDOMText: findAndReplaceDOMText };\n\n    var getElmIndex = function (elm) {\n      var value = elm.getAttribute('data-mce-index');\n      if (typeof value === 'number') {\n        return '' + value;\n      }\n      return value;\n    };\n    var markAllMatches = function (editor, currentSearchState, regex) {\n      var node, marker;\n      marker = editor.dom.create('span', { 'data-mce-bogus': 1 });\n      marker.className = 'mce-match-marker';\n      node = editor.getBody();\n      done(editor, currentSearchState, false);\n      return FindReplaceText.findAndReplaceDOMText(regex, node, marker, false, editor.schema);\n    };\n    var unwrap = function (node) {\n      var parentNode = node.parentNode;\n      if (node.firstChild) {\n        parentNode.insertBefore(node.firstChild, node);\n      }\n      node.parentNode.removeChild(node);\n    };\n    var findSpansByIndex = function (editor, index) {\n      var nodes;\n      var spans = [];\n      nodes = global$1.toArray(editor.getBody().getElementsByTagName('span'));\n      if (nodes.length) {\n        for (var i = 0; i < nodes.length; i++) {\n          var nodeIndex = getElmIndex(nodes[i]);\n          if (nodeIndex === null || !nodeIndex.length) {\n            continue;\n          }\n          if (nodeIndex === index.toString()) {\n            spans.push(nodes[i]);\n          }\n        }\n      }\n      return spans;\n    };\n    var moveSelection = function (editor, currentSearchState, forward) {\n      var searchState = currentSearchState.get();\n      var testIndex = searchState.index;\n      var dom = editor.dom;\n      forward = forward !== false;\n      if (forward) {\n        if (testIndex + 1 === searchState.count) {\n          testIndex = 0;\n        } else {\n          testIndex++;\n        }\n      } else {\n        if (testIndex - 1 === -1) {\n          testIndex = searchState.count - 1;\n        } else {\n          testIndex--;\n        }\n      }\n      dom.removeClass(findSpansByIndex(editor, searchState.index), 'mce-match-marker-selected');\n      var spans = findSpansByIndex(editor, testIndex);\n      if (spans.length) {\n        dom.addClass(findSpansByIndex(editor, testIndex), 'mce-match-marker-selected');\n        editor.selection.scrollIntoView(spans[0]);\n        return testIndex;\n      }\n      return -1;\n    };\n    var removeNode = function (dom, node) {\n      var parent = node.parentNode;\n      dom.remove(node);\n      if (dom.isEmpty(parent)) {\n        dom.remove(parent);\n      }\n    };\n    var find = function (editor, currentSearchState, text, matchCase, wholeWord) {\n      text = text.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&');\n      text = text.replace(/\\s/g, '[^\\\\S\\\\r\\\\n]');\n      text = wholeWord ? '\\\\b' + text + '\\\\b' : text;\n      var count = markAllMatches(editor, currentSearchState, new RegExp(text, matchCase ? 'g' : 'gi'));\n      if (count) {\n        var newIndex = moveSelection(editor, currentSearchState, true);\n        currentSearchState.set({\n          index: newIndex,\n          count: count,\n          text: text,\n          matchCase: matchCase,\n          wholeWord: wholeWord\n        });\n      }\n      return count;\n    };\n    var next = function (editor, currentSearchState) {\n      var index = moveSelection(editor, currentSearchState, true);\n      currentSearchState.set(__assign(__assign({}, currentSearchState.get()), { index: index }));\n    };\n    var prev = function (editor, currentSearchState) {\n      var index = moveSelection(editor, currentSearchState, false);\n      currentSearchState.set(__assign(__assign({}, currentSearchState.get()), { index: index }));\n    };\n    var isMatchSpan = function (node) {\n      var matchIndex = getElmIndex(node);\n      return matchIndex !== null && matchIndex.length > 0;\n    };\n    var replace = function (editor, currentSearchState, text, forward, all) {\n      var searchState = currentSearchState.get();\n      var currentIndex = searchState.index;\n      var i, nodes, node, matchIndex, currentMatchIndex, nextIndex = currentIndex;\n      forward = forward !== false;\n      node = editor.getBody();\n      nodes = global$1.grep(global$1.toArray(node.getElementsByTagName('span')), isMatchSpan);\n      for (i = 0; i < nodes.length; i++) {\n        var nodeIndex = getElmIndex(nodes[i]);\n        matchIndex = currentMatchIndex = parseInt(nodeIndex, 10);\n        if (all || matchIndex === searchState.index) {\n          if (text.length) {\n            nodes[i].firstChild.nodeValue = text;\n            unwrap(nodes[i]);\n          } else {\n            removeNode(editor.dom, nodes[i]);\n          }\n          while (nodes[++i]) {\n            matchIndex = parseInt(getElmIndex(nodes[i]), 10);\n            if (matchIndex === currentMatchIndex) {\n              removeNode(editor.dom, nodes[i]);\n            } else {\n              i--;\n              break;\n            }\n          }\n          if (forward) {\n            nextIndex--;\n          }\n        } else if (currentMatchIndex > currentIndex) {\n          nodes[i].setAttribute('data-mce-index', String(currentMatchIndex - 1));\n        }\n      }\n      currentSearchState.set(__assign(__assign({}, searchState), {\n        count: all ? 0 : searchState.count - 1,\n        index: nextIndex\n      }));\n      if (forward) {\n        next(editor, currentSearchState);\n      } else {\n        prev(editor, currentSearchState);\n      }\n      return !all && currentSearchState.get().count > 0;\n    };\n    var done = function (editor, currentSearchState, keepEditorSelection) {\n      var i, nodes, startContainer, endContainer;\n      var searchState = currentSearchState.get();\n      nodes = global$1.toArray(editor.getBody().getElementsByTagName('span'));\n      for (i = 0; i < nodes.length; i++) {\n        var nodeIndex = getElmIndex(nodes[i]);\n        if (nodeIndex !== null && nodeIndex.length) {\n          if (nodeIndex === searchState.index.toString()) {\n            if (!startContainer) {\n              startContainer = nodes[i].firstChild;\n            }\n            endContainer = nodes[i].firstChild;\n          }\n          unwrap(nodes[i]);\n        }\n      }\n      currentSearchState.set(__assign(__assign({}, searchState), {\n        index: -1,\n        count: 0,\n        text: ''\n      }));\n      if (startContainer && endContainer) {\n        var rng = editor.dom.createRng();\n        rng.setStart(startContainer, 0);\n        rng.setEnd(endContainer, endContainer.data.length);\n        if (keepEditorSelection !== false) {\n          editor.selection.setRng(rng);\n        }\n        return rng;\n      }\n    };\n    var hasNext = function (editor, currentSearchState) {\n      return currentSearchState.get().count > 1;\n    };\n    var hasPrev = function (editor, currentSearchState) {\n      return currentSearchState.get().count > 1;\n    };\n\n    var get = function (editor, currentState) {\n      var done$1 = function (keepEditorSelection) {\n        return done(editor, currentState, keepEditorSelection);\n      };\n      var find$1 = function (text, matchCase, wholeWord) {\n        return find(editor, currentState, text, matchCase, wholeWord);\n      };\n      var next$1 = function () {\n        return next(editor, currentState);\n      };\n      var prev$1 = function () {\n        return prev(editor, currentState);\n      };\n      var replace$1 = function (text, forward, all) {\n        return replace(editor, currentState, text, forward, all);\n      };\n      return {\n        done: done$1,\n        find: find$1,\n        next: next$1,\n        prev: prev$1,\n        replace: replace$1\n      };\n    };\n    var Api = { get: get };\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isFunction = isType('function');\n\n    var nativeSlice = Array.prototype.slice;\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var value = function () {\n      var subject = Cell(Option.none());\n      var clear = function () {\n        subject.set(Option.none());\n      };\n      var set = function (s) {\n        subject.set(Option.some(s));\n      };\n      var on = function (f) {\n        subject.get().each(f);\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      return {\n        clear: clear,\n        set: set,\n        isSet: isSet,\n        on: on\n      };\n    };\n\n    var open = function (editor, currentSearchState) {\n      var dialogApi = value();\n      editor.undoManager.add();\n      var selectedText = global$1.trim(editor.selection.getContent({ format: 'text' }));\n      function updateButtonStates(api) {\n        var updateNext = hasNext(editor, currentSearchState) ? api.enable : api.disable;\n        updateNext('next');\n        var updatePrev = hasPrev(editor, currentSearchState) ? api.enable : api.disable;\n        updatePrev('prev');\n      }\n      var disableAll = function (api, disable) {\n        var buttons = [\n          'replace',\n          'replaceall',\n          'prev',\n          'next'\n        ];\n        var toggle = disable ? api.disable : api.enable;\n        each(buttons, toggle);\n      };\n      function notFoundAlert(api) {\n        editor.windowManager.alert('Could not find the specified string.', function () {\n          api.focus('findtext');\n        });\n      }\n      var reset = function (api) {\n        done(editor, currentSearchState, false);\n        disableAll(api, true);\n        updateButtonStates(api);\n      };\n      var doFind = function (api) {\n        var data = api.getData();\n        var last = currentSearchState.get();\n        if (!data.findtext.length) {\n          reset(api);\n          return;\n        }\n        if (last.text === data.findtext && last.matchCase === data.matchcase && last.wholeWord === data.wholewords) {\n          next(editor, currentSearchState);\n        } else {\n          var count = find(editor, currentSearchState, data.findtext, data.matchcase, data.wholewords);\n          if (count <= 0) {\n            notFoundAlert(api);\n          }\n          disableAll(api, count === 0);\n        }\n        updateButtonStates(api);\n      };\n      var initialState = currentSearchState.get();\n      var initialData = {\n        findtext: selectedText,\n        replacetext: '',\n        wholewords: initialState.wholeWord,\n        matchcase: initialState.matchCase\n      };\n      var spec = {\n        title: 'Find and Replace',\n        size: 'normal',\n        body: {\n          type: 'panel',\n          items: [\n            {\n              type: 'bar',\n              items: [\n                {\n                  type: 'input',\n                  name: 'findtext',\n                  placeholder: 'Find',\n                  maximized: true,\n                  inputMode: 'search'\n                },\n                {\n                  type: 'button',\n                  name: 'prev',\n                  text: 'Previous',\n                  icon: 'action-prev',\n                  disabled: true,\n                  borderless: true\n                },\n                {\n                  type: 'button',\n                  name: 'next',\n                  text: 'Next',\n                  icon: 'action-next',\n                  disabled: true,\n                  borderless: true\n                }\n              ]\n            },\n            {\n              type: 'input',\n              name: 'replacetext',\n              placeholder: 'Replace with',\n              inputMode: 'search'\n            }\n          ]\n        },\n        buttons: [\n          {\n            type: 'menu',\n            name: 'options',\n            icon: 'preferences',\n            tooltip: 'Preferences',\n            align: 'start',\n            items: [\n              {\n                type: 'togglemenuitem',\n                name: 'matchcase',\n                text: 'Match case'\n              },\n              {\n                type: 'togglemenuitem',\n                name: 'wholewords',\n                text: 'Find whole words only'\n              }\n            ]\n          },\n          {\n            type: 'custom',\n            name: 'find',\n            text: 'Find',\n            primary: true\n          },\n          {\n            type: 'custom',\n            name: 'replace',\n            text: 'Replace',\n            disabled: true\n          },\n          {\n            type: 'custom',\n            name: 'replaceall',\n            text: 'Replace All',\n            disabled: true\n          }\n        ],\n        initialData: initialData,\n        onChange: function (api, details) {\n          if (details.name === 'findtext' && currentSearchState.get().count > 0) {\n            reset(api);\n          }\n        },\n        onAction: function (api, details) {\n          var data = api.getData();\n          switch (details.name) {\n          case 'find':\n            doFind(api);\n            break;\n          case 'replace':\n            if (!replace(editor, currentSearchState, data.replacetext)) {\n              reset(api);\n            } else {\n              updateButtonStates(api);\n            }\n            break;\n          case 'replaceall':\n            replace(editor, currentSearchState, data.replacetext, true, true);\n            reset(api);\n            break;\n          case 'prev':\n            prev(editor, currentSearchState);\n            updateButtonStates(api);\n            break;\n          case 'next':\n            next(editor, currentSearchState);\n            updateButtonStates(api);\n            break;\n          default:\n            break;\n          }\n        },\n        onSubmit: doFind,\n        onClose: function () {\n          editor.focus();\n          done(editor, currentSearchState);\n          editor.undoManager.add();\n        }\n      };\n      dialogApi.set(editor.windowManager.open(spec, { inline: 'toolbar' }));\n    };\n    var Dialog = { open: open };\n\n    var register = function (editor, currentSearchState) {\n      editor.addCommand('SearchReplace', function () {\n        Dialog.open(editor, currentSearchState);\n      });\n    };\n    var Commands = { register: register };\n\n    var showDialog = function (editor, currentSearchState) {\n      return function () {\n        Dialog.open(editor, currentSearchState);\n      };\n    };\n    var register$1 = function (editor, currentSearchState) {\n      editor.ui.registry.addMenuItem('searchreplace', {\n        text: 'Find and replace...',\n        shortcut: 'Meta+F',\n        onAction: showDialog(editor, currentSearchState),\n        icon: 'search'\n      });\n      editor.ui.registry.addButton('searchreplace', {\n        tooltip: 'Find and replace',\n        onAction: showDialog(editor, currentSearchState),\n        icon: 'search'\n      });\n      editor.shortcuts.add('Meta+F', '', showDialog(editor, currentSearchState));\n    };\n    var Buttons = { register: register$1 };\n\n    function Plugin () {\n      global.add('searchreplace', function (editor) {\n        var currentSearchState = Cell({\n          index: -1,\n          count: 0,\n          text: '',\n          matchCase: false,\n          wholeWord: false\n        });\n        Commands.register(editor, currentSearchState);\n        Buttons.register(editor, currentSearchState);\n        return Api.get(editor, currentSearchState);\n      });\n    }\n\n    Plugin();\n\n}());\n"]}