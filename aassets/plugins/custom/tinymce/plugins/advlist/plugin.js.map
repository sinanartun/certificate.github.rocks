{"version":3,"sources":["advlist/plugin.js"],"names":["eq","call","id","me","global","tinymce","util","Tools","resolve","global$1","Actions","editor","listName","styleValue","cmd","execCommand","list-style-type","Commands","register","addCommand","ui","value","Settings","styles","getParam","split","noop","constant","never","always","none","NONE","o","isNone","fold","n","s","is","isSome","getOr","getOrThunk","thunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","Object","freeze","some","a","constant_a","self","f","v","elementEq","b","Option","ListUtils","node","test","nodeName","elm","$","contains","getBody","isChildOfBody","listElm","dom","getParent","selection","getNode","style","getStyle","isWithinList","e","tableCellIndex","list","predicate","index","length","findIndex","parents","slice","lists","grep","addControl","tooltip","registry","addSplitButton","icon","presets","columns","fetch","callback","type","text","replace","chr","toUpperCase","styleValueToText","onAction","onItemAction","splitButtonApi","select","listStyle","onSetup","api","nodeChangeHandler","setActive","on","off","addToggleButton","active","addButton","Buttons","add","plugin","plugins","settings","inArray","hasPlugin"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function () {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var applyListFormat = function (editor, listName, styleValue) {\n      var cmd = listName === 'UL' ? 'InsertUnorderedList' : 'InsertOrderedList';\n      editor.execCommand(cmd, false, styleValue === false ? null : { 'list-style-type': styleValue });\n    };\n    var Actions = { applyListFormat: applyListFormat };\n\n    var register = function (editor) {\n      editor.addCommand('ApplyUnorderedListStyle', function (ui, value) {\n        Actions.applyListFormat(editor, 'UL', value['list-style-type']);\n      });\n      editor.addCommand('ApplyOrderedListStyle', function (ui, value) {\n        Actions.applyListFormat(editor, 'OL', value['list-style-type']);\n      });\n    };\n    var Commands = { register: register };\n\n    var getNumberStyles = function (editor) {\n      var styles = editor.getParam('advlist_number_styles', 'default,lower-alpha,lower-greek,lower-roman,upper-alpha,upper-roman');\n      return styles ? styles.split(/[ ,]/) : [];\n    };\n    var getBulletStyles = function (editor) {\n      var styles = editor.getParam('advlist_bullet_styles', 'default,circle,square');\n      return styles ? styles.split(/[ ,]/) : [];\n    };\n    var Settings = {\n      getNumberStyles: getNumberStyles,\n      getBulletStyles: getBulletStyles\n    };\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var isChildOfBody = function (editor, elm) {\n      return editor.$.contains(editor.getBody(), elm);\n    };\n    var isTableCellNode = function (node) {\n      return node && /^(TH|TD)$/.test(node.nodeName);\n    };\n    var isListNode = function (editor) {\n      return function (node) {\n        return node && /^(OL|UL|DL)$/.test(node.nodeName) && isChildOfBody(editor, node);\n      };\n    };\n    var getSelectedStyleType = function (editor) {\n      var listElm = editor.dom.getParent(editor.selection.getNode(), 'ol,ul');\n      var style = editor.dom.getStyle(listElm, 'listStyleType');\n      return Option.from(style);\n    };\n    var ListUtils = {\n      isTableCellNode: isTableCellNode,\n      isListNode: isListNode,\n      getSelectedStyleType: getSelectedStyleType\n    };\n\n    var findIndex = function (list, predicate) {\n      for (var index = 0; index < list.length; index++) {\n        var element = list[index];\n        if (predicate(element)) {\n          return index;\n        }\n      }\n      return -1;\n    };\n    var styleValueToText = function (styleValue) {\n      return styleValue.replace(/\\-/g, ' ').replace(/\\b\\w/g, function (chr) {\n        return chr.toUpperCase();\n      });\n    };\n    var isWithinList = function (editor, e, nodeName) {\n      var tableCellIndex = findIndex(e.parents, ListUtils.isTableCellNode);\n      var parents = tableCellIndex !== -1 ? e.parents.slice(0, tableCellIndex) : e.parents;\n      var lists = global$1.grep(parents, ListUtils.isListNode(editor));\n      return lists.length > 0 && lists[0].nodeName === nodeName;\n    };\n    var addSplitButton = function (editor, id, tooltip, cmd, nodeName, styles) {\n      editor.ui.registry.addSplitButton(id, {\n        tooltip: tooltip,\n        icon: nodeName === 'OL' ? 'ordered-list' : 'unordered-list',\n        presets: 'listpreview',\n        columns: 3,\n        fetch: function (callback) {\n          var items = global$1.map(styles, function (styleValue) {\n            var iconStyle = nodeName === 'OL' ? 'num' : 'bull';\n            var iconName = styleValue === 'disc' || styleValue === 'decimal' ? 'default' : styleValue;\n            var itemValue = styleValue === 'default' ? '' : styleValue;\n            var displayText = styleValueToText(styleValue);\n            return {\n              type: 'choiceitem',\n              value: itemValue,\n              icon: 'list-' + iconStyle + '-' + iconName,\n              text: displayText\n            };\n          });\n          callback(items);\n        },\n        onAction: function () {\n          return editor.execCommand(cmd);\n        },\n        onItemAction: function (splitButtonApi, value) {\n          Actions.applyListFormat(editor, nodeName, value);\n        },\n        select: function (value) {\n          var listStyleType = ListUtils.getSelectedStyleType(editor);\n          return listStyleType.map(function (listStyle) {\n            return value === listStyle;\n          }).getOr(false);\n        },\n        onSetup: function (api) {\n          var nodeChangeHandler = function (e) {\n            api.setActive(isWithinList(editor, e, nodeName));\n          };\n          editor.on('NodeChange', nodeChangeHandler);\n          return function () {\n            return editor.off('NodeChange', nodeChangeHandler);\n          };\n        }\n      });\n    };\n    var addButton = function (editor, id, tooltip, cmd, nodeName, styles) {\n      editor.ui.registry.addToggleButton(id, {\n        active: false,\n        tooltip: tooltip,\n        icon: nodeName === 'OL' ? 'ordered-list' : 'unordered-list',\n        onSetup: function (api) {\n          var nodeChangeHandler = function (e) {\n            api.setActive(isWithinList(editor, e, nodeName));\n          };\n          editor.on('NodeChange', nodeChangeHandler);\n          return function () {\n            return editor.off('NodeChange', nodeChangeHandler);\n          };\n        },\n        onAction: function () {\n          return editor.execCommand(cmd);\n        }\n      });\n    };\n    var addControl = function (editor, id, tooltip, cmd, nodeName, styles) {\n      if (styles.length > 0) {\n        addSplitButton(editor, id, tooltip, cmd, nodeName, styles);\n      } else {\n        addButton(editor, id, tooltip, cmd, nodeName);\n      }\n    };\n    var register$1 = function (editor) {\n      addControl(editor, 'numlist', 'Numbered list', 'InsertOrderedList', 'OL', Settings.getNumberStyles(editor));\n      addControl(editor, 'bullist', 'Bullet list', 'InsertUnorderedList', 'UL', Settings.getBulletStyles(editor));\n    };\n    var Buttons = { register: register$1 };\n\n    function Plugin () {\n      global.add('advlist', function (editor) {\n        var hasPlugin = function (editor, plugin) {\n          var plugins = editor.settings.plugins ? editor.settings.plugins : '';\n          return global$1.inArray(plugins.split(/[ ,]/), plugin) !== -1;\n        };\n        if (hasPlugin(editor, 'lists')) {\n          Buttons.register(editor);\n          Commands.register(editor);\n        }\n      });\n    }\n\n    Plugin();\n\n}());\n"]}