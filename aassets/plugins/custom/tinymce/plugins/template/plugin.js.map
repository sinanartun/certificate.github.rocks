{"version":3,"sources":["template/plugin.js"],"names":["global","tinymce","util","Tools","resolve","noop","constant","value","eq","call","id","me","type","never","always","global$1","global$2","Settings","editor","getParam","editorSettings","templates","translate","addZeros","len","length","i","DateTimeHelper","fmt","date","daysShort","split","daysLong","monthsShort","monthsLong","Date","replace","getFullYear","getYear","getMonth","getDate","getHours","getMinutes","getSeconds","getDay","replaceTemplateValues","html","templateValues","each","v","k","RegExp","replaceVals","e","dom","vl","select","hasClass","n","c","test","className","Templates","callback","templateList","send","url","success","text","JSON","parse","ui","el","sel","selection","getContent","create","appendChild","cloneNode","innerHTML","execCommand","addVisual","Commands","register","addCommand","fn","initialArgs","_i","arguments","restArgs","all","concat","apply","curry","FilterContent","setup","on","o","dateFormat","node","none","NONE","isNone","fold","s","is","isSome","getOr","getOrThunk","thunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","bind","exists","forall","filter","equals","equals_","toArray","toString","Object","freeze","some","a","constant_a","self","f","elementEq","b","Option","from","isFunction","x","t","Array","prototype","isPrototypeOf","constructor","name","String","typeOf","nativeSlice","slice","global$3","hasOwnProperty","has","obj","key","entitiesAttr","\"","<",">","&","'","htmlEscape","match","Dialog","createSelectBoxItems","xs","r","findTemplate","templateTitle","pred","find","getTemplateContent","reject","content","error","onChange","updateDialog","api","change","newTemplateTitle","getData","template","block","then","previewHtml","unblock","onSubmit","data","close","message","notificationManager","open","index","isUrlTemplate","selected","title","description","createTemplates","selectBoxItems","buildDialogSpec","bodyItems","initialData","size","body","items","buttons","primary","dialogApi","indexOf","contentCssLinks_1","contentCSS","documentBaseURI","toAbsolute","bodyClass","settings","body_class","encode","directionality","getBody","dir","dirAttr","getPreviewContent","label","sandboxed","preview","redial","focus","windowManager","showDialog","Buttons","registry","addButton","icon","tooltip","onAction","addMenuItem","add"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function () {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    function curry(fn) {\n      var initialArgs = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        initialArgs[_i - 1] = arguments[_i];\n      }\n      return function () {\n        var restArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          restArgs[_i] = arguments[_i];\n        }\n        var all = initialArgs.concat(restArgs);\n        return fn.apply(null, all);\n      };\n    }\n    var never = constant(false);\n    var always = constant(true);\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.XHR');\n\n    var getCreationDateClasses = function (editor) {\n      return editor.getParam('template_cdate_classes', 'cdate');\n    };\n    var getModificationDateClasses = function (editor) {\n      return editor.getParam('template_mdate_classes', 'mdate');\n    };\n    var getSelectedContentClasses = function (editor) {\n      return editor.getParam('template_selected_content_classes', 'selcontent');\n    };\n    var getPreviewReplaceValues = function (editor) {\n      return editor.getParam('template_preview_replace_values');\n    };\n    var getTemplateReplaceValues = function (editor) {\n      return editor.getParam('template_replace_values');\n    };\n    var getTemplates = function (editorSettings) {\n      return editorSettings.templates;\n    };\n    var getCdateFormat = function (editor) {\n      return editor.getParam('template_cdate_format', editor.translate('%Y-%m-%d'));\n    };\n    var getMdateFormat = function (editor) {\n      return editor.getParam('template_mdate_format', editor.translate('%Y-%m-%d'));\n    };\n    var Settings = {\n      getCreationDateClasses: getCreationDateClasses,\n      getModificationDateClasses: getModificationDateClasses,\n      getSelectedContentClasses: getSelectedContentClasses,\n      getPreviewReplaceValues: getPreviewReplaceValues,\n      getTemplateReplaceValues: getTemplateReplaceValues,\n      getTemplates: getTemplates,\n      getCdateFormat: getCdateFormat,\n      getMdateFormat: getMdateFormat\n    };\n\n    var addZeros = function (value, len) {\n      value = '' + value;\n      if (value.length < len) {\n        for (var i = 0; i < len - value.length; i++) {\n          value = '0' + value;\n        }\n      }\n      return value;\n    };\n    var getDateTime = function (editor, fmt, date) {\n      var daysShort = 'Sun Mon Tue Wed Thu Fri Sat Sun'.split(' ');\n      var daysLong = 'Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday'.split(' ');\n      var monthsShort = 'Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec'.split(' ');\n      var monthsLong = 'January February March April May June July August September October November December'.split(' ');\n      date = date || new Date();\n      fmt = fmt.replace('%D', '%m/%d/%Y');\n      fmt = fmt.replace('%r', '%I:%M:%S %p');\n      fmt = fmt.replace('%Y', '' + date.getFullYear());\n      fmt = fmt.replace('%y', '' + date.getYear());\n      fmt = fmt.replace('%m', addZeros(date.getMonth() + 1, 2));\n      fmt = fmt.replace('%d', addZeros(date.getDate(), 2));\n      fmt = fmt.replace('%H', '' + addZeros(date.getHours(), 2));\n      fmt = fmt.replace('%M', '' + addZeros(date.getMinutes(), 2));\n      fmt = fmt.replace('%S', '' + addZeros(date.getSeconds(), 2));\n      fmt = fmt.replace('%I', '' + ((date.getHours() + 11) % 12 + 1));\n      fmt = fmt.replace('%p', '' + (date.getHours() < 12 ? 'AM' : 'PM'));\n      fmt = fmt.replace('%B', '' + editor.translate(monthsLong[date.getMonth()]));\n      fmt = fmt.replace('%b', '' + editor.translate(monthsShort[date.getMonth()]));\n      fmt = fmt.replace('%A', '' + editor.translate(daysLong[date.getDay()]));\n      fmt = fmt.replace('%a', '' + editor.translate(daysShort[date.getDay()]));\n      fmt = fmt.replace('%%', '%');\n      return fmt;\n    };\n    var DateTimeHelper = { getDateTime: getDateTime };\n\n    var createTemplateList = function (editorSettings, callback) {\n      return function () {\n        var templateList = Settings.getTemplates(editorSettings);\n        if (typeof templateList === 'function') {\n          templateList(callback);\n          return;\n        }\n        if (typeof templateList === 'string') {\n          global$2.send({\n            url: templateList,\n            success: function (text) {\n              callback(JSON.parse(text));\n            }\n          });\n        } else {\n          callback(templateList);\n        }\n      };\n    };\n    var replaceTemplateValues = function (html, templateValues) {\n      global$1.each(templateValues, function (v, k) {\n        if (typeof v === 'function') {\n          v = v(k);\n        }\n        html = html.replace(new RegExp('\\\\{\\\\$' + k + '\\\\}', 'g'), v);\n      });\n      return html;\n    };\n    var replaceVals = function (editor, e) {\n      var dom = editor.dom, vl = Settings.getTemplateReplaceValues(editor);\n      global$1.each(dom.select('*', e), function (e) {\n        global$1.each(vl, function (v, k) {\n          if (dom.hasClass(e, k)) {\n            if (typeof vl[k] === 'function') {\n              vl[k](e);\n            }\n          }\n        });\n      });\n    };\n    var hasClass = function (n, c) {\n      return new RegExp('\\\\b' + c + '\\\\b', 'g').test(n.className);\n    };\n    var insertTemplate = function (editor, ui, html) {\n      var el;\n      var n;\n      var dom = editor.dom;\n      var sel = editor.selection.getContent();\n      html = replaceTemplateValues(html, Settings.getTemplateReplaceValues(editor));\n      el = dom.create('div', null, html);\n      n = dom.select('.mceTmpl', el);\n      if (n && n.length > 0) {\n        el = dom.create('div', null);\n        el.appendChild(n[0].cloneNode(true));\n      }\n      global$1.each(dom.select('*', el), function (n) {\n        if (hasClass(n, Settings.getCreationDateClasses(editor).replace(/\\s+/g, '|'))) {\n          n.innerHTML = DateTimeHelper.getDateTime(editor, Settings.getCdateFormat(editor));\n        }\n        if (hasClass(n, Settings.getModificationDateClasses(editor).replace(/\\s+/g, '|'))) {\n          n.innerHTML = DateTimeHelper.getDateTime(editor, Settings.getMdateFormat(editor));\n        }\n        if (hasClass(n, Settings.getSelectedContentClasses(editor).replace(/\\s+/g, '|'))) {\n          n.innerHTML = sel;\n        }\n      });\n      replaceVals(editor, el);\n      editor.execCommand('mceInsertContent', false, el.innerHTML);\n      editor.addVisual();\n    };\n    var Templates = {\n      createTemplateList: createTemplateList,\n      replaceTemplateValues: replaceTemplateValues,\n      replaceVals: replaceVals,\n      insertTemplate: insertTemplate\n    };\n\n    var register = function (editor) {\n      editor.addCommand('mceInsertTemplate', curry(Templates.insertTemplate, editor));\n    };\n    var Commands = { register: register };\n\n    var setup = function (editor) {\n      editor.on('PreProcess', function (o) {\n        var dom = editor.dom, dateFormat = Settings.getMdateFormat(editor);\n        global$1.each(dom.select('div', o.node), function (e) {\n          if (dom.hasClass(e, 'mceTmpl')) {\n            global$1.each(dom.select('*', e), function (e) {\n              if (dom.hasClass(e, editor.getParam('template_mdate_classes', 'mdate').replace(/\\s+/g, '|'))) {\n                e.innerHTML = DateTimeHelper.getDateTime(editor, dateFormat);\n              }\n            });\n            Templates.replaceVals(editor, e);\n          }\n        });\n      });\n    };\n    var FilterContent = { setup: setup };\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isFunction = isType('function');\n\n    var nativeSlice = Array.prototype.slice;\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var find = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Option.some(x);\n        }\n      }\n      return Option.none();\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n    var hasOwnProperty = Object.hasOwnProperty;\n    var get = function (obj, key) {\n      return has(obj, key) ? Option.from(obj[key]) : Option.none();\n    };\n    var has = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n\n    var entitiesAttr = {\n      '\"': '&quot;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '&': '&amp;',\n      '\\'': '&#039;'\n    };\n    var htmlEscape = function (html) {\n      return html.replace(/[\"'<>&]/g, function (match) {\n        return get(entitiesAttr, match).getOr(match);\n      });\n    };\n\n    var getPreviewContent = function (editor, html) {\n      if (html.indexOf('<html>') === -1) {\n        var contentCssLinks_1 = '';\n        global$1.each(editor.contentCSS, function (url) {\n          contentCssLinks_1 += '<link type=\"text/css\" rel=\"stylesheet\" href=\"' + editor.documentBaseURI.toAbsolute(url) + '\">';\n        });\n        var bodyClass = editor.settings.body_class || '';\n        if (bodyClass.indexOf('=') !== -1) {\n          bodyClass = editor.getParam('body_class', '', 'hash');\n          bodyClass = bodyClass[editor.id] || '';\n        }\n        var encode = editor.dom.encode;\n        var directionality = editor.getBody().dir;\n        var dirAttr = directionality ? ' dir=\"' + encode(directionality) + '\"' : '';\n        html = '<!DOCTYPE html>' + '<html>' + '<head>' + contentCssLinks_1 + '</head>' + '<body class=\"' + encode(bodyClass) + '\"' + dirAttr + '>' + html + '</body>' + '</html>';\n      }\n      return Templates.replaceTemplateValues(html, Settings.getPreviewReplaceValues(editor));\n    };\n    var open = function (editor, templateList) {\n      var createTemplates = function () {\n        if (!templateList || templateList.length === 0) {\n          var message = editor.translate('No templates defined.');\n          editor.notificationManager.open({\n            text: message,\n            type: 'info'\n          });\n          return Option.none();\n        }\n        return Option.from(global$1.map(templateList, function (template, index) {\n          var isUrlTemplate = function (t) {\n            return t.url !== undefined;\n          };\n          return {\n            selected: index === 0,\n            text: template.title,\n            value: {\n              url: isUrlTemplate(template) ? Option.from(template.url) : Option.none(),\n              content: !isUrlTemplate(template) ? Option.from(template.content) : Option.none(),\n              description: template.description\n            }\n          };\n        }));\n      };\n      var createSelectBoxItems = function (templates) {\n        return map(templates, function (t) {\n          return {\n            text: t.text,\n            value: t.text\n          };\n        });\n      };\n      var findTemplate = function (templates, templateTitle) {\n        return find(templates, function (t) {\n          return t.text === templateTitle;\n        });\n      };\n      var getTemplateContent = function (t) {\n        return new global$3(function (resolve, reject) {\n          t.value.url.fold(function () {\n            return resolve(t.value.content.getOr(''));\n          }, function (url) {\n            return global$2.send({\n              url: url,\n              success: function (html) {\n                resolve(html);\n              },\n              error: function (e) {\n                reject(e);\n              }\n            });\n          });\n        });\n      };\n      var onChange = function (templates, updateDialog) {\n        return function (api, change) {\n          if (change.name === 'template') {\n            var newTemplateTitle = api.getData().template;\n            findTemplate(templates, newTemplateTitle).each(function (t) {\n              api.block('Loading...');\n              getTemplateContent(t).then(function (previewHtml) {\n                updateDialog(api, t, previewHtml);\n                api.unblock();\n              });\n            });\n          }\n        };\n      };\n      var onSubmit = function (templates) {\n        return function (api) {\n          var data = api.getData();\n          findTemplate(templates, data.template).each(function (t) {\n            getTemplateContent(t).then(function (previewHtml) {\n              Templates.insertTemplate(editor, false, previewHtml);\n              api.close();\n            });\n          });\n        };\n      };\n      var openDialog = function (templates) {\n        var selectBoxItems = createSelectBoxItems(templates);\n        var buildDialogSpec = function (bodyItems, initialData) {\n          return {\n            title: 'Insert Template',\n            size: 'large',\n            body: {\n              type: 'panel',\n              items: bodyItems\n            },\n            initialData: initialData,\n            buttons: [\n              {\n                type: 'cancel',\n                name: 'cancel',\n                text: 'Cancel'\n              },\n              {\n                type: 'submit',\n                name: 'save',\n                text: 'Save',\n                primary: true\n              }\n            ],\n            onSubmit: onSubmit(templates),\n            onChange: onChange(templates, updateDialog)\n          };\n        };\n        var updateDialog = function (dialogApi, template, previewHtml) {\n          var content = getPreviewContent(editor, previewHtml);\n          var bodyItems = [\n            {\n              type: 'selectbox',\n              name: 'template',\n              label: 'Templates',\n              items: selectBoxItems\n            },\n            {\n              type: 'htmlpanel',\n              html: '<p aria-live=\"polite\">' + htmlEscape(template.value.description) + '</p>'\n            },\n            {\n              label: 'Preview',\n              type: 'iframe',\n              name: 'preview',\n              sandboxed: false\n            }\n          ];\n          var initialData = {\n            template: template.text,\n            preview: content\n          };\n          dialogApi.unblock();\n          dialogApi.redial(buildDialogSpec(bodyItems, initialData));\n          dialogApi.focus('template');\n        };\n        var dialogApi = editor.windowManager.open(buildDialogSpec([], {\n          template: '',\n          preview: ''\n        }));\n        dialogApi.block('Loading...');\n        getTemplateContent(templates[0]).then(function (previewHtml) {\n          updateDialog(dialogApi, templates[0], previewHtml);\n        });\n      };\n      var optTemplates = createTemplates();\n      optTemplates.each(openDialog);\n    };\n    var Dialog = { open: open };\n\n    var showDialog = function (editor) {\n      return function (templates) {\n        Dialog.open(editor, templates);\n      };\n    };\n    var register$1 = function (editor) {\n      editor.ui.registry.addButton('template', {\n        icon: 'template',\n        tooltip: 'Insert template',\n        onAction: Templates.createTemplateList(editor.settings, showDialog(editor))\n      });\n      editor.ui.registry.addMenuItem('template', {\n        icon: 'template',\n        text: 'Insert template...',\n        onAction: Templates.createTemplateList(editor.settings, showDialog(editor))\n      });\n    };\n    var Buttons = { register: register$1 };\n\n    function Plugin () {\n      global.add('template', function (editor) {\n        Buttons.register(editor);\n        Commands.register(editor);\n        FilterContent.setup(editor);\n      });\n    }\n\n    Plugin();\n\n}());\n"]}