{"version":3,"sources":["fullpage/plugin.js"],"names":["domGlobals","merger","Cell","initial","value","get","set","v","clone","global","tinymce","util","Tools","resolve","global$1","global$2","global$3","global$4","Settings","editor","getParam","parseHeader","head","validate","root_name","parse","Parser","elm","matches","headerFragment","data","getAttr","name","attr","fontface","fontsize","firstChild","type","xml_pi","exec","docencoding","getAll","doctype","title","each","meta","httpEquiv","toLowerCase","langcode","stylesheets","link","push","langdir","style","visited_color","link_color","active_color","headElement","html","dom","setAttr","undefined","addHeadNode","node","insert","append","remove","substring","length","shortEnded","empty","split","i","nodes","currentStyleSheetsMap","stylesheet","rel","text","href","setAttribs","getBody","dir","vLink","aLink","indent","indent_before","indent_after","serialize","indexOf","hasOwnProperty","Object","prototype","merge","old","nu","objects","Array","arguments","Error","ret","j","curObject","key","call","Dialog","headState","initialData","keywords","description","robots","author","windowManager","open","size","body","items","label","buttons","primary","onSubmit","api","nuData","getData","headHtml","extend","close","Commands","register","addCommand","Protect","protect","pattern","replace","str","escape","a","m","unescape","low","s","getDefaultHeader","header","styles","piEncoding","FilterContent","setup","footState","on","evt","startPos","endPos","content","selection","settings","format","source_view","trim","bodyElm","headElm","getDoc","getElementsByTagName","add","id","appendChild","document","createTextNode","getAttribute","data-mce-fullpage","parentNode","removeChild","handleSetContent","foot","handleGetContent","Buttons","ui","registry","addButton","tooltip","icon","onAction","execCommand","addMenuItem","window"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      var clone = function () {\n        return Cell(get());\n      };\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.html.DomParser');\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.html.Node');\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.html.Serializer');\n\n    var shouldHideInSourceView = function (editor) {\n      return editor.getParam('fullpage_hide_in_source_view');\n    };\n    var getDefaultXmlPi = function (editor) {\n      return editor.getParam('fullpage_default_xml_pi');\n    };\n    var getDefaultEncoding = function (editor) {\n      return editor.getParam('fullpage_default_encoding');\n    };\n    var getDefaultFontFamily = function (editor) {\n      return editor.getParam('fullpage_default_font_family');\n    };\n    var getDefaultFontSize = function (editor) {\n      return editor.getParam('fullpage_default_font_size');\n    };\n    var getDefaultTextColor = function (editor) {\n      return editor.getParam('fullpage_default_text_color');\n    };\n    var getDefaultTitle = function (editor) {\n      return editor.getParam('fullpage_default_title');\n    };\n    var getDefaultDocType = function (editor) {\n      return editor.getParam('fullpage_default_doctype', '<!DOCTYPE html>');\n    };\n    var Settings = {\n      shouldHideInSourceView: shouldHideInSourceView,\n      getDefaultXmlPi: getDefaultXmlPi,\n      getDefaultEncoding: getDefaultEncoding,\n      getDefaultFontFamily: getDefaultFontFamily,\n      getDefaultFontSize: getDefaultFontSize,\n      getDefaultTextColor: getDefaultTextColor,\n      getDefaultTitle: getDefaultTitle,\n      getDefaultDocType: getDefaultDocType\n    };\n\n    var parseHeader = function (head) {\n      return global$2({\n        validate: false,\n        root_name: '#document'\n      }).parse(head);\n    };\n    var htmlToData = function (editor, head) {\n      var headerFragment = parseHeader(head);\n      var data = {};\n      var elm, matches;\n      function getAttr(elm, name) {\n        var value = elm.attr(name);\n        return value || '';\n      }\n      data.fontface = Settings.getDefaultFontFamily(editor);\n      data.fontsize = Settings.getDefaultFontSize(editor);\n      elm = headerFragment.firstChild;\n      if (elm.type === 7) {\n        data.xml_pi = true;\n        matches = /encoding=\"([^\"]+)\"/.exec(elm.value);\n        if (matches) {\n          data.docencoding = matches[1];\n        }\n      }\n      elm = headerFragment.getAll('#doctype')[0];\n      if (elm) {\n        data.doctype = '<!DOCTYPE' + elm.value + '>';\n      }\n      elm = headerFragment.getAll('title')[0];\n      if (elm && elm.firstChild) {\n        data.title = elm.firstChild.value;\n      }\n      global$1.each(headerFragment.getAll('meta'), function (meta) {\n        var name = meta.attr('name');\n        var httpEquiv = meta.attr('http-equiv');\n        var matches;\n        if (name) {\n          data[name.toLowerCase()] = meta.attr('content');\n        } else if (httpEquiv === 'Content-Type') {\n          matches = /charset\\s*=\\s*(.*)\\s*/gi.exec(meta.attr('content'));\n          if (matches) {\n            data.docencoding = matches[1];\n          }\n        }\n      });\n      elm = headerFragment.getAll('html')[0];\n      if (elm) {\n        data.langcode = getAttr(elm, 'lang') || getAttr(elm, 'xml:lang');\n      }\n      data.stylesheets = [];\n      global$1.each(headerFragment.getAll('link'), function (link) {\n        if (link.attr('rel') === 'stylesheet') {\n          data.stylesheets.push(link.attr('href'));\n        }\n      });\n      elm = headerFragment.getAll('body')[0];\n      if (elm) {\n        data.langdir = getAttr(elm, 'dir');\n        data.style = getAttr(elm, 'style');\n        data.visited_color = getAttr(elm, 'vlink');\n        data.link_color = getAttr(elm, 'link');\n        data.active_color = getAttr(elm, 'alink');\n      }\n      return data;\n    };\n    var dataToHtml = function (editor, data, head) {\n      var headerFragment, headElement, html, elm, value;\n      var dom = editor.dom;\n      function setAttr(elm, name, value) {\n        elm.attr(name, value ? value : undefined);\n      }\n      function addHeadNode(node) {\n        if (headElement.firstChild) {\n          headElement.insert(node, headElement.firstChild);\n        } else {\n          headElement.append(node);\n        }\n      }\n      headerFragment = parseHeader(head);\n      headElement = headerFragment.getAll('head')[0];\n      if (!headElement) {\n        elm = headerFragment.getAll('html')[0];\n        headElement = new global$3('head', 1);\n        if (elm.firstChild) {\n          elm.insert(headElement, elm.firstChild, true);\n        } else {\n          elm.append(headElement);\n        }\n      }\n      elm = headerFragment.firstChild;\n      if (data.xml_pi) {\n        value = 'version=\"1.0\"';\n        if (data.docencoding) {\n          value += ' encoding=\"' + data.docencoding + '\"';\n        }\n        if (elm.type !== 7) {\n          elm = new global$3('xml', 7);\n          headerFragment.insert(elm, headerFragment.firstChild, true);\n        }\n        elm.value = value;\n      } else if (elm && elm.type === 7) {\n        elm.remove();\n      }\n      elm = headerFragment.getAll('#doctype')[0];\n      if (data.doctype) {\n        if (!elm) {\n          elm = new global$3('#doctype', 10);\n          if (data.xml_pi) {\n            headerFragment.insert(elm, headerFragment.firstChild);\n          } else {\n            addHeadNode(elm);\n          }\n        }\n        elm.value = data.doctype.substring(9, data.doctype.length - 1);\n      } else if (elm) {\n        elm.remove();\n      }\n      elm = null;\n      global$1.each(headerFragment.getAll('meta'), function (meta) {\n        if (meta.attr('http-equiv') === 'Content-Type') {\n          elm = meta;\n        }\n      });\n      if (data.docencoding) {\n        if (!elm) {\n          elm = new global$3('meta', 1);\n          elm.attr('http-equiv', 'Content-Type');\n          elm.shortEnded = true;\n          addHeadNode(elm);\n        }\n        elm.attr('content', 'text/html; charset=' + data.docencoding);\n      } else if (elm) {\n        elm.remove();\n      }\n      elm = headerFragment.getAll('title')[0];\n      if (data.title) {\n        if (!elm) {\n          elm = new global$3('title', 1);\n          addHeadNode(elm);\n        } else {\n          elm.empty();\n        }\n        elm.append(new global$3('#text', 3)).value = data.title;\n      } else if (elm) {\n        elm.remove();\n      }\n      global$1.each('keywords,description,author,copyright,robots'.split(','), function (name) {\n        var nodes = headerFragment.getAll('meta');\n        var i, meta;\n        var value = data[name];\n        for (i = 0; i < nodes.length; i++) {\n          meta = nodes[i];\n          if (meta.attr('name') === name) {\n            if (value) {\n              meta.attr('content', value);\n            } else {\n              meta.remove();\n            }\n            return;\n          }\n        }\n        if (value) {\n          elm = new global$3('meta', 1);\n          elm.attr('name', name);\n          elm.attr('content', value);\n          elm.shortEnded = true;\n          addHeadNode(elm);\n        }\n      });\n      var currentStyleSheetsMap = {};\n      global$1.each(headerFragment.getAll('link'), function (stylesheet) {\n        if (stylesheet.attr('rel') === 'stylesheet') {\n          currentStyleSheetsMap[stylesheet.attr('href')] = stylesheet;\n        }\n      });\n      global$1.each(data.stylesheets, function (stylesheet) {\n        if (!currentStyleSheetsMap[stylesheet]) {\n          elm = new global$3('link', 1);\n          elm.attr({\n            rel: 'stylesheet',\n            text: 'text/css',\n            href: stylesheet\n          });\n          elm.shortEnded = true;\n          addHeadNode(elm);\n        }\n        delete currentStyleSheetsMap[stylesheet];\n      });\n      global$1.each(currentStyleSheetsMap, function (stylesheet) {\n        stylesheet.remove();\n      });\n      elm = headerFragment.getAll('body')[0];\n      if (elm) {\n        setAttr(elm, 'dir', data.langdir);\n        setAttr(elm, 'style', data.style);\n        setAttr(elm, 'vlink', data.visited_color);\n        setAttr(elm, 'link', data.link_color);\n        setAttr(elm, 'alink', data.active_color);\n        dom.setAttribs(editor.getBody(), {\n          style: data.style,\n          dir: data.dir,\n          vLink: data.visited_color,\n          link: data.link_color,\n          aLink: data.active_color\n        });\n      }\n      elm = headerFragment.getAll('html')[0];\n      if (elm) {\n        setAttr(elm, 'lang', data.langcode);\n        setAttr(elm, 'xml:lang', data.langcode);\n      }\n      if (!headElement.firstChild) {\n        headElement.remove();\n      }\n      html = global$4({\n        validate: false,\n        indent: true,\n        indent_before: 'head,html,body,meta,title,script,link,style',\n        indent_after: 'head,html,body,meta,title,script,link,style'\n      }).serialize(headerFragment);\n      return html.substring(0, html.indexOf('</body>'));\n    };\n    var Parser = {\n      parseHeader: parseHeader,\n      htmlToData: htmlToData,\n      dataToHtml: dataToHtml\n    };\n\n    var hasOwnProperty = Object.prototype.hasOwnProperty;\n    var shallow = function (old, nu) {\n      return nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n        for (var i = 0; i < objects.length; i++) {\n          objects[i] = arguments[i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (hasOwnProperty.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var merge = baseMerge(shallow);\n\n    var open = function (editor, headState) {\n      var data = Parser.htmlToData(editor, headState.get());\n      var defaultData = {\n        title: '',\n        keywords: '',\n        description: '',\n        robots: '',\n        author: '',\n        docencoding: ''\n      };\n      var initialData = merge(defaultData, data);\n      editor.windowManager.open({\n        title: 'Metadata and Document Properties',\n        size: 'normal',\n        body: {\n          type: 'panel',\n          items: [\n            {\n              name: 'title',\n              type: 'input',\n              label: 'Title'\n            },\n            {\n              name: 'keywords',\n              type: 'input',\n              label: 'Keywords'\n            },\n            {\n              name: 'description',\n              type: 'input',\n              label: 'Description'\n            },\n            {\n              name: 'robots',\n              type: 'input',\n              label: 'Robots'\n            },\n            {\n              name: 'author',\n              type: 'input',\n              label: 'Author'\n            },\n            {\n              name: 'docencoding',\n              type: 'input',\n              label: 'Encoding'\n            }\n          ]\n        },\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: initialData,\n        onSubmit: function (api) {\n          var nuData = api.getData();\n          var headHtml = Parser.dataToHtml(editor, global$1.extend(data, nuData), headState.get());\n          headState.set(headHtml);\n          api.close();\n        }\n      });\n    };\n    var Dialog = { open: open };\n\n    var register = function (editor, headState) {\n      editor.addCommand('mceFullPageProperties', function () {\n        Dialog.open(editor, headState);\n      });\n    };\n    var Commands = { register: register };\n\n    var protectHtml = function (protect, html) {\n      global$1.each(protect, function (pattern) {\n        html = html.replace(pattern, function (str) {\n          return '<!--mce:protected ' + escape(str) + '-->';\n        });\n      });\n      return html;\n    };\n    var unprotectHtml = function (html) {\n      return html.replace(/<!--mce:protected ([\\s\\S]*?)-->/g, function (a, m) {\n        return unescape(m);\n      });\n    };\n    var Protect = {\n      protectHtml: protectHtml,\n      unprotectHtml: unprotectHtml\n    };\n\n    var each = global$1.each;\n    var low = function (s) {\n      return s.replace(/<\\/?[A-Z]+/g, function (a) {\n        return a.toLowerCase();\n      });\n    };\n    var handleSetContent = function (editor, headState, footState, evt) {\n      var startPos, endPos, content, headerFragment, styles = '';\n      var dom = editor.dom;\n      if (evt.selection) {\n        return;\n      }\n      content = Protect.protectHtml(editor.settings.protect, evt.content);\n      if (evt.format === 'raw' && headState.get()) {\n        return;\n      }\n      if (evt.source_view && Settings.shouldHideInSourceView(editor)) {\n        return;\n      }\n      if (content.length === 0 && !evt.source_view) {\n        content = global$1.trim(headState.get()) + '\\n' + global$1.trim(content) + '\\n' + global$1.trim(footState.get());\n      }\n      content = content.replace(/<(\\/?)BODY/gi, '<$1body');\n      startPos = content.indexOf('<body');\n      if (startPos !== -1) {\n        startPos = content.indexOf('>', startPos);\n        headState.set(low(content.substring(0, startPos + 1)));\n        endPos = content.indexOf('</body', startPos);\n        if (endPos === -1) {\n          endPos = content.length;\n        }\n        evt.content = global$1.trim(content.substring(startPos + 1, endPos));\n        footState.set(low(content.substring(endPos)));\n      } else {\n        headState.set(getDefaultHeader(editor));\n        footState.set('\\n</body>\\n</html>');\n      }\n      headerFragment = Parser.parseHeader(headState.get());\n      each(headerFragment.getAll('style'), function (node) {\n        if (node.firstChild) {\n          styles += node.firstChild.value;\n        }\n      });\n      var bodyElm = headerFragment.getAll('body')[0];\n      if (bodyElm) {\n        dom.setAttribs(editor.getBody(), {\n          style: bodyElm.attr('style') || '',\n          dir: bodyElm.attr('dir') || '',\n          vLink: bodyElm.attr('vlink') || '',\n          link: bodyElm.attr('link') || '',\n          aLink: bodyElm.attr('alink') || ''\n        });\n      }\n      dom.remove('fullpage_styles');\n      var headElm = editor.getDoc().getElementsByTagName('head')[0];\n      if (styles) {\n        var styleElm = dom.add(headElm, 'style', { id: 'fullpage_styles' });\n        styleElm.appendChild(domGlobals.document.createTextNode(styles));\n      }\n      var currentStyleSheetsMap = {};\n      global$1.each(headElm.getElementsByTagName('link'), function (stylesheet) {\n        if (stylesheet.rel === 'stylesheet' && stylesheet.getAttribute('data-mce-fullpage')) {\n          currentStyleSheetsMap[stylesheet.href] = stylesheet;\n        }\n      });\n      global$1.each(headerFragment.getAll('link'), function (stylesheet) {\n        var href = stylesheet.attr('href');\n        if (!href) {\n          return true;\n        }\n        if (!currentStyleSheetsMap[href] && stylesheet.attr('rel') === 'stylesheet') {\n          dom.add(headElm, 'link', {\n            'rel': 'stylesheet',\n            'text': 'text/css',\n            'href': href,\n            'data-mce-fullpage': '1'\n          });\n        }\n        delete currentStyleSheetsMap[href];\n      });\n      global$1.each(currentStyleSheetsMap, function (stylesheet) {\n        stylesheet.parentNode.removeChild(stylesheet);\n      });\n    };\n    var getDefaultHeader = function (editor) {\n      var header = '', value, styles = '';\n      if (Settings.getDefaultXmlPi(editor)) {\n        var piEncoding = Settings.getDefaultEncoding(editor);\n        header += '<?xml version=\"1.0\" encoding=\"' + (piEncoding ? piEncoding : 'ISO-8859-1') + '\" ?>\\n';\n      }\n      header += Settings.getDefaultDocType(editor);\n      header += '\\n<html>\\n<head>\\n';\n      if (value = Settings.getDefaultTitle(editor)) {\n        header += '<title>' + value + '</title>\\n';\n      }\n      if (value = Settings.getDefaultEncoding(editor)) {\n        header += '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=' + value + '\" />\\n';\n      }\n      if (value = Settings.getDefaultFontFamily(editor)) {\n        styles += 'font-family: ' + value + ';';\n      }\n      if (value = Settings.getDefaultFontSize(editor)) {\n        styles += 'font-size: ' + value + ';';\n      }\n      if (value = Settings.getDefaultTextColor(editor)) {\n        styles += 'color: ' + value + ';';\n      }\n      header += '</head>\\n<body' + (styles ? ' style=\"' + styles + '\"' : '') + '>\\n';\n      return header;\n    };\n    var handleGetContent = function (editor, head, foot, evt) {\n      if (!evt.selection && (!evt.source_view || !Settings.shouldHideInSourceView(editor))) {\n        evt.content = Protect.unprotectHtml(global$1.trim(head) + '\\n' + global$1.trim(evt.content) + '\\n' + global$1.trim(foot));\n      }\n    };\n    var setup = function (editor, headState, footState) {\n      editor.on('BeforeSetContent', function (evt) {\n        handleSetContent(editor, headState, footState, evt);\n      });\n      editor.on('GetContent', function (evt) {\n        handleGetContent(editor, headState.get(), footState.get(), evt);\n      });\n    };\n    var FilterContent = { setup: setup };\n\n    var register$1 = function (editor) {\n      editor.ui.registry.addButton('fullpage', {\n        tooltip: 'Metadata and document properties',\n        icon: 'document-properties',\n        onAction: function () {\n          editor.execCommand('mceFullPageProperties');\n        }\n      });\n      editor.ui.registry.addMenuItem('fullpage', {\n        text: 'Metadata and document properties',\n        icon: 'document-properties',\n        onAction: function () {\n          editor.execCommand('mceFullPageProperties');\n        }\n      });\n    };\n    var Buttons = { register: register$1 };\n\n    function Plugin () {\n      global.add('fullpage', function (editor) {\n        var headState = Cell(''), footState = Cell('');\n        Commands.register(editor, headState);\n        Buttons.register(editor);\n        FilterContent.setup(editor, headState, footState);\n      });\n    }\n\n    Plugin();\n\n}(window));\n"]}